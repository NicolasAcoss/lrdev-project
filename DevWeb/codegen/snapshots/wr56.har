{
    "log": {
        "version": "1.2",
        "creator": {
            "name": "DevWeb",
            "version": "1.2"
        },
        "pages": [
            {
                "startedDateTime": "2022-12-06T11:38:13.494313Z",
                "id": "page_1",
                "title": "https://mail.etu.univ-lorraine.fr/zimbra/js/Startup1_2_all.js.zgz",
                "pageTimings": {}
            }
        ],
        "entries": [
            {
                "pageref": "page_1",
                "startedDateTime": "2022-12-06T11:38:13.494313Z",
                "time": 0,
                "_isResource": false,
                "request": {
                    "method": "GET",
                    "url": "https://mail.etu.univ-lorraine.fr/zimbra/js/Startup1_2_all.js.zgz?v=220726112844",
                    "httpVersion": "HTTP/2.0",
                    "cookies": [
                        {
                            "name": "UL-AUTHTRACE",
                            "value": "TRACE-4112-JXC2ao-ce1Zm2D1QbNJ8m16DlLYEFM9cZACAS-LEIA",
                            "httpOnly": false
                        },
                        {
                            "name": "JSESSIONID",
                            "value": "node01ewv5q86m64i21vkfxtflutla86873.node0",
                            "httpOnly": false
                        },
                        {
                            "name": "ZM_AUTH_TOKEN",
                            "value": "0_a80cf5ba65b244a73d683b9482d447f357160abf_69643d33363a62636630316235642d373166332d343464652d396163322d3235343836613061666531323b6578703d31333a313637303336363239323738353b747970653d363a7a696d6272613b753d313a613b7469643d31303a313932323132303830333b76657273696f6e3d31343a382e382e31355f47415f333836393b",
                            "httpOnly": false
                        }
                    ],
                    "headers": [
                        {
                            "name": "accept",
                            "value": "*/*"
                        },
                        {
                            "name": "accept-encoding",
                            "value": "gzip, deflate, br"
                        },
                        {
                            "name": "accept-language",
                            "value": "fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3"
                        },
                        {
                            "name": "cookie",
                            "value": "UL-AUTHTRACE=TRACE-4112-JXC2ao-ce1Zm2D1QbNJ8m16DlLYEFM9cZACAS-LEIA; JSESSIONID=node01ewv5q86m64i21vkfxtflutla86873.node0; ZM_AUTH_TOKEN=0_a80cf5ba65b244a73d683b9482d447f357160abf_69643d33363a62636630316235642d373166332d343464652d396163322d3235343836613061666531323b6578703d31333a313637303336363239323738353b747970653d363a7a696d6272613b753d313a613b7469643d31303a313932323132303830333b76657273696f6e3d31343a382e382e31355f47415f333836393b"
                        },
                        {
                            "name": "dnt",
                            "value": "1"
                        },
                        {
                            "name": "referer",
                            "value": "https://mail.etu.univ-lorraine.fr/"
                        },
                        {
                            "name": "sec-fetch-dest",
                            "value": "script"
                        },
                        {
                            "name": "sec-fetch-mode",
                            "value": "no-cors"
                        },
                        {
                            "name": "sec-fetch-site",
                            "value": "same-origin"
                        },
                        {
                            "name": "te",
                            "value": "trailers"
                        },
                        {
                            "name": "user-agent",
                            "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0"
                        }
                    ],
                    "queryString": [
                        {
                            "name": "v",
                            "value": "220726112844"
                        }
                    ],
                    "headersSize": -1,
                    "bodySize": -1
                },
                "response": {
                    "status": 200,
                    "statusText": "OK",
                    "httpVersion": "HTTP/2.0",
                    "cookies": null,
                    "headers": [
                        {
                            "name": "accept-ranges",
                            "value": "bytes"
                        },
                        {
                            "name": "cache-control",
                            "value": "public, max-age=2595600"
                        },
                        {
                            "name": "content-type",
                            "value": "text/javascript"
                        },
                        {
                            "name": "date",
                            "value": "Tue, 06 Dec 2022 10:38:13 GMT"
                        },
                        {
                            "name": "expires",
                            "value": "Thu, 5 Jan 2023 11:38:13 GMT"
                        },
                        {
                            "name": "last-modified",
                            "value": "Tue, 26 Jul 2022 15:30:06 GMT"
                        },
                        {
                            "name": "server",
                            "value": "nginx"
                        },
                        {
                            "name": "x-frame-options",
                            "value": "SAMEORIGIN"
                        },
                        {
                            "name": "x-recouv-allowed",
                            "value": "Recouv"
                        }
                    ],
                    "content": {
                        "size": 1001287,
                        "mimeType": "",
                        "text": "\n/* \n* Zimbra Collaboration Suite Web Client\n* Copyright (C) 2004-2017 Synacor, Inc.\n* https://www.zimbra.com/license\n*/\nif(AjxPackage.define(\"Startup1_2\")){if(AjxPackage.define(\"zimbraMail.share.model.ZmObjectHandler\")){ZmObjectHandler=function(a,b){if(arguments.length>0){this.init(a,b)\n}};\nZmObjectHandler.prototype.constructor=ZmObjectHandler;\nZmObjectHandler.prototype.isZmObjectHandler=true;\nZmObjectHandler.prototype.init=function(a,b){this._typeName=a;\nthis._className=b?b:\"Object\";\nthis.name=this.toString()\n};\nZmObjectHandler.prototype.toString=function(){if(!this._toString){var a=\"\"+this.constructor;\na=a.substring(0,a.indexOf(\"(\"));\nthis._toString=a.substring(\"function \".length)\n}return this._toString\n};\nZmObjectHandler.prototype.getEnabled=function(){return true\n};\nZmObjectHandler.prototype.getTypeName=function(){return this._typeName\n};\nZmObjectHandler.prototype.getClassName=function(c,a,b){return this._className\n};\nZmObjectHandler.prototype.getHoveredClassName=function(d,b,c){var a=this.getClassName(d,b,c);\nif(this._cachedClassNameForHovered!==a){this._cachedClassNameForHovered=a;\nthis._classNameHovered=a+\"-\"+DwtCssStyle.HOVER\n}return this._classNameHovered\n};\nZmObjectHandler.prototype.getActiveClassName=function(d,b,c){var a=this.getClassName(d,b,c);\nif(this._cachedClassNameForActive!==a){this._cachedClassNameForActive=a;\nthis._classNameActive=a+\"-\"+DwtCssStyle.ACTIVE\n}return this._classNameActive\n};\nZmObjectHandler.prototype.findObject=function(a,c,b){if(c===0){this._lastMatch=null;\nthis._noMatch=false\n}if(this._noMatch){return null\n}if(this._lastMatch&&this._lastMatch.index>=c){return this._lastMatch\n}this._lastMatch=this.match(a,c,b);\nthis._noMatch=(this._lastMatch===null);\nreturn this._lastMatch\n};\nZmObjectHandler.prototype.match=function(a,b){return null\n};\nZmObjectHandler.prototype._getHtmlContent=function(c,a,e,b,d){c[a++]=AjxStringUtil.htmlEncode(e,true);\nreturn a\n};\nZmObjectHandler.prototype.generateSpan=function(d,a,f,e,c,b){d[a++]=\"<span class='\";\nd[a++]=this.getClassName(f);\nd[a++]=\"' role='link' id='\";\nd[a++]=e;\nd[a++]=\"'>\";\na=this._getHtmlContent(d,a,f,c,e,b);\nd[a++]=\"</span>\";\nreturn a\n};\nZmObjectHandler.prototype.hasToolTipText=function(b,a){return true\n};\nZmObjectHandler.prototype.getToolTipText=function(b,a){return AjxStringUtil.htmlEncode(b)\n};\nZmObjectHandler.prototype.populateToolTip=function(b,a){};\nZmObjectHandler.prototype.getActionMenu=function(c,b,a){return null\n};\nZmObjectHandler.prototype.selected=function(d,b,c,a){return this.clicked(b,d,a,c)\n};\nZmObjectHandler.prototype.clicked=function(b,d,a,c){};\nZmObjectHandler.prototype.hoverOver=function(b,c,a,h){var f=this.getToolTipText(b,c)||\"\",e,g;\nif(typeof(f)===\"string\"){e=f\n}else{if(f.isAjxCallback||AjxUtil.isFunction(f)){g=f\n}else{if(typeof(f)===\"object\"){e=f.content;\ng=f.callback\n}}}if(!e&&g&&f.loading){e=AjxMsg.loading\n}if(e){this._showTooltip(b,c,a,h,e)\n}if(g){var d=new AjxCallback(this,this._showTooltip,[b,c,a,h]);\nAjxTimedAction.scheduleAction(new AjxTimedAction(null,function(){g.run(d)\n}),0)\n}};\nZmObjectHandler.prototype._showTooltip=function(b,d,a,g,e){var c=DwtShell.getShell(window);\nvar f=c.getToolTip();\nf.setContent(e);\nf.popup(a,g);\nthis.populateToolTip(b,d)\n};\nZmObjectHandler.prototype.hoverOut=function(a,c){var b=DwtShell.getShell(window);\nvar d=b.getToolTip();\nd.popdown()\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmObjectManager\")){ZmObjectManager=function(b,a,c){this._selectCallback=a;\nthis._uuid=Dwt.getNextId();\nthis._objectIdPrefix=\"OBJ_PREFIX_\";\nthis._objectHandlers={};\nif(appCtxt.get(ZmSetting.MAIL_ENABLED)&&window.ZmImageAttachmentObjectHandler){this._imageAttachmentHandler=new ZmImageAttachmentObjectHandler()\n}if(!c){this.initialized=false;\nthis._addAutoHandlers()\n}else{this.initialized=true\n}this.sortHandlers();\nthis.reset();\nthis.setView(b)\n};\nZmObjectManager._TOOLTIP_DELAY=275;\nZmObjectManager.EMAIL=\"email\";\nZmObjectManager.URL=\"url\";\nZmObjectManager.PHONE=\"phone\";\nZmObjectManager.DATE=\"date\";\nZmObjectManager.ADDRESS=\"address\";\nZmObjectManager.TITLE=\"title\";\nZmObjectManager.ATTR_CURRENT_DATE=\"currentDate\";\nZmObjectManager._autohandlers=[];\nZmObjectManager.registerHandler=function(obj,type,priority){if(typeof obj==\"string\"){obj=eval(obj)\n}var c=ZmObjectManager._autohandlers;\nif(!obj.__registered){var id=c.push(obj);\nvar i=id-1;\nif(type){c[i].useType=type\n}if(priority){c[i].usePrio=priority\n}obj.__registered=true\n}};\nZmObjectManager.unregisterHandler=function(obj){if(typeof obj==\"string\"){obj=eval(obj)\n}var c=ZmObjectManager._autohandlers,i;\nfor(i=c.length;\n--i>=0;\n){if(c[i]===obj){c.splice(i,1);\nbreak\n}}};\nZmObjectManager.prototype.toString=function(){return\"ZmObjectManager\"\n};\nZmObjectManager.prototype.getHandlers=function(){if(!this.initialized){var a=appCtxt.getZimletMgr();\nif(a.isLoaded()){this.initialized=true;\nvar c=a.getContentZimlets();\nfor(var b=0;\nb<c.length;\nb++){this.addHandler(c[b],c[b].type,c[b].prio)\n}}}return this._objectHandlers\n};\nZmObjectManager.prototype.addHandler=function(c,b,a){b=b||(c.getTypeName()?c.getTypeName():\"none\");\na=a?a:-1;\nc._prio=a;\nvar d=this.getHandlers();\nif(!d[b]){d[b]=[]\n}d[b].push(c)\n};\nZmObjectManager.prototype.removeHandler=function(c,b){b=b||(c.getTypeName()?c.getTypeName():\"none\");\nvar e=this.getHandlers();\nif(e[b]){for(var a=0,d=e[b].length;\na<d;\na++){if(e[b][a]==c){e[b].splice(a,1);\nbreak\n}}}};\nZmObjectManager.prototype.sortHandlers=function(){this._allObjectHandlers=[];\nvar c=this.getHandlers();\nfor(var b in c){c[b].sort(ZmObjectManager.__byPriority);\nfor(var a=0;\na<c[b].length;\na++){this._allObjectHandlers.push(c[b][a])\n}}this._allObjectHandlers.sort(ZmObjectManager.__byPriority)\n};\nZmObjectManager.prototype._addAutoHandlers=function(){var g=ZmObjectManager._autohandlers,a,e,f;\nfor(a=0;\na<g.length;\n++a){e=g[a];\nvar d=e;\nvar b=e.TYPE;\nif(!(e.isZmObjectHandler)){d=new e()\n}if(e.useType){b=e.useType\n}if(e.usePrio){f=e.usePrio\n}this.addHandler(d,b,f)\n}};\nZmObjectManager.prototype.reset=function(){this._objects={}\n};\nZmObjectManager.prototype.setView=function(a){if(a!=null&&appCtxt.getZimletMgr().isLoaded()){a.addListener(DwtEvent.ONMOUSEOVER,new AjxListener(this,this._mouseOverListener));\na.addListener(DwtEvent.ONMOUSEOUT,new AjxListener(this,this._mouseOutListener));\na.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));\na.addListener(DwtEvent.ONMOUSEUP,new AjxListener(this,this._mouseUpListener));\na.addListener(DwtEvent.ONMOUSEMOVE,new AjxListener(this,this._mouseMoveListener));\na.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._rightClickListener));\nthis._hoverOverListener=new AjxListener(this,this._handleHoverOver);\nthis._hoverOutListener=new AjxListener(this,this._handleHoverOut)\n}this._view=a\n};\nZmObjectManager.prototype.getView=function(){return this._view\n};\nZmObjectManager.prototype.objectsCount=function(){return(appCtxt.zimletsPresent())?appCtxt.getZimletMgr().getContentZimlets().length:0\n};\nZmObjectManager.prototype.getImageAttachmentHandler=function(){return this._imageAttachmentHandler\n};\nZmObjectManager.prototype._getAjxEmailAddress=function(a){if(appCtxt.isChildWindow&&a.isAjxEmailAddress){a=AjxEmailAddress.copy(a)\n}return a\n};\nZmObjectManager.prototype.findObjects=function(p,a,d,o,c){if(!p){return\"\"\n}var h=[];\nvar l=0;\nvar k=p.length;\nvar t=0;\nvar e=this.getHandlers();\nwhile(true){var u=null;\nvar q=k;\nvar n=null;\nvar s;\nvar m;\nvar g;\nvar f=null;\nif(d){m=e[d];\nif(m){for(s=0;\ns<m.length;\ns++){f=m[s].findObject(p,t,this);\nif(!f){continue\n}if(f.index>=q){break\n}u=f;\nq=f.index;\nn=m[s]\n}}if(d==\"email\"||p instanceof AjxEmailAddress){if(n){p=this._getAjxEmailAddress(p);\nthis.generateSpan(n,h,l,p,u,c)\n}else{h[l++]=AjxStringUtil.htmlEncode(p.toString())\n}return h.join(\"\")\n}}else{for(var r=0;\nr<this._allObjectHandlers.length;\nr++){var b=this._allObjectHandlers[r];\nf=b.findObject(p,t,this);\nif(f&&f.index<q){u=f;\nq=f.index;\nn=b\n}}}if(!u){g=p.substring(t,k);\nif(a){h[l++]=AjxStringUtil.htmlEncode(g,!!o)\n}else{h[l++]=g\n}break\n}if(q>t){g=p.substring(t,q);\nif(a){h[l++]=AjxStringUtil.htmlEncode(g,!!o)\n}else{h[l++]=g\n}}if(n){l=this.generateSpan(n,h,l,u[0],u.context)\n}else{h[l++]=u[0]\n}t=u.index+(u.matchLength||u[0].length)\n}return h.join(\"\")\n};\nZmObjectManager.prototype.processObjectsInNode=function(f,e){var a=this;\nf=f||e.ownerDocument;\nvar c=f.createElement(\"div\");\nvar d=function(k,l){var p,q,j,r;\nswitch(k.nodeType){case 1:k.normalize();\np=k.tagName.toLowerCase();\nif(r==null){if(/^(img|a)$/.test(p)){var g;\ntry{g=k.href\n}catch(t){}var m=p===\"a\"&&ZmMailMsgView._MAILTO_RE.test(g),s=p===\"a\"&&ZmMailMsgView._URL_RE.test(g);\nif((m||s)&&k.target){var o=m?g:RegExp.$1;\np=f.createElement(\"div\");\np.innerHTML=a.findObjects(AjxStringUtil.trim(o));\np=p.firstChild;\nif(p.nodeType==3){return p.nextSibling\n}k.parentNode.insertBefore(p,k);\np.innerHTML=\"\";\np.appendChild(k);\nreturn p.nextSibling\n}l=false\n}}else{k=r\n}if(parseFloat(k.style.textIndent)<0){k.style.textIndent=\"\"\n}for(q=k.firstChild;\nq;\nq=d(q,l)){}return k.nextSibling;\ncase 3:case 4:if(l&&/[^\\s\\xA0]/.test(k.data)){try{var x=null,v=null;\nif(!AjxEnv.isIE){var n=/^[\\s\\xA0]+/.exec(k.data);\nif(n){x=k;\nk=k.splitText(n[0].length)\n}n=/[\\s\\xA0]+$/.exec(k.data);\nif(n){v=k.splitText(k.data.length-n[0].length)\n}}p=c;\nvar h=a.findObjects(k.data,true,null,false);\nvar w=false;\nif(AjxEnv.isIE){p.innerHTML=[\"<pre>\",h,\"</pre>\"].join(\"\");\nw=true\n}else{p.innerHTML=h\n}if(x){p.insertBefore(x,p.firstChild)\n}if(v){p.appendChild(v)\n}x=k.parentNode;\nif(w){p=p.firstChild\n}while(p.firstChild){x.insertBefore(p.firstChild,k)\n}p=k.nextSibling;\nx.removeChild(k);\nreturn p\n}catch(u){}}}return k.nextSibling\n};\nif(e&&e.childNodes&&e.childNodes.length){for(var b=0;\nb<e.childNodes.length;\nb++){d(e.childNodes[b],true)\n}}};\nZmObjectManager.prototype.findObjectsInNode=function(c,b,e,f){var d=this,h=c.ownerDocument,i=h.createElement(\"div\");\nif(!b){b=/^(script|link|object|iframe|applet)$/i\n}var a=function(l,m){var o,p,k,r;\nswitch(l.nodeType){case 1:l.normalize();\no=l.tagName.toLowerCase();\nif(f&&f.foreachElement){r=f.foreachElement(l,o,b,e)\n}if(r==null){if(/^(img|a)$/.test(o)){if(o==\"a\"&&l.target&&(ZmMailMsgView._URL_RE.test(l.href)||ZmMailMsgView._MAILTO_RE.test(l.href))){var q=RegExp.$1;\no=h.createElement(\"div\");\no.innerHTML=d.findObjects(AjxStringUtil.trim(RegExp.$1));\no=o.firstChild;\nif(o.nodeType==3){return o.nextSibling\n}l.parentNode.insertBefore(o,l);\no.innerHTML=\"\";\no.appendChild(l);\nreturn o.nextSibling\n}m=false\n}else{if(b.test(o)||(e&&!e.test(o))){o=l.nextSibling;\nl.parentNode.removeChild(l);\nreturn o\n}}}else{l=r\n}if(AjxEnv.isIE){l.style.cssText=l.style.cssText\n}for(p=l.firstChild;\np;\np=a(p,m)){}return l.nextSibling;\ncase 3:case 4:if(m&&/[^\\s\\xA0]/.test(l.data)){try{var v=null,t=null;\nif(!AjxEnv.isIE){var n=/^[\\s\\xA0]+/.exec(l.data);\nif(n){v=l;\nl=l.splitText(n[0].length)\n}n=/[\\s\\xA0]+$/.exec(l.data);\nif(n){t=l.splitText(l.data.length-n[0].length)\n}}o=i;\nvar j=d.findObjects(l.data,true,null,false);\nvar u=false;\nif(AjxEnv.isIE){o.innerHTML=[\"<pre>\",j,\"</pre>\"].join(\"\");\nu=true\n}else{o.innerHTML=j\n}if(v){o.insertBefore(v,o.firstChild)\n}if(t){o.appendChild(t)\n}v=l.parentNode;\nif(u){o=o.firstChild\n}while(o.firstChild){v.insertBefore(o.firstChild,l)\n}o=l.nextSibling;\nv.removeChild(l);\nreturn o\n}catch(s){}}}return l.nextSibling\n};\nvar g=h.createDocumentFragment();\nwhile(c.firstChild){g.appendChild(c.firstChild);\na(g.lastChild,true,this)\n}c.appendChild(g)\n};\nZmObjectManager.prototype.setHandlerAttr=function(d,b,e){var a=this.getHandlers()[d];\nif(a){for(var c=0;\nc<a.length;\nc++){a[c][b]=e\n}}};\nZmObjectManager.prototype.generateSpan=function(e,d,a,f,c,b){var g=this._objectIdPrefix+Dwt.getNextId();\nif(e&&e.name){g=g+\"_\"+e.name\n}this._objects[g]={object:f,handler:e,id:g,context:c};\nreturn e.generateSpan(d,a,f,g,c,b)\n};\nZmObjectManager.prototype._findObjectSpan=function(a){while(a&&(!a.id||a.id.indexOf(this._objectIdPrefix)!==0)){a=a.parentNode\n}return a\n};\nZmObjectManager.prototype._mouseOverListener=function(e){var d=this._findObjectSpan(e.target);\nif(!d){return false\n}var a=this._objects[d.id];\nif(!a){return false\n}d.className=a.handler.getHoveredClassName(a.object,a.context,d.id);\nif(a.handler.hasToolTipText()){var c=DwtShell.getShell(window);\nvar b=c.getHoverMgr();\nif((!b.isHovering()||b.getHoverObject()!=a)&&!DwtMenu.menuShowing()){b.reset();\nb.setHoverOverDelay(ZmObjectManager._TOOLTIP_DELAY);\nb.setHoverObject(a);\nb.setHoverOverData(a);\nb.setHoverOverListener(this._hoverOverListener);\nb.hoverOver(e.docX,e.docY);\ne.hoverStarted=true\n}}e._returnValue=true;\ne._dontCallPreventDefault=true;\nreturn false\n};\nZmObjectManager.prototype._mouseOutListener=function(e){var d=this._findObjectSpan(e.target);\nvar a=d?this._objects[d.id]:null;\nif(a){d.className=a.handler.getClassName(a.object,a.context,d.id);\nvar c=DwtShell.getShell(window);\nvar b=c.getHoverMgr();\nb.setHoverOutDelay(150);\nb.setHoverOutData(a);\nb.setHoverOutListener(this._hoverOutListener);\nb.hoverOut()\n}return false\n};\nZmObjectManager.prototype._mouseMoveListener=function(e){e._returnValue=true;\ne._dontCallPreventDefault=true;\ne._stopPropagation=true;\nvar d=this._findObjectSpan(e.target);\nvar a=d?this._objects[d.id]:null;\nif(a){var c=DwtShell.getShell(window);\nvar b=c.getHoverMgr();\nif(!b.isHovering()){b.hoverOver(e.docX,e.docY)\n}}return false\n};\nZmObjectManager.prototype._rightClickListener=function(a){a.button=DwtMouseEvent.RIGHT;\nreturn this._mouseDownListener(a)\n};\nZmObjectManager.prototype._mouseDownListener=function(e){if(!e._authoritative){e._dontCallPreventDefault=true;\ne._returnValue=true;\ne._stopPropagation=false\n}var d=this._findObjectSpan(e.target);\nif(!d){return true\n}var a=this._objects[d.id];\nif(!a){return true\n}e._stopPropagation=true;\nvar c=DwtShell.getShell(window);\nvar b=c.getHoverMgr();\nb.setHoverOutDelay(0);\nb.setHoverOutData(a);\nb.setHoverOutListener(this._hoverOutListener);\nb.hoverOut();\nd.className=a.handler.getActiveClassName(a.object,a.context,d.id);\nif(e.button==DwtMouseEvent.RIGHT){var f=a.handler.getActionMenu(a.object,d,a.context,e);\nif(f){f.popup(0,e.docX,e.docY);\ne._dontCallPreventDefault=false;\ne._returnValue=false;\ne._stopPropagation=true;\nreturn true\n}}else{if(e.button==DwtMouseEvent.LEFT){if(this._selectCallback){this._selectCallback.run()\n}a.handler.selected(a.object,d,e,a.context);\nreturn true\n}}return false\n};\nZmObjectManager.prototype._mouseUpListener=function(c){c._returnValue=true;\nc._dontCallPreventDefault=true;\nc._stopPropagation=true;\nvar b=this._findObjectSpan(c.target);\nif(!b){return false\n}var a=this._objects[b.id];\nif(!a){return false\n}b.className=a.handler.getHoveredClassName(a.object,a.context,b.id);\nreturn false\n};\nZmObjectManager.prototype._handleHoverOver=function(f){if(!(f&&f.object)){return\n}var e=this._findObjectSpan(f.target);\nvar d=f.object.handler;\nvar b=f.object.object;\nvar c=f.object.context;\nvar h=f.object.id;\nvar a=f.x;\nvar g=f.y;\nd.hoverOver(b,c,a,g,e,h)\n};\nZmObjectManager.prototype._handleHoverOut=function(e){if(!(e&&e.object)){return\n}var d=this._findObjectSpan(e.target);\nvar c=e.object.handler;\nvar a=e.object.object;\nvar b=e.object.context;\nvar f=e.object.id;\nc.hoverOut(a,b,d,f)\n};\nZmObjectManager.__byPriority=function(d,c){return(c._prio<d._prio)-(d._prio<c._prio)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmSettings\")){ZmSettings=function(a){ZmModel.call(this,ZmEvent.S_SETTINGS);\nthis._settings={};\nthis._nameToId={};\nthis.getInfoResponse=null;\nthis._handleImplicitChange=new AjxListener(this,this._implicitChangeListener);\nif(!a){this.initialize()\n}};\nZmSettings.prototype=new ZmModel;\nZmSettings.prototype.constructor=ZmSettings;\nZmSettings.BASE64_TO_NORMAL_RATIO=1.34;\nZmSettings.prototype.registerSetting=function(c,b){ZmSetting[c]=c;\nvar a=this._settings[c]=new ZmSetting(c,b);\nif(b.name){this._nameToId[b.name]=c\n}if(b.isImplicit){a.addChangeListener(this._handleImplicitChange)\n}return a\n};\nZmSettings.prototype.toString=function(){return\"ZmSettings\"\n};\nZmSettings.prototype.initialize=function(){this._initialize();\nthis._setDefaults();\nthis.userSettingsLoaded=false;\nvar a=new AjxListener(this,this._changeListener);\nif(!appCtxt.multiAccounts){this.getSetting(ZmSetting.QUOTA_USED).addChangeListener(a)\n}this.getSetting(ZmSetting.POLLING_INTERVAL).addChangeListener(a);\nthis.getSetting(ZmSetting.SKIN_NAME).addChangeListener(a);\nthis.getSetting(ZmSetting.SHOW_SELECTION_CHECKBOX).addChangeListener(a);\nthis.getSetting(ZmSetting.LOCALE_NAME).addChangeListener(a);\nthis.getSetting(ZmSetting.FONT_NAME).addChangeListener(a);\nthis.getSetting(ZmSetting.FONT_SIZE).addChangeListener(a);\nthis.getSetting(ZmSetting.SHORTCUTS).addChangeListener(a);\nthis.getSetting(ZmSetting.CHILD_ACCTS_VISIBLE).addChangeListener(a);\nthis.getSetting(ZmSetting.ATTACHMENTS_BLOCKED).addChangeListener(a);\nthis.getSetting(ZmSetting.CHAT_PLAY_SOUND).addChangeListener(a);\nthis.getSetting(ZmSetting.CHAT_ENABLED).addChangeListener(a);\nthis.getSetting(ZmSetting.DISPLAY_TIME_IN_MAIL_LIST).addChangeListener(a);\nif(appCtxt.isOffline){this.getSetting(ZmSetting.OFFLINE_IS_MAILTO_HANDLER).addChangeListener(a);\nthis.getSetting(ZmSetting.OFFLINE_BACKUP_ACCOUNT_ID).addChangeListener(a);\nthis.getSetting(ZmSetting.OFFLINE_BACKUP_INTERVAL).addChangeListener(a);\nthis.getSetting(ZmSetting.OFFLINE_BACKUP_PATH).addChangeListener(a);\nthis.getSetting(ZmSetting.OFFLINE_BACKUP_KEEP).addChangeListener(a);\nthis.getSetting(ZmSetting.OFFLINE_UPDATE_NOTIFY).addChangeListener(a)\n}};\nZmSettings.prototype.get=function(b,a){return(b&&this._settings[b])?this._settings[b].getValue(a):null\n};\nZmSettings.prototype.set=function(f,e,b,c,a,d){if(f&&this._settings[f]){this._settings[f].setValue(e,b,c,a,d)\n}else{}};\nZmSettings.prototype.getSetting=function(a){return this._settings[a]\n};\nZmSettings.prototype.createFromJs=function(h,l,k,n){n=n==null||n;\nfor(var f in h){var d=h[f];\nvar o=this._settings[this._nameToId[f]];\nif(o){if(o.dataType==ZmSetting.D_HASH){var c=d.split(\",\");\nvar m={};\nfor(var e=0;\ne<c.length;\ne++){var g=c[e].split(\":\");\nif(o.name===\"zimbraPrefFoldersExpanded\"&&g.length>2){var b=g.pop();\nvar a=g.join(\":\");\nm[a]=b\n}else{m[g[0]]=g[1]\n}}d=m\n}o.setValue(d,null,l,k,n);\nif(ZmSetting.IS_IMPLICIT[o.id]){o.origValue=o.copyValue()\n}}else{}}};\nZmSettings.prototype.getSettingByName=function(a){return this._nameToId[a]\n};\nZmSettings.prototype.attrExists=function(b){var a=this.getSetting(b).name;\nreturn(this.getInfoResponse.prefs._attrs[a]||this.getInfoResponse.attrs._attrs[a])\n};\nZmSettings.prototype.loadUserSettings=function(h,d,g,c,a){var e=[h,g];\nvar f=AjxSoapDoc.create(\"GetInfoRequest\",\"urn:zimbraAccount\");\nf.setMethodAttribute(\"rights\",\"createDistList\");\nvar i=this._handleResponseLoadUserSettings.bind(this,e);\nif(a){a.addNewRequestParams(f,i)\n}else{var b={soapDoc:(c?null:f),accountName:g,asyncMode:true,callback:i,errorCallback:d,response:c};\nappCtxt.getAppController().sendRequest(b)\n}};\nZmSettings.prototype._handleResponseLoadUserSettings=function(c,b,a){this.setUserSettings(a.getResponse().GetInfoResponse,b);\nthis.userSettingsLoaded=true;\nif(c){c.run(a)\n}};\nZmSettings.prototype.setUserSettings=function(r){r=Dwt.getParams(arguments,[\"info\",\"accountName\",\"setDefault\",\"skipNotify\",\"skipImplicit\",\"preInit\"]);\nvar p=this.getInfoResponse=r.info;\nappCtxt.createDistListAllowed=false;\nappCtxt.createDistListAllowedDomains=[];\nappCtxt.createDistListAllowedDomainsMap={};\nvar f=p.rights&&p.rights.targets;\nif(f){for(var m=0;\nm<f.length;\nm++){var t=f[m];\nif(t.right==\"createDistList\"){if(t.target[0].type==\"domain\"){appCtxt.createDistListAllowed=true;\nappCtxt.createDistListAllowedDomains.push(t.target[0].name);\nappCtxt.createDistListAllowedDomainsMap[t.target[0].name]=true;\nbreak\n}}}}if(this.get(ZmSetting.ADMIN_DELEGATED)){if(!this.get(ZmSetting.ADMIN_MAIL_ENABLED)&&this.get(ZmSetting.ADMIN_PREFERENCES_ENABLED)){(new ZmMailApp()).enableMailPrefs()\n}}this.set(ZmSetting.VOICE_ENABLED,this._hasVoiceFeature(),null,false,true);\nvar a=r.accountName;\nvar q=r.preInit?false:r.setDefault;\nvar h=r.preInit?true:r.skipNotify;\nvar c=r.preInit?true:r.skipImplicit;\nvar o=[ZmSetting.ADMIN_DELEGATED,p.adminDelegated,ZmSetting.MESSAGE_SIZE_LIMIT,this._base64toNormalSize(p.attSizeLimit),ZmSetting.CHANGE_PASSWORD_URL,p.changePasswordURL,ZmSetting.DOCUMENT_SIZE_LIMIT,this._base64toNormalSize(p.docSizeLimit),ZmSetting.LAST_ACCESS,p.accessed,ZmSetting.LICENSE_STATUS,p.license&&p.license.status,ZmSetting.PREVIOUS_SESSION,p.prevSession,ZmSetting.PUBLIC_URL,p.publicURL,ZmSetting.ADMIN_URL,p.adminURL,ZmSetting.QUOTA_USED,p.used,ZmSetting.RECENT_MESSAGES,p.recent,ZmSetting.REST_URL,p.rest,ZmSetting.USERNAME,p.name,ZmSetting.EMAIL_VALIDATION_REGEX,p.zimbraMailAddressValidationRegex,ZmSetting.HAB_ROOT,(p.habRoots&&p.habRoots.hab?p.habRoots.hab:false),ZmSetting.SPELL_CHECK_ENABLED,p.isSpellCheckAvailable,ZmSetting.DISABLE_SENSITIVE_ZIMLETS_IN_MIXED_MODE,(p.domainSettings&&p.domainSettings.zimbraZimletDataSensitiveInMixedModeDisabled?p.domainSettings.zimbraZimletDataSensitiveInMixedModeDisabled:\"FALSE\")];\nfor(var m=0;\nm<o.length;\nm+=2){var k=o[m+1];\nif(k!=null){this.set(o[m],k,null,q,h,c)\n}}if(p.attrs&&p.attrs._attrs){this.createFromJs(p.attrs._attrs,q,h,c)\n}if(this.get(ZmSetting.ADMIN_DELEGATED)){this.set(ZmSetting.MAIL_ENABLED,this.get(ZmSetting.ADMIN_MAIL_ENABLED),q,h,c);\nvar d=this.get(ZmSetting.MAIL_ENABLED)||(this.get(ZmSetting.ADMIN_DELEGATED)&&this.get(ZmSetting.ADMIN_PREFERENCES_ENABLED));\nthis.set(ZmSetting.MAIL_PREFERENCES_ENABLED,d,q,h,c);\nif(this.get(ZmSetting.MAIL_PREFERENCES_ENABLED)&&!this.get(ZmSetting.MAIL_ENABLED)){this.set(ZmSetting.MAIL_FORWARDING_ENABLED,false,q,h,c);\nthis.set(ZmSetting.FILTERS_MAIL_FORWARDING_ENABLED,false,q,h,c);\nthis.set(ZmSetting.NOTIF_FEATURE_ENABLED,false,q,h,c)\n}}if(p.communityURL){this.set(ZmSetting.SOCIAL_EXTERNAL_URL,p.communityURL,null,q,h)\n}if(r.preInit){return\n}if(p.prefs&&p.prefs._attrs){this.createFromJs(p.prefs._attrs,q,h,c)\n}var j;\nif(!a){appCtxt.accountList.createAccounts(this,p);\nif(appCtxt.isOffline){if(AjxEnv.isPrism&&window.platform){this.set(ZmSetting.OFFLINE_SUPPORTS_MAILTO,true,null,q,h,c);\nthis.set(ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE,true,null,q,h,c)\n}appCtxt.set(ZmSetting.SHARING_ENABLED,true,null,q,h)\n}}j=this._settings[ZmSetting.REPLY_TO_ADDRESS];\nif(j){j.defaultValue=this.get(ZmSetting.USERNAME)\n}if(this.get(ZmSetting.FORCE_CAL_OFF)){this.set(ZmSetting.CALENDAR_ENABLED,false,null,q,h,c)\n}if(!this.get(ZmSetting.OPTIONS_ENABLED)){this.set(ZmSetting.FILTERS_ENABLED,false,null,q,h,c)\n}if(!a){if(p.zimlets&&p.zimlets.zimlet){if(this.get(ZmSetting.ZIMLETS_SYNCHRONOUS)){var l=new AjxTimedAction(this,this._beginLoadZimlets,[p.zimlets.zimlet,p.props.prop,true]);\nAjxTimedAction.scheduleAction(l,0)\n}else{var e=new AjxListener(this,this._beginLoadZimlets,[p.zimlets.zimlet,p.props.prop,false]);\nappCtxt.getAppController().addListener(ZmAppEvent.POST_STARTUP,e)\n}}else{appCtxt.allZimletsLoaded()\n}}var k=appCtxt.get(ZmSetting.REPLY_INCLUDE_ORIG);\nif(k){var n=ZmMailApp.INC_MAP[k];\nappCtxt.set(ZmSetting.REPLY_INCLUDE_WHAT,n[0],null,q,h);\nappCtxt.set(ZmSetting.REPLY_USE_PREFIX,n[1],null,q,h);\nappCtxt.set(ZmSetting.REPLY_INCLUDE_HEADERS,n[2],null,q,h)\n}var k=appCtxt.get(ZmSetting.FORWARD_INCLUDE_ORIG);\nif(k){var n=ZmMailApp.INC_MAP[k];\nappCtxt.set(ZmSetting.FORWARD_INCLUDE_WHAT,n[0],null,q,h);\nappCtxt.set(ZmSetting.FORWARD_USE_PREFIX,n[1],null,q,h);\nappCtxt.set(ZmSetting.FORWARD_INCLUDE_HEADERS,n[2],null,q,h)\n}var b=ZmSettings.DEFAULT_SORT_PREF;\nb[ZmId.VIEW_CONVLIST]=ZmSearch.DATE_DESC;\nb[ZmId.VIEW_CONV]=ZmSearch.DATE_DESC;\nb[ZmId.VIEW_TRAD]=ZmSearch.DATE_DESC;\nb[ZmId.VIEW_CONTACT_SRC]=ZmSearch.NAME_ASC;\nb[ZmId.VIEW_CONTACT_TGT]=ZmSearch.NAME_ASC;\nb[ZmId.VIEW_CONTACT_SIMPLE]=ZmSearch.NAME_ASC;\nb[ZmId.VIEW_CAL]=ZmSearch.DATE_ASC;\nb[ZmId.VIEW_TASKLIST]=ZmSearch.DUE_DATE_ASC;\nb[ZmId.VIEW_BRIEFCASE_DETAIL]=ZmSearch.SUBJ_ASC;\nvar g=this._settings[ZmSetting.SORTING_PREF];\nif(g){for(var s in b){if(!g.getValue(s)){g.setValue(b[s],s,false,true)\n}}g.defaultValue=AjxUtil.hashCopy(b)\n}DwtControl.useBrowserTooltips=this.get(ZmSetting.BROWSER_TOOLTIPS_ENABLED);\nthis._updateUserFontPrefsRule()\n};\nZmSettings.prototype._base64toNormalSize=function(a){if(!a||a===-1){return a\n}return a/ZmSettings.BASE64_TO_NORMAL_RATIO\n};\nZmSettings.prototype._beginLoadZimlets=function(a,d,b){var c=new AjxCallback(this,this._loadZimletPackage,[a,d,b]);\nAjxDispatcher.require([\"Startup2\"],false,c)\n};\nZmSettings.prototype._loadZimletPackage=function(a,d,b){var c=new AjxCallback(this,this._loadZimlets,[a,d,b]);\nAjxDispatcher.require(\"Zimlet\",false,c)\n};\nZmSettings.prototype._loadZimlets=function(b,h,j){b=b||[];\nthis.registerSetting(\"ZIMLETS\",{type:ZmSetting.T_CONFIG,defaultValue:b,isGlobal:true});\nthis.registerSetting(\"USER_PROPS\",{type:ZmSetting.T_CONFIG,defaultValue:h});\nvar d=this._getCheckedZimlets(b);\nvar c=appCtxt.getZimletMgr();\nc.loadZimlets(d,h,null,null,j);\nif(d&&d.length){var a=appCtxt.getCurrentApp();\nif(a){var l;\nif(appCtxt.multiAccounts){var f=a.getOverviewContainer().containerId;\nvar k=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];\nvar e=[f,k].join(\"_\");\nl=appCtxt.getOverviewController().getOverview(e)\n}else{l=a.getOverview()\n}}if(l){l.setTreeView(ZmOrganizer.ZIMLET);\nif(appCtxt.multiAccounts&&c.getPanelZimlets().length==0){a.getOverviewContainer().removeZimletSection()\n}}if(appCtxt.get(ZmSetting.PORTAL_ENABLED)){var g=appCtxt.getApp(ZmApp.PORTAL).getPortletMgr();\nvar i=g.createPortlets(true)\n}}};\nZmSettings.prototype._getCheckedZimlets=function(c){var d=[];\nfor(var b=0;\nb<c.length;\nb++){var a=c[b];\nif(a.zimletContext[0].presence!=\"disabled\"){d.push(a)\n}}return d\n};\nZmSettings.prototype.loadPreferenceData=function(h){var g=new ZmBatchCommand(null,appCtxt.accountList.mainAccount.name);\nvar f=AjxSoapDoc.create(\"GetAvailableSkinsRequest\",\"urn:zimbraAccount\");\nvar e=new AjxCallback(this,this._handleResponseLoadAvailableSkins);\ng.addNewRequestParams(f,e);\nvar a=AjxSoapDoc.create(\"GetAvailableLocalesRequest\",\"urn:zimbraAccount\");\nvar d=new AjxCallback(this,this._handleResponseGetAllLocales);\ng.addNewRequestParams(a,d);\nvar b=AjxSoapDoc.create(\"GetAvailableCsvFormatsRequest\",\"urn:zimbraAccount\");\nvar c=new AjxCallback(this,this._handleResponseGetAvailableCsvFormats);\ng.addNewRequestParams(b,c);\ng.run(h)\n};\nZmSettings.prototype._handleResponseLoadAvailableSkins=function(a){var e=a.getResponse().GetAvailableSkinsResponse;\nvar d=e.skin;\nif(d&&d.length){var c=appCtxt.accountList.mainAccount.settings.getSetting(ZmSetting.AVAILABLE_SKINS);\nfor(var b=0;\nb<d.length;\nb++){c.setValue(d[b].name)\n}}};\nZmSettings.prototype._handleResponseGetAllLocales=function(c){var b=c._data.GetAvailableLocalesResponse.locale;\nif(b&&b.length){for(var d=0,e=b.length;\nd<e;\nd++){var a=b[d];\na.id=a.id.replace(/^in/,\"id\");\nZmLocale.create(a.id,a.name,ZmMsg[\"localeName_\"+a.id]||a.localName)\n}if(b.length===1){this.set(ZmSetting.LOCALE_CHANGE_ENABLED,true)\n}else{this.set(ZmSetting.LOCALE_CHANGE_ENABLED,ZmLocale.hasChoices())\n}}};\nZmSettings.prototype._handleResponseGetAvailableCsvFormats=function(b){var a=b.getResponse().GetAvailableCsvFormatsResponse.csv;\nif(a&&a.length){var d=appCtxt.accountList.mainAccount.settings.getSetting(ZmSetting.AVAILABLE_CSVFORMATS);\nfor(var c=0;\nc<a.length;\nc++){d.setValue(a[c].name)\n}}};\nZmSettings.prototype.save=function(s,d,f,b,o){if(!(s&&s.length)){return\n}var g=b||appCtxt.getActiveAccount();\nvar t=AjxSoapDoc.create(\"ModifyPrefsRequest\",\"urn:zimbraAccount\");\nvar e=false;\nvar q=[],h={},l;\nfor(var r=0;\nr<s.length;\nr++){l=s[r];\nif(h[l.id]){continue\n}if(l.type==ZmSetting.T_METADATA){q.push(l);\ng.metaData.update(l.section,l.name,l.getValue());\ncontinue\n}else{if(l.type!=ZmSetting.T_PREF){continue\n}}if(!l.name){continue\n}if(l.dataType==ZmSetting.D_LIST){var m=l.getValue();\nif(m&&m.length){for(var p=0;\np<m.length;\np++){var n=t.set(\"pref\",m[p]);\nn.setAttribute(\"name\",l.name)\n}}else{var n=t.set(\"pref\",\"\");\nn.setAttribute(\"name\",l.name)\n}}else{var m=l.getValue(null,true);\nvar n=t.set(\"pref\",m);\nn.setAttribute(\"name\",l.name)\n}h[l.id]=true;\ne=true\n}if(appCtxt.isOffline&&ZmSetting.IS_IMPLICIT[l.id]&&ZmSetting.IS_GLOBAL[l.id]){g=appCtxt.accountList.mainAccount\n}if(q.length>0){var a=new AjxCallback(this,this._handleResponseSaveMetaData,[q]);\nvar k=[ZmSetting.M_IMPLICIT,ZmSetting.M_OFFLINE];\ng.metaData.save(k,a)\n}if(e){var c;\nif(d||f){c=new AjxCallback(this,this._handleResponseSave,[s,d])\n}if(f){f.addNewRequestParams(t,c)\n}else{appCtxt.getAppController().sendRequest({soapDoc:t,asyncMode:true,callback:c,accountName:g.name,noBusyOverlay:o})\n}}};\nZmSettings.prototype._handleResponseSaveMetaData=function(d,a){for(var b=0;\nb<d.length;\nb++){var c=d[b];\nif(!ZmSetting.IS_IMPLICIT[c.id]){c.origValue=c.copyValue();\nc._notify(ZmEvent.E_MODIFY)\n}}};\nZmSettings.prototype._handleResponseSave=function(d,f,a){var e=a.getResponse();\nif(e.ModifyPrefsResponse!=null){for(var b=0;\nb<d.length;\nb++){var c=d[b];\nc.origValue=c.copyValue();\nif(!ZmSetting.IS_IMPLICIT[c.id]){c._notify(ZmEvent.E_MODIFY)\n}}this._notify(ZmEvent.E_MODIFY,{settings:d})\n}if(f){f.run(a)\n}};\nZmSettings.DEFAULT_SORT_PREF={};\nZmSettings.prototype._setDefaults=function(){var b=AjxUtil.formatUrl({host:location.hostname,path:\"/service/soap/\",qsReset:true});\nthis.set(ZmSetting.CSFE_SERVER_URI,b,null,false,true);\nb=AjxUtil.formatUrl({host:location.hostname,path:\"/service/home/~/\",qsReset:true,qsArgs:{auth:\"co\"}});\nthis.set(ZmSetting.CSFE_MSG_FETCHER_URI,b,null,false,true);\nb=AjxUtil.formatUrl({host:location.hostname,path:\"/service/upload\",qsReset:true,qsArgs:{lbfums:\"\"}});\nthis.set(ZmSetting.CSFE_UPLOAD_URI,b,null,false,true);\nb=AjxUtil.formatUrl({host:location.hostname,path:\"/service/upload\",qsReset:true});\nthis.set(ZmSetting.CSFE_ATTACHMENT_UPLOAD_URI,b,null,false,true);\nb=AjxUtil.formatUrl({host:location.hostname,path:\"/service/home/~/\",qsReset:true,qsArgs:{auth:\"co\",id:\"{0}\",fmt:\"csv\"}});\nthis.set(ZmSetting.CSFE_EXPORT_URI,b,null,false,true);\nvar a=location.hostname;\nvar c=((a.indexOf(\".zimbra.com\")!=-1)||(window.appDevMode&&(/\\.local$/.test(a)||(!appCtxt.isOffline&&a==\"localhost\"))));\nthis.set(ZmSetting.IS_DEV_SERVER,c);\nif(c||window.isScriptErrorOn){this.set(ZmSetting.SHOW_SCRIPT_ERRORS,true,null,false,true)\n}this.setReportScriptErrorsSettings(AjxException,ZmController.handleScriptError)\n};\nZmSettings.prototype.persistImplicitSortPrefs=function(a){return ZmSettings.DEFAULT_SORT_PREF[a]\n};\nZmSettings.prototype.setReportScriptErrorsSettings=function(b,c){var a=b.reportScriptErrors=this._settings[ZmSetting.SHOW_SCRIPT_ERRORS].getValue();\nif(a){b.setScriptErrorHandler(c)\n}};\nZmSettings.prototype._initialize=function(){this.registerSetting(\"ADMIN_DELEGATED\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"AC_TIMER_INTERVAL\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:300});\nthis.registerSetting(\"ASYNC_MODE\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"BRANCH\",{type:ZmSetting.T_CONFIG,defaultValue:\"JUDASPRIEST\"});\nthis.registerSetting(\"CLIENT_DATETIME\",{type:ZmSetting.T_CONFIG,defaultValue:\"20220726-1128\"});\nthis.registerSetting(\"CLIENT_RELEASE\",{type:ZmSetting.T_CONFIG,defaultValue:\"20220726082327\"});\nthis.registerSetting(\"CLIENT_VERSION\",{type:ZmSetting.T_CONFIG,defaultValue:\"8.8.15_GA_4372\"});\nthis.registerSetting(\"CONFIG_PATH\",{type:ZmSetting.T_CONFIG,defaultValue:appContextPath+\"/js/zimbraMail/config\"});\nthis.registerSetting(\"CSFE_EXPORT_URI\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"CSFE_MSG_FETCHER_URI\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"CSFE_SERVER_URI\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"CSFE_UPLOAD_URI\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"CSFE_ATTACHMENT_UPLOAD_URI\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"DEV\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"FORCE_CAL_OFF\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"HELP_URI\",{name:\"zimbraHelpAdvancedURL\",type:ZmSetting.T_CONFIG,defaultValue:appContextPath+ZmMsg.helpURI});\nthis.registerSetting(\"HTTP_PORT\",{type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.HTTP_DEFAULT_PORT});\nthis.registerSetting(\"HTTPS_PORT\",{type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.HTTPS_DEFAULT_PORT});\nthis.registerSetting(\"INSTANT_NOTIFY_INTERVAL\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:500});\nthis.registerSetting(\"INSTANT_NOTIFY_TIMEOUT\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:300});\nthis.registerSetting(\"IS_DEV_SERVER\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"LOG_REQUEST\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"LOGO_URI\",{type:ZmSetting.T_CONFIG,defaultValue:null});\nthis.registerSetting(\"PROTOCOL_MODE\",{type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.PROTO_HTTP});\nthis.registerSetting(\"SERVER_VERSION\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"SHOW_SCRIPT_ERRORS\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"TIMEOUT\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:30});\nthis.registerSetting(\"USE_XML\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"SMIME_HELP_URI\",{type:ZmSetting.T_CONFIG,defaultValue:appContextPath+ZmMsg.smimeHelpURI});\nthis.registerSetting(\"CHANGE_PASSWORD_URL\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"PUBLIC_URL\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"ADMIN_URL\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"DISABLE_SENSITIVE_ZIMLETS_IN_MIXED_MODE\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"BRIEFCASE_ENABLED\",{name:\"zimbraFeatureBriefcasesEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"ATTACHMENTS_BLOCKED\",{name:\"zimbraAttachmentsBlocked\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"CALENDAR_ENABLED\",{name:\"zimbraFeatureCalendarEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"CALENDAR_UPSELL_ENABLED\",{name:\"zimbraFeatureCalendarUpsellEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"CALENDAR_UPSELL_URL\",{name:\"zimbraFeatureCalendarUpsellURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"CONTACTS_ENABLED\",{name:\"zimbraFeatureContactsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"CONTACTS_UPSELL_ENABLED\",{name:\"zimbraFeatureContactsUpsellEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"CONTACTS_UPSELL_URL\",{name:\"zimbraFeatureContactsUpsellURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"IMPORT_ENABLED\",{name:\"zimbraFeatureImportFolderEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"EXPORT_ENABLED\",{name:\"zimbraFeatureExportFolderEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"MAIL_ENABLED\",{name:\"zimbraFeatureMailEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"EXTERNAL_USER_MAIL_ADDRESS\",{name:\"zimbraExternalUserMailAddress\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"ADMIN_MAIL_ENABLED\",{name:\"zimbraFeatureAdminMailEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"ADMIN_PREFERENCES_ENABLED\",{name:\"zimbraFeatureAdminPreferencesEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"MAIL_UPSELL_ENABLED\",{name:\"zimbraFeatureMailUpsellEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"MAIL_UPSELL_URL\",{name:\"zimbraFeatureMailUpsellURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"OPTIONS_ENABLED\",{name:\"zimbraFeatureOptionsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"PORTAL_ENABLED\",{name:\"zimbraFeaturePortalEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"SOCIAL_ENABLED\",{name:\"zimbraFeatureSocialEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"SOCIAL_EXTERNAL_ENABLED\",{name:\"zimbraFeatureSocialExternalEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"SOCIAL_EXTERNAL_URL\",{name:\"zimbraFeatureSocialExternalURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"SOCIAL_NAME\",{name:\"zimbraFeatureSocialName\",type:ZmSetting.T_COS,defaultValue:ZmMsg.communityName});\nthis.registerSetting(\"TASKS_ENABLED\",{name:\"zimbraFeatureTasksEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"VOICE_ENABLED\",{name:\"zimbraFeatureVoiceEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"VOICE_UPSELL_ENABLED\",{name:\"zimbraFeatureVoiceUpsellEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"VOICE_UPSELL_URL\",{name:\"zimbraFeatureVoiceUpsellURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"DLS_FOLDER_ENABLED\",{name:\"zimbraFeatureDistributionListFolderEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"ATTACHMENTS_VIEW_IN_HTML_ONLY\",{name:\"zimbraAttachmentsViewInHtmlOnly\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"AVAILABLE_SKINS\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST,isGlobal:true});\nthis.registerSetting(\"AVAILABLE_CSVFORMATS\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST,isGlobal:true});\nthis.registerSetting(\"CHANGE_PASSWORD_ENABLED\",{name:\"zimbraFeatureChangePasswordEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"DISPLAY_NAME\",{name:\"displayName\",type:ZmSetting.T_COS});\nthis.registerSetting(\"DUMPSTER_ENABLED\",{name:\"zimbraDumpsterEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"ERROR_REPORT_URL\",{name:\"zimbraErrorReportUrl\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"EXPORT_MAX_DAYS\",{name:\"zimbraExportMaxDays\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:0});\nthis.registerSetting(\"FILTER_BATCH_SIZE\",{name:\"zimbraFilterBatchSize\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:10000});\nthis.registerSetting(\"FLAGGING_ENABLED\",{name:\"zimbraFeatureFlaggingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"FOLDERS_EXPANDED\",{name:\"zimbraPrefFoldersExpanded\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_HASH,isImplicit:true,section:ZmSetting.M_IMPLICIT});\nthis.registerSetting(\"FOLDER_TREE_OPEN\",{name:\"zimbraPrefFolderTreeOpen\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true});\nthis.registerSetting(\"FOLDER_TREE_SASH_WIDTH\",{name:\"zimbraPrefFolderTreeSash\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_INT,isImplicit:true,section:ZmSetting.M_IMPLICIT});\nthis.registerSetting(\"GAL_AUTOCOMPLETE_ENABLED\",{name:\"zimbraFeatureGalAutoCompleteEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"GAL_ENABLED\",{name:\"zimbraFeatureGalEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"HAB_ROOT\",{type:ZmSetting.T_CONFIG});\nthis.registerSetting(\"GROUP_CALENDAR_ENABLED\",{name:\"zimbraFeatureGroupCalendarEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"HTML_COMPOSE_ENABLED\",{name:\"zimbraFeatureHtmlComposeEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"IDLE_SESSION_TIMEOUT\",{name:\"zimbraMailIdleSessionTimeout\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LDAP_TIME,defaultValue:0});\nthis.registerSetting(\"IMAP_ACCOUNTS_ENABLED\",{name:\"zimbraFeatureImapDataSourceEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"IMPORT_ON_LOGIN_ENABLED\",{name:\"zimbraDataSourceImportOnLogin\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"INSTANT_NOTIFY\",{name:\"zimbraFeatureInstantNotify\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"LOCALE_CHANGE_ENABLED\",{name:\"zimbraFeatureLocaleChangeEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"LOCALES\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"LOGIN_URL\",{name:\"zimbraWebClientLoginURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"LOGOUT_URL\",{name:\"zimbraWebClientLogoutURL\",type:ZmSetting.T_COS});\nthis.registerSetting(\"MIN_POLLING_INTERVAL\",{name:\"zimbraMailMinPollingInterval\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LDAP_TIME,defaultValue:120});\nthis.registerSetting(\"MOBILE_SYNC_ENABLED\",{name:\"zimbraFeatureMobileSyncEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"MOBILE_POLICY_ENABLED\",{name:\"zimbraFeatureMobilePolicyEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"POP_ACCOUNTS_ENABLED\",{name:\"zimbraFeaturePop3DataSourceEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"PORTAL_NAME\",{name:\"zimbraPortalName\",type:ZmSetting.T_COS,defaultValue:\"example\"});\nthis.registerSetting(\"PRIORITY_INBOX_ENABLED\",{name:\"zimbraFeaturePriorityInboxEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"PWD_MAX_LENGTH\",{name:\"zimbraPasswordMaxLength\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:64});\nthis.registerSetting(\"PWD_MIN_LENGTH\",{name:\"zimbraPasswordMinLength\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:6});\nthis.registerSetting(\"QUOTA\",{name:\"zimbraMailQuota\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:0});\nthis.registerSetting(\"SAVED_SEARCHES_ENABLED\",{name:\"zimbraFeatureSavedSearchesEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"SEARCH_TREE_OPEN\",{name:\"zimbraPrefSearchTreeOpen\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true});\nthis.registerSetting(\"SHARING_ENABLED\",{name:\"zimbraFeatureSharingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHARING_PUBLIC_ENABLED\",{name:\"zimbraPublicSharingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHARING_EXTERNAL_ENABLED\",{name:\"zimbraExternalSharingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHORTCUT_ALIASES_ENABLED\",{name:\"zimbraFeatureShortcutAliasesEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHOW_OFFLINE_LINK\",{name:\"zimbraWebClientShowOfflineLink\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SIGNATURES_ENABLED\",{name:\"zimbraFeatureSignaturesEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SKIN_CHANGE_ENABLED\",{name:\"zimbraFeatureSkinChangeEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SOCIAL_FILTERS_ENABLED\",{name:\"zimbraFeatureSocialFiltersEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST,isImplicit:true,section:ZmSetting.M_IMPLICIT});\nthis.registerSetting(\"SPAM_ENABLED\",{name:\"zimbraFeatureAntispamEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"TAG_TREE_OPEN\",{name:\"zimbraPrefTagTreeOpen\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true});\nthis.registerSetting(\"TAGGING_ENABLED\",{name:\"zimbraFeatureTaggingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"VIEW_ATTACHMENT_AS_HTML\",{name:\"zimbraFeatureViewInHtmlEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"EXPAND_DL_ENABLED\",{name:\"zimbraFeatureDistributionListExpandMembersEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"FORCE_CLEAR_COOKIES\",{name:\"zimbraForceClearCookies\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"WEBCLIENT_OFFLINE_ENABLED\",{name:\"zimbraFeatureWebClientOfflineAccessEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SPELL_DICTIONARY\",{name:\"zimbraPrefSpellDictionary\",type:ZmSetting.T_COS,defaultValue:\"\"});\nthis.registerSetting(\"TWO_FACTOR_AUTH_AVAILABLE\",{name:\"zimbraFeatureTwoFactorAuthAvailable\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"TWO_FACTOR_AUTH_REQUIRED\",{name:\"zimbraFeatureTwoFactorAuthRequired\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"TRUSTED_DEVICES_ENABLED\",{name:\"zimbraFeatureTrustedDevicesEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"APP_PASSWORDS_ENABLED\",{name:\"zimbraFeatureAppSpecificPasswordsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"RESET_PASSWORD_STATUS\",{name:\"zimbraFeatureResetPasswordStatus\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"PASSWORD_RECOVERY_EMAIL\",{name:\"zimbraPrefPasswordRecoveryAddress\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"PASSWORD_RECOVERY_EMAIL_STATUS\",{name:\"zimbraPrefPasswordRecoveryAddressStatus\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"RESET_PASSWORD_RECOVERY_CODE_EXPIRY\",{name:\"zimbraResetPasswordRecoveryCodeExpiry\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"PASSWORD_RECOVERY_CODE_VALIDITY\",{name:\"zimbraRecoveryAccountCodeValidity\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"PASSWORD_RECOVERY_SUSPENSION_TIME\",{name:\"zimbraFeatureResetPasswordSuspensionTime\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"LICENSE_STATUS\",{type:ZmSetting.T_COS,defaultValue:ZmSetting.LICENSE_GOOD});\nthis.registerSetting(\"QUOTA_USED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"USERID\",{name:\"zimbraId\",type:ZmSetting.T_COS});\nthis.registerSetting(\"USERNAME\",{type:ZmSetting.T_COS});\nthis.registerSetting(\"CN\",{name:\"cn\",type:ZmSetting.T_COS});\nthis.registerSetting(\"LAST_ACCESS\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"PREVIOUS_SESSION\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"RECENT_MESSAGES\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"REST_URL\",{name:\"rest\",type:ZmSetting.T_COS});\nthis.registerSetting(\"IS_ADMIN\",{name:\"zimbraIsAdminAccount\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"IS_EXTERNAL\",{name:\"zimbraIsExternalVirtualAccount\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"IS_DELEGATED_ADMIN\",{name:\"zimbraIsDelegatedAdminAccount\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"MESSAGE_SIZE_LIMIT\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"DOCUMENT_SIZE_LIMIT\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_INT});\nthis.registerSetting(\"ATTACHMENT_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"ATT_VIEW_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"BROWSER_TOOLTIPS_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"EVAL_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"FEED_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"HELP_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"HISTORY_SUPPORT_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:(\"onhashchange\" in window)});\nthis.registerSetting(\"NOTES_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"PRINT_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SEARCH_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHORTCUT_LIST_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"OFFLINE_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:appCtxt.isOffline});\nthis.registerSetting(\"SPELL_CHECK_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN});\nthis.registerSetting(\"SPELL_CHECK_ADD_WORD_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:!AjxEnv.isSafari||AjxEnv.isSafari3up||AjxEnv.isChrome});\nthis.registerSetting(\"EMAIL_VALIDATION_REGEX\",{name:\"zimbraMailAddressValidationRegex\",type:ZmSetting.T_DOMAIN,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"SUPPORTED_HELPS\",{name:\"zimbraWebClientSupportedHelps\",type:ZmSetting.T_DOMAIN,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"ACCOUNTS\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"TWO_FACTOR_AUTH_ENABLED\",{name:\"zimbraTwoFactorAuthEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"ACCOUNT_TREE_OPEN\",{name:\"zimbraPrefAccountTreeOpen\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true});\nthis.registerSetting(\"CHILD_ACCTS_VISIBLE\",{name:\"zimbraPrefChildVisibleAccount\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"CLIENT_TYPE\",{name:\"zimbraPrefClientType\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.CLIENT_ADVANCED});\nthis.registerSetting(\"COMPOSE_AS_FORMAT\",{name:\"zimbraPrefComposeFormat\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_HTML,isGlobal:true});\nthis.registerSetting(\"COMPOSE_INIT_FONT_COLOR\",{name:\"zimbraPrefHtmlEditorDefaultFontColor\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_COLOR,isGlobal:true});\nthis.registerSetting(\"COMPOSE_INIT_FONT_FAMILY\",{name:\"zimbraPrefHtmlEditorDefaultFontFamily\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_FAM,isGlobal:true});\nthis.registerSetting(\"COMPOSE_INIT_FONT_SIZE\",{name:\"zimbraPrefHtmlEditorDefaultFontSize\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_SIZE,isGlobal:true});\nthis.registerSetting(\"COMPOSE_INIT_DIRECTION\",{name:\"zimbraPrefComposeDirection\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.LTR,isGlobal:true});\nthis.registerSetting(\"SHOW_COMPOSE_DIRECTION_BUTTONS\",{name:\"zimbraPrefShowComposeDirection\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"DEFAULT_TIMEZONE\",{name:\"zimbraPrefTimeZoneId\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:AjxTimezone.getServerId(AjxTimezone.DEFAULT),isGlobal:true});\nthis.registerSetting(\"WEBCLIENT_OFFLINE_BROWSER_KEY\",{name:\"zimbraPrefWebClientOfflineBrowserKey\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,isImplicit:true});\nthis.registerSetting(\"DEFAULT_PRINTFONTSIZE\",{name:\"zimbraPrefDefaultPrintFontSize\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.PRINT_FONT_SIZE,isGlobal:true});\nthis.registerSetting(\"GROUPBY_HASH\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"GROUPBY_LIST\",{name:\"zimbraPrefGroupByList\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_HASH,isImplicit:true,section:ZmSetting.M_IMPLICIT});\nthis.registerSetting(\"FILTERS\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"FONT_NAME\",{name:\"zimbraPrefFont\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.FONT_SYSTEM,isGlobal:true});\nthis.registerSetting(\"FONT_SIZE\",{name:\"zimbraPrefFontSize\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.FONT_SIZE_NORMAL,isGlobal:true});\nthis.registerSetting(\"IDENTITIES\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"INITIALLY_SEARCH_GAL\",{name:\"zimbraPrefGalSearchEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"LIST_VIEW_COLUMNS\",{name:\"zimbraPrefListViewColumns\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH,isImplicit:true});\nthis.registerSetting(\"LOCALE_NAME\",{name:\"zimbraPrefLocale\",type:ZmSetting.T_PREF,defaultValue:appRequestLocaleId,isGlobal:true});\nthis.registerSetting(\"SHOW_SELECTION_CHECKBOX\",{name:\"zimbraPrefShowSelectionCheckbox\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\nthis.registerSetting(\"PAGE_SIZE\",{name:\"zimbraPrefItemsPerVirtualPage\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:50,isGlobal:true});\nthis.registerSetting(\"PASSWORD\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE});\nthis.registerSetting(\"POLLING_INTERVAL\",{name:\"zimbraPrefMailPollingInterval\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LDAP_TIME,defaultValue:300});\nthis.registerSetting(\"POLLING_INTERVAL_ENABLED\",{name:\"zimbraFeatureMailPollingIntervalPreferenceEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SEARCH_INCLUDES_SHARED\",{name:\"zimbraPrefIncludeSharedItemsInSearch\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"SEARCH_INCLUDES_SPAM\",{name:\"zimbraPrefIncludeSpamInSearch\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"SEARCH_INCLUDES_TRASH\",{name:\"zimbraPrefIncludeTrashInSearch\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"SHORT_ADDRESS\",{name:\"zimbraPrefShortEmailAddress\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"SHORTCUTS\",{name:\"zimbraPrefShortcuts\",type:ZmSetting.T_PREF});\nthis.registerSetting(\"SHOW_SEARCH_STRING\",{name:\"zimbraPrefShowSearchString\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"SIGNATURES\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"SIGNATURES_MAX\",{name:\"zimbraSignatureMaxNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:20});\nthis.registerSetting(\"SIGNATURES_MIN\",{name:\"zimbraSignatureMinNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:1});\nthis.registerSetting(\"SKIN_NAME\",{name:\"zimbraPrefSkin\",type:ZmSetting.T_PREF,defaultValue:\"skin\",isGlobal:true});\nthis.registerSetting(\"SORTING_PREF\",{name:\"zimbraPrefSortOrder\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH,isImplicit:true,isGlobal:true,dontSaveDefault:true});\nthis.registerSetting(\"USE_KEYBOARD_SHORTCUTS\",{name:\"zimbraPrefUseKeyboardShortcuts\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"VIEW_AS_HTML\",{name:\"zimbraPrefMessageViewHtmlPreferred\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"VOICE_ACCOUNTS\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH});\nthis.registerSetting(\"WARN_ON_EXIT\",{name:\"zimbraPrefWarnOnExit\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"DISPLAY_TIME_IN_MAIL_LIST\",{name:\"zimbraPrefDisplayTimeInMailList\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis._registerOfflineSettings();\nthis._registerZimletsSettings();\nthis.registerSetting(\"ZIMLET_TREE_OPEN\",{name:\"zimbraPrefZimletTreeOpen\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true});\nthis.registerSetting(\"MAIL_ALIASES\",{name:\"zimbraMailAlias\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"ALLOW_FROM_ADDRESSES\",{name:\"zimbraAllowFromAddress\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"MAIL_PREFERENCES_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"CHAT_PLAY_SOUND\",{name:\"zimbraPrefChatPlaySound\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\nthis.registerSetting(\"CHAT_FEATURE_ENABLED\",{name:\"zimbraFeatureChatEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\nthis.registerSetting(\"CHAT_ENABLED\",{name:\"zimbraPrefChatEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\nZmApp.runAppFunction(\"registerSettings\",this)\n};\nZmSettings.prototype._registerZimletsSettings=function(){this.registerSetting(\"CHECKED_ZIMLETS_ENABLED\",{name:\"zimbraFeatureManageZimlets\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\nthis.registerSetting(\"CHECKED_ZIMLETS\",{name:\"zimbraPrefZimlets\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST,isGlobal:true});\nthis.registerSetting(\"MANDATORY_ZIMLETS\",{name:\"zimbraZimletMandatoryZimlets\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST});\nthis.registerSetting(\"ZIMLETS_SYNCHRONOUS\",{name:\"zimbraZimletLoadSynchronously\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false})\n};\nZmSettings.prototype._registerOfflineSettings=function(){if(!appCtxt.isOffline){return\n}this.registerSetting(\"OFFLINE_ACCOUNT_FLAVOR\",{name:\"offlineAccountFlavor\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"OFFLINE_COMPOSE_ENABLED\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"OFFLINE_DEBUG_TRACE\",{type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"OFFLINE_IS_MAILTO_HANDLER\",{name:\"zimbraPrefMailtoHandlerEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"OFFLINE_REMOTE_SERVER_URI\",{name:\"offlineRemoteServerUri\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"OFFLINE_REPORT_EMAIL\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"zdesktop-report@zimbra.com\",isGlobal:true});\nthis.registerSetting(\"OFFLINE_SHOW_ALL_MAILBOXES\",{name:\"offlineShowAllMailboxes\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,section:ZmSetting.M_OFFLINE,isGlobal:true});\nthis.registerSetting(\"OFFLINE_ALL_MAILBOXES_TREE_OPEN\",{name:\"offlineAllMailboxesTreeOpen\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,section:ZmSetting.M_OFFLINE,isGlobal:true,isImplicit:true});\nthis.registerSetting(\"OFFLINE_NOTIFY_NEWMAIL_ON_INBOX\",{name:\"offlineNotifyNewMailOnInbox\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,section:ZmSetting.M_OFFLINE,isGlobal:true});\nthis.registerSetting(\"OFFLINE_SAVED_SEARCHES_TREE_OPEN\",{name:\"offlineSavedSearchesTreeOpen\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,section:ZmSetting.M_OFFLINE,isGlobal:true,isImplicit:true});\nthis.registerSetting(\"OFFLINE_SMTP_ENABLED\",{name:\"zimbraDataSourceSmtpEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\nthis.registerSetting(\"OFFLINE_SUPPORTS_MAILTO\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"OFFLINE_SUPPORTS_DOCK_UPDATE\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"OFFLINE_WEBAPP_URI\",{name:\"offlineWebappUri\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"OFFLINE_BACKUP_INTERVAL\",{name:\"zimbraPrefOfflineBackupInterval\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0,isGlobal:true});\nthis.registerSetting(\"OFFLINE_BACKUP_PATH\",{name:\"zimbraPrefOfflineBackupPath\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,isGlobal:true});\nthis.registerSetting(\"OFFLINE_BACKUP_KEEP\",{name:\"zimbraPrefOfflineBackupKeep\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,isGlobal:true});\nthis.registerSetting(\"OFFLINE_BACKUP_ACCOUNT_ID\",{name:\"zimbraPrefOfflineBackupAccountId\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,isGlobal:true});\nthis.registerSetting(\"OFFLINE_BACKUP_RESTORE\",{name:\"zimbraPrefOfflineBackupRestore\",dataType:ZmSetting.D_INT,isGlobal:true});\nthis.registerSetting(\"OFFLINE_BACKUP_NOW_BUTTON\",{name:\"zimbraPrefOfflineBackupAccount\",dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\nthis.registerSetting(\"OFFLINE_ZIMLET_SYNC_ACCOUNT_ID\",{name:\"zimbraPrefOfflineZimletSyncAccountId\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,isGlobal:true});\nthis.registerSetting(\"OFFLINE_WEBAPP_URI\",{name:\"offlineWebappUri\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING});\nthis.registerSetting(\"HELP_URI\",{type:ZmSetting.T_CONFIG,defaultValue:\"https://www.zimbra.com/desktop7/\"});\nthis.registerSetting(\"DUMPSTER_ENABLED\",{name:\"zimbraDumpsterEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\nthis.registerSetting(\"OFFLINE_UPDATE_NOTIFY\",{name:\"zimbraPrefOfflineUpdateChannel\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,isGlobal:true})\n};\nZmSettings.prototype._changeListener=function(d){if(d.type!==ZmEvent.S_SETTING){return\n}var f=d.source.id,e=d.source.getValue();\nif(f===ZmSetting.QUOTA_USED){appCtxt.getAppController().setUserInfo()\n}else{if(f===ZmSetting.POLLING_INTERVAL){appCtxt.getAppController().setPollInterval()\n}else{if(f===ZmSetting.SKIN_NAME){this._showConfirmDialog(ZmMsg.skinChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{if(f===ZmSetting.SHOW_SELECTION_CHECKBOX){this._showConfirmDialog(e?ZmMsg.checkboxChangeRestartShow:ZmMsg.checkboxChangeRestartHide,this._refreshBrowserCallback.bind(this))\n}else{if(f===ZmSetting.FONT_NAME||f===ZmSetting.FONT_SIZE){this._showConfirmDialog(ZmMsg.fontChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{if(f===ZmSetting.LOCALE_NAME){if(appCtxt.isOffline&&AjxEnv.isPrism){try{netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\");\nvar b=Components.classes[\"@mozilla.org/preferences-service;1\"].getService(Components.interfaces.nsIPrefBranch);\nif(b){var a=appCtxt.get(ZmSetting.LOCALE_NAME).replace(\"_\",\"-\");\nb.setCharPref(\"general.useragent.locale\",a);\nb.setCharPref(\"intl.accept_languages\",a)\n}}catch(c){}}this._showConfirmDialog(ZmMsg.localeChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{if(f===ZmSetting.CHILD_ACCTS_VISIBLE){this._showConfirmDialog(ZmMsg.accountChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{if(appCtxt.isOffline&&f===ZmSetting.OFFLINE_IS_MAILTO_HANDLER){appCtxt.getAppController().registerMailtoHandler(true,d.source.getValue())\n}else{if(appCtxt.isOffline&&f===ZmSetting.OFFLINE_UPDATE_NOTIFY){appCtxt.getAppController()._offlineUpdateChannelPref(d.source.getValue())\n}else{if(f===ZmSetting.CHAT_ENABLED||f===ZmSetting.CHAT_PLAY_SOUND||(f===ZmSetting.CHAT_PLAY_SOUND&&f===ZmSetting.CHAT_ENABLED)){this._showConfirmDialog(ZmMsg.chatFeatureChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{if(f===ZmSetting.DISPLAY_TIME_IN_MAIL_LIST){this._showConfirmDialog(e?ZmMsg.timeInMailListChangeRestartShow:ZmMsg.timeInMailListChangeRestartHide,this._refreshBrowserCallback.bind(this))\n}}}}}}}}}}}};\nZmSettings.prototype._showConfirmDialog=function(c,d,a){var b=appCtxt.getYesNoMsgDialog();\nb.reset();\nb.registerCallback(DwtDialog.YES_BUTTON,d);\nb.setMessage(c,a||DwtMessageDialog.WARNING_STYLE);\nb.popup()\n};\nZmSettings.prototype._implicitChangeListener=function(c){var e=c.source.id;\nvar a=c.source.type;\nif(!appCtxt.get(ZmSetting.OPTIONS_ENABLED)&&ZmSetting.T_METADATA!==a){return\n}if(c.type!=ZmEvent.S_SETTING){return\n}var b=this.getSetting(e);\nif(e==ZmSetting.FOLDERS_EXPANDED&&window.duringExpandAll){if(!window.afterExpandAllCallback){window.afterExpandAllCallback=this.save.bind(this,[b],null,null,appCtxt.getActiveAccount(),true)\n}return\n}if(ZmSetting.IS_IMPLICIT[e]&&b){if(e===ZmSetting.WEBCLIENT_OFFLINE_BROWSER_KEY){var d=this._offlineSettingsSaveCallback.bind(this,b)\n}else{var d=appCtxt.reloadAppCache.bind(appCtxt,false)\n}this.save([b],d,null,appCtxt.getActiveAccount(),true)\n}};\nZmSettings.prototype._refreshBrowserCallback=function(b){appCtxt.getYesNoMsgDialog().popdown();\nwindow.onbeforeunload=ZmZimbraMail.getConfirmExitMethod();\nvar a=AjxUtil.formatUrl({qsArgs:b});\nwindow.location.replace(a)\n};\nZmSettings.prototype._updateUserFontPrefsRule=function(){if(this._userFontPrefsRuleIndex!=null){DwtCssStyle.removeRule(document.styleSheets[0],this._userFontPrefsRuleIndex)\n}var a=\".\"+ZmSetting.USER_FONT_CLASS;\nvar b=\"font-family:\"+appCtxt.get(ZmSetting.COMPOSE_INIT_FONT_FAMILY)+\";font-size:\"+appCtxt.get(ZmSetting.COMPOSE_INIT_FONT_SIZE)+\";color:\"+appCtxt.get(ZmSetting.COMPOSE_INIT_FONT_COLOR)+\";\";\nthis._userFontPrefsRuleIndex=DwtCssStyle.addRule(document.styleSheets[0],a,b)\n};\nZmSettings.prototype._hasVoiceFeature=function(){var e=this.getInfoResponse;\nvar d=e&&e.license;\nvar b=d&&d.status;\nif(!d||!d.attr){return false\n}if(ZmSetting.LICENSE_MSG[b]){return false\n}for(var c=0;\nd&&c<d.attr.length;\nc++){var a=d.attr[c];\nif(a.name==\"VOICE\"){return a._content==\"TRUE\"\n}}return false\n};\nZmSettings.prototype._offlineSettingsSaveCallback=function(c){var a=c.getValue();\nvar b=localStorage.getItem(ZmSetting.WEBCLIENT_OFFLINE_BROWSER_KEY);\nif(a&&a.indexOf(b)!==-1){this._showConfirmDialog(ZmMsg.offlineChangeRestart,this._refreshBrowserCallback.bind(this))\n}else{ZmOffline.deleteOfflineData();\nappCtxt.initWebOffline();\nvar d=appCtxt.getById(ZmFolder.ID_OUTBOX);\nif(d){d.notifyDelete()\n}}appCtxt.reloadAppCache(true)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmMetaData\")){ZmMetaData=function(a,b){this._sections={};\nthis._account=a;\nthis._itemId=b\n};\nZmMetaData.prototype.constructor=ZmMetaData;\nZmMetaData.NAMESPACE=\"zwc\";\nZmMetaData.prototype.toString=function(){return\"ZmMetaData\"\n};\nZmMetaData.prototype.set=function(m,f,b,n,g,j){var l;\nif(this._itemId){l=AjxSoapDoc.create(\"SetCustomMetadataRequest\",\"urn:zimbraMail\");\nl.getMethod().setAttribute(\"id\",this._itemId)\n}else{l=AjxSoapDoc.create(\"SetMailboxMetadataRequest\",\"urn:zimbraMail\")\n}var o=l.set(\"meta\");\no.setAttribute(\"section\",[ZmMetaData.NAMESPACE,m].join(\":\"));\nfor(var e in f){var h=f[e];\nif(AjxUtil.isObject(h)){h=ZmSetting.serialize(h,ZmSetting.D_HASH)\n}if(h!==null&&h!==\"\"){var k=l.set(\"a\",h,o);\nk.setAttribute(\"n\",e)\n}}if(b){b.addNewRequestParams(l,n,g)\n}else{var c={soapDoc:l,asyncMode:true,callback:n,errorCallback:g,accountName:(this._account?this._account.name:null),sensitive:j};\nappCtxt.getAppController().sendRequest(c)\n}};\nZmMetaData.prototype.get=function(g,a,i,d){var b=a||(new ZmBatchCommand());\nvar c=[ZmMetaData.NAMESPACE,g].join(\":\");\nvar e=this._sections[c];\nif(!e){var f;\nif(this._itemId){f=AjxSoapDoc.create(\"GetCustomMetadataRequest\",\"urn:zimbraMail\");\nf.getMethod().setAttribute(\"id\",this._itemId)\n}else{f=AjxSoapDoc.create(\"GetMailboxMetadataRequest\",\"urn:zimbraMail\")\n}var h=f.set(\"meta\");\nh.setAttribute(\"section\",c);\nb.addNewRequestParams(f);\nif(!a){b.run(i,d)\n}}else{if(i){i.run(e)\n}else{return e\n}}};\nZmMetaData.prototype.load=function(g,f,b){if(!g){return\n}if(!(g instanceof Array)){g=[g]\n}var c=b||(new ZmBatchCommand());\nfor(var a=0;\na<g.length;\na++){if(g[a]==ZmSetting.M_OFFLINE&&!appCtxt.isOffline){continue\n}this.get(g[a],c)\n}if(!b){if(c.size()>0){var e=new AjxCallback(this,this._handleLoad,[f]);\nvar d=this._handleOfflineLoad.bind(this,e);\nc.run(e,null,d)\n}}else{if(f){f.run(this._sections)\n}}};\nZmMetaData.prototype._handleLoad=function(f,a){this._sections={};\nvar c=a.getResponse().BatchResponse;\nif(c){var e=(this._itemId!=null)?c.GetCustomMetadataResponse:c.GetMailboxMetadataResponse;\nif(e&&e.length){if(ZmOffline.isOnlineMode()){localStorage.setItem(\"MetadataResponse\",JSON.stringify(c))\n}for(var b=0;\nb<e.length;\nb++){var d=e[b].meta[0];\nthis._sections[d.section]=d._attrs\n}}}if(f){f.run(this._sections)\n}};\nZmMetaData.prototype._handleOfflineLoad=function(c){var a=localStorage.getItem(\"MetadataResponse\");\nif(a){var b=new ZmCsfeResult({BatchResponse:JSON.parse(a)});\nc.run(b)\n}};\nZmMetaData.prototype.modify=function(j,d,b,k,f){var h=AjxSoapDoc.create(\"ModifyMailboxMetadataRequest\",\"urn:zimbraMail\");\nvar l=h.set(\"meta\");\nl.setAttribute(\"section\",[ZmMetaData.NAMESPACE,j].join(\":\"));\nfor(var e in d){var g=h.set(\"a\",d[e],l);\ng.setAttribute(\"n\",e)\n}if(b){b.addNewRequestParams(h,k,f)\n}else{var c={soapDoc:h,asyncMode:true,callback:k,errorCallback:f,accountName:(this._account?this._account.name:null)};\nappCtxt.getAppController().sendRequest(c)\n}};\nZmMetaData.prototype.save=function(g,h,a){if(!g){return\n}if(!(g instanceof Array)){g=[g]\n}var f=this._account?this._account.name:null;\nvar b=a||(new ZmBatchCommand(null,f));\nfor(var d=0;\nd<g.length;\nd++){var j=g[d];\nvar c=[ZmMetaData.NAMESPACE,j].join(\":\");\nvar e=this._sections[c];\nif(e){this.set(j,e,b)\n}}if(!a){if(b.size()>0){b.run(h)\n}}else{if(h){h.run()\n}}};\nZmMetaData.prototype.update=function(e,c,d){var b=[ZmMetaData.NAMESPACE,e].join(\":\");\nvar a=this._sections[b];\nif(!a){a=this._sections[b]={}\n}a[c]=d\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmKeyMap\")){ZmKeyMap=function(){ZmKeyMap._setPreconditions();\nDwtKeyMap.call(this);\nthis._load(this._map,ZmKeys)\n};\nZmKeyMap.prototype=new DwtKeyMap(true);\nZmKeyMap.prototype.constructor=ZmKeyMap;\nZmKeyMap.prototype.isZmKeyMap=true;\nZmKeyMap.prototype.toString=function(){return\"ZmKeyMap\"\n};\nZmKeyMap.MAP_ADDRESS=\"address\";\nZmKeyMap.MAP_BRIEFCASE=\"briefcase\";\nZmKeyMap.MAP_CALENDAR=\"calendar\";\nZmKeyMap.MAP_CALL=\"call\";\nZmKeyMap.MAP_COMPOSE=\"compose\";\nZmKeyMap.MAP_CONTACTS=\"contacts\";\nZmKeyMap.MAP_CONVERSATION=\"conversation\";\nZmKeyMap.MAP_CONVERSATION_LIST=\"conversationList\";\nZmKeyMap.MAP_DL_ADDRESS_LIST=\"dlAddressList\";\nZmKeyMap.MAP_EDIT_APPOINTMENT=\"editAppointment\";\nZmKeyMap.MAP_EDIT_CONTACT=\"editContact\";\nZmKeyMap.MAP_EDIT_TASK=\"editTask\";\nZmKeyMap.MAP_GLOBAL=\"global\";\nZmKeyMap.MAP_MAIL=\"mail\";\nZmKeyMap.MAP_MESSAGE=\"message\";\nZmKeyMap.MAP_QUICK_REPLY=\"quickReply\";\nZmKeyMap.MAP_OPTIONS=\"options\";\nZmKeyMap.MAP_TASKS=\"tasks\";\nZmKeyMap.MAP_VIEW_APPOINTMENT=\"viewAppointment\";\nZmKeyMap.MAP_VOICEMAIL=\"voicemail\";\nZmKeyMap.ADDRESS_PICKER=\"AddressPicker\";\nZmKeyMap.ADD_EXTERNAL_CALENDAR=\"AddExternalCalendar\";\nZmKeyMap.ATTACHMENT=\"Attachment\";\nZmKeyMap.CAL_DAY_VIEW=\"DayView\";\nZmKeyMap.CAL_FB_VIEW=\"FBView\";\nZmKeyMap.CAL_LIST_VIEW=\"CalListView\";\nZmKeyMap.CAL_MONTH_VIEW=\"MonthView\";\nZmKeyMap.CAL_WEEK_VIEW=\"WeekView\";\nZmKeyMap.CAL_WORK_WEEK_VIEW=\"WorkWeekView\";\nZmKeyMap.CALL_MANAGER=\"CallManager\";\nZmKeyMap.CANCEL=\"Cancel\";\nZmKeyMap.COLLAPSE=\"Collapse\";\nZmKeyMap.COLLAPSE_ALL=\"CollapseAll\";\nZmKeyMap.DEL=\"Delete\";\nZmKeyMap.SHIFT_DEL=\"ShiftDelete\";\nZmKeyMap.DOWNLOAD=\"Download\";\nZmKeyMap.EDIT=\"Edit\";\nZmKeyMap.EXPAND=\"Expand\";\nZmKeyMap.EXPAND_ALL=\"ExpandAll\";\nZmKeyMap.FIRST_UNREAD=\"FirstUnread\";\nZmKeyMap.FIRST_UNREAD_MSG=\"FirstUnreadMsg\";\nZmKeyMap.FLAG=\"Flag\";\nZmKeyMap.FOCUS_CONTENT_PANE=\"FocusContentPane\";\nZmKeyMap.FOCUS_SEARCH_BOX=\"FocusSearchBox\";\nZmKeyMap.FOCUS_TOOLBAR=\"FocusToolbar\";\nZmKeyMap.FORWARD=\"Forward\";\nZmKeyMap.GET_MAIL=\"GetMail\";\nZmKeyMap.GOTO_BRIEFCASE=\"GoToBriefcase\";\nZmKeyMap.GOTO_CALENDAR=\"GoToCalendar\";\nZmKeyMap.GOTO_CONTACTS=\"GoToContacts\";\nZmKeyMap.GOTO_DRAFTS=\"GoToDrafts\";\nZmKeyMap.GOTO_JUNK=\"GoToJunk\";\nZmKeyMap.GOTO_INBOX=\"GoToInbox\";\nZmKeyMap.GOTO_MAIL=\"GoToMail\";\nZmKeyMap.GOTO_OPTIONS=\"GoToOptions\";\nZmKeyMap.GOTO_SENT=\"GoToSent\";\nZmKeyMap.GOTO_TASKS=\"GoToTasks\";\nZmKeyMap.GOTO_TRASH=\"GoToTrash\";\nZmKeyMap.GOTO_VOICE=\"GoToVoice\";\nZmKeyMap.HTML_FORMAT=\"HtmlFormat\";\nZmKeyMap.KEEP_READING=\"KeepReading\";\nZmKeyMap.LAST_UNREAD=\"LastUnread\";\nZmKeyMap.LAST_UNREAD_MSG=\"LastUnreadMsg\";\nZmKeyMap.MARK_COMPLETE=\"MarkComplete\";\nZmKeyMap.MARK_HEARD=\"MarkHeard\";\nZmKeyMap.MARK_READ=\"MarkRead\";\nZmKeyMap.MARK_UNCOMPLETE=\"MarkUncomplete\";\nZmKeyMap.MARK_UNHEARD=\"MarkUnheard\";\nZmKeyMap.MARK_UNREAD=\"MarkUnread\";\nZmKeyMap.MOVE=\"Move\";\nZmKeyMap.MOVE_TO_INBOX=\"MoveToInbox\";\nZmKeyMap.MOVE_TO_JUNK=\"MoveToJunk\";\nZmKeyMap.MOVE_TO_TRASH=\"MoveToTrash\";\nZmKeyMap.MUTE_UNMUTE_CONV=\"MuteUnmuteConv\";\nZmKeyMap.NEW=\"New\";\nZmKeyMap.NEW_APPT=\"NewAppointment\";\nZmKeyMap.NEW_BRIEFCASE=\"NewBriefcase\";\nZmKeyMap.NEW_CALENDAR=\"NewCalendar\";\nZmKeyMap.NEW_CONTACT=\"NewContact\";\nZmKeyMap.NEW_DOC=\"NewDocument\";\nZmKeyMap.NEW_FILE=\"NewFile\";\nZmKeyMap.NEW_FOLDER=\"NewFolder\";\nZmKeyMap.NEW_MESSAGE=\"NewMessage\";\nZmKeyMap.NEW_MESSAGE_WIN=\"NewMessageWindow\";\nZmKeyMap.NEW_SEARCH=\"NewSearch\";\nZmKeyMap.NEW_TAG=\"NewTag\";\nZmKeyMap.NEW_TASK=\"NewTask\";\nZmKeyMap.NEW_WINDOW=\"NewWindow\";\nZmKeyMap.NEXT_APPT=\"NextAppointment\";\nZmKeyMap.NEXT_CONV=\"NextConversation\";\nZmKeyMap.NEXT_DAY=\"NextDay\";\nZmKeyMap.NEXT_MSG=\"NextMessage\";\nZmKeyMap.NEXT_PAGE=\"NextPage\";\nZmKeyMap.NEXT_UNREAD=\"NextUnread\";\nZmKeyMap.NEXT_UNREAD_MSG=\"NextUnreadMsg\";\nZmKeyMap.PLAY=\"Play\";\nZmKeyMap.PRESENCE_MENU=\"PresenceMenu\";\nZmKeyMap.PREV_APPT=\"PreviousAppointment\";\nZmKeyMap.PREV_CONV=\"PreviousConversation\";\nZmKeyMap.PREV_DAY=\"PreviousDay\";\nZmKeyMap.PREV_MSG=\"PreviousMessage\";\nZmKeyMap.PREV_PAGE=\"PreviousPage\";\nZmKeyMap.PREV_UNREAD=\"PreviousUnread\";\nZmKeyMap.PREV_UNREAD_MSG=\"PreviousUnreadMsg\";\nZmKeyMap.PRINT=\"Print\";\nZmKeyMap.PRINT_ALL=\"PrintAll\";\nZmKeyMap.QUICK_ADD=\"QuickAdd\";\nZmKeyMap.QUICK_REMINDER=\"QuickReminder\";\nZmKeyMap.READING_PANE_BOTTOM=\"ReadingPaneAtBottom\";\nZmKeyMap.READING_PANE_OFF=\"ReadingPaneOff\";\nZmKeyMap.READING_PANE_RIGHT=\"ReadingPaneOnRight\";\nZmKeyMap.REFRESH=\"Refresh\";\nZmKeyMap.REPLY=\"Reply\";\nZmKeyMap.REPLY_ALL=\"ReplyAll\";\nZmKeyMap.SAVE=\"Save\";\nZmKeyMap.SAVED_SEARCH=\"SavedSearch\";\nZmKeyMap.SELECT_ALL=\"SelectAll\";\nZmKeyMap.SEND=\"Send\";\nZmKeyMap.SHORTCUTS=\"Shortcuts\";\nZmKeyMap.SHOW_FRAGMENT=\"ShowFragment\";\nZmKeyMap.SPAM=\"Spam\";\nZmKeyMap.SPELLCHECK=\"Spellcheck\";\nZmKeyMap.TAG=\"Tag\";\nZmKeyMap.TODAY=\"Today\";\nZmKeyMap.TOGGLE=\"Toggle\";\nZmKeyMap.UNTAG=\"Untag\";\nZmKeyMap.VIEW_BY_CONV=\"ViewByConversation\";\nZmKeyMap.VIEW_BY_MSG=\"ViewByMessage\";\nZmKeyMap.VISIT=\"Visit\";\nZmKeyMap.VISIT_TAG=\"VisitTag\";\nZmKeyMap.ENTITY={};\nZmKeyMap.ENTITY[DwtKeyMap.ARROW_LEFT]=\"&larr;\";\nZmKeyMap.ENTITY[DwtKeyMap.ARROW_RIGHT]=\"&rarr;\";\nZmKeyMap.ENTITY[DwtKeyMap.ARROW_UP]=\"&uarr;\";\nZmKeyMap.ENTITY[DwtKeyMap.ARROW_DOWN]=\"&darr;\";\nZmKeyMap.ENTITY['\"']=\"&quot;\";\nZmKeyMap.ENTITY[\"&\"]=\"&amp;\";\nZmKeyMap.ENTITY[\"<\"]=\"&lt;\";\nZmKeyMap.ENTITY[\">\"]=\"&gt;\";\nZmKeyMap.ENTITY[DwtKeyMap.COMMA]=\",\";\nZmKeyMap.ENTITY[DwtKeyMap.SEMICOLON]=\";\";\nZmKeyMap.ENTITY[DwtKeyMap.BACKSLASH]=\"\\\\\";\nZmKeyMap.MAP_PRECONDITION={};\nZmKeyMap.ACTION_PRECONDITION={};\nZmKeyMap._setPreconditions=function(){ZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_COMPOSE]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_MAIL]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_CONVERSATION_LIST]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_CONVERSATION]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_DL_ADDRESS_LIST]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_MESSAGE]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_CONTACTS]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_EDIT_CONTACT]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_CALENDAR]=ZmSetting.CALENDAR_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_EDIT_APPOINTMENT]=ZmSetting.CALENDAR_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_OPTIONS]=ZmSetting.OPTIONS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_BRIEFCASE]=ZmSetting.BRIEFCASE_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_TASKS]=ZmSetting.TASKS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_EDIT_TASK]=ZmSetting.TASKS_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_VOICEMAIL]=ZmSetting.VOICE_ENABLED;\nZmKeyMap.MAP_PRECONDITION[ZmKeyMap.MAP_CALL]=ZmSetting.VOICE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL]={};\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.FOCUS_SEARCH_BOX]=ZmSetting.SEARCH_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_BRIEFCASE]=ZmSetting.BRIEFCASE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_CALENDAR]=ZmSetting.CALENDAR_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_CONTACTS]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_MAIL]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_OPTIONS]=ZmSetting.OPTIONS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_TASKS]=ZmSetting.TASKS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.GOTO_VOICE]=ZmSetting.VOICE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_APPT]=ZmSetting.CALENDAR_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_BRIEFCASEITEM]=ZmSetting.BRIEFCASE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_CALENDAR]=ZmSetting.CALENDAR_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_CONTACT]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_FILE]=ZmSetting.BRIEFCASE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_DOC]=ZmSetting.DOCS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_FOLDER]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_MESSAGE]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_MESSAGE_WIN]=ZmSetting.MAIL_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_TAG]=ZmSetting.TAGGING_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.NEW_TASK]=ZmSetting.TASKS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.SAVED_SEARCH]=ZmSetting.SAVED_SEARCHES_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.TAG]=ZmSetting.TAGGING_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_GLOBAL][ZmKeyMap.UNTAG]=ZmSetting.TAGGING_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_COMPOSE]={};\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_COMPOSE][ZmKeyMap.ADDRESS_PICKER]=ZmSetting.CONTACTS_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_COMPOSE][ZmKeyMap.HTML_FORMAT]=ZmSetting.HTML_COMPOSE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_COMPOSE][ZmKeyMap.NEW_WINDOW]=ZmSetting.NEW_WINDOW_COMPOSE;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_COMPOSE][ZmKeyMap.SAVE]=ZmSetting.SAVE_DRAFT_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_EDIT_APPOINTMENT]={};\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_EDIT_APPOINTMENT][ZmKeyMap.HTML_FORMAT]=ZmSetting.HTML_COMPOSE_ENABLED;\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_CALENDAR]={};\nZmKeyMap.ACTION_PRECONDITION[ZmKeyMap.MAP_CALENDAR][ZmKeyMap.CAL_FB_VIEW]=ZmSetting.FREE_BUSY_VIEW_ENABLED\n};\nZmKeyMap.prototype._checkMap=function(b){var a=this._checkedMap[b]=appCtxt.checkPrecondition(ZmKeyMap.MAP_PRECONDITION[b]);\nreturn a\n};\nZmKeyMap.prototype._checkAction=function(b,c){if(this._checkedMap[b]===false||(!this._checkedMap[b]&&!this._checkMap(b))){return false\n}var a=ZmKeyMap.ACTION_PRECONDITION[b];\nreturn appCtxt.checkPrecondition(a&&a[c])\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmTimezone\")){ZmTimezone=function(){};\nZmTimezone.getDefault=function(){var b=DwtShell.getShell(window);\nvar a=appCtxt.get(ZmSetting.DEFAULT_TIMEZONE);\nreturn(a)?AjxTimezone.getClientId(a):AjxTimezone.DEFAULT\n};\nZmTimezone.getDefaultRule=function(){return AjxTimezone.getRule(ZmTimezone.getDefault())\n};\nZmTimezone.set=function(e,b,a,d){var c=AjxTimezone.getRule(b);\nif(!c){return\n}if(c.autoDetected||!d){if(e instanceof AjxSoapDoc){ZmTimezone._setSoap(e,b,a,c)\n}else{ZmTimezone._setJson(e,b,c)\n}}};\nZmTimezone._setSoap=function(p,g,m,n){var f=p.set(\"tz\",null,m);\nvar b=AjxTimezone.getServerId(g);\nf.setAttribute(\"id\",b);\nif(n.autoDetected){f.setAttribute(\"stdoff\",n.standard.offset);\nif(n.daylight){f.setAttribute(\"dayoff\",n.daylight.offset);\nvar o=[\"standard\",\"daylight\"];\nvar a=[\"mon\",\"mday\",\"week\",\"wkday\",\"hour\",\"min\",\"sec\"];\nfor(var k=0;\nk<o.length;\nk++){var d=o[k];\nvar l=n[d];\nvar c=p.set(d,null,f);\nfor(var h=0;\nh<a.length;\nh++){var e=a[h];\nif(e in l){c.setAttribute(e,l[e])\n}}}}}};\nZmTimezone._setJson=function(h,f,m){var b=AjxTimezone.getServerId(f);\nvar e=h.tz={id:b};\nif(m.autoDetected){e.stdoff=m.standard.offset;\nif(m.daylight){e.dayoff=m.daylight.offset;\nvar n=[\"standard\",\"daylight\"];\nvar a=[\"mon\",\"mday\",\"week\",\"wkday\",\"hour\",\"min\",\"sec\"];\nfor(var k=0;\nk<n.length;\nk++){var c=n[k];\nvar l=m[c];\ne[c]={};\nfor(var g=0;\ng<a.length;\ng++){var d=a[g];\nif(d in l){e[c][d]=l[d]\n}}}}}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmItem\")){ZmItem=function(c,e,d,a){if(arguments.length==0){return\n}ZmModel.call(this,c);\nthis.type=c;\nthis.id=e;\nthis.list=d;\nthis._list={};\nthis.refCount=0;\nthis.tags=[];\nthis.tagHash={};\nthis.folderId=0;\nvar b=appCtxt.getById(e);\nif(b){this._list=AjxUtil.hashCopy(b._list);\nif(!d){this.list=b.list\n}}if(d){this._list[d.id]=true\n}if(e&&!a){appCtxt.cacheSet(e,this)\n}};\nZmItem.prototype=new ZmModel;\nZmItem.prototype.constructor=ZmItem;\nZmItem.prototype.isZmItem=true;\nZmItem.prototype.toString=function(){return\"ZmItem\"\n};\nZmItem.APP={};\nZmItem.MSG_KEY={};\nZmItem.ICON={};\nZmItem.RESULTS_LIST={};\nZmItem.F_ACCOUNT=ZmId.FLD_ACCOUNT;\nZmItem.F_ATTACHMENT=ZmId.FLD_ATTACHMENT;\nZmItem.F_CAPACITY=ZmId.FLD_CAPACITY;\nZmItem.F_COMPANY=ZmId.FLD_COMPANY;\nZmItem.F_DATE=ZmId.FLD_DATE;\nZmItem.F_DEPARTMENT=ZmId.FLD_DEPARTMENT;\nZmItem.F_EMAIL=ZmId.FLD_EMAIL;\nZmItem.F_EXPAND=ZmId.FLD_EXPAND;\nZmItem.F_FILE_TYPE=ZmId.FLD_FILE_TYPE;\nZmItem.F_FLAG=ZmId.FLD_FLAG;\nZmItem.F_FOLDER=ZmId.FLD_FOLDER;\nZmItem.F_FRAGMENT=ZmId.FLD_FRAGMENT;\nZmItem.F_FROM=ZmId.FLD_FROM;\nZmItem.F_HOME_PHONE=ZmId.FLD_HOME_PHONE;\nZmItem.F_ID=ZmId.FLD_ID;\nZmItem.F_INDEX=ZmId.FLD_INDEX;\nZmItem.F_ITEM_ROW=ZmId.FLD_ITEM_ROW;\nZmItem.F_ITEM_ROW_3PANE=ZmId.FLD_ITEM_ROW_3PANE;\nZmItem.F_LOCATION=ZmId.FLD_LOCATION;\nZmItem.F_NAME=ZmId.FLD_NAME;\nZmItem.F_NOTES=ZmId.FLD_NOTES;\nZmItem.F_PARTICIPANT=ZmId.FLD_PARTICIPANT;\nZmItem.F_PCOMPLETE=ZmId.FLD_PCOMPLETE;\nZmItem.F_PRIORITY=ZmId.FLD_PRIORITY;\nZmItem.F_RECURRENCE=ZmId.FLD_RECURRENCE;\nZmItem.F_SELECTION=ZmId.FLD_SELECTION;\nZmItem.F_SELECTION_CELL=ZmId.FLD_SELECTION_CELL;\nZmItem.F_SIZE=ZmId.FLD_SIZE;\nZmItem.F_SORTED_BY=ZmId.FLD_SORTED_BY;\nZmItem.F_STATUS=ZmId.FLD_STATUS;\nZmItem.F_READ=ZmId.FLD_READ;\nZmItem.F_MUTE=ZmId.FLD_MUTE;\nZmItem.F_SUBJECT=ZmId.FLD_SUBJECT;\nZmItem.F_TAG=ZmId.FLD_TAG;\nZmItem.F_TAG_CELL=ZmId.FLD_TAG_CELL;\nZmItem.F_TO=ZmId.FLD_TO;\nZmItem.F_TYPE=ZmId.FLD_TYPE;\nZmItem.F_VERSION=ZmId.FLD_VERSION;\nZmItem.F_WORK_PHONE=ZmId.FLD_WORK_PHONE;\nZmItem.F_LOCK=ZmId.FLD_LOCK;\nZmItem.F_MSG_PRIORITY=ZmId.FLD_MSG_PRIORITY;\nZmItem.F_APP_PASSCODE_CREATED=ZmId.FLD_CREATED;\nZmItem.F_APP_PASSCODE_LAST_USED=ZmId.FLD_LAST_USED;\nZmItem.SOAP_CMD={};\nZmItem.TAGS_FIELD=1;\nZmItem.FLAG_ATTACH=\"a\";\nZmItem.FLAG_FLAGGED=\"f\";\nZmItem.FLAG_FORWARDED=\"w\";\nZmItem.FLAG_ISDRAFT=\"d\";\nZmItem.FLAG_ISSCHEDULED=\"c\";\nZmItem.FLAG_ISSENT=\"s\";\nZmItem.FLAG_READ_RECEIPT_SENT=\"n\";\nZmItem.FLAG_REPLIED=\"r\";\nZmItem.FLAG_UNREAD=\"u\";\nZmItem.FLAG_MUTE=\"(\";\nZmItem.FLAG_LOW_PRIORITY=\"?\";\nZmItem.FLAG_HIGH_PRIORITY=\"!\";\nZmItem.FLAG_PRIORITY=\"+\";\nZmItem.FLAG_NOTE=\"t\";\nZmItem.FLAG_OFFLINE_CREATED=\"o\";\nZmItem.ALL_FLAGS=[ZmItem.FLAG_FLAGGED,ZmItem.FLAG_ATTACH,ZmItem.FLAG_UNREAD,ZmItem.FLAG_MUTE,ZmItem.FLAG_REPLIED,ZmItem.FLAG_FORWARDED,ZmItem.FLAG_ISSENT,ZmItem.FLAG_READ_RECEIPT_SENT,ZmItem.FLAG_ISDRAFT,ZmItem.FLAG_ISSCHEDULED,ZmItem.FLAG_HIGH_PRIORITY,ZmItem.FLAG_LOW_PRIORITY,ZmItem.FLAG_PRIORITY,ZmItem.FLAG_NOTE,ZmItem.FLAG_OFFLINE_CREATED];\nZmItem.FLAG_PROP={};\nZmItem.FLAG_PROP[ZmItem.FLAG_ATTACH]=\"hasAttach\";\nZmItem.FLAG_PROP[ZmItem.FLAG_FLAGGED]=\"isFlagged\";\nZmItem.FLAG_PROP[ZmItem.FLAG_FORWARDED]=\"isForwarded\";\nZmItem.FLAG_PROP[ZmItem.FLAG_ISDRAFT]=\"isDraft\";\nZmItem.FLAG_PROP[ZmItem.FLAG_ISSCHEDULED]=\"isScheduled\";\nZmItem.FLAG_PROP[ZmItem.FLAG_ISSENT]=\"isSent\";\nZmItem.FLAG_PROP[ZmItem.FLAG_READ_RECEIPT_SENT]=\"readReceiptSent\";\nZmItem.FLAG_PROP[ZmItem.FLAG_REPLIED]=\"isReplied\";\nZmItem.FLAG_PROP[ZmItem.FLAG_UNREAD]=\"isUnread\";\nZmItem.FLAG_PROP[ZmItem.FLAG_MUTE]=\"isMute\";\nZmItem.FLAG_PROP[ZmItem.FLAG_LOW_PRIORITY]=\"isLowPriority\";\nZmItem.FLAG_PROP[ZmItem.FLAG_HIGH_PRIORITY]=\"isHighPriority\";\nZmItem.FLAG_PROP[ZmItem.FLAG_PRIORITY]=\"isPriority\";\nZmItem.FLAG_PROP[ZmItem.FLAG_NOTE]=\"isNote\";\nZmItem.FLAG_PROP[ZmItem.FLAG_OFFLINE_CREATED]=\"isOfflineCreated\";\nZmItem.DND_ACTION_MOVE=1<<0;\nZmItem.DND_ACTION_COPY=1<<1;\nZmItem.DND_ACTION_BOTH=ZmItem.DND_ACTION_MOVE|ZmItem.DND_ACTION_COPY;\nZmItem.NOTES_SEPARATOR=\"*~*~*~*~*~*~*~*~*~*\";\nZmItem.registerItem=function(a,b){if(b.app){ZmItem.APP[a]=b.app\n}if(b.nameKey){ZmItem.MSG_KEY[a]=b.nameKey\n}if(b.icon){ZmItem.ICON[a]=b.icon\n}if(b.soapCmd){ZmItem.SOAP_CMD[a]=b.soapCmd\n}if(b.itemClass){ZmList.ITEM_CLASS[a]=b.itemClass\n}if(b.node){ZmList.NODE[a]=b.node\n}if(b.organizer){ZmOrganizer.ITEM_ORGANIZER[a]=b.organizer\n}if(b.searchType){ZmSearch.TYPE[a]=b.searchType\n}if(b.resultsList){ZmItem.RESULTS_LIST[a]=b.resultsList\n}if(b.node){ZmList.ITEM_TYPE[b.node]=a\n}if(b.dropTargets){if(!ZmApp.DROP_TARGETS[b.app]){ZmApp.DROP_TARGETS[b.app]={}\n}ZmApp.DROP_TARGETS[b.app][a]=b.dropTargets\n}};\nZmItem.getItemId=function(b){if(!b){return b\n}if(!ZmItem.SHORT_ID_RE){var a=DwtShell.getShell(window);\nZmItem.SHORT_ID_RE=new RegExp(appCtxt.get(ZmSetting.USERID)+\":\",\"gi\")\n}return b.replace(ZmItem.SHORT_ID_RE,\"\")\n};\nZmItem.prototype.create=function(a){};\nZmItem.prototype.modify=function(a){};\nZmItem.prototype.getById=function(a){if(a==this.id){return this\n}};\nZmItem.prototype.getAccount=function(){if(!this.account){var d;\nif(this.folderId){var c=window.parentAppCtxt||window.appCtxt;\nvar b=c.getById(this.folderId);\nd=b&&b.getAccount()\n}if(!d){var a=ZmOrganizer.parseId(this.id);\nd=a&&a.account\n}this.account=d\n}return this.account\n};\nZmItem.prototype.clear=function(){if(this.refCount<=1){this._evtMgr.removeAll(ZmEvent.L_MODIFY);\nif(this.tags.length){for(var a=0;\na<this.tags.length;\na++){this.tags[a]=null\n}this.tags=[]\n}for(var a in this.tagHash){this.tagHash[a]=null\n}this.tagHash={}\n}this.refCount--\n};\nZmItem.prototype.cache=function(){if(this.id){appCtxt.cacheSet(this.id,this);\nreturn true\n}return false\n};\nZmItem.prototype.hasTag=function(a){return(this.tagHash[a]==true)\n};\nZmItem.prototype.canAddTag=function(a){return !this.hasTag(a)\n};\nZmItem.prototype.getFolderId=function(){return this.folderId\n};\nZmItem.prototype.getUrl=function(){return this.getRestUrl()\n};\nZmItem.prototype.getRestUrl=function(){if(this.restUrl){return this.restUrl\n}var c=ZmOrganizer.ITEM_ORGANIZER[this.type];\nvar a=appCtxt.getById(this.folderId);\nvar b=a?([a.getRestUrl(),\"/\",AjxStringUtil.urlComponentEncode(this.name)].join(\"\")):null;\nreturn b\n};\nZmItem.prototype.getTagImageInfo=function(){return this.getTagImageFromNames(this.getVisibleTags())\n};\nZmItem.prototype.getTagImageFromIds=function(b){var a;\nif(!b||b.length==0){a=\"Blank_16\"\n}else{if(b.length==1){a=this.getTagImage(b[0])\n}else{a=\"TagStack\"\n}}return a\n};\nZmItem.prototype.getVisibleTags=function(){if(!appCtxt.get(ZmSetting.TAGGING_ENABLED)){return[]\n}return this.tags\n};\nZmItem.prototype.getTagImageFromNames=function(a){if(!a||a.length==0){return\"Blank_16\"\n}if(a.length==1){return this.getTagImage(a[0])\n}return\"TagStack\"\n};\nZmItem.prototype.getTagImage=function(b){var c=appCtxt.getAccountTagList(this);\nvar a=c.getByNameOrRemote(b);\nreturn a?a.getIconWithColor():\"Blank_16\"\n};\nZmItem.prototype.getDefaultDndAction=function(a){return(this.isReadOnly()||a)?ZmItem.DND_ACTION_COPY:ZmItem.DND_ACTION_MOVE\n};\nZmItem.prototype.isReadOnly=function(){return false\n};\nZmItem.prototype.isShared=function(){if(this._isShared==null){if(this.id===-1){this._isShared=false\n}else{this._isShared=appCtxt.isRemoteId(this.id)\n}}return this._isShared\n};\nZmItem.prototype.notifyDelete=function(){this._notifyDelete();\nfor(var b in this._list){var c=appCtxt.getById(b);\nif(!c||(this.list&&b==this.list.id)){continue\n}var a=c.controller;\nif(!a||a.inactive||(a.getList().id!=b)){continue\n}var d=c.getById(this.id);\nif(d){d._notifyDelete()\n}}};\nZmItem.prototype._notifyDelete=function(){this.deleteLocal();\nif(this.list){this.list.deleteLocal([this])\n}this._notify(ZmEvent.E_DELETE)\n};\nZmItem.prototype.notifyModify=function(d,f){this._notifyModify(d,f);\nfor(var b in this._list){var c=b?appCtxt.getById(b):null;\nif(!c||(this.list&&(b==this.list.id))){continue\n}var a=c.controller;\nif(!a||a.inactive||(a.getList().id!=b)){continue\n}var e=c.getById(this.id);\nif(e){e._notifyModify(d,f)\n}}};\nZmItem.prototype._notifyModify=function(g,h){if(g.tn!=null){this._parseTagNames(g.tn);\nthis._notify(ZmEvent.E_TAGS)\n}if(g.f!=null){var c=this._getFlags();\nvar f={};\nfor(var e=0;\ne<c.length;\ne++){f[c[e]]=this[ZmItem.FLAG_PROP[c[e]]]\n}this._parseFlags(g.f);\nvar b=[];\nfor(var e=0;\ne<c.length;\ne++){var a=this[ZmItem.FLAG_PROP[c[e]]];\nif(f[c[e]]!=a){b.push(c[e])\n}}if(b.length){this._notify(ZmEvent.E_FLAGS,{flags:b})\n}}if(g.l!=null&&g.l!=this.folderId){var d={oldFolderId:this.folderId};\nthis.moveLocal(g.l);\nif(this.list){this.list.moveLocal([this],g.l)\n}if(h){delete g.l;\nreturn ZmEvent.E_MOVE\n}else{this._notify(ZmEvent.E_MOVE,d)\n}}};\nZmItem.prototype.flagLocal=function(b,a){this[ZmItem.FLAG_PROP[b]]=a\n};\nZmItem.prototype.setFlag=function(c,b){this.flagLocal(c,b);\nvar a=this.flags||\"\";\nif(b&&a.indexOf(c)==-1){a=a+c\n}else{if(!b&&a.indexOf(c)!=-1){a=a.replace(c,\"\")\n}}this.flags=a;\nreturn a\n};\nZmItem.prototype.tagLocal=function(a,d){var c=false;\nif(d){if(!this.tagHash[a]){c=true;\nthis.tags.push(a);\nthis.tagHash[a]=true\n}}else{for(var b=0;\nb<this.tags.length;\nb++){if(this.tags[b]==a){this.tags.splice(b,1);\ndelete this.tagHash[a];\nc=true;\nbreak\n}}}return c\n};\nZmItem.prototype.removeAllTagsLocal=function(){this.tags=[];\nfor(var a in this.tagHash){delete this.tagHash[a]\n}};\nZmItem.prototype.deleteLocal=function(){};\nZmItem.prototype.move=function(a,c,b){return ZmItem.move(this.id,a,c,b)\n};\nZmItem.move=function(f,a,g,b,c){var d={ItemActionRequest:{_jsns:\"urn:zimbraMail\",action:{id:f instanceof Array?f.join():f,op:\"move\",l:a}}};\nvar e={jsonObj:d,asyncMode:Boolean(g),callback:g,errorCallback:b,accountName:c};\nreturn appCtxt.getAppController().sendRequest(e)\n};\nZmItem.prototype.moveLocal=function(a){this.folderId=a\n};\nZmItem.prototype._parseTags=function(d){this.tags=[];\nthis.tagHash={};\nif(d&&d.length){var a=d.split(\",\");\nfor(var b=0;\nb<a.length;\nb++){var c=Number(a[b]);\nif(c>=ZmOrganizer.FIRST_USER_ID[ZmOrganizer.TAG]){this.tagLocal(c,true)\n}}}};\nZmItem.prototype._parseTagNames=function(d){this.tags=[];\nthis.tagHash={};\nif(!d||!d.length){return\n}d=d.replace(/\\\\,/g,\"\\u001D\");\nvar a=d.split(\",\");\nfor(var c=0;\nc<a.length;\nc++){var b=a[c].replace(\"\\u001D\",\",\");\nthis.tagLocal(b,true)\n}};\nZmItem.prototype._parseFlags=function(d){this.flags=d;\nfor(var c=0;\nc<ZmItem.ALL_FLAGS.length;\nc++){var b=ZmItem.ALL_FLAGS[c];\nvar a=(d&&(d.indexOf(b)!=-1))?true:false;\nthis.flagLocal(b,a)\n}};\nZmItem.prototype._notify=function(b,a){this._doNotify(b,a)\n};\nZmItem.prototype._setupNotify=function(){this._doNotify()\n};\nZmItem.prototype._doNotify=function(b,a){if(this._evt){this._evt.item=this;\nif(b!=null){ZmModel.prototype._notify.call(this,b,a)\n}}else{var c=\"\";\nif(this.type&&this.id){c=\": item = \"+this.type+\"(\"+this.id+\")\"\n}}if(this.list){this.list._evt.item=this;\nthis.list._evt.items=[this];\nif(b!=null){if(a){a.items=[this]\n}else{a={items:[this]}\n}this.list._notify(b,a)\n}}};\nZmItem.prototype._getFlags=function(){return[ZmItem.FLAG_FLAGGED,ZmItem.FLAG_ATTACH]\n};\nZmItem.prototype.rename=function(a,c,b){return ZmItem.rename(this.id,a,c,b)\n};\nZmItem.rename=function(f,a,g,b,c){var d={ItemActionRequest:{_jsns:\"urn:zimbraMail\",action:{id:f instanceof Array?f[0]:f,op:\"rename\",name:a}}};\nvar e={jsonObj:d,asyncMode:Boolean(g),callback:g,errorCallback:b,accountName:c};\nreturn appCtxt.getAppController().sendRequest(e)\n};\nZmItem.prototype.getSortedTags=function(){var d=this.tags&&this.tags.length;\nif(d){var e=appCtxt.getAccountTagList(this);\nvar b=[];\nfor(var c=0;\nc<d;\nc++){var a=e.getByNameOrRemote(this.tags[c]);\nif(!a){continue\n}b.push(a)\n}b.sort(ZmTag.sortCompare);\nreturn b\n}return null\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmActionStack\")){ZmActionStack=function(a){this._stack=[];\nthis._pointer=-1;\nthis._maxLength=a||0\n};\nZmEvent.S_ACTION=\"ACTION\";\nZmActionStack.validTypes=[ZmId.ORG_FOLDER,ZmId.ITEM_MSG,ZmId.ITEM_CONV,ZmId.ITEM_CONTACT,ZmId.ITEM_GROUP,ZmId.ITEM_BRIEFCASE,ZmId.ORG_BRIEFCASE,ZmId.ITEM_TASK,ZmId.ORG_TASKS];\nZmActionStack.prototype.toString=function(){return\"ZmActionStack\"\n};\nZmActionStack.prototype.logAction=function(e){var g=e.op,j=[];\nif(e.items){for(var f=0;\nf<e.items.length;\nf++){var n=e.items[f];\nif(n&&this._isValidType(n.type)){j.push(n)\n}}}else{if(e.item){if(e.item&&this._isValidType(e.item.type)){j.push(e.item)\n}}else{if(e.ids){for(var f=0;\nf<e.ids.length;\nf++){var n=appCtxt.getById(e.ids[f]);\nif(n&&this._isValidType(n.type)){j.push(n)\n}}}else{if(e.id){var n=appCtxt.getById(e.id);\nif(n&&this._isValidType(n.type)){j.push(n)\n}}}}}var m=e.attrs;\nfor(var f=0;\nf<j.length;\nf++){var n=j[f];\nif(n.type===ZmItem.CONV){var l=m&&m.tcon;\nfor(var c in n.msgFolder){var b=n.msgFolder[c],k=ZmFolder.TCON_CODE[b];\nif(!l||l.indexOf(k)===-1){j.push({isConvMsg:true,id:c,type:ZmItem.MSG,folderId:b,list:{type:ZmItem.MSG}})\n}}}}var h=j.length>1;\nvar d=null;\nvar b;\nswitch(g){case\"trash\":b=ZmFolder.ID_TRASH;\nbreak;\ncase\"spam\":b=ZmFolder.ID_SPAM;\nbreak;\ncase\"move\":case\"!spam\":b=m.l;\nbreak\n}var a=appCtxt.getById(b);\nif(a&&!a.isRemote()){switch(g){case\"trash\":case\"move\":case\"spam\":case\"!spam\":for(var f=0;\nf<j.length;\nf++){var n=j[f];\nvar o;\nif(n instanceof ZmItem){if(!n.isShared()){o=new ZmItemMoveAction(n,n.getFolderId(),b,g)\n}}else{if(n instanceof ZmOrganizer){if(!n.isRemote()){o=new ZmOrganizerMoveAction(n,n.parent.id,b,g)\n}}else{if(n.isConvMsg){if(!appCtxt.isRemoteId(n.id)){o=new ZmItemMoveAction(n,n.folderId,b,g)\n}}}}if(o){if(h){if(!d){d=new ZmCompositeAction(b)\n}d.addAction(o)\n}else{d=o\n}}}break\n}if(d){this._push(d)\n}}return d\n};\nZmActionStack.prototype.canUndo=function(){return this._pointer>=0\n};\nZmActionStack.prototype.canRedo=function(){return this._pointer<this._stack.length-1\n};\nZmActionStack.prototype.actionIsComplete=function(){return this.canUndo()&&this._current().getComplete()\n};\nZmActionStack.prototype.onComplete=function(b){var a=this._current();\nif(a){a.onComplete(b)\n}};\nZmActionStack.prototype.undo=function(){if(this.canUndo()){var a=this._pop();\na.undo()\n}};\nZmActionStack.prototype.redo=function(){if(this.canRedo()){var a=this._stack[++this._pointer];\na.redo()\n}};\nZmActionStack.prototype._push=function(b){if(b&&b instanceof ZmAction){var a=this._pointer+1;\nwhile(this._maxLength&&a>=this._maxLength){this._stack.shift();\na--\n}this._stack[a]=b;\nthis._stack.length=a+1;\nthis._pointer=a\n}};\nZmActionStack.prototype._pop=function(){return this.canUndo()?this._stack[this._pointer--]:null\n};\nZmActionStack.prototype._current=function(){return this.canUndo()?this._stack[this._pointer]:null\n};\nZmActionStack.prototype._isValidType=function(a){return !ZmActionStack.validTypes||AjxUtil.indexOf(ZmActionStack.validTypes,a)!==-1\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmAction\")){ZmAction=function(){ZmModel.call(this,ZmEvent.S_ACTION);\nthis._complete=false\n};\nZmAction.prototype=new ZmModel;\nZmAction.prototype.constructor=ZmAction;\nZmAction.ACTION_ZMACTION=\"ZmAction\";\nZmAction.ACTION_ZMITEMACTION=\"ZmItemAction\";\nZmAction.ACTION_ZMITEMMOVEACTION=\"ZmItemMoveAction\";\nZmAction.ACTION_ZMITEMTRASHACTION=\"ZmItemTrashAction\";\nZmAction.ACTION_ZMORGANIZERACTION=\"ZmOrganizerAction\";\nZmAction.ACTION_ZMORGANIZERMOVEACTION=\"ZmOrganizerMoveAction\";\nZmAction.ACTION_ZMCOMPOSITEACTION=\"ZmCompositeAction\";\nZmAction.prototype.type=ZmAction.ACTION_ZMITEMACTION;\nZmAction.prototype.toString=function(){return\"ZmAction\"\n};\nZmAction.prototype.undo=function(){};\nZmAction.prototype.redo=function(){};\nZmAction.prototype.setComplete=function(){if(!this._complete){this._complete=true;\nthis._notify(ZmEvent.E_COMPLETE)\n}};\nZmAction.prototype.getComplete=function(){return this._complete\n};\nZmAction.prototype.onComplete=function(a){if(this._complete){a.run(this)\n}else{this.addChangeListener(new AjxListener(this,this._handleComplete,[a]))\n}};\nZmAction.prototype._handleComplete=function(b,a){if(a.event===ZmEvent.E_COMPLETE){b.run(this)\n}};\nZmItemAction=function(a,b){if(!arguments.length){return\n}ZmAction.call(this);\nthis._item=a;\nthis._op=b\n};\nZmItemAction.prototype=new ZmAction;\nZmItemAction.prototype.constructor=ZmItemAction;\nZmItemAction.prototype.type=ZmAction.ACTION_ZMITEMACTION;\nZmItemAction.prototype.toString=function(){return\"ZmItemAction\"\n};\nZmItemAction.prototype.getItem=function(){return this._item\n};\nZmItemAction.prototype.getOp=function(){return this._op\n};\nZmOrganizerAction=function(a,b){if(!arguments.length){return\n}ZmAction.call(this);\nthis._organizer=a;\nthis._op=b\n};\nZmOrganizerAction.prototype=new ZmAction;\nZmOrganizerAction.prototype.constructor=ZmOrganizerAction;\nZmOrganizerAction.prototype.type=ZmAction.ACTION_ZMORGANIZERACTION;\nZmOrganizerAction.prototype.toString=function(){return\"ZmOrganizerAction\"\n};\nZmOrganizerAction.prototype.getOrganizer=function(){return this._organizer\n};\nZmOrganizerAction.prototype.getOp=function(){return this._op\n};\nZmItemMoveAction=function(b,a,d,c){ZmItemAction.call(this,b,c);\nthis._fromFolderId=a;\nthis._toFolderId=d\n};\nZmItemMoveAction.prototype=new ZmItemAction;\nZmItemMoveAction.prototype.constructor=ZmItemMoveAction;\nZmItemMoveAction.prototype.type=ZmAction.ACTION_ZMITEMMOVEACTION;\nZmItemMoveAction.prototype.toString=function(){return\"ZmItemMoveAction\"\n};\nZmItemMoveAction.UNDO_MSG={move:ZmMsg.actionUndoMove,trash:ZmMsg.actionUndoTrash,spam:ZmMsg.actionUndoMarkAsJunk,\"!spam\":ZmMsg.actionUndoMarkAsNotJunk};\nZmItemMoveAction.prototype.getFromFolderId=function(){return this._fromFolderId\n};\nZmItemMoveAction.prototype.getToFolderId=function(){return this._toFolderId\n};\nZmItemMoveAction.prototype._doMove=function(e,c,a){var b=ZmItemMoveAction._realizeItems(this._item),d=b[0]&&b[0].list;\nd.moveItems({items:b,folder:appCtxt.getById(a),noUndo:true,finalCallback:this._handleDoMove.bind(this,this._item.folderId,a),fromFolderId:this._toFolderId})\n};\nZmItemMoveAction.prototype._handleDoMove=function(e,c,g){var a=[];\nfor(var h in g.idHash){var d=g.idHash[h];\nif(d instanceof ZmConv){d.folderId=c\n}var f=d&&d.list;\nif(AjxUtil.indexOf(a,f)==-1){a.push(f)\n}}for(var b=0;\nb<a.length;\nb++){a[b]._notify(ZmEvent.E_MOVE,{oldFolderId:e})\n}ZmListController.handleProgress({state:ZmListController.PROGRESS_DIALOG_CLOSE});\nZmBaseController.showSummary(g.actionSummary)\n};\nZmItemMoveAction.prototype.undo=function(b,a){this._doMove(b,a,this._fromFolderId)\n};\nZmItemMoveAction.prototype.redo=function(b,a){this._doMove(b,a,this._toFolderId)\n};\nZmItemMoveAction.multipleUndo=function(e,h,b){var a={};\nfor(var f=0;\nf<e.length;\nf++){var d=e[f];\nif(d instanceof ZmItemMoveAction){var l=d.getFromFolderId();\nvar m=d.getToFolderId();\nvar n=d.getItem();\nvar k=(n&&n.list&&n.list.type)||0;\nif(!a[l]){a[l]={}\n}if(!a[l][m]){a[l][m]={}\n}if(!a[l][m][k]){a[l][m][k]=[]\n}a[l][m][k].push(d)\n}}for(var l in a){for(var m in a[l]){for(var k in a[l][m]){var c=a[l][m][k];\nvar j=[];\nvar g=null;\nfor(var f=0;\nf<c.length;\nf++){var d=c[f];\nvar n=d.getItem();\nj.push(n)\n}j=ZmItemMoveAction._realizeItems(j);\ng=j[0]&&j[0].list;\nif(g){g.moveItems({items:j,folder:appCtxt.getById(h?m:l),noUndo:true,fromFolderId:b})\n}}}}};\nZmItemMoveAction.multipleRedo=function(a){ZmItemMoveAction.multipleUndo(a,true)\n};\nZmItemMoveAction._realizeItems=function(a){var b,c;\nreturn AjxUtil.map(AjxUtil.toArray(a),function(d){if(d.isConvMsg){b=b||new ZmMailList(ZmItem.MSG);\nc=new ZmMailMsg(d.id,b,true);\nc.folderId=d.folderId;\nreturn c\n}else{return d\n}})\n};\nZmOrganizerMoveAction=function(a,b,d,c){ZmOrganizerAction.call(this,a,c);\nthis._fromFolderId=b;\nthis._toFolderId=d\n};\nZmOrganizerMoveAction.prototype=new ZmOrganizerAction;\nZmOrganizerMoveAction.prototype.constructor=ZmOrganizerMoveAction;\nZmOrganizerMoveAction.prototype.type=ZmAction.ACTION_ZMORGANIZERMOVEACTION;\nZmOrganizerMoveAction.prototype.toString=function(){return\"ZmOrganizerMoveAction\"\n};\nZmOrganizerMoveAction.prototype.getFromFolderId=function(){return this._fromFolderId\n};\nZmOrganizerMoveAction.prototype.getToFolderId=function(){return this._toFolderId\n};\nZmOrganizerMoveAction.prototype._doMove=function(d,b,a){var c=appCtxt.getById(a);\nif(c){this._organizer.move(c,true)\n}};\nZmOrganizerMoveAction.prototype.undo=function(b,a){this._doMove(b,a,this._fromFolderId)\n};\nZmOrganizerMoveAction.prototype.redo=function(b,a){this._doMove(b,a,this._toFolderId)\n};\nZmOrganizerMoveAction.multipleUndo=function(d,a){for(var b=0;\nb<d.length;\nb++){var c=d[b];\nif(c instanceof ZmOrganizerMoveAction){c._doMove(null,null,a?this._toFolderId:this._fromFolderId)\n}}};\nZmOrganizerMoveAction.multipleRedo=function(a){ZmItemMoveAction.multipleUndo(a,true)\n};\nZmCompositeAction=function(a){ZmAction.call(this);\nthis._actions={};\nthis._toFolderId=a\n};\nZmCompositeAction.prototype=new ZmAction;\nZmCompositeAction.prototype.constructor=ZmCompositeAction;\nZmCompositeAction.prototype.type=ZmAction.ACTION_ZMCOMPOSITEACTION;\nZmCompositeAction.prototype.toString=function(){return\"ZmCompositeAction\"\n};\nZmCompositeAction.prototype.addAction=function(b){if(b&&b!=this&&b instanceof ZmAction){var a=b.type;\nif(!this._actions[a]){this._actions[a]=[]\n}this._actions[a].push(b)\n}};\nZmCompositeAction.prototype.getActions=function(a){return this._actions[a]||[]\n};\nZmCompositeAction.prototype.hasActions=function(a){return this._actions[a]&&this._actions[a].length>0\n};\nZmCompositeAction.prototype.undo=function(d,a){if(this.hasActions(ZmAction.ACTION_ZMITEMMOVEACTION)){ZmItemMoveAction.multipleUndo(this.getActions(ZmAction.ACTION_ZMITEMMOVEACTION),null,this._toFolderId)\n}if(this.hasActions(ZmAction.ACTION_ZMORGANIZERMOVEACTION)){ZmOrganizerMoveAction.multipleUndo(this.getActions(ZmAction.ACTION_ZMORGANIZERMOVEACTION))\n}if(this.hasActions(ZmAction.ACTION_ZMCOMPOSITEACTION)||this.hasActions(ZmAction.ACTION_ZMITEMACTION)){var c=this.getActions(ZmAction.ACTION_ZMCOMPOSITEACTION).concat(this.getActions(ZmAction.ACTION_ZMITEMACTION));\nfor(var b=0;\nb<c.length;\nb++){c[b].undo()\n}}};\nZmCompositeAction.prototype.redo=function(d,a){if(this.hasActions(ZmAction.ACTION_ZMITEMMOVEACTION)){ZmItemMoveAction.multipleRedo(this.getActions(ZmAction.ACTION_ZMITEMMOVEACTION))\n}if(this.hasActions(ZmAction.ACTION_ZMORGANIZERMOVEACTION)){ZmOrganizerMoveAction.multipleRedo(this.getActions(ZmAction.ACTION_ZMORGANIZERMOVEACTION))\n}if(this.hasActions(ZmAction.ACTION_ZMCOMPOSITEACTION)||this.hasActions(ZmAction.ACTION_ZMITEMACTION)||this.hasActions(ZmAction.ACTION_ZMORGANIZERACTION)){var c=this.getActions(ZmAction.ACTION_ZMCOMPOSITEACTION).concat(this.getActions(ZmAction.ACTION_ZMITEMACTION)).concat(this.getActions(ZmAction.ACTION_ZMORGANIZERACTION));\nfor(var b=0;\nb<c.length;\nb++){c[b].redo()\n}}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmOrganizer\")){ZmOrganizer=function(a){if(arguments.length==0){return\n}this.type=a.type;\nvar b=this.id=a.id;\nthis.nId=ZmOrganizer.normalizeId(b);\nthis.name=ZmFolder.MSG_KEY[this.nId]?ZmMsg[ZmFolder.MSG_KEY[this.nId]]:a.name;\nthis.mail=a.mail;\nthis._systemName=this.nId<256&&a.name;\nthis.parent=a.parent;\nthis.tree=a.tree;\nthis.numUnread=a.numUnread||0;\nthis.numTotal=a.numTotal||0;\nthis.noTooltip=a.noTooltip;\nthis.sizeTotal=a.sizeTotal||0;\nthis.url=a.url;\nthis.owner=a.owner;\nthis.oname=a.oname;\nthis.link=a.link||(Boolean(a.zid))||(this.parent&&this.parent.link);\nthis.isMountpoint=a.link;\nthis.zid=a.zid;\nthis.rid=a.rid;\nthis.restUrl=a.restUrl;\nthis.account=a.account;\nthis.perm=a.perm;\nthis.noSuchFolder=a.broken;\nthis._isAdmin=this._isReadOnly=this._hasPrivateAccess=null;\nthis.retentionPolicy=a.retentionPolicy;\nthis.webOfflineSyncDays=a.webOfflineSyncDays;\nthis.color=a.color||(this.parent&&this.parent.color)||ZmOrganizer.ORG_COLOR[b]||ZmOrganizer.ORG_COLOR[this.nId]||ZmOrganizer.DEFAULT_COLOR[this.type]||ZmOrganizer.C_NONE;\nthis.isColorCustom=a.rgb!=null;\nthis.rgb=a.rgb||ZmOrganizer.COLOR_VALUES[this.color]||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];\nif(appCtxt.isOffline&&!this.account&&this.id==this.nId){this.account=appCtxt.accountList.mainAccount\n}if(b&&a.tree){appCtxt.cacheSet(b,this);\nif(this.link){appCtxt.cacheSet([this.zid,this.rid].join(\":\"),this)\n}}this.children=new AjxVector()\n};\nZmOrganizer.prototype.isZmOrganizer=true;\nZmOrganizer.prototype.toString=function(){return\"ZmOrganizer\"\n};\nZmOrganizer.TAG=ZmEvent.S_TAG;\nZmOrganizer.SEARCH=ZmEvent.S_SEARCH;\nZmOrganizer.SHARE=ZmEvent.S_SHARE;\nZmOrganizer.MOUNTPOINT=ZmEvent.S_MOUNTPOINT;\nZmOrganizer.ZIMLET=ZmEvent.S_ZIMLET;\nZmOrganizer.HAB=ZmEvent.S_HAB;\nZmOrganizer.ID_ROOT=1;\nZmOrganizer.ID_INBOX=2;\nZmOrganizer.ID_TRASH=3;\nZmOrganizer.ID_SPAM=4;\nZmOrganizer.ID_ADDRBOOK=7;\nZmOrganizer.ID_CALENDAR=10;\nZmOrganizer.ID_AUTO_ADDED=13;\nZmOrganizer.ID_CHATS=14;\nZmOrganizer.ID_TASKS=15;\nZmOrganizer.ID_BRIEFCASE=16;\nZmOrganizer.ID_ALL_MAILBOXES=249;\nZmOrganizer.ID_NOTIFICATION_MP=250;\nZmOrganizer.ID_SYNC_FAILURES=252;\nZmOrganizer.ID_OUTBOX=254;\nZmOrganizer.ID_ZIMLET=-1000;\nZmOrganizer.ID_ATTACHMENTS=-17;\nZmOrganizer.ID_DLS=-18;\nZmOrganizer.F_NAME=\"name\";\nZmOrganizer.F_UNREAD=\"unread\";\nZmOrganizer.F_TOTAL=\"total\";\nZmOrganizer.F_SIZE=\"size\";\nZmOrganizer.F_COLOR=\"color\";\nZmOrganizer.F_RGB=\"rgb\";\nZmOrganizer.F_QUERY=\"query\";\nZmOrganizer.F_SHARES=\"shares\";\nZmOrganizer.F_FLAGS=\"flags\";\nZmOrganizer.F_REST_URL=\"rest\";\nZmOrganizer.F_PERMS=\"perms\";\nZmOrganizer.F_RNAME=\"rname\";\nZmOrganizer.FLAG_CHECKED=\"#\";\nZmOrganizer.FLAG_DISALLOW_SUBFOLDER=\"o\";\nZmOrganizer.FLAG_EXCLUDE_FREE_BUSY=\"b\";\nZmOrganizer.FLAG_IMAP_SUBSCRIBED=\"*\";\nZmOrganizer.FLAG_OFFLINE_GLOBAL=\"g\";\nZmOrganizer.FLAG_OFFLINE_SYNCABLE=\"y\";\nZmOrganizer.FLAG_OFFLINE_SYNCING=\"~\";\nZmOrganizer.ALL_FLAGS=[ZmOrganizer.FLAG_CHECKED,ZmOrganizer.FLAG_IMAP_SUBSCRIBED,ZmOrganizer.FLAG_EXCLUDE_FREE_BUSY,ZmOrganizer.FLAG_DISALLOW_SUBFOLDER,ZmOrganizer.FLAG_OFFLINE_GLOBAL,ZmOrganizer.FLAG_OFFLINE_SYNCABLE,ZmOrganizer.FLAG_OFFLINE_SYNCING];\nZmOrganizer.FLAG_PROP={};\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_CHECKED]=\"isChecked\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_IMAP_SUBSCRIBED]=\"imapSubscribed\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_EXCLUDE_FREE_BUSY]=\"excludeFreeBusy\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_DISALLOW_SUBFOLDER]=\"disallowSubFolder\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_GLOBAL]=\"isOfflineGlobalSearch\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_SYNCABLE]=\"isOfflineSyncable\";\nZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_SYNCING]=\"isOfflineSyncing\";\nZmOrganizer.VALID_NAME_CHARS='[^\\\\x00-\\\\x1F\\\\x7F:\\\\/\\\\\"]';\nZmOrganizer.VALID_PATH_CHARS='[^\\\\x00-\\\\x1F\\\\x7F:\\\\\"]';\nZmOrganizer.VALID_NAME_RE=new RegExp(\"^\"+ZmOrganizer.VALID_NAME_CHARS+\"+$\");\nZmOrganizer.MAX_NAME_LENGTH=128;\nZmOrganizer.MAX_DISPLAY_NAME_LENGTH=30;\nZmOrganizer.C_NONE=0;\nZmOrganizer.C_BLUE=1;\nZmOrganizer.C_CYAN=2;\nZmOrganizer.C_GREEN=3;\nZmOrganizer.C_PURPLE=4;\nZmOrganizer.C_RED=5;\nZmOrganizer.C_YELLOW=6;\nZmOrganizer.C_PINK=7;\nZmOrganizer.C_GRAY=8;\nZmOrganizer.C_ORANGE=9;\nZmOrganizer.MAX_COLOR=ZmOrganizer.C_ORANGE;\nZmOrganizer.ORG_DEFAULT_COLOR=ZmOrganizer.C_GRAY;\nZmOrganizer.COLOR_VALUES=[null,ZmMsg.colorBlue,ZmMsg.colorCyan,ZmMsg.colorGreen,ZmMsg.colorPurple,ZmMsg.colorRed,ZmMsg.colorYellow,ZmMsg.colorPink,ZmMsg.colorGray,ZmMsg.colorOrange];\nZmOrganizer.COLOR_TEXT={};\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_NONE]=ZmMsg.none;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_ORANGE]=ZmMsg.orange;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_BLUE]=ZmMsg.blue;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_CYAN]=ZmMsg.cyan;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_GREEN]=ZmMsg.green;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_PURPLE]=ZmMsg.purple;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_RED]=ZmMsg.red;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_YELLOW]=ZmMsg.yellow;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_PINK]=ZmMsg.pink;\nZmOrganizer.COLOR_TEXT[ZmOrganizer.C_GRAY]=ZmMsg.gray;\nZmOrganizer.COLORS=[];\nZmOrganizer.COLOR_CHOICES=[];\n(function(){for(var b=0;\nb<=ZmOrganizer.MAX_COLOR;\nb++){var a=ZmOrganizer.COLOR_TEXT[b];\nZmOrganizer.COLORS.push(a);\nZmOrganizer.COLOR_CHOICES.push({value:b,label:a})\n}})();\nZmOrganizer.MSG_KEY={};\nZmOrganizer.ROOT_MSG_KEY={};\nZmOrganizer.ITEM_ORGANIZER={};\nZmOrganizer.DEFAULT_FOLDER={};\nZmOrganizer.SOAP_CMD={};\nZmOrganizer.FIRST_USER_ID={};\nZmOrganizer.PRECONDITION={};\nZmOrganizer.HAS_COLOR={};\nZmOrganizer.DEFAULT_COLOR={};\nZmOrganizer.ORG_COLOR={};\nZmOrganizer.APP={};\nZmOrganizer.ORG_CLASS={};\nZmOrganizer.ORG_PACKAGE={};\nZmOrganizer.CREATE_FUNC={};\nZmOrganizer.LABEL={};\nZmOrganizer.ITEMS_KEY={};\nZmOrganizer.TREE_TYPE={};\nZmOrganizer.VIEWS={};\nZmOrganizer.VIEW_HASH={};\nZmOrganizer.TYPE={};\nZmOrganizer.FOLDER_KEY={};\nZmOrganizer.MOUNT_KEY={};\nZmOrganizer.DEFERRABLE={};\nZmOrganizer.PATH_IN_NAME={};\nZmOrganizer.OPEN_SETTING={};\nZmOrganizer.NEW_OP={};\nZmOrganizer.DISPLAY_ORDER={};\nZmOrganizer.HIDE_EMPTY={};\nZmOrganizer.SHAREABLE={};\nZmOrganizer.APP2ORGANIZER={};\nZmOrganizer.APP2ORGANIZER_R={};\nZmOrganizer.PERM_READ=\"r\";\nZmOrganizer.PERM_WRITE=\"w\";\nZmOrganizer.PERM_INSERT=\"i\";\nZmOrganizer.PERM_DELETE=\"d\";\nZmOrganizer.PERM_ADMIN=\"a\";\nZmOrganizer.PERM_WORKFLOW=\"x\";\nZmOrganizer.PERM_PRIVATE=\"p\";\nZmOrganizer.RETENTION_KEEP=\"keep\";\nZmOrganizer.RETENTION_PURGE=\"purge\";\nZmOrganizer.registerOrg=function(c,a){if(a.nameKey){ZmOrganizer.MSG_KEY[c]=a.nameKey\n}if(a.app){ZmOrganizer.APP[c]=a.app;\nif(!ZmOrganizer.APP2ORGANIZER[a.app]){ZmOrganizer.APP2ORGANIZER[a.app]=[]\n}ZmOrganizer.APP2ORGANIZER[a.app].push(c);\nZmOrganizer.APP2ORGANIZER_R[c]=a.app\n}if(a.defaultFolder){ZmOrganizer.DEFAULT_FOLDER[c]=a.defaultFolder\n}if(a.precondition){ZmOrganizer.PRECONDITION[c]=a.precondition\n}if(a.soapCmd){ZmOrganizer.SOAP_CMD[c]=a.soapCmd\n}if(a.firstUserId){ZmOrganizer.FIRST_USER_ID[c]=a.firstUserId\n}if(a.orgClass){ZmOrganizer.ORG_CLASS[c]=a.orgClass\n}if(a.orgPackage){ZmOrganizer.ORG_PACKAGE[c]=a.orgPackage\n}if(a.labelKey){ZmOrganizer.LABEL[c]=a.labelKey\n}if(a.itemsKey){ZmOrganizer.ITEMS_KEY[c]=a.itemsKey\n}if(a.hasColor){ZmOrganizer.HAS_COLOR[c]=a.hasColor\n}if(a.views){ZmOrganizer.VIEWS[c]=a.views\n}if(a.folderKey){ZmOrganizer.FOLDER_KEY[c]=a.folderKey\n}if(a.mountKey){ZmOrganizer.MOUNT_KEY[c]=a.mountKey\n}if(a.deferrable){ZmOrganizer.DEFERRABLE[c]=a.deferrable\n}if(a.pathInName){ZmOrganizer.PATH_IN_NAME[c]=a.pathInName\n}if(a.openSetting){ZmOrganizer.OPEN_SETTING[c]=a.openSetting\n}if(a.newOp){ZmOrganizer.NEW_OP[c]=a.newOp\n}if(a.displayOrder){ZmOrganizer.DISPLAY_ORDER[c]=a.displayOrder\n}if(a.hideEmpty){ZmOrganizer.HIDE_EMPTY[c]=a.hideEmpty\n}ZmOrganizer.SHAREABLE[c]=!a.disableShare;\nif(!appCtxt.isChildWindow||a.childWindow){if(a.compareFunc){ZmTreeView.COMPARE_FUNC[c]=a.compareFunc\n}if(a.treeController){ZmOverviewController.CONTROLLER[c]=a.treeController\n}}ZmOrganizer.TREE_TYPE[c]=a.treeType||c;\nZmOrganizer.CREATE_FUNC[c]=a.createFunc||\"ZmOrganizer.create\";\nif(a.views){ZmOrganizer.VIEW_HASH[c]=AjxUtil.arrayAsHash(ZmOrganizer.VIEWS[c])\n}if(a.hasColor){ZmOrganizer.DEFAULT_COLOR[c]=(a.defaultColor!=null)?a.defaultColor:ZmOrganizer.ORG_DEFAULT_COLOR\n}if(a.orgColor){for(var b in a.orgColor){ZmOrganizer.ORG_COLOR[b]=a.orgColor[b]\n}}if(a.dropTargets){if(!ZmApp.DROP_TARGETS[a.app]){ZmApp.DROP_TARGETS[a.app]={}\n}ZmApp.DROP_TARGETS[a.app][c]=a.dropTargets\n}};\nZmOrganizer.sortCompare=function(b,a){};\nZmOrganizer.getColorValue=function(b,a){if(b==ZmOrganizer.DEFAULT_COLOR[a]){return null\n}return b\n};\nZmOrganizer.create=function(f){var h={CreateFolderRequest:{_jsns:\"urn:zimbraMail\"}};\nvar d=h.CreateFolderRequest.folder={};\nvar a=f.errorCallback||new AjxCallback(null,ZmOrganizer._handleErrorCreate,f);\nvar c=f.type;\nf.view=f.view||ZmOrganizer.VIEWS[c]?ZmOrganizer.VIEWS[c][0]:null;\nfor(var b in f){if(b==\"type\"||b==\"errorCallback\"||b==\"account\"){continue\n}var e=f[b];\nif(e){d[b]=e\n}}var g=f.asyncMode===undefined?true:f.asyncMode;\nreturn appCtxt.getAppController().sendRequest({jsonObj:h,asyncMode:g,accountName:(f.account&&f.account.name),callback:f.callback,callbackAfterNotifications:f.callbackAfterNotifications,errorCallback:a})\n};\nZmOrganizer._handleErrorCreate=function(e,a){if(!e.url&&!e.name){return false\n}var d;\nif(e.name&&(a.code==ZmCsfeException.MAIL_ALREADY_EXISTS)){var b=appCtxt.getFolderTree(appCtxt.getActiveAccount()).getFolderTypeByName(e.name);\nd=AjxMessageFormat.format(ZmMsg.errorAlreadyExists,[e.name,b.toLowerCase()])\n}else{if(e.url){var c=(a.code==ZmCsfeException.SVC_RESOURCE_UNREACHABLE)?ZmMsg.feedUnreachable:ZmMsg.feedInvalid;\nd=AjxMessageFormat.format(c,e.url)\n}}if(d){ZmOrganizer._showErrorMsg(d);\nreturn true\n}return false\n};\nZmOrganizer._showErrorMsg=function(b){var a=appCtxt.getMsgDialog();\na.reset();\na.setMessage(AjxStringUtil.htmlEncode(b),DwtMessageDialog.CRITICAL_STYLE);\na.popup()\n};\nZmOrganizer.getFolder=function(f,e,a){var d={GetFolderRequest:{_jsns:\"urn:zimbraMail\"}};\nvar b=d.GetFolderRequest;\nb.folder={l:f};\nvar c=new AjxCallback(null,ZmOrganizer._handleResponseGetFolder,[e]);\nif(a){a.addRequestParams(d,c)\n}else{appCtxt.getRequestMgr().sendRequest({jsonObj:d,asyncMode:true,callback:c})\n}};\nZmOrganizer._handleResponseGetFolder=function(f,a){var e=a.getResponse().GetFolderResponse;\nvar b=(e&&e.folder&&e.folder[0])||(e&&e.link&&e.link[0]);\nvar d;\nif(b){d=appCtxt.getById(b.id);\nif(d){d.clearShares();\nd._setSharesFromJs(b)\n}else{var c=appCtxt.getById(b.l);\nd=ZmFolderTree.createFromJs(c,b,appCtxt.getFolderTree(),\"folder\")\n}}if(f){f.run(d)\n}};\nZmOrganizer.prototype.getFolder=function(b,a){ZmOrganizer.getFolder(this.id,b,a)\n};\nZmOrganizer.getViewName=function(a){return ZmOrganizer.VIEWS[a][0]\n};\nZmOrganizer.checkWebOfflineSyncDays=function(b){if(isNaN(b)){return ZmMsg.invalidFolderSyncInterval\n}var a=parseInt(b);\nif(a<0||a>30){return ZmMsg.invalidFolderSyncInterval\n}return null\n};\nZmOrganizer.checkName=function(a){if(a.length==0){return ZmMsg.nameEmpty\n}if(a.length>ZmOrganizer.MAX_NAME_LENGTH){return AjxMessageFormat.format(ZmMsg.nameTooLong,ZmOrganizer.MAX_NAME_LENGTH)\n}if(!ZmOrganizer.VALID_NAME_RE.test(a)){return AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(a))\n}return null\n};\nZmOrganizer.checkUrl=function(a){if(!a.match(/^[a-zA-Z]+:\\/\\/.*$/i)){return ZmMsg.errorUrlMissing\n}return null\n};\nZmOrganizer.checkSortArgs=function(a,b){if(!a&&!b){return 0\n}if(a&&!b){return 1\n}if(!a&&b){return -1\n}return null\n};\nZmOrganizer.checkColor=function(a){return((a!=null)&&(a>=0&&a<=ZmOrganizer.MAX_COLOR))?a:ZmOrganizer.ORG_DEFAULT_COLOR\n};\nZmOrganizer.getSystemId=function(c,b,a){b=b||appCtxt.getActiveAccount();\nif((b&&!b.isMain)||a){return((typeof(c)==\"string\")&&(c.indexOf(\":\")!=-1)||!c)?c:([b.id,c].join(\":\"))\n}return c\n};\nZmOrganizer.normalizeId=function(d,c){if(typeof(d)!=\"string\"){return d\n}var a=d.indexOf(\":\");\nvar b=(a==-1)?d:d.substr(a+1);\nreturn(c&&(b>=ZmOrganizer.FIRST_USER_ID[c]))?d:b\n};\nZmOrganizer.parseId=function(d,b){var c=window.parentAppCtxt||window.appCtxt;\nb=b||{};\nif(d==null){return b\n}var a=(typeof d==\"string\")?d.indexOf(\":\"):-1;\nif(a==-1){b.account=c.accountList.mainAccount;\nb.id=d\n}else{b.acctId=d.substring(0,a);\nb.account=c.accountList.getAccount(b.acctId);\nb.id=d.substr(a+1)\n}return b\n};\nZmOrganizer.prototype.getName=function(h,c,g,b,f,a){if(this.nId==ZmFolder.ID_ROOT){var e=a||this.type;\nreturn(ZmOrganizer.LABEL[e])?ZmMsg[ZmOrganizer.LABEL[e]]:\"\"\n}var d=(b&&this._systemName)||(f&&this.oname)||this.name||\"\";\nif(ZmOrganizer.PATH_IN_NAME[this.type]&&this.path){d=[this.path,d].join(\"/\")\n}d=(c&&d.length>c)?d.substring(0,c-3)+\"...\":d;\nreturn this._markupName(d,h,g)\n};\nZmOrganizer.prototype.getPath=function(c,h,b,g,a,e){var d=this.parent;\nvar f=this.getName(h,b,g,a,e);\nwhile(d&&((d.nId!=ZmOrganizer.ID_ROOT)||c)){f=d.getName(h,b,g,a,e)+ZmFolder.SEP+f;\nd=d.parent\n}return f\n};\nZmOrganizer.prototype.getToolTip=function(c){if(this.noTooltip){return null\n}if(!this._tooltip||c){var a=this._getItemsText();\nvar d=this._getUnreadLabel();\nvar b={name:this.name,itemText:a,numTotal:this.numTotal,sizeTotal:this.sizeTotal,numUnread:this.numUnread,unreadLabel:d};\nthis._tooltip=AjxTemplate.expand(\"share.App#FolderTooltip\",b)\n}return this._tooltip\n};\nZmOrganizer.prototype.getSearchPath=function(a){return(this.nId!=ZmOrganizer.ID_ROOT)?this.getPath(null,null,null,true,true,a):\"/\"\n};\nZmOrganizer.prototype.getUrl=function(){return this.getRestUrl()\n};\nZmOrganizer.prototype.getSyncUrl=function(){return url\n};\nZmOrganizer.prototype.getRemoteId=function(){if(!this._remoteId){this._remoteId=(this.isRemote()&&this.zid&&this.rid)?(this.zid+\":\"+this.rid):this.id\n}return this._remoteId\n};\nZmOrganizer.prototype.getRestUrl=function(c){var b=appCtxt.get(ZmSetting.REST_URL);\nif(b&&(!this.isRemote()||c)){var d=AjxStringUtil.urlEncode(this.getSearchPath()).replace(\"#\",\"%23\").replace(\";\",\"%3B\");\nreturn([b,\"/\",d].join(\"\"))\n}if(this.restUrl){return this.restUrl\n}var a=this._generateRestUrl();\nreturn a\n};\nZmOrganizer.prototype.getOwnerRestUrl=function(){var b=this;\nvar a;\nvar c=\"\";\nwhile(b&&!b.restUrl){c=b.name+\"/\"+c;\nb=b.parent\n}a=b.restUrl;\nc=b.oname+\"/\"+c;\nc=AjxStringUtil.urlEncode(c).replace(\"#\",\"%23\").replace(new RegExp(\"/$\"),\"\");\nreturn([a,\"/\",c].join(\"\"))\n};\nZmOrganizer.prototype._generateRestUrl=function(){var e=document.location;\nvar b=appCtxt.get(ZmSetting.USERNAME);\nvar c=e.host;\nvar a=b.match(/^(.*)@(.*)$/);\nc=(a&&a[2])||c;\nif(e.port&&e.port!=80){c=c+\":\"+e.port\n}var d=AjxStringUtil.urlEncode(this.getSearchPath()).replace(\"#\",\"%23\");\nreturn[e.protocol,\"//\",c,\"/service/user/\",b,\"/\",d].join(\"\")\n};\nZmOrganizer.prototype.getAccount=function(){if(appCtxt.multiAccounts){if(!this.account){this.account=ZmOrganizer.parseId(this.id).account\n}if(!this.account){var a=this.parent;\nwhile(a&&!this.account){this.account=a.getAccount();\na=a.parent\n}}return this.account\n}return(this.account||appCtxt.accountList.mainAccount)\n};\nZmOrganizer.prototype.getShares=function(){return this.shares\n};\nZmOrganizer.prototype.addShare=function(c){this.shares=this.shares||[];\nthis.shares.push(c);\nvar d=appCtxt.getActiveAccount();\nvar a=d&&d.id;\nvar b=c.grantee&&c.grantee.id;\nif(b&&(b==a)){this._mainShare=c\n}};\nZmOrganizer.prototype.clearShares=function(){if(this.shares&&this.shares.length){for(var a=0;\na<this.shares.length;\na++){this.shares[a]=null\n}}this.shares=null;\nthis._mainShare=null\n};\nZmOrganizer.prototype.getMainShare=function(){if(!this._mainShare){var d=appCtxt.getActiveAccount();\nvar a=d&&d.id;\nif(a&&this.shares&&this.shares.length){for(var b=0;\nb<this.shares.length;\nb++){var c=this.shares[b];\nvar e=c&&c.grantee&&c.grantee.id;\nif(e&&e==a){this._mainShare=c;\nbreak\n}}}}return this._mainShare\n};\nZmOrganizer.prototype.supportsSharing=function(){return true\n};\nZmOrganizer.prototype.supportsPublicAccess=function(){return true\n};\nZmOrganizer.prototype.supportsPrivatePermission=function(){return false\n};\nZmOrganizer.prototype.getIcon=function(){};\nZmOrganizer.prototype.getColor=function(){return this.rgb||ZmOrganizer.COLOR_VALUES[this.color]\n};\nZmOrganizer.prototype.getIconWithColor=function(){var b=this.getIcon()||\"\";\nvar a=this.getColor();\nreturn a?[b,a].join(\",color=\"):b\n};\nZmOrganizer.prototype.rename=function(c,e,b,a){if(c==this.name){return\n}var d={action:\"rename\",attrs:{name:c},callback:e,errorCallback:b,batchCmd:a};\nthis._organizerAction(d)\n};\nZmOrganizer.prototype.setOfflineSyncInterval=function(c,d,b,a){if(this.webOfflineSyncDays==c){return\n}this._organizerAction({action:\"webofflinesyncdays\",attrs:{numDays:c},callback:d,errorCallback:b,batchCmd:a})\n};\nZmOrganizer.prototype.setColor=function(c,d,b,a){var c=ZmOrganizer.checkColor(c);\nif(!this.isColorChanged(c)){return\n}this._organizerAction({action:\"color\",attrs:{color:c},callback:d,errorCallback:b,batchCmd:a})\n};\nZmOrganizer.prototype.setRGB=function(c,d,b,a){if(!this.isColorChanged(c)){return\n}this._organizerAction({action:\"color\",attrs:{rgb:c},callback:d,errorCallback:b,batchCmd:a})\n};\nZmOrganizer.prototype.getRetentionPolicy=function(a){var b=null;\nif(this.retentionPolicy&&this.retentionPolicy[0]&&this.retentionPolicy[0][a]&&this.retentionPolicy[0][a][0]&&this.retentionPolicy[0][a][0].policy&&this.retentionPolicy[0][a][0].policy[0]){b=this.retentionPolicy[0][a][0].policy[0]\n}return b\n};\nZmOrganizer.prototype.getRetentionPolicyLifetimeMsec=function(e){if(e){var a=e.lifetime;\nvar d=parseInt(a);\nvar b=a.slice(a.length-1);\nvar c=0;\nswitch(b){case\"d\":c=d*AjxDateUtil.MSEC_PER_DAY;\nbreak;\ncase\"h\":c=d*AjxDateUtil.MSEC_PER_HOUR;\nbreak;\ncase\"m\":c=d*AjxDateUtil.MSEC_PER_MINUTE;\nbreak;\ncase\"s\":c=d*1000;\nbreak;\ncase\"ms\":c=d;\nbreak;\ndefault:c=d*1000;\nbreak\n}}return c\n};\nZmOrganizer.prototype.setRetentionPolicy=function(d,j,g,c){var a=this.getRetentionPolicy(ZmOrganizer.RETENTION_KEEP);\nvar e=this.getRetentionPolicy(ZmOrganizer.RETENTION_PURGE);\nif(!this.policiesDiffer(a,d.keep)&&!this.policiesDiffer(e,d.purge)){return\n}var b=ZmOrganizer.SOAP_CMD[this.type]+\"Request\";\nvar f={_jsns:\"urn:zimbraMail\",action:{op:\"retentionpolicy\",id:this.id,retentionPolicy:{keep:{},purge:{}}}};\nvar k={};\nk[b]=f;\nvar i=f.action.retentionPolicy;\nif(d.keep){this._addPolicy(i.keep,d.keep)\n}if(d.purge){this._addPolicy(i.purge,d.purge)\n}if(c){c.addRequestParams(k,j,g)\n}else{var h;\nif(appCtxt.multiAccounts){h=(this.account)?this.account.name:appCtxt.accountList.mainAccount.name\n}appCtxt.getAppController().sendRequest({jsonObj:k,asyncMode:true,accountName:h,callback:j,errorCallback:g})\n}};\nZmOrganizer.prototype.policiesDiffer=function(b,a){var c=false;\nif((b&&!a)||(!b&&a)){c=true\n}else{if(b){if(b.type!=a.type){c=true\n}else{if(b.type==\"user\"){c=b.lifetime!=a.lifetime\n}else{c=b.id!=a.id\n}}}}return c\n};\nZmOrganizer.prototype._addPolicy=function(c,d){var b=c.policy={};\nfor(var a in d){if(AjxEnv.isIE){d[a]+=\"\"\n}b[a]=d[a]\n}};\nZmOrganizer.getStandardColorNumber=function(b){if(String(b).match(/^#/)){var a=ZmOrganizer.COLOR_VALUES.length;\nfor(var d=0;\nd<a;\nd++){var c=ZmOrganizer.COLOR_VALUES[d];\nif(c&&c==b){return d\n}}}else{if(b<=9&&b>=0){return b\n}}return -1\n};\nZmOrganizer.prototype.isColorChanged=function(b){var a=ZmOrganizer.getStandardColorNumber(b)===-1,c=this.isColorCustom;\nif((a&&!c)||(!a&&c)){return true\n}else{if(a&&c){return b!=this.rgb\n}else{if(!a&&!c){return b!=this.color\n}}}return false\n};\nZmOrganizer.prototype.update=function(a){this._organizerAction({action:\"update\",attrs:a})\n};\nZmOrganizer.prototype.move=function(d,c,a){var b=(d.nId>0)?d.id:ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT);\nif((b==this.id||b==this.parent.id)||(this.type==ZmOrganizer.FOLDER&&(ZmOrganizer.normalizeId(b,this.type)==ZmFolder.ID_SPAM))||(d.isChildOf(this))){return\n}var e={};\ne.batchCmd=a;\ne.actionTextKey=\"actionMoveOrganizer\";\ne.orgName=this.getName(false,false,true,false,false,this.type);\nif(b==ZmOrganizer.ID_TRASH){e.actionArg=ZmMsg.trash;\ne.action=\"trash\";\ne.noUndo=c\n}else{if(d.account&&d.account.isLocal()){b=[ZmAccount.LOCAL_ACCOUNT_ID,b].join(\":\")\n}e.actionArg=d.getName(false,false,true,false,false,this.type);\ne.action=\"move\";\ne.attrs={l:b};\ne.noUndo=c\n}this._organizerAction(e)\n};\nZmOrganizer.prototype._delete=function(b){var a=((this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK||this.type==ZmOrganizer.BRIEFCASE)&&(this.nId==ZmFolder.ID_SPAM||this.nId==ZmFolder.ID_TRASH));\nif(this.isSystem()&&!a){return\n}var c=a?\"empty\":\"delete\";\nthis._organizerAction({action:c,batchCmd:b})\n};\nZmOrganizer.prototype.empty=function(f,c,h,e,b,d){f=f||false;\nvar a=((this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK)&&(this.nId==ZmFolder.ID_SPAM||this.nId==ZmFolder.ID_TRASH||this.nId==ZmFolder.ID_CHATS||this.nId==ZmOrganizer.ID_SYNC_FAILURES));\nif(this.isSystem()&&!a){return\n}var g={action:\"empty\",batchCmd:c,callback:h,timeout:e,errorCallback:b,noBusyOverlay:d};\ng.attrs=(this.nId==ZmFolder.ID_TRASH)?{recursive:true}:{recursive:f};\nif(this.isRemote()){g.id=this.getRemoteId()\n}this._organizerAction(g)\n};\nZmOrganizer.prototype.markAllRead=function(a){var b=this.isRemote()?this.getRemoteId():null;\nthis._organizerAction({action:\"read\",id:b,attrs:{l:this.id},batchCmd:a})\n};\nZmOrganizer.prototype.sync=function(){this._organizerAction({action:\"sync\"})\n};\nZmOrganizer.prototype.notifyDelete=function(){var b=appCtxt.getOverviewController().getTreeController(this.type);\nvar d=b&&b.getTreeView(appCtxt.getCurrentApp().getOverviewId());\nvar e=d&&d.getSelected();\nif(e){if(!(e instanceof Array)){e=[e]\n}for(var g=0;\ng<e.length;\ng++){var a=e[g];\nif(a&&(a==this||a.isChildOf(this))){var c=this.parent.id;\nif(this.parent.nId==ZmOrganizer.ID_ROOT){c=ZmOrganizer.getSystemId(this.getDefaultFolderId())\n}var f=false;\nd.setSelected(c,f)\n}}}this.deleteLocal();\nthis._notify(ZmEvent.E_DELETE)\n};\nZmOrganizer.prototype.notifyCreate=function(){};\nZmOrganizer.prototype.notifyModify=function(obj,details){var doNotify=false;\nvar details=details||{};\nvar fields={};\nif(obj.name!=null&&(this.name!=obj.name||this.id!=obj.id)){if(obj.id==this.id){details.oldName=this.name;\nthis.name=obj.name;\nfields[ZmOrganizer.F_NAME]=true;\nthis.parent.children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]))\n}else{details.newName=obj.name;\nfields[ZmOrganizer.F_RNAME]=true\n}doNotify=true\n}if(obj.u!=null&&this.numUnread!=obj.u){this.numUnread=obj.u;\nfields[ZmOrganizer.F_UNREAD]=true;\ndoNotify=true\n}if(obj.n!=null&&this.numTotal!=obj.n){this.numTotal=obj.n;\nfields[ZmOrganizer.F_TOTAL]=true;\ndoNotify=true\n}if(obj.s!=null&&this.sizeTotal!=obj.s){this.sizeTotal=obj.s;\nfields[ZmOrganizer.F_SIZE]=true;\ndoNotify=true\n}if((obj.rgb!=null||obj.color!=null)&&!obj._isRemote){var color=obj.color||obj.rgb;\nif(this.isColorChanged(color)){this.isColorCustom=obj.rgb!=null;\nthis.color=obj.color;\nthis.rgb=obj.rgb||ZmOrganizer.COLOR_VALUES[color];\nfields[ZmOrganizer.F_COLOR]=true;\nfields[ZmOrganizer.F_RGB]=true\n}doNotify=true\n}if(obj.f!=null&&!obj._isRemote){var oflags=this._setFlags().split(\"\").sort().join(\"\");\nvar nflags=obj.f.split(\"\").sort().join(\"\");\nif(oflags!=nflags){this._parseFlags(obj.f);\nfields[ZmOrganizer.F_FLAGS]=true;\ndoNotify=true\n}}if(obj.rest!=null&&this.restUrl!=obj.rest&&!obj._isRemote){this.restUrl=obj.rest;\nfields[ZmOrganizer.F_REST_URL]=true;\ndoNotify=true\n}if(obj.acl){this.clearShares();\nif(obj.acl.grant&&obj.acl.grant.length){AjxDispatcher.require(\"Share\");\nfor(var i=0;\ni<obj.acl.grant.length;\ni++){share=ZmShare.createFromJs(this,obj.acl.grant[i]);\nthis.addShare(share)\n}}fields[ZmOrganizer.F_SHARES]=true;\ndoNotify=true\n}if(obj.perm&&obj._isRemote){fields[ZmOrganizer.F_PERMS]=true;\ndoNotify=true;\nthis._isAdmin=this._isReadOnly=this._hasPrivateAccess=null\n}if(obj.retentionPolicy){if(obj.retentionPolicy[0].keep||obj.retentionPolicy[0].purge){this.retentionPolicy=obj.retentionPolicy\n}else{this.retentionPolicy=null\n}}if(obj.hasOwnProperty(\"webOfflineSyncDays\")){this.webOfflineSyncDays=obj.webOfflineSyncDays\n}if(doNotify){details.fields=fields;\nthis._notify(ZmEvent.E_MODIFY,details)\n}if(this.parent&&obj.l!=null&&obj.l!=this.parent.id){var newParent=this._getNewParent(obj.l);\nif(newParent){this.reparent(newParent);\nthis._notify(ZmEvent.E_MOVE);\nthis.tree=newParent.tree\n}}};\nZmOrganizer.prototype.deleteLocal=function(){this.parent.children.remove(this);\nvar b=this.children.getArray();\nvar d=this.children.size();\nfor(var c=0;\nc<d;\nc++){var e=b[c];\nif(e){e.deleteLocal()\n}}this.children.removeAll()\n};\nZmOrganizer.prototype.hasChild=function(a){return(this.getChild(a)!=null)\n};\nZmOrganizer.prototype.getChild=function(c){c=c?c.toLowerCase():\"\";\nvar b=this.children.getArray();\nvar e=this.children.size();\nfor(var d=0;\nd<e;\nd++){if(b[d]&&b[d].name&&(b[d].name.toLowerCase()==c)){return b[d]\n}}return null\n};\nZmOrganizer.prototype.getChildByPath=function(e){var a=this;\nif(e.match(/^\\//)){while(a.nId!=ZmOrganizer.ID_ROOT){a=a.parent\n}e=e.substr(1)\n}if(e.length==0){return a\n}var d=e.split(\"/\");\nvar c=0;\nwhile(c<d.length){var b=d[c++];\nvar f=a.getChild(b);\nif(f==null){return null\n}a=f\n}return a\n};\nZmOrganizer.prototype.reparent=function(a){if(this.parent){this.parent.children.remove(this)\n}if(a){a.children.add(this)\n}this.parent=a\n};\nZmOrganizer.prototype.getById=function(g){if(this.link&&g&&typeof(g)==\"string\"){var e=g.split(\":\");\nif(this.zid==e[0]&&this.rid==e[1]){return this\n}}if(this.id==g||this.nId==g){return this\n}var b;\nvar c=this.children.getArray();\nvar f=this.children.size();\nfor(var d=0;\nd<f;\nd++){if(b=c[d].getById(g)){return b\n}}return null\n};\nZmOrganizer.prototype.getByName=function(b,a){return this._getByName(b.toLowerCase(),a)\n};\nZmOrganizer.prototype.getByType=function(a){var b=[];\nthis._getByType(a,b);\nreturn b\n};\nZmOrganizer.prototype._getByType=function(d,e){if(this.type==d){e.push(this)\n}var b=this.children.getArray();\nfor(var c=0;\nc<b.length;\nc++){if(b[c]){b[c]._getByType(d,e)\n}}};\nZmOrganizer.prototype.getByPath=function(b,a){return this._getByPath(b.toLowerCase(),a)\n};\nZmOrganizer.prototype._getByPath=function(f,d){if(this.nId==ZmFolder.ID_TAGS){return null\n}if(f==this.getPath(false,false,null,true,d).toLowerCase()){return this\n}var c=this.children.getArray();\nfor(var e=0;\ne<c.length;\ne++){var b=c[e]._getByPath(f,d);\nif(b){return b\n}}return null\n};\nZmOrganizer.prototype.size=function(){return this.children.size()\n};\nZmOrganizer.prototype.isChildOf=function(a){var b=this.parent;\nwhile(b){if(b==a){return true\n}b=b.parent\n}return false\n};\nZmOrganizer.prototype._getNewParent=function(a){return appCtxt.getById(a)\n};\nZmOrganizer.prototype.isUnder=function(b){b=b.toString();\nif(this.nId==b||(this.isRemote()&&this.rid==b)){return true\n}var a=this.parent;\nwhile(a&&a.nId!=ZmOrganizer.ID_ROOT){if(a.nId==b){return true\n}a=a.parent\n}return false\n};\nZmOrganizer.prototype.isInTrash=function(){return this.isUnder(ZmOrganizer.ID_TRASH)\n};\nZmOrganizer.prototype.isPermAllowed=function(b){if(this.perm){var a=this.perm.replace(/-./g,\"\");\nreturn(a.indexOf(b)!=-1)\n}return false\n};\nZmOrganizer.prototype.isReadOnly=function(){if(this._isReadOnly==null){var a=this.getMainShare();\nthis._isReadOnly=(a!=null)?(this.isRemote()&&!a.isWrite()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_READ)&&!this.isPermAllowed(ZmOrganizer.PERM_WRITE))\n}return this._isReadOnly\n};\nZmOrganizer.prototype.isAdmin=function(){if(this._isAdmin==null){var a=this.getMainShare();\nthis._isAdmin=(a!=null)?(this.isRemote()&&a.isAdmin()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_ADMIN))\n}return this._isAdmin\n};\nZmOrganizer.prototype.hasPrivateAccess=function(){if(this._hasPrivateAccess==null){var a=this.getMainShare();\nthis._hasPrivateAccess=(a!=null)?(this.isRemote()&&a.hasPrivateAccess()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_PRIVATE))\n}return this._hasPrivateAccess\n};\nZmOrganizer.prototype.isRemote=function(){if(this._isRemote==null){if(this.zid!=null){this._isRemote=true\n}else{if(appCtxt.multiAccounts){var b=this.account;\nvar a=ZmOrganizer.parseId(this.id);\nif(!b){if(a.account&&a.account.isMain){this._isRemote=false;\nreturn this._isRemote\n}else{b=appCtxt.getActiveAccount()\n}}this._isRemote=Boolean(!a.account||(a.account&&(a.account!=b)))\n}else{var c=String(this.id);\nthis._isRemote=((c.indexOf(\":\")!=-1)&&(c.indexOf(appCtxt.getActiveAccount().id)!=0))\n}}}return this._isRemote\n};\nZmOrganizer.prototype.isRemoteRoot=function(){return this.isRemote()&&(this.rid==ZmOrganizer.ID_ROOT)\n};\nZmOrganizer.prototype.isSystem=function(){return(this.nId<ZmOrganizer.FIRST_USER_ID[this.type])\n};\nZmOrganizer.prototype.isDefault=function(){return this.nId==this.getDefaultFolderId()\n};\nZmOrganizer.prototype.getDefaultFolderId=function(){return ZmOrganizer.DEFAULT_FOLDER[this.type]\n};\nZmOrganizer.prototype.isTrash=function(){return this.nId==ZmFolder.ID_TRASH\n};\nZmOrganizer.prototype.isFeed=function(){return Boolean(this.url)\n};\nZmOrganizer.prototype.hasFeeds=function(){return false\n};\nZmOrganizer.prototype.isDataSource=function(b,c){var a=this.getDataSources(b,c);\nreturn(a&&a.length>0)\n};\nZmOrganizer.prototype.getDataSources=function(b,c){if(!appCtxt.get(ZmSetting.MAIL_ENABLED)){return null\n}var a=appCtxt.getDataSourceCollection();\nvar d=a.getByFolderId(this.nId,b);\nif(d.length==0){return(c&&this.parent)?this.parent.getDataSources(b,c):null\n}return d\n};\nZmOrganizer.prototype.getOwner=function(){return this.owner||(this.parent&&this.parent.getOwner())||appCtxt.get(ZmSetting.USERNAME)\n};\nZmOrganizer.getSortIndex=function(e,a){if(!(e&&e.parent&&a)){return null\n}var c=e.parent.children.getArray();\nfor(var b=0;\nb<c.length;\nb++){var d=a(e,c[b]);\nif(d==-1){return b\n}}return b\n};\nZmOrganizer.prototype._organizerAction=function(c){var b=ZmOrganizer.SOAP_CMD[this.type]+\"Request\";\nvar d={_jsns:\"urn:zimbraMail\",action:{op:c.action,id:c.id||this.id}};\nvar h={};\nh[b]=d;\nfor(var e in c.attrs){if(AjxEnv.isIE){c.attrs[e]+=\"\"\n}d.action[e]=c.attrs[e]\n}var g=appCtxt.getActionController();\ng.dismiss();\nvar a=(!c.noUndo&&g&&g.actionPerformed({op:c.action,id:c.id||this.id,attrs:c.attrs}))||null;\nvar i=new AjxCallback(this,this._handleResponseOrganizerAction,[c,a]);\nif(c.batchCmd){c.batchCmd.addRequestParams(h,i,c.errorCallback)\n}else{var f;\nif(appCtxt.multiAccounts){f=(this.account)?this.account.name:appCtxt.accountList.mainAccount.name\n}appCtxt.getAppController().sendRequest({jsonObj:h,asyncMode:true,accountName:f,callback:i,errorCallback:c.errorCallback,timeout:c.timeout,noBusyOverlay:c.noBusyOverlay})\n}};\nZmOrganizer.prototype._handleResponseOrganizerAction=function(f,e,a){if(e){e.setComplete()\n}if(f.callback){f.callback.run(a)\n}if(f.actionTextKey){var d=appCtxt.getActionController();\nvar c=ZmOrganizer.getActionSummary({actionTextKey:f.actionTextKey,numItems:f.numItems||1,type:this.type,orgName:f.orgName,actionArg:f.actionArg});\nvar b=e&&d&&d.getUndoLink(e);\nif(b&&d){d.onPopup();\nappCtxt.setStatusMsg({msg:c+b,transitions:d.getStatusTransitions()})\n}else{appCtxt.setStatusMsg(c)\n}}};\nZmOrganizer.getActionSummary=function(a){var f=a.type,g=ZmOrganizer.FOLDER_KEY[f],c=ZmMsg[g],d=AjxStringUtil.capitalize(g),b=a.actionTextKey+d,h=ZmMsg[b]||ZmMsg[a.actionTextKey],e=AjxStringUtil.htmlEncode(a.orgName),i=AjxStringUtil.htmlEncode(a.actionArg);\nreturn AjxMessageFormat.format(h,[c,e,i])\n};\nZmOrganizer.prototype._getByName=function(e,c){if(this.name&&e==this.name.toLowerCase()){return this\n}var b;\nvar d=this.children.getArray();\nvar g=this.children.size();\nfor(var f=0;\nf<g;\nf++){if(b=d[f]._getByName(e,c)){if(c&&b.isDataSource(ZmAccount.TYPE_IMAP,true)){continue\n}return b\n}}return null\n};\nZmOrganizer.prototype._parseFlags=function(c){for(var b=0;\nb<ZmOrganizer.ALL_FLAGS.length;\nb++){var a=ZmOrganizer.ALL_FLAGS[b];\nthis[ZmOrganizer.FLAG_PROP[a]]=(Boolean(c&&(c.indexOf(a)!=-1)))\n}};\nZmOrganizer.prototype._setFlags=function(){var b=\"\";\nfor(var c=0;\nc<ZmOrganizer.ALL_FLAGS.length;\nc++){var a=ZmOrganizer.ALL_FLAGS[c];\nvar d=ZmOrganizer.FLAG_PROP[a];\nif(this[d]){b=b+a\n}}return b\n};\nZmOrganizer.prototype.addChangeListener=function(a){this.tree.addChangeListener(a)\n};\nZmOrganizer.prototype.removeChangeListener=function(a){this.tree.removeChangeListener(a)\n};\nZmOrganizer.prototype._setSharesFromJs=function(c){if(c.acl&&c.acl.grant&&c.acl.grant.length>0){AjxDispatcher.require(\"Share\");\nfor(var b=0;\nb<c.acl.grant.length;\nb++){var a=c.acl.grant[b];\nthis.addShare(ZmShare.createFromJs(this,a))\n}}};\nZmOrganizer.prototype._notify=function(b,a){if(a){a.organizers=[this]\n}else{a={organizers:[this]}\n}this.tree._evt.type=this.type;\nthis.tree._notify(b,a)\n};\nZmOrganizer.prototype._markupName=function(a,c,b){if(!b){a=AjxStringUtil.htmlEncode(a,true)\n}if(c&&this.hasUnreadDescendent()){if(this.numUnread>0){a=AjxMessageFormat.format(ZmMsg.folderUnread,[a,this.numUnread])\n}if(!b){a=[\"<span style='font-weight:bold'>\",a,\"</span>\"].join(\"\")\n}}if(this.noSuchFolder&&!b){a=[\"<del>\",a,\"</del>\"].join(\"\")\n}return a\n};\nZmOrganizer.prototype._getItemsText=function(){var a=ZmMsg[ZmOrganizer.ITEMS_KEY[this.type]];\nif(!a||this.isTrash()){a=ZmMsg.items\n}return a\n};\nZmOrganizer.prototype._getUnreadLabel=function(){return ZmMsg.unread\n};\nZmOrganizer.prototype.hasUnreadDescendent=function(){if(this.numUnread>0){return true\n}var b=this.children.getArray(),d=this.children.size();\nfor(var c=0;\nc<d;\nc++){if(b[c].hasUnreadDescendent()){return true\n}}return false\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmFolder\")){ZmFolder=function(a){if(arguments.length==0){return\n}a.type=a.type||ZmOrganizer.FOLDER;\nZmOrganizer.call(this,a)\n};\nZmFolder.prototype=new ZmOrganizer;\nZmFolder.prototype.constructor=ZmFolder;\nZmFolder.prototype.isZmFolder=true;\nZmFolder.prototype.toString=function(){return\"ZmFolder\"\n};\nZmOrganizer.ORG_CLASS[ZmId.ORG_FOLDER]=\"ZmFolder\";\nZmFolder.SEP=\"/\";\nZmFolder.ID_LOAD_FOLDERS=-3;\nZmFolder.ID_OTHER=-2;\nZmFolder.ID_SEP=-1;\nZmFolder.ID_ROOT=ZmOrganizer.ID_ROOT;\nZmFolder.ID_INBOX=ZmOrganizer.ID_INBOX;\nZmFolder.ID_TRASH=ZmOrganizer.ID_TRASH;\nZmFolder.ID_SPAM=ZmOrganizer.ID_SPAM;\nZmFolder.ID_SENT=5;\nZmFolder.ID_DRAFTS=6;\nZmFolder.ID_CONTACTS=ZmOrganizer.ID_ADDRBOOK;\nZmFolder.ID_AUTO_ADDED=ZmOrganizer.ID_AUTO_ADDED;\nZmFolder.ID_TAGS=8;\nZmFolder.ID_TASKS=ZmOrganizer.ID_TASKS;\nZmFolder.ID_SYNC_FAILURES=ZmOrganizer.ID_SYNC_FAILURES;\nZmFolder.ID_OUTBOX=ZmOrganizer.ID_OUTBOX;\nZmFolder.ID_CHATS=ZmOrganizer.ID_CHATS;\nZmFolder.ID_ATTACHMENTS=ZmOrganizer.ID_ATTACHMENTS;\nZmFolder.ID_DLS=ZmOrganizer.ID_DLS;\nZmFolder.MSG_KEY={};\nZmFolder.MSG_KEY[ZmFolder.ID_INBOX]=\"inbox\";\nZmFolder.MSG_KEY[ZmFolder.ID_TRASH]=\"trash\";\nZmFolder.MSG_KEY[ZmFolder.ID_SPAM]=\"junk\";\nZmFolder.MSG_KEY[ZmFolder.ID_SENT]=\"sent\";\nZmFolder.MSG_KEY[ZmFolder.ID_DRAFTS]=\"drafts\";\nZmFolder.MSG_KEY[ZmFolder.ID_CONTACTS]=\"contacts\";\nZmFolder.MSG_KEY[ZmFolder.ID_AUTO_ADDED]=\"emailedContacts\";\nZmFolder.MSG_KEY[ZmFolder.ID_TASKS]=\"tasks\";\nZmFolder.MSG_KEY[ZmFolder.ID_TAGS]=\"tags\";\nZmFolder.MSG_KEY[ZmOrganizer.ID_CALENDAR]=\"calendar\";\nZmFolder.MSG_KEY[ZmOrganizer.ID_BRIEFCASE]=\"briefcase\";\nZmFolder.MSG_KEY[ZmOrganizer.ID_CHATS]=\"chats\";\nZmFolder.MSG_KEY[ZmOrganizer.ID_ALL_MAILBOXES]=\"allMailboxes\";\nZmFolder.MSG_KEY[ZmFolder.ID_OUTBOX]=\"outbox\";\nZmFolder.MSG_KEY[ZmFolder.ID_SYNC_FAILURES]=\"errorReports\";\nZmFolder.MSG_KEY[ZmFolder.ID_ATTACHMENTS]=\"attachments\";\nZmFolder.ICON={};\nZmFolder.ICON[ZmFolder.ID_INBOX]=\"Inbox\";\nZmFolder.ICON[ZmFolder.ID_TRASH]=\"Trash\";\nZmFolder.ICON[ZmFolder.ID_SPAM]=\"SpamFolder\";\nZmFolder.ICON[ZmFolder.ID_SENT]=\"SentFolder\";\nZmFolder.ICON[ZmFolder.ID_SYNC_FAILURES]=\"SendReceive\";\nZmFolder.ICON[ZmFolder.ID_OUTBOX]=\"Outbox\";\nZmFolder.ICON[ZmFolder.ID_DRAFTS]=\"DraftFolder\";\nZmFolder.ICON[ZmFolder.ID_CHATS]=\"ChatFolder\";\nZmFolder.ICON[ZmFolder.ID_LOAD_FOLDERS]=\"Plus\";\nZmFolder.ICON[ZmFolder.ID_ATTACHMENTS]=\"Attachment\";\nZmFolder.QUERY_NAME={};\nZmFolder.QUERY_NAME[ZmFolder.ID_INBOX]=\"inbox\";\nZmFolder.QUERY_NAME[ZmFolder.ID_TRASH]=\"trash\";\nZmFolder.QUERY_NAME[ZmFolder.ID_SPAM]=\"junk\";\nZmFolder.QUERY_NAME[ZmFolder.ID_SENT]=\"sent\";\nZmFolder.QUERY_NAME[ZmFolder.ID_OUTBOX]=\"outbox\";\nZmFolder.QUERY_NAME[ZmFolder.ID_DRAFTS]=\"drafts\";\nZmFolder.QUERY_NAME[ZmOrganizer.ID_CALENDAR]=\"calendar\";\nZmFolder.QUERY_NAME[ZmFolder.ID_CONTACTS]=\"contacts\";\nZmFolder.QUERY_NAME[ZmFolder.ID_TASKS]=\"tasks\";\nZmFolder.QUERY_NAME[ZmFolder.ID_AUTO_ADDED]=\"Emailed Contacts\";\nZmFolder.QUERY_NAME[ZmOrganizer.ID_BRIEFCASE]=\"briefcase\";\nZmFolder.QUERY_NAME[ZmFolder.ID_CHATS]=\"chats\";\nZmFolder.QUERY_NAME[ZmFolder.ID_SYNC_FAILURES]=\"Error Reports\";\nZmFolder.QUERY_ID=AjxUtil.valueHash(ZmFolder.QUERY_NAME);\nZmFolder.SORT_ORDER={};\nZmFolder.SORT_ORDER[ZmFolder.ID_INBOX]=1;\nZmFolder.SORT_ORDER[ZmFolder.ID_CHATS]=2;\nZmFolder.SORT_ORDER[ZmFolder.ID_SENT]=3;\nZmFolder.SORT_ORDER[ZmFolder.ID_DRAFTS]=4;\nZmFolder.SORT_ORDER[ZmFolder.ID_SPAM]=5;\nZmFolder.SORT_ORDER[ZmFolder.ID_OUTBOX]=6;\nZmFolder.SORT_ORDER[ZmFolder.ID_TRASH]=7;\nZmFolder.SORT_ORDER[ZmFolder.ID_SYNC_FAILURES]=8;\nZmFolder.SORT_ORDER[ZmFolder.ID_SEP]=9;\nZmFolder.SORT_ORDER[ZmFolder.ID_ATTACHMENTS]=99;\nZmFolder.TCON_CODE={};\nZmFolder.TCON_CODE[ZmFolder.ID_TRASH]=\"t\";\nZmFolder.TCON_CODE[ZmFolder.ID_SYNC_FAILURES]=\"o\";\nZmFolder.TCON_CODE[ZmFolder.ID_SPAM]=\"j\";\nZmFolder.TCON_CODE[ZmFolder.ID_SENT]=\"s\";\nZmFolder.TCON_CODE[ZmFolder.ID_DRAFTS]=\"d\";\nZmFolder.TCON_CODE[ZmFolder.ID_OTHER]=\"o\";\nZmFolder.HIDE_ID={};\nZmFolder.HIDE_ID[ZmOrganizer.ID_CHATS]=true;\nZmFolder.HIDE_ID[ZmOrganizer.ID_NOTIFICATION_MP]=true;\nZmFolder.HIDE_NAME={};\nZmFolder.OUTBOUND=[ZmFolder.ID_SENT,ZmFolder.ID_OUTBOX,ZmFolder.ID_DRAFTS];\nZmFolder.SYNC_ISSUES=\"Sync Issues\";\nZmFolder.QUERY_ID={};\n(function(){for(var a in ZmFolder.QUERY_NAME){ZmFolder.QUERY_ID[ZmFolder.QUERY_NAME[a]]=a\n}})();\nZmFolder.sortCompare=function(d,c,b){var a=ZmOrganizer.checkSortArgs(d,c);\nif(a!=null){return a\n}if(appCtxt.isOffline){if(d.isDataSource(ZmAccount.TYPE_POP)){if(d.id==ZmFolder.ID_INBOX){return -1\n}if(c.isDataSource(ZmAccount.TYPE_POP)){if(d.name.toLowerCase()>c.name.toLowerCase()){return 1\n}if(d.name.toLowerCase()<c.name.toLowerCase()){return -1\n}return 0\n}return -1\n}else{if(c.isDataSource(ZmAccount.TYPE_POP)){return 1\n}}}if(ZmFolder.SORT_ORDER[d.nId]&&ZmFolder.SORT_ORDER[c.nId]){return(ZmFolder.SORT_ORDER[d.nId]-ZmFolder.SORT_ORDER[c.nId])\n}if(d.link!==c.link){return d.link?1:-1\n}if(b){if(d.isTrash()){return 1\n}if(c.isTrash()){return -1\n}if(d.isSystem()&&!c.isSystem()){return -1\n}if(!d.isSystem()&&c.isSystem()){return 1\n}if(d.isSystem()&&c.isSystem()){if(d.isDefault()){return -1\n}if(c.isDefault()){return 1\n}}}else{if(!ZmFolder.SORT_ORDER[d.nId]&&ZmFolder.SORT_ORDER[c.nId]){return 1\n}if(ZmFolder.SORT_ORDER[d.nId]&&!ZmFolder.SORT_ORDER[c.nId]){return -1\n}}if(d.name.toLowerCase()>c.name.toLowerCase()){return 1\n}if(d.name.toLowerCase()<c.name.toLowerCase()){return -1\n}return 0\n};\nZmFolder.sortCompareNonMail=function(b,a){return ZmFolder.sortCompare(b,a,true)\n};\nZmFolder.sortComparePath=function(e,d){var c=e&&e.getPath(false,false,null,true,true);\nvar b=d&&d.getPath(false,false,null,true,true);\nvar a=ZmOrganizer.checkSortArgs(c,b);\nif(a!=null){return a\n}if(ZmFolder.SORT_ORDER[e.nId]&&ZmFolder.SORT_ORDER[d.nId]){return(ZmFolder.SORT_ORDER[e.nId]-ZmFolder.SORT_ORDER[d.nId])\n}if(!ZmFolder.SORT_ORDER[e.nId]&&ZmFolder.SORT_ORDER[d.nId]){return 1\n}if(ZmFolder.SORT_ORDER[e.nId]&&!ZmFolder.SORT_ORDER[d.nId]){return -1\n}if(c.toLowerCase()>b.toLowerCase()){return 1\n}if(c.toLowerCase()<b.toLowerCase()){return -1\n}return 0\n};\nZmFolder.checkName=function(c,d){var b=ZmOrganizer.checkName(c);\nif(b){return b\n}d=d||appCtxt.getFolderTree().root;\nif(d&&(d.id==ZmFolder.ID_ROOT)){var a=c.toLowerCase();\nfor(var f in ZmFolder.MSG_KEY){var e=ZmMsg[ZmFolder.MSG_KEY[f]];\nif(e&&(a==e.toLowerCase())){return ZmMsg.folderNameReserved\n}}}return null\n};\nZmFolder.getIdForName=function(c){var a=c.toLowerCase();\nfor(var b in ZmFolder.MSG_KEY){if(ZmFolder.MSG_KEY[b]==a){return b\n}}return null\n};\nZmFolder.prototype.move=function(e,d,f,a){var c=this.name;\nvar b=this.name;\nwhile(e.hasChild(b)){b=b+\"_\"\n}if(c!=b){this.rename(b)\n}ZmOrganizer.prototype.move.call(this,e,d,a)\n};\nZmFolder.prototype.toggleSyncOffline=function(f,a){if(!this.isOfflineSyncable){return\n}var e=this.isOfflineSyncing?\"!syncon\":\"syncon\";\nvar c=AjxSoapDoc.create(\"FolderActionRequest\",\"urn:zimbraMail\");\nvar b=c.set(\"action\");\nb.setAttribute(\"op\",e);\nb.setAttribute(\"id\",this.id);\nvar d={soapDoc:c,asyncMode:true,callback:f,errorCallback:a};\nappCtxt.getAppController().sendRequest(d)\n};\nZmFolder.prototype.hasFeeds=function(){if(this.type!=ZmOrganizer.FOLDER){return false\n}var b=this.children.getArray();\nvar d=this.children.size();\nfor(var c=0;\nc<d;\nc++){if(b[c].isFeed()){return true\n}if(b[c].children&&b[c].children.size()>0){return(b[c].hasFeeds&&b[c].hasFeeds())\n}}return false\n};\nZmFolder.prototype.hasSearch=function(e){if(this.type==ZmOrganizer.SEARCH){return true\n}var b=this.children.getArray();\nvar d=this.children.size();\nfor(var c=0;\nc<d;\nc++){if(b[c].hasSearch()){return true\n}}return false\n};\nZmFolder.prototype.supportsPublicAccess=function(){return true\n};\nZmFolder.prototype.notifyCreate=function(obj,elementType,skipNotify){var nId=ZmOrganizer.normalizeId(obj.id);\nif(this.isSystem()&&nId<ZmOrganizer.FIRST_USER_ID[this.type]){return\n}var account=ZmOrganizer.parseId(obj.id).account;\nvar folder=ZmFolderTree.createFromJs(this,obj,this.tree,elementType,null,account);\nif(folder){var index=ZmOrganizer.getSortIndex(folder,eval(ZmTreeView.COMPARE_FUNC[this.type]));\nthis.children.add(folder,index);\nif(!skipNotify){folder._notify(ZmEvent.E_CREATE)\n}}};\nZmFolder.prototype.notifyModify=function(obj){var details={};\nvar fields={};\nvar doNotify=false;\nif(obj.name!=null&&this.name!=obj.name&&obj.id==this.id){details.oldPath=this.getPath();\nthis.name=obj.name;\nfields[ZmOrganizer.F_NAME]=true;\nthis.parent.children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]));\ndoNotify=true;\nobj.name=null\n}if(doNotify){details.fields=fields;\nthis._notify(ZmEvent.E_MODIFY,details)\n}if(obj.l!=null&&(!this.parent||(obj.l!=this.parent.id))){var newParent=this._getNewParent(obj.l);\nif(newParent){details.oldPath=this.getPath();\nthis.reparent(newParent);\nthis._notify(ZmEvent.E_MOVE,details);\nobj.l=null\n}}ZmOrganizer.prototype.notifyModify.apply(this,[obj])\n};\nZmFolder.prototype.createQuery=function(c){if(!this.isRemote()&&this.isSystem()){var e=ZmFolder.QUERY_NAME[this.nId]||this.getName(false,null,true,true)||this.name;\nvar a=/^\\w+$/.test(e)?\"\":'\"';\nreturn c?e:(\"in:\"+a+e+a)\n}var g=this.isSystem()?ZmFolder.QUERY_NAME[this.nId]:this.name;\nvar d=this.parent;\nwhile(d&&(d.nId!=ZmFolder.ID_ROOT)&&d.name.length){var b=(d.isSystem()&&ZmFolder.QUERY_NAME[d.nId])||d.name;\ng=b+\"/\"+g;\nd=d.parent\n}g='\"'+g+'\"';\nreturn c?g:(\"in:\"+g)\n};\nZmFolder.prototype.getName=function(e,b,d,a){if(this.nId==ZmFolder.ID_DRAFTS||this.nId==ZmFolder.ID_OUTBOX||this.rid==ZmFolder.ID_DRAFTS){var c=(a&&this._systemName)?this._systemName:this.name;\nif(e&&this.numTotal>0){c=AjxMessageFormat.format(ZmMsg.folderUnread,[c,this.numTotal]);\nif(!d){c=[\"<span style='font-weight:bold'>\",c,\"</span>\"].join(\"\")\n}}return c\n}else{return ZmOrganizer.prototype.getName.apply(this,arguments)\n}};\nZmFolder.prototype.getIcon=function(){if(this.nId==ZmOrganizer.ID_ROOT){return null\n}if(ZmFolder.ICON[this.nId]){return ZmFolder.ICON[this.nId]\n}if(this.isFeed()){return\"RSS\"\n}if(this.isRemote()){return\"SharedMailFolder\"\n}if(this.isDataSource(ZmAccount.TYPE_POP)){return\"POPAccount\"\n}var a=this.getSystemEquivalentFolderId();\nif(a){return ZmFolder.ICON[a]||\"Folder\"\n}return\"Folder\"\n};\nZmFolder.prototype.getSystemEquivalentFolderId=function(){if(this.parent&&this.parent.isDataSource(ZmAccount.TYPE_IMAP)){return ZmFolder.getIdForName(this.name)\n}return null\n};\nZmFolder.prototype.isSystemEquivalent=function(){return this.getSystemEquivalentFolderId()!=null\n};\nZmFolder.prototype.mayContainFolderFromAccount=function(a){var b=this.getAccount();\nif(b==a){return true\n}return b.isLocal()\n};\nZmFolder.prototype.mayContain=function(h,k,l){if(!h){return true\n}if(this.isFeed()){return false\n}if(this.id==ZmFolder.ID_LOAD_FOLDERS){return false\n}var j=k||this.type;\nvar d=false;\nif(h instanceof ZmFolder){d=((h.parent===this&&!l)||this.isChildOf(h)||this.nId==ZmFolder.ID_DRAFTS||this.nId==ZmFolder.ID_SPAM||(!this.isInTrash()&&this.hasChild(h.name)&&!l)||(h.type!==j&&this.nId!=ZmFolder.ID_TRASH)||(h.id===this.id)||(this.disallowSubFolder)||(appCtxt.multiAccounts&&!this.mayContainFolderFromAccount(h.getAccount()))||(this.isRemote()&&!this._remoteMoveOk(h))||(h.isRemote()&&!this._remoteMoveOk(h)))\n}else{var e=AjxUtil.toArray(h);\nvar m=e[0];\nif((this.nId==ZmOrganizer.ID_ROOT&&(h.type!==ZmOrganizer.CALENDAR))||this.nId==ZmOrganizer.ID_OUTBOX||this.nId==ZmOrganizer.ID_SYNC_FAILURES){d=true\n}else{if(j===ZmOrganizer.SEARCH){d=true\n}else{if(m&&(m.type===ZmItem.CONTACT)&&m.isGal){d=true\n}else{if(m&&(m.type===ZmItem.CONV)&&m.list&&m.list.search&&(m.list.search.folderId===this.id)){d=true\n}else{for(var b=0;\nb<e.length;\nb++){var g=e[b];\nif(!g){d=true;\nbreak\n}if(Dwt.instanceOf(g,\"ZmBriefcaseFolderItem\")){if(g.folder&&g.folder.isRemote()&&!g.folder.rid){d=true;\nbreak\n}}else{if(m.type===ZmItem.MSG&&g.isDraft&&(this.nId!=ZmFolder.ID_TRASH&&this.nId!=ZmFolder.ID_DRAFTS&&this.rid!=ZmFolder.ID_DRAFTS)){d=true;\nbreak\n}else{if((this.nId==ZmFolder.ID_DRAFTS||this.rid==ZmFolder.ID_DRAFTS)&&!g.isDraft){d=true;\nbreak\n}}}}if(appCtxt.isOffline&&!d){var f=this.getAccount();\nif(f&&m.getAccount()!=f&&(f.type===ZmAccount.TYPE_MSE||f.type===ZmAccount.TYPE_EXCHANGE)){d=true\n}else{var c=appCtxt.getCurrentSearch();\nvar a=c&&appCtxt.getById(c.folderId);\nif(a&&a.nId==ZmOrganizer.ID_SYNC_FAILURES){d=true\n}}}if(appCtxt.multiAccounts&&this.isRemote()&&h.getAccount&&this.getAccount().id!=h.getAccount().id){d=true\n}if(!d&&!l){if(m&&m.folderId){d=true;\nfor(var b=0;\nb<e.length;\nb++){if(e[b].folderId!=this.id){d=false;\nbreak\n}}}}}}}}if(!d&&this.link){d=this.isReadOnly()\n}}return !d\n};\nZmFolder.prototype.isHardDelete=function(){return(this.isInTrash()||this.isInSpam()||(appCtxt.isOffline&&this.isUnder(ZmOrganizer.ID_SYNC_FAILURES)))\n};\nZmFolder.prototype.isInSpam=function(){return this.isUnder(ZmFolder.ID_SPAM)\n};\nZmFolder.prototype._remoteMoveOk=function(a){if(!this.isRemote()&&a.isMountpoint&&a.rid){return true\n}if(!this.link||!a.link||this.getOwner()!==a.getOwner()){return false\n}if(!this._folderActionOk(this,\"isInsert\")){return false\n}return this._folderActionOk(a,\"isDelete\")\n};\nZmFolder.prototype._folderActionOk=function(c,b){var a=c.shares&&c.shares[0];\nif(!a){return !c.isReadOnly()\n}return a[b]()\n};\nZmFolder.prototype.isOutbound=function(){for(var a=0;\na<ZmFolder.OUTBOUND.length;\na++){if(this.isUnder(ZmFolder.OUTBOUND[a])){return true\n}}return false\n};\nZmOrganizer.prototype.setGlobalMarkRead=function(c,d,b,a){if(this.globalMarkRead==c){return\n}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmSearchFolder\")){ZmSearchFolder=function(b){b.type=ZmOrganizer.SEARCH;\nZmFolder.call(this,b);\nif(b.query){var a={query:b.query,types:b.types,checkTypes:true,sortBy:b.sortBy,searchId:b.id,accountName:(b.account&&b.account.name)};\nthis.search=new ZmSearch(a)\n}};\nZmSearchFolder.prototype=new ZmFolder;\nZmSearchFolder.prototype.constructor=ZmSearchFolder;\nZmSearchFolder.prototype.toString=function(){return\"ZmSearchFolder\"\n};\nZmSearchFolder.ID_ROOT=ZmOrganizer.ID_ROOT;\nZmSearchFolder.create=function(e){e=e||{};\nvar d=e.search,f={CreateSearchFolderRequest:{_jsns:\"urn:zimbraMail\"}},c=f.CreateSearchFolderRequest.search={};\nc.name=e.name;\nc.query=d.query;\nc.l=e.l;\nif(e.sortBy){c.sortBy=e.sortBy\n}c.types=ZmSearchFolder._getSearchTypes(d);\nif(e.rgb){c.rgb=e.rgb\n}else{if(e.color){var a=ZmOrganizer.getColorValue(e.color,e.type);\nif(a){c.color=a\n}}}var b;\nif(e.isGlobal){c.f=\"g\";\nb=appCtxt.accountList.mainAccount.name\n}return appCtxt.getAppController().sendRequest({jsonObj:f,asyncMode:e.asyncMode!==false,accountName:b,callback:ZmSearchFolder._handleCreate,errorCallback:e.errorCallback||ZmOrganizer._handleErrorCreate.bind(null)})\n};\nZmSearchFolder._getSearchTypes=function(e){var b=\"\";\nif(e&&e.types){var c=e.types.getArray();\nif(c.length){var b=[];\nfor(var d=0;\nd<c.length;\nd++){b.push(ZmSearch.TYPE[c[d]])\n}b=b.join(\",\")\n}}return b\n};\nZmSearchFolder._handleCreate=function(a){appCtxt.setStatusMsg(ZmMsg.searchSaved)\n};\nZmSearchFolder.prototype.setQuery=function(f,h,e,b){if(f===this.search.query){return\n}var c={callback:h,errorCallback:e,batchCmd:b};\nvar a=\"ModifySearchFolderRequest\";\nvar d={_jsns:\"urn:zimbraMail\",search:{query:f,id:c.id||this.id,types:ZmSearchFolder._getSearchTypes(this.search)}};\nvar j={};\nj[a]=d;\nvar i=this._handleResponseOrganizerAction.bind(this,c);\nif(c.batchCmd){c.batchCmd.addRequestParams(j,i,c.errorCallback)\n}else{var g;\nif(appCtxt.multiAccounts){g=this.account?this.account.name:appCtxt.accountList.mainAccount.name\n}appCtxt.getAppController().sendRequest({jsonObj:j,asyncMode:true,accountName:g,callback:i,errorCallback:c.errorCallback})\n}};\nZmSearchFolder.prototype.getIcon=function(){return(this.nId==ZmOrganizer.ID_ROOT)?null:(this.isOfflineGlobalSearch?\"GlobalSearchFolder\":\"SearchFolder\")\n};\nZmSearchFolder.prototype.getToolTip=function(){};\nZmSearchFolder.prototype._getNewParent=function(b){var a=appCtxt.getById(b);\nif(a){return a\n}return appCtxt.getById(b)\n};\nZmSearchFolder.prototype.notifyModify=function(b){if(b.query&&b.query!==this.search.query&&b.id===this.id){this.search.query=b.query;\nvar a={};\na[ZmOrganizer.F_QUERY]=true;\nthis._notify(ZmEvent.E_MODIFY,{fields:a});\nb.query=null\n}ZmFolder.prototype.notifyModify.apply(this,[b])\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmSearch\")){ZmSearch=function(f){f=f||{};\nfor(var b in f){this[b]=f[b]\n}this.galType=this.galType||ZmSearch.GAL_ACCOUNT;\nthis.join=this.join||ZmSearch.JOIN_AND;\nif(this.query||this.queryHint){if(!this.isGalSearch&&!this.isAutocompleteSearch&&!this.isGalAutocompleteSearch&&!this.isCalResSearch){var c=this.parsedQuery=new ZmParsedQuery(this.query||this.queryHint);\nthis._setProperties();\nvar a=c.getTerm(\"sort\");\nif(a){this.sortBy=a.arg\n}}}this.isGalSearch=false;\nthis.isCalResSearch=false;\nif(ZmSearch._mailEnabled==null){ZmSearch._mailEnabled=appCtxt.get(ZmSetting.MAIL_ENABLED);\nif(ZmSearch._mailEnabled){AjxDispatcher.require(\"MailCore\")\n}}if(f.checkTypes){var h=AjxUtil.toArray(this.types);\nvar e=[];\nfor(var g=0;\ng<h.length;\ng++){var j=h[g];\nvar d=ZmItem.APP[j];\nif(appCtxt.get(ZmApp.SETTING[d])){e.push(j)\n}}this.types=AjxVector.fromArray(e)\n}};\nZmSearch.prototype.isZmSearch=true;\nZmSearch.prototype.toString=function(){return\"ZmSearch\"\n};\nZmSearch.TYPE={};\nZmSearch.TYPE_ANY=\"any\";\nZmSearch.GAL_ACCOUNT=\"account\";\nZmSearch.GAL_RESOURCE=\"resource\";\nZmSearch.GAL_ALL=\"\";\nZmSearch.JOIN_AND=1;\nZmSearch.JOIN_OR=2;\nZmSearch.TYPE_MAP={};\nZmSearch.DEFAULT_LIMIT=DwtListView.DEFAULT_LIMIT;\nZmSearch.DATE_DESC=\"dateDesc\";\nZmSearch.DATE_ASC=\"dateAsc\";\nZmSearch.SUBJ_DESC=\"subjDesc\";\nZmSearch.SUBJ_ASC=\"subjAsc\";\nZmSearch.NAME_DESC=\"nameDesc\";\nZmSearch.NAME_ASC=\"nameAsc\";\nZmSearch.SIZE_DESC=\"sizeDesc\";\nZmSearch.SIZE_ASC=\"sizeAsc\";\nZmSearch.RCPT_ASC=\"rcptAsc\";\nZmSearch.RCPT_DESC=\"rcptDesc\";\nZmSearch.ATTACH_ASC=\"attachAsc\";\nZmSearch.ATTACH_DESC=\"attachDesc\";\nZmSearch.FLAG_ASC=\"flagAsc\";\nZmSearch.FLAG_DESC=\"flagDesc\";\nZmSearch.MUTE_ASC=\"muteAsc\";\nZmSearch.MUTE_DESC=\"muteDesc\";\nZmSearch.READ_ASC=\"readAsc\";\nZmSearch.READ_DESC=\"readDesc\";\nZmSearch.PRIORITY_ASC=\"priorityAsc\";\nZmSearch.PRIORITY_DESC=\"priorityDesc\";\nZmSearch.SCORE_DESC=\"scoreDesc\";\nZmSearch.DURATION_DESC=\"durDesc\";\nZmSearch.DURATION_ASC=\"durAsc\";\nZmSearch.STATUS_DESC=\"taskStatusDesc\";\nZmSearch.STATUS_ASC=\"taskStatusAsc\";\nZmSearch.PCOMPLETE_DESC=\"taskPercCompletedDesc\";\nZmSearch.PCOMPLETE_ASC=\"taskPercCompletedAsc\";\nZmSearch.DUE_DATE_DESC=\"taskDueDesc\";\nZmSearch.DUE_DATE_ASC=\"taskDueAsc\";\nZmSearch.prototype.execute=function(a){if(a.batchCmd||this.soapInfo){return this._executeSoap(a)\n}else{return this._executeJson(a)\n}};\nZmSearch.prototype._executeSoap=function(e){this.isGalSearch=(this.contactSource&&(this.contactSource==ZmId.SEARCH_GAL));\nthis.isCalResSearch=(!this.contactSource&&this.conds!=null);\nif(appCtxt.isOffline&&this.isCalResSearch){this.isCalResSearch=appCtxt.isZDOnline()\n}if(this.isEmpty){this._handleResponseExecute(e.callback);\nreturn null\n}var n;\nif(!this.response){if(this.isGalSearch){n=AjxSoapDoc.create(\"SearchGalRequest\",\"urn:zimbraAccount\");\nvar b=n.getMethod();\nif(this.galType){b.setAttribute(\"type\",this.galType)\n}n.set(\"name\",this.query);\nvar h=n.set(\"searchFilter\");\nif(this.conds&&this.conds.length){var g=n.set(\"conds\",null,h);\nthis._applySoapCond(this.conds,n,g)\n}}else{if(this.isAutocompleteSearch){n=AjxSoapDoc.create(\"AutoCompleteRequest\",\"urn:zimbraMail\");\nvar b=n.getMethod();\nif(this.limit){b.setAttribute(\"limit\",this.limit)\n}n.set(\"name\",this.query)\n}else{if(this.isGalAutocompleteSearch){n=AjxSoapDoc.create(\"AutoCompleteGalRequest\",\"urn:zimbraAccount\");\nvar b=n.getMethod();\nb.setAttribute(\"limit\",this._getLimit());\nif(this.galType){b.setAttribute(\"type\",this.galType)\n}n.set(\"name\",this.query)\n}else{if(this.isCalResSearch){n=AjxSoapDoc.create(\"SearchCalendarResourcesRequest\",\"urn:zimbraAccount\");\nvar b=n.getMethod();\nif(this.attrs){var o=[].concat(this.attrs);\nAjxUtil.arrayRemove(o,\"fullName\");\nb.setAttribute(\"attrs\",o.join(\",\"))\n}var h=n.set(\"searchFilter\");\nif(this.conds&&this.conds.length){var g=n.set(\"conds\",null,h);\nthis._applySoapCond(this.conds,n,g)\n}}else{if(this.soapInfo){n=AjxSoapDoc.create(this.soapInfo.method,this.soapInfo.namespace);\nfor(var m in this.soapInfo.additional){var d=n.set(m);\nvar o=this.soapInfo.additional[m];\nfor(var j in o){d.setAttribute(j,o[j])\n}}}else{n=AjxSoapDoc.create(\"SearchRequest\",\"urn:zimbraMail\")\n}var b=this._getStandardMethod(n);\nif(this.types){var l=this.types.getArray();\nif(l.length){var k=[];\nfor(var f=0;\nf<l.length;\nf++){k.push(ZmSearch.TYPE[l[f]])\n}b.setAttribute(\"types\",k.join(\",\"));\nif(this.types.contains(ZmItem.MSG)||this.types.contains(ZmItem.CONV)){var c=this.folderId&&appCtxt.getById(this.folderId);\nb.setAttribute(\"recip\",(c&&c.isOutbound())?\"1\":\"0\")\n}if(this.types.contains(ZmItem.CONV)){b.setAttribute(\"fullConversation\",1)\n}if(this.fetch){b.setAttribute(\"fetch\",(this.fetch==\"all\")?\"all\":\"1\");\nif(this.getHtml){b.setAttribute(\"html\",\"1\")\n}}if(this.markRead){b.setAttribute(\"read\",\"1\")\n}}}if(this.inDumpster){b.setAttribute(\"inDumpster\",\"1\")\n}}}}}}var p=this._getStandardMethod(n);\np.setAttribute(\"needExp\",1);\nvar q=this._handleResponseExecute.bind(this,e.callback);\nif(e.batchCmd){e.batchCmd.addRequestParams(n,q)\n}else{return appCtxt.getAppController().sendRequest({soapDoc:n,asyncMode:true,callback:q,errorCallback:e.errorCallback,timeout:e.timeout,noBusyOverlay:e.noBusyOverlay,response:this.response})\n}};\nZmSearch.prototype._executeJson=function(d){this.isGalSearch=(this.contactSource&&(this.contactSource==ZmId.SEARCH_GAL));\nthis.isCalResSearch=(!this.contactSource&&this.conds!=null);\nif(appCtxt.isOffline&&this.isCalResSearch){this.isCalResSearch=appCtxt.isZDOnline()\n}if(this.isEmpty){this._handleResponseExecute(d.callback);\nreturn null\n}var q,e,l;\nif(!this.response){if(this.isGalSearch){e={_jsns:\"urn:zimbraAccount\",needIsOwner:\"1\",needIsMember:\"directOnly\"};\nq={SearchGalRequest:e};\nif(this.galType){e.type=this.galType\n}e.name=this.query;\ne.offset=this.offset=(this.offset||0);\ne.limit=this._getLimit();\ne.locale={_content:AjxEnv.DEFAULT_LOCALE};\nif(this.lastId){e.cursor={id:this.lastId,sortVal:(this.lastSortVal||\"\")}\n}if(this.sortBy){e.sortBy=this.sortBy\n}if(this.conds&&this.conds.length){e.searchFilter={conds:{}};\ne.searchFilter.conds=ZmSearch.prototype._applyJsonCond(this.conds,e)\n}}else{if(this.isAutocompleteSearch){q={AutoCompleteRequest:{_jsns:\"urn:zimbraMail\"}};\ne=q.AutoCompleteRequest;\nif(this.limit){e.limit=this.limit\n}e.name={_content:this.query};\nif(d.autocompleteType){e.t=d.autocompleteType\n}}else{if(this.isGalAutocompleteSearch){q={AutoCompleteGalRequest:{_jsns:\"urn:zimbraAccount\"}};\ne=q.AutoCompleteGalRequest;\ne.limit=this._getLimit();\ne.name=this.query;\nif(this.galType){e.type=this.galType\n}}else{if(this.isCalResSearch){q={SearchCalendarResourcesRequest:{_jsns:\"urn:zimbraAccount\"}};\ne=q.SearchCalendarResourcesRequest;\nif(this.attrs){var o=[].concat(this.attrs);\ne.attrs=o.join(\",\")\n}e.offset=this.offset=(this.offset||0);\ne.limit=this._getLimit();\nif(this.conds&&this.conds.length){e.searchFilter={conds:{}};\ne.searchFilter.conds=ZmSearch.prototype._applyJsonCond(this.conds,e)\n}}else{if(this.soapInfo){l=AjxSoapDoc.create(this.soapInfo.method,this.soapInfo.namespace);\nfor(var k in this.soapInfo.additional){var c=l.set(k);\nvar o=this.soapInfo.additional[k];\nfor(var g in o){c.setAttribute(g,o[g])\n}}}else{q={SearchRequest:{_jsns:\"urn:zimbraMail\"}};\ne=q.SearchRequest\n}this._getStandardMethodJson(e);\nif(this.types){var j=this.types.getArray();\nif(j.length){var h=[];\nfor(var f=0;\nf<j.length;\nf++){h.push(ZmSearch.TYPE[j[f]])\n}e.types=h.join(\",\");\nif(this.types.contains(ZmItem.MSG)||this.types.contains(ZmItem.CONV)){var b=this.folderId&&appCtxt.getById(this.folderId);\ne.recip=(b&&b.isOutbound())?\"2\":\"0\"\n}if(this.types.contains(ZmItem.CONV)){e.fullConversation=1\n}if(this.fetch){e.fetch=(this.fetch==\"all\")?\"all\":1;\nif(this.getHtml){e.html=1\n}}if(this.markRead){e.read=1\n}if(this.headers){for(var n in this.headers){if(!e.header){e.header=[]\n}e.header.push({n:this.headers[n]})\n}}if(j.length==1&&j[0]==ZmItem.TASK&&this.allowableTaskStatus){e.allowableTaskStatus=this.allowableTaskStatus\n}}}if(this.inDumpster){e.inDumpster=1\n}}}}}}if(e){e.needExp=1\n}var p=this._handleResponseExecute.bind(this,d.callback);\nif(d.batchCmd){d.batchCmd.addRequestParams(l,p)\n}else{var m={jsonObj:q,soapDoc:l,asyncMode:true,callback:p,errorCallback:d.errorCallback,offlineCallback:d.offlineCallback,timeout:d.timeout,offlineCache:d.offlineCache,noBusyOverlay:d.noBusyOverlay,response:this.response,accountName:this.accountName,offlineRequest:d.offlineRequest};\nreturn appCtxt.getAppController().sendRequest(m)\n}};\nZmSearch.prototype._applySoapCond=function(k,j,g,e){if(e||this.join==ZmSearch.JOIN_OR){g.setAttribute(\"or\",1)\n}for(var f=0;\nf<k.length;\nf++){var h=k[f];\nif(AjxUtil.isArray(h)){var d=j.set(\"conds\",null,g);\nthis._applySoapCond(h,j,d,true)\n}else{if(h.attr==\"fullName\"&&h.op==\"has\"){var b=j.set(\"name\",h.value)\n}else{var a=j.set(\"cond\",null,g);\na.setAttribute(\"attr\",h.attr);\na.setAttribute(\"op\",h.op);\na.setAttribute(\"value\",h.value)\n}}}};\nZmSearch.prototype._applyJsonCond=function(a,d,e){var g={};\nif(e||this.join==ZmSearch.JOIN_OR){g.or=1\n}for(var b=0;\nb<a.length;\nb++){var f=a[b];\nif(AjxUtil.isArray(f)){if(!g.conds){g.conds=[]\n}g.conds.push(this._applyJsonCond(f,d,true))\n}else{if(f.attr==\"fullName\"&&f.op==\"has\"){d.name={_content:f.value}\n}else{if(!g.cond){g.cond=[]\n}g.cond.push({attr:f.attr,op:f.op,value:f.value})\n}}}return g\n};\nZmSearch.prototype._handleResponseExecute=function(d,b){if(b){var c=b.getResponse();\nif(this.isGalSearch){c=c.SearchGalResponse\n}else{if(this.isCalResSearch){c=c.SearchCalendarResourcesResponse\n}else{if(this.isAutocompleteSearch){c=c.AutoCompleteResponse\n}else{if(this.isGalAutocompleteSearch){c=c.AutoCompleteGalResponse\n}else{if(this.soapInfo){c=c[this.soapInfo.response]\n}else{c=c.SearchResponse\n}}}}}}else{c={_jsns:\"urn:zimbraMail\",more:false}\n}var a=new ZmSearchResult(this);\na.set(c);\nb=b||new ZmCsfeResult();\nb.set(a);\nif(d){d.run(b)\n}};\nZmSearch.prototype.getConv=function(c){if((!this.query&&!this.queryHint)||!c.cid){return\n}var d={SearchConvRequest:{_jsns:\"urn:zimbraMail\"}};\nvar a=d.SearchConvRequest;\nthis._getStandardMethodJson(a);\na.cid=c.cid;\nif(c.fetch){a.fetch=c.fetch;\nif(c.markRead){a.read=1\n}if(this.getHtml){a.html=1\n}if(c.needExp!==false){a.needExp=1\n}}if(!c.noTruncate){a.max=appCtxt.get(ZmSetting.MAX_MESSAGE_SIZE)\n}a.recip=\"2\";\nvar b={jsonObj:d,asyncMode:true,callback:this._handleResponseGetConv.bind(this,c.callback),accountName:this.accountName};\nappCtxt.getAppController().sendRequest(b)\n};\nZmSearch.prototype._handleResponseGetConv=function(d,b){var c=b.getResponse().SearchConvResponse;\nvar a=new ZmSearchResult(this);\na.set(c,null,true);\nb.set(a);\nif(d){d.run(b)\n}};\nZmSearch.prototype.clearCursor=function(){this.lastId=this.lastSortVal=this.endSortVal=null\n};\nZmSearch.prototype.getTitle=function(){var c;\nvar a=this.parsedQuery;\nvar b=this.searchId||((a&&(a.getNumTokens()==1))?this.folderId||this.tagId:null);\nif(b){var d=appCtxt.getById(ZmOrganizer.getSystemId(b));\nif(d){c=d.getName(true,ZmOrganizer.MAX_DISPLAY_NAME_LENGTH,true)\n}}return c?([ZmMsg.zimbraTitle,c].join(\": \")):([ZmMsg.zimbraTitle,ZmMsg.searchResults].join(\": \"))\n};\nZmSearch.prototype.isMultiAccount=function(){if(!this._isMultiAccount){this._isMultiAccount=(this.queryHint&&this.queryHint.length>0&&(this.queryHint.split(\"inid:\").length>1||this.queryHint.split(\"underid:\").length>1))\n}return this._isMultiAccount\n};\nZmSearch.prototype._getStandardMethod=function(a){var d=a.getMethod();\nif(this.sortBy){d.setAttribute(\"sortBy\",this.sortBy)\n}if(this.types.contains(ZmItem.MSG)||this.types.contains(ZmItem.CONV)){ZmMailMsg.addRequestHeaders(a)\n}ZmTimezone.set(a,AjxTimezone.DEFAULT,null);\na.set(\"locale\",appCtxt.get(ZmSetting.LOCALE_NAME),null);\nif(this.lastId!=null&&this.lastSortVal){var c=a.set(\"cursor\");\nc.setAttribute(\"id\",this.lastId);\nc.setAttribute(\"sortVal\",this.lastSortVal);\nif(this.endSortVal){c.setAttribute(\"endSortVal\",this.endSortVal)\n}}this.offset=this.offset||0;\nd.setAttribute(\"offset\",this.offset);\nd.setAttribute(\"limit\",this._getLimit());\nvar b=this._getQuery();\na.set(\"query\",b);\nif(this.field){d.setAttribute(\"field\",this.field)\n}return d\n};\nZmSearch.prototype._getStandardMethodJson=function(a){if(this.sortBy){a.sortBy=this.sortBy\n}if(this.types.contains(ZmItem.MSG)||this.types.contains(ZmItem.CONV)){ZmMailMsg.addRequestHeaders(a)\n}ZmTimezone.set(a,AjxTimezone.DEFAULT);\na.locale={_content:AjxEnv.DEFAULT_LOCALE};\nif(this.lastId!=null&&this.lastSortVal){a.cursor={id:this.lastId,sortVal:this.lastSortVal};\nif(this.endSortVal){a.cursor.endSortVal=this.endSortVal\n}}a.offset=this.offset=this.offset||0;\na.limit=this._getLimit();\nif(this.idsOnly){a.resultMode=\"IDS\"\n}a.query=this._getQuery();\nif(this.field){a.field=this.field\n}};\nZmSearch.prototype._getQuery=function(){if(this.queryHint){var a=this.query?[\"(\",this.query,\") \"].join(\"\"):\"\";\nreturn[a,\"(\",this.queryHint,\")\"].join(\"\")\n}return this.query\n};\nZmSearch.prototype._getLimit=function(){if(this.limit){return this.limit\n}var a;\nif(this.isGalAutocompleteSearch){a=appCtxt.get(ZmSetting.AUTOCOMPLETE_LIMIT)\n}else{var b=this.types&&this.types.get(0);\nvar c=appCtxt.getApp(ZmItem.APP[b])||appCtxt.getCurrentApp();\nif(c&&c.getLimit){a=c.getLimit(this.offset)\n}else{a=appCtxt.get(ZmSetting.PAGE_SIZE)||ZmSearch.DEFAULT_LIMIT\n}}this.limit=a;\nreturn a\n};\nZmSearch.prototype.matches=function(a){if(!this.parsedQuery){return null\n}if(this.folderId&&!this.parsedQuery.hasOrTerm){if(a.type===ZmItem.CONV){if(a.folders&&!a.folders[this.folderId]){return false\n}}else{if(a.folderId&&a.folderId!==this.folderId){return false\n}}}var b=this.parsedQuery.getMatchFunction();\nreturn b?b(a):null\n};\nZmSearch.prototype.hasFolderTerm=function(a){return this.parsedQuery&&this.parsedQuery.hasTerm([\"in\",\"under\"],a)\n};\nZmSearch.prototype.replaceFolderTerm=function(c,a){if(!this.parsedQuery){return this.query\n}var b=this.parsedQuery.replaceTerm([\"in\",\"under\"],c,a);\nif(b){this.query=b\n}return Boolean(b)\n};\nZmSearch.prototype.hasTagTerm=function(a){return this.parsedQuery&&this.parsedQuery.hasTerm(\"tag\",a)\n};\nZmSearch.prototype.replaceTagTerm=function(b,a){if(!this.parsedQuery){return this.query\n}var c=this.parsedQuery.replaceTerm(\"tag\",b,a);\nif(c){this.query=c\n}return Boolean(c)\n};\nZmSearch.prototype.hasUnreadTerm=function(){return(this.parsedQuery&&(this.parsedQuery.hasTerm(\"is\",\"read\")||this.parsedQuery.hasTerm(\"is\",\"unread\")))\n};\nZmSearch.prototype.isAnywhere=function(){return(this.parsedQuery&&this.parsedQuery.hasTerm(\"is\",\"anywhere\"))\n};\nZmSearch.prototype.hasContentTerm=function(){return(this.parsedQuery&&this.parsedQuery.hasTerm(\"content\"))\n};\nZmSearch.prototype.isSimple=function(){var a=this.parsedQuery;\nif(a&&(a.getNumTokens()==1)){return a.hasTerm([\"in\",\"inid\",\"tag\"])\n}return false\n};\nZmSearch.prototype.getTokens=function(){return this.parsedQuery&&this.parsedQuery.getTokens()\n};\nZmSearch.prototype._setProperties=function(){var b=this.parsedQuery&&this.parsedQuery.getProperties();\nfor(var a in b){this[a]=b[a]\n}};\nZmParsedQuery=function(a){this.hasOrTerm=false;\nthis._tokens=this._parse(AjxStringUtil.trim(a,true));\nif(!ZmParsedQuery.IS_VALUE_PRECONDITION){ZmParsedQuery.IS_VALUE_PRECONDITION={};\nZmParsedQuery.IS_VALUE_PRECONDITION.flagged=ZmSetting.FLAGGING_ENABLED;\nZmParsedQuery.IS_VALUE_PRECONDITION.unflagged=ZmSetting.FLAGGING_ENABLED\n}};\nZmParsedQuery.prototype.isZmParsedQuery=true;\nZmParsedQuery.prototype.toString=function(){return\"ZmParsedQuery\"\n};\nZmParsedQuery.TERM=\"TERM\";\nZmParsedQuery.COND=\"COND\";\nZmParsedQuery.GROUP=\"GROUP\";\nZmParsedQuery.OP_CONTENT=\"content\";\nZmParsedQuery.OP_LIST=[\"content\",\"subject\",\"msgid\",\"envto\",\"envfrom\",\"contact\",\"to\",\"from\",\"cc\",\"tofrom\",\"tocc\",\"fromcc\",\"tofromcc\",\"in\",\"under\",\"inid\",\"underid\",\"has\",\"filename\",\"type\",\"attachment\",\"is\",\"date\",\"mdate\",\"day\",\"week\",\"month\",\"year\",\"after\",\"before\",\"size\",\"bigger\",\"larger\",\"smaller\",\"tag\",\"priority\",\"message\",\"my\",\"modseq\",\"conv\",\"conv-count\",\"conv-minm\",\"conv-maxm\",\"conv-start\",\"conv-end\",\"appt-start\",\"appt-end\",\"author\",\"title\",\"keywords\",\"company\",\"metadata\",\"item\",\"sort\"];\nZmParsedQuery.IS_OP=AjxUtil.arrayAsHash(ZmParsedQuery.OP_LIST);\nZmParsedQuery.IS_VALUES=[\"unread\",\"read\",\"flagged\",\"unflagged\",\"draft\",\"sent\",\"received\",\"replied\",\"unreplied\",\"forwarded\",\"unforwarded\",\"invite\",\"solo\",\"tome\",\"fromme\",\"ccme\",\"tofromme\",\"toccme\",\"fromccme\",\"tofromccme\",\"local\",\"remote\",\"anywhere\"];\nZmParsedQuery.MULTIPLE={};\nZmParsedQuery.MULTIPLE.to=true;\nZmParsedQuery.MULTIPLE.is=true;\nZmParsedQuery.MULTIPLE.has=true;\nZmParsedQuery.MULTIPLE.tag=true;\nZmParsedQuery.MULTIPLE[\"appt-start\"]=true;\nZmParsedQuery.MULTIPLE[\"appt-end\"]=true;\nZmParsedQuery.MULTIPLE.type=true;\nZmParsedQuery.isMultiple=function(a){return Boolean(a&&ZmParsedQuery.MULTIPLE[a.op])\n};\nZmParsedQuery.EXCLUDE={};\nZmParsedQuery.EXCLUDE.before=[\"date\"];\nZmParsedQuery.EXCLUDE.after=[\"date\"];\nZmParsedQuery.EXCLUDE.is={};\nZmParsedQuery.EXCLUDE.is[\"read\"]=[\"unread\"];\nZmParsedQuery.EXCLUDE.is[\"flagged\"]=[\"unflagged\"];\nZmParsedQuery.EXCLUDE.is[\"sent\"]=[\"received\"];\nZmParsedQuery.EXCLUDE.is[\"replied\"]=[\"unreplied\"];\nZmParsedQuery.EXCLUDE.is[\"forwarded\"]=[\"unforwarded\"];\nZmParsedQuery.EXCLUDE.is[\"local\"]=[\"remote\",\"anywhere\"];\nZmParsedQuery.EXCLUDE.is[\"tome\"]=[\"tofromme\",\"toccme\",\"tofromccme\"];\nZmParsedQuery.EXCLUDE.is[\"fromme\"]=[\"tofromme\",\"fromccme\",\"tofromccme\"];\nZmParsedQuery.EXCLUDE.is[\"ccme\"]=[\"toccme\",\"fromccme\",\"tofromccme\"];\nZmParsedQuery._createExcludeMap=function(f){var c={};\nfor(var b in f){var e=f[b];\nif(AjxUtil.isArray1(e)){e.push(b);\nZmParsedQuery._permuteExcludeMap(c,e)\n}else{for(var d in e){var a=f[b][d];\na.push(d);\nZmParsedQuery._permuteExcludeMap(c,AjxUtil.map(a,function(g){return new ZmSearchToken(b,g).toString()\n}))\n}}}return c\n};\nZmParsedQuery._permuteExcludeMap=function(g,h){if(h.length<2){return\n}for(var f=0;\nf<h.length-1;\nf++){var d=h[f];\nfor(var e=f+1;\ne<h.length;\ne++){var c=h[e];\ng[d]=g[d]||{};\ng[c]=g[c]||{};\ng[d][c]=true;\ng[c][d]=true\n}}};\nZmParsedQuery.areExclusive=function(d,b){if(!d||!b){return false\n}var f=ZmParsedQuery.EXCLUDE_MAP;\nif(!f){f=ZmParsedQuery.EXCLUDE_MAP=ZmParsedQuery._createExcludeMap(ZmParsedQuery.EXCLUDE)\n}var a=d.op,g=b.op;\nvar e=d.toString(),c=b.toString();\nreturn Boolean((f[a]&&f[a][g])||(f[g]&&f[g][a])||(f[e]&&f[e][c])||(f[c]&&f[c][e]))\n};\nZmParsedQuery.COND_AND=\"and\";\nZmParsedQuery.COND_OR=\"or\";\nZmParsedQuery.COND_NOT=\"not\";\nZmParsedQuery.GROUP_OPEN=\"(\";\nZmParsedQuery.GROUP_CLOSE=\")\";\nZmParsedQuery.COND_OP={};\nZmParsedQuery.COND_OP[ZmParsedQuery.COND_AND]=\" && \";\nZmParsedQuery.COND_OP[ZmParsedQuery.COND_OR]=\" || \";\nZmParsedQuery.COND_OP[ZmParsedQuery.COND_NOT]=\" !\";\nZmParsedQuery.EOW_LIST=[\" \",\":\",ZmParsedQuery.GROUP_OPEN,ZmParsedQuery.GROUP_CLOSE];\nZmParsedQuery.IS_EOW=AjxUtil.arrayAsHash(ZmParsedQuery.EOW_LIST);\nZmParsedQuery.FLAG={};\nZmParsedQuery.FLAG.unread=\"item.isUnread\";\nZmParsedQuery.FLAG.read=\"!item.isUnread\";\nZmParsedQuery.FLAG.flagged=\"item.isFlagged\";\nZmParsedQuery.FLAG.unflagged=\"!item.isFlagged\";\nZmParsedQuery.FLAG.forwarded=\"item.isForwarded\";\nZmParsedQuery.FLAG.unforwarded=\"!item.isForwarded\";\nZmParsedQuery.FLAG.sent=\"item.isSent\";\nZmParsedQuery.FLAG.draft=\"item.isDraft\";\nZmParsedQuery.FLAG.replied=\"item.isReplied\";\nZmParsedQuery.FLAG.unreplied=\"!item.isReplied\";\nZmParsedQuery.prototype._parse=function(a){function c(y,z,x){var x=x||y.charAt(z);\nz++;\nvar u=false,w,v=\"\";\nwhile(z<y.length&&!u){w=y.charAt(z);\nif(w==x){u=true\n}else{v+=w;\nz++\n}}return u?{str:v,pos:z+1}:null\n}function f(u,v){while(v<u.length&&u.charAt(v)==\" \"){v++\n}return v\n}function e(v,u){this.parseFailed=v;\nreturn k\n}var p=a.length;\nvar k=[],j,t,i,q=\"\",g=false,m=true,s=0,o=0;\nvar d=f(a,0);\nwhile(d<p){t=(j!=\" \")?j:t;\nj=a.charAt(d);\ng=ZmParsedQuery.IS_EOW[j];\nif(j==\":\"){if(ZmParsedQuery.IS_OP[q]){i=q\n}else{return e(\"unrecognized op '\"+q+\"'\",a)\n}q=\"\";\nd=f(a,d+1);\ncontinue\n}if(g){var h=q.toLowerCase();\nvar b=!!ZmParsedQuery.COND_OP[h];\nif(i&&q&&!(b&&s>0)){k.push(new ZmSearchToken(i,h));\nif(s==0){i=\"\"\n}q=\"\";\nm=true\n}else{if(!i||(i&&s>0)){if(b){k.push(new ZmSearchToken(h));\nm=false;\nif(h==ZmParsedQuery.COND_OR){this.hasOrTerm=true\n}}else{if(q){k.push(new ZmSearchToken(ZmParsedQuery.OP_CONTENT,q))\n}}q=\"\"\n}}}if(j=='\"'){var n=c(a,d);\nif(n){q=n.str;\nd=n.pos\n}else{return e(\"improper use of quotes\",a)\n}}else{if(j==ZmParsedQuery.GROUP_OPEN){var l=false;\nif(s>0){s++\n}else{if(t==\":\"){s=1;\nvar r=a.substr(d,a.indexOf(ZmParsedQuery.GROUP_CLOSE,d+1));\nr=r&&r.toLowerCase();\nif(r&&(r.indexOf(\" \"+ZmParsedQuery.COND_OR+\" \")==-1)&&(r.indexOf(\" \"+ZmParsedQuery.COND_AND+\" \")==-1)){var n=c(a,d,ZmParsedQuery.GROUP_CLOSE);\nif(n){q=n.str;\nd=n.pos;\ns=0\n}else{return e(\"improper use of paren-based quoting\",a)\n}l=true\n}}}if(!l){k.push(new ZmSearchToken(j));\no++\n}d=f(a,d+1)\n}else{if(j==ZmParsedQuery.GROUP_CLOSE){if(s>0){s--\n}if(s==0){i=\"\"\n}k.push(new ZmSearchToken(j));\nd=f(a,d+1)\n}else{if(j==\"-\"&&!q&&!i){k.push(new ZmSearchToken(ZmParsedQuery.COND_NOT));\nd=f(a,d+1);\nm=false\n}else{if(j!=\" \"){q+=j\n}d++\n}}}}}if((d>=a.length)&&i&&q){k.push(new ZmSearchToken(i,q));\nm=true\n}else{if(!i&&q){k.push(new ZmSearchToken(q))\n}}if(k.length>=3&&o==1&&k[0].op==ZmParsedQuery.GROUP_OPEN&&k[k.length-1].op==ZmParsedQuery.GROUP_CLOSE){k.shift();\nk.pop()\n}if(!m){return e(\"unexpected end of query\",a)\n}return k\n};\nZmParsedQuery.prototype.getTokens=function(){return this._tokens\n};\nZmParsedQuery.prototype.getNumTokens=function(){return this._tokens?this._tokens.length:0\n};\nZmParsedQuery.prototype.getProperties=function(){var d={};\nfor(var c=0,a=this._tokens.length;\nc<a;\nc++){var b=this._tokens[c];\nif(b.type==ZmParsedQuery.TERM){var e=c>0?this._tokens[c-1]:null;\nif(!((e&&e.op==ZmParsedQuery.COND_NOT)||this.hasOrTerm)){if((b.op==\"in\"||b.op==\"inid\")){this.folderId=d.folderId=(b.op==\"in\")?this._getFolderId(b.arg):b.arg\n}else{if(b.op==\"tag\"){this.tagId=d.tagId=this._getTagId(b.arg,true)\n}}}}}return d\n};\nZmParsedQuery.prototype.getMatchFunction=function(){if(this._matchFunction){return this._matchFunction\n}if(this.parseFailed||this.hasTerm(ZmParsedQuery.OP_CONTENT)){return null\n}var a,d;\nvar c=[\"return Boolean(\"];\nfor(var e=0,g=this._tokens.length;\ne<g;\ne++){var k=this._tokens[e];\nif(k.type===ZmParsedQuery.TERM){if(k.op===\"in\"||k.op===\"inid\"){a=(k.op===\"in\")?this._getFolderId(k.arg):k.arg;\nif(a){c.push(\"((item.type === ZmItem.CONV) ? item.folders && item.folders['\"+a+\"'] : item.folderId === '\"+a+\"')\")\n}}else{if(k.op===\"tag\"){d=this._getTagId(k.arg,true);\nif(d){c.push(\"item.hasTag('\"+k.arg+\"')\")\n}}else{if(k.op===\"is\"){var j=ZmParsedQuery.FLAG[k.arg];\nif(j){c.push(j)\n}}else{if(k.op===\"has\"&&k.arg===\"attachment\"){c.push(\"item.hasAttach\")\n}else{return null\n}}}}var f=this._tokens[e+1];\nif(f&&(f.type==ZmParsedQuery.TERM||f==ZmParsedQuery.COND_OP[ZmParsedQuery.COND_NOT]||f==ZmParsedQuery.GROUP_CLOSE)){c.push(ZmParsedQuery.COND_OP[ZmParsedQuery.COND_AND])\n}}else{if(k.type===ZmParsedQuery.COND){c.push(ZmParsedQuery.COND_OP[k.op])\n}else{if(k.type===ZmParsedQuery.GROUP){c.push(k.op)\n}}}}c.push(\")\");\nvar b=(appCtxt.multiAccounts&&this.isMultiAccount()&&!this.query&&this.queryHint);\nif(!this.hasOrTerm||b){this.folderId=a;\nthis.tagId=d\n}try{this._matchFunction=new Function(\"item\",c.join(\"\"))\n}catch(h){}return this._matchFunction\n};\nZmParsedQuery.prototype.createQuery=function(){var c=[];\nfor(var b=0,a=this._tokens.length;\nb<a;\nb++){c.push(this._tokens[b].toString())\n}return c.join(\" \")\n};\nZmParsedQuery.prototype._getFolderId=function(g){var a=ZmFolder.QUERY_ID[g];\nvar b=this.accountName;\nif(!b){var f=appCtxt.getActiveAccount();\nb=f?f.name:appCtxt.accountList.mainAccount\n}if(!a){var e=b&&appCtxt.accountList.getAccountByName(b);\nvar c=appCtxt.getFolderTree(e);\nvar d=c?c.getByPath(g,true):null;\nif(d){a=d.id\n}}if(b){a=ZmOrganizer.getSystemId(a,appCtxt.accountList.getAccountByName(b))\n}return a\n};\nZmParsedQuery.prototype._getTagId=function(c,d){var b=appCtxt.getTagTree();\nif(b){var a=b.getByName(c.toLowerCase());\nif(a){return d?a.nId:a.id\n}}return null\n};\nZmParsedQuery.prototype.getTerm=function(f,h){var g=AjxUtil.arrayAsHash(f);\nvar b=h&&h.toLowerCase();\nfor(var d=0,a=this._tokens.length;\nd<a;\nd++){var c=this._tokens[d];\nvar e=c.arg&&c.arg.toLowerCase();\nif(c.type==ZmParsedQuery.TERM&&g[c.op]&&(!h||e==b)){return c\n}}return null\n};\nZmParsedQuery.prototype.hasTerm=function(a,b){return Boolean(this.getTerm(a,b))\n};\nZmParsedQuery.prototype.replaceTerm=function(d,a,c){var f=a&&a.toLowerCase();\nvar b=AjxUtil.arrayAsHash(d);\nif(a&&c){for(var e=0,g=this._tokens.length;\ne<g;\ne++){var j=this._tokens[e];\nvar h=j.arg&&j.arg.toLowerCase();\nif(j.type==ZmParsedQuery.TERM&&b[j.op]&&(h==f)){j.arg=c;\nreturn this.createQuery()\n}}}return\"\"\n};\nZmSearchToken=function(c,a){if(c&&arguments.length==1){var b=c.split(\":\");\nc=b[0];\na=b[1]\n}this.op=c;\nthis.arg=a;\nif(ZmParsedQuery.IS_OP[c]&&a){this.type=ZmParsedQuery.TERM\n}else{if(c&&ZmParsedQuery.COND_OP[c.toLowerCase()]){this.type=ZmParsedQuery.COND;\nthis.op=c.toLowerCase()\n}else{if(c==ZmParsedQuery.GROUP_OPEN||c==ZmParsedQuery.GROUP_CLOSE){this.type=ZmParsedQuery.GROUP\n}else{if(c){this.type=ZmParsedQuery.TERM;\nthis.op=ZmParsedQuery.OP_CONTENT;\nthis.arg=c\n}}}}};\nZmSearchToken.prototype.isZmSearchToken=true;\nZmSearchToken.prototype.toString=function(b){if(this.type==ZmParsedQuery.TERM){var a=this.arg;\nif(this.op==ZmParsedQuery.OP_CONTENT){return/\\W/.test(a)?'\"'+a.replace(/\"/g,'\\\\\"')+'\"':a\n}else{a=(a&&(a.indexOf('\"')!==0)&&a.indexOf(\" \")!=-1)?'\"'+a+'\"':a;\nreturn[this.op,a].join(\":\")\n}}else{return(!b&&this.op==ZmParsedQuery.COND_AND)?\"\":this.op\n}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmSearchResult\")){ZmSearchResult=function(a){if(!a){return\n}this._results={};\nthis.search=a;\nthis.type=a.searchFor\n};\nZmSearchResult.prototype.isZmSearchResult=true;\nZmSearchResult.prototype.toString=function(){return\"ZmSearchResult\"\n};\nZmSearchResult.prototype.getResults=function(a){a=a||this.type;\nif(!this._results){return this._getResultsList(a)\n}else{if(this.search.idsOnly){return this._results\n}else{return this._results[a]?this._results[a]:a&&this._getResultsList(a)\n}}};\nZmSearchResult.prototype.getAttribute=function(a){return this._respEl?this._respEl[a]:null\n};\nZmSearchResult.prototype.set=function(n){if(!this.search){return\n}this._respEl=n;\nif(this.search.isAutocompleteSearch){return\n}var l={};\nvar f=0;\nvar o,d;\nvar b=this.search.isGalSearch;\nvar c=new Date();\nvar e=0;\nif(b||this.search.isCalResSearch){o=d=b?ZmItem.CONTACT:ZmItem.RESOURCE;\nvar u=b?n.cn:n.calresource;\nif(u){if(!this._results[o]){this._results[o]=this._getResultsList(o)\n}for(var p=0;\np<u.length;\np++){this._results[o].addFromDom(u[p])\n}if(b){this._results[o].getArray().sort(ZmSearchResult._sortGalResults)\n}e=u.length\n}}else{if(this.search.idsOnly){this._results=n.hit||[];\nreturn\n}else{var h=this.search.types.getArray();\nd=h[0];\nif(!d){var g=AjxUtil.values(ZmList.NODE);\nfor(var q=0;\nq<g.length;\nq++){var k=g[q];\nif(n[k]){d=ZmList.ITEM_TYPE[k];\nif(h&&h.length==0){h=[d]\n}break\n}}}if(!d){var s=appCtxt.getCurrentAppName();\nvar h=ZmApp.SEARCH_TYPES[s];\nd=h&&h.length&&h[0]\n}for(var q=0;\nq<h.length;\nq++){var a=h[q];\nvar u=n[ZmList.NODE[a]];\nif(!u&&(a==ZmItem.MSG)){u=n.chat\n}if(!u&&(a==ZmItem.RESOURCE)){u=n[ZmList.NODE[ZmItem.CONTACT]]\n}if(u&&u.length){e+=u.length;\nif(!this._results[a]){this._results[a]=this._getResultsList(a)\n}for(var p=0;\np<u.length;\np++){var r=u[p];\nr._type=a;\nthis._results[a].addFromDom(r)\n}if(!l[a]){l[a]=true;\nf++;\no=a\n}}}}}if(!e&&d){this._results[d]=this._getResultsList(d)\n}if((b||this.search.isGalAutocompleteSearch)&&this._results[ZmItem.CONTACT]){this._results[ZmItem.CONTACT].setIsGal(true)\n}if(this.search.isGalAutocompleteSearch){this.isTokenized=(this._respEl.tokenizeKey!=null)\n}var m=new Date();\no=o||d;\nif(f<=1){this.type=o\n}return this.type\n};\nZmSearchResult._sortGalResults=function(d,c){var e=d.getFileAs&&d.getFileAs().toLowerCase();\nvar f=c.getFileAs&&c.getFileAs().toLowerCase();\nreturn e<f?-1:(e>f?1:0)\n};\nZmSearchResult.prototype._getResultsList=function(a){if(a&&typeof(ZmItem.RESULTS_LIST[a])===\"function\"){return ZmItem.RESULTS_LIST[a](this.search)\n}else{DBG.println(AjxDebug.DBG1,AjxMessageFormat.format(\"!type || ZmItem.RESULTS_LIST[type] !== function. Active app: {0}, type: {1}, searchFor: {2}.\",[appCtxt.getCurrentAppName(),a,this.search.searchFor]));\nreturn new ZmList(a,this.search)\n}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmTag\")){ZmTag=function(a){a.type=ZmOrganizer.TAG;\nZmOrganizer.call(this,a);\nthis.notLocal=a.notLocal\n};\nZmTag.prototype=new ZmOrganizer;\nZmTag.prototype.constructor=ZmTag;\nZmTag.prototype.isZmTag=true;\nZmTag.prototype.toString=function(){return\"ZmTag\"\n};\nZmTag.COLOR_ICON=new Object();\nZmTag.COLOR_ICON[ZmOrganizer.C_ORANGE]=\"TagOrange\";\nZmTag.COLOR_ICON[ZmOrganizer.C_BLUE]=\"TagBlue\";\nZmTag.COLOR_ICON[ZmOrganizer.C_CYAN]=\"TagCyan\";\nZmTag.COLOR_ICON[ZmOrganizer.C_GREEN]=\"TagGreen\";\nZmTag.COLOR_ICON[ZmOrganizer.C_PURPLE]=\"TagPurple\";\nZmTag.COLOR_ICON[ZmOrganizer.C_RED]=\"TagRed\";\nZmTag.COLOR_ICON[ZmOrganizer.C_YELLOW]=\"TagYellow\";\nZmTag.ID_ROOT=ZmOrganizer.ID_ROOT;\nZmTag.ID_UNREAD=32;\nZmTag.ID_FLAGGED=33;\nZmTag.ID_FROM_ME=34;\nZmTag.ID_REPLIED=35;\nZmTag.ID_FORWARDED=36;\nZmTag.ID_ATTACHED=37;\nZmTag.createFromJs=function(h,d,i,g,f){var j;\nvar a=ZmOrganizer.normalizeId(d.id);\nif(a<ZmOrganizer.FIRST_USER_ID[ZmOrganizer.TAG]){return\n}j=i.getById(d.id);\nif(j){return j\n}var b={id:d.id,name:d.name,color:ZmTag.checkColor(d.color),rgb:d.rgb,parent:h,tree:i,numUnread:d.u,account:f};\nj=new ZmTag(b);\nvar e=g?ZmOrganizer.getSortIndex(j,ZmTag.sortCompare):null;\nh.children.add(j,e);\nvar c=h.getTagNameMap();\nc[d.name]=j;\nreturn j\n};\nZmTag.createNotLocalTag=function(c){var b=ZmTag.notLocalCache=ZmTag.notLocalCache||[];\nvar a=b[c];\nif(a){return a\n}a=new ZmTag({notLocal:true,id:\"notLocal_\"+c,name:c});\nb[c]=a;\nreturn a\n};\nZmTag.sortCompare=function(c,b){var a=ZmOrganizer.checkSortArgs(c,b);\nif(a!=null){return a\n}if(c.name.toLowerCase()>b.name.toLowerCase()){return 1\n}if(c.name.toLowerCase()<b.name.toLowerCase()){return -1\n}return 0\n};\nZmTag.checkName=function(a){var b=ZmOrganizer.checkName(a);\nif(b){return b\n}if(a.indexOf(\"\\\\\")==0){return AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(a))\n}return null\n};\nZmTag.checkColor=function(a){a=Number(a);\nreturn((a!=null)&&(a>=0&&a<=ZmOrganizer.MAX_COLOR))?a:ZmOrganizer.DEFAULT_COLOR[ZmOrganizer.TAG]\n};\nZmTag.getIcon=function(a){var b={getIcon:ZmTag.prototype.getIcon,getColor:ZmTag.prototype.getColor,color:a};\nif(String(a).match(/^#/)){b.rgb=a;\nb.color=null\n}return ZmTag.prototype.getIconWithColor.call(b)\n};\nZmTag.create=function(c){var b={_jsns:\"urn:zimbraMail\"};\nvar d={CreateTagRequest:b};\nb.tag={name:c.name};\nif(c.rgb){b.tag.rgb=c.rgb\n}else{b.tag.color=ZmOrganizer.checkColor(c.color)||ZmOrganizer.DEFAULT_COLOR[ZmOrganizer.TAG]\n}var a=new AjxCallback(null,ZmTag._handleErrorCreate,c);\nappCtxt.getAppController().sendRequest({jsonObj:d,asyncMode:true,errorCallback:a,accountName:c.accountName})\n};\nZmTag._handleErrorCreate=function(d,b){if(b.code==ZmCsfeException.MAIL_INVALID_NAME){var c=AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(d.name));\nvar a=appCtxt.getMsgDialog();\na.setMessage(c,DwtMessageDialog.CRITICAL_STYLE);\na.popup();\nreturn true\n}return false\n};\nZmTag.prototype.getIcon=function(){if(this.notLocal){return\"TagShared\"\n}return(this.id==ZmOrganizer.ID_ROOT)?null:\"Tag\"\n};\nZmTag.prototype.getTagNameMap=function(){if(!this.tagNameMap){this.tagNameMap={}\n}return this.tagNameMap\n};\nZmTag.prototype.createQuery=function(){return['tag:\"',this.name,'\"'].join(\"\")\n};\nZmTag.prototype.getToolTip=function(){};\nZmTag.prototype.notifyCreate=function(a){var b=ZmTag.createFromJs(this,a,this.tree,true);\nb._notify(ZmEvent.E_CREATE)\n};\nZmTag.prototype.notifyModify=function(b){if(b.name){var a=this.name;\nvar c=this.parent.getTagNameMap();\ndelete c[a];\nc[b.name]=this\n}ZmOrganizer.prototype.notifyModify.call(this,b)\n};\nZmTag.prototype.notifyDelete=function(){var a=this.parent.getTagNameMap();\ndelete a[this.name];\nZmOrganizer.prototype.notifyDelete.call(this)\n};\nZmTag.prototype.supportsSharing=function(){return false\n};\nZmTag.prototype.getByNameOrRemote=function(b){var c=this.getTagNameMap();\nvar a=c[b];\nif(a){return a\n}return ZmTag.createNotLocalTag(b)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmTree\")){ZmTree=function(a){if(arguments.length==0){return\n}ZmModel.call(this,a);\nthis.type=a;\nthis.root=null\n};\nZmTree.prototype=new ZmModel;\nZmTree.prototype.constructor=ZmTree;\nZmTree.prototype.toString=function(){return\"ZmTree\"\n};\nZmTree.prototype.asString=function(){return this.root?this._asString(this.root,\"\"):\"\"\n};\nZmTree.prototype.getById=function(a){return this.root?this.root.getById(a):null\n};\nZmTree.prototype.getByName=function(a){return this.root?this.root.getByName(a):null\n};\nZmTree.prototype.getFolderTypeByName=function(b){var d=b.toLowerCase();\nvar l=appCtxt.getTree(ZmOrganizer.FOLDER).asList();\nvar h;\nvar g;\nfor(g=0;\ng<l.length;\ng++){var m=l[g].name;\nif(d==m.toLowerCase()){return l[g].type\n}}var a=ZmApp.APPS;\nfor(g=0;\ng<a.length;\ng++){var c=appCtxt.getApp(a[g]);\nvar k=c&&c._deferredFolders;\nif(!k){continue\n}var e;\nfor(e=0;\ne<k.length;\ne++){var f=k[e];\nvar m=f.obj&&f.obj.name;\nif(d==m.toLowerCase()){return f.type\n}}}h=ZmOrganizer.FOLDER;\nreturn h\n};\nZmTree.prototype.getByType=function(a){return this.root?this.root.getByType(a):null\n};\nZmTree.prototype.size=function(){return this.root?this.root.size():0\n};\nZmTree.prototype.reset=function(){this.root=null\n};\nZmTree.prototype.asList=function(a){var b=[];\nreturn this.root?this._addToList(this.root,b,a):b\n};\nZmTree.prototype.getUnreadHash=function(a){if(!a){a={}\n}return this.root?this._getUnreadHash(this.root,a):a\n};\nZmTree.prototype._addToList=function(a,g,b){var f=b&&b.includeRemote;\nvar h=b&&b.remoteOnly;\nvar e=a.isRemote();\nif((!e&&!h)||(e&&(h||f))){g.push(a)\n}var d=a.children.getArray();\nfor(var c=0;\nc<d.length;\nc++){this._addToList(d[c],g,b)\n}return g\n};\nZmTree.prototype._asString=function(a,d){if(a.id){d=d+a.id\n}var c=a.children.clone().getArray();\nif(c.length){c.sort(function(f,e){return f.id-e.id\n});\nd=d+\"[\";\nfor(var b=0;\nb<c.length;\nb++){if(c[b].id==ZmFolder.ID_TAGS){continue\n}if(b>0){d=d+\",\"\n}d=this._asString(c[b],d)\n}d=d+\"]\"\n}return d\n};\nZmTree.prototype._getUnreadHash=function(a,b){b[a.id]=a.numUnread;\nvar d=a.children.getArray();\nfor(var c=0;\nc<d.length;\nc++){this._getUnreadHash(d[c],b)\n}return b\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmTagTree\")){ZmTagTree=function(a){ZmTree.call(this,ZmOrganizer.TAG);\nvar b=(a)?([a.id,ZmTag.ID_ROOT].join(\":\")):ZmTag.ID_ROOT;\nthis.root=new ZmTag({id:b,tree:this})\n};\nZmTagTree.prototype=new ZmTree;\nZmTagTree.prototype.constructor=ZmTagTree;\nZmTagTree.COLOR_LIST=[ZmOrganizer.C_BLUE,ZmOrganizer.C_CYAN,ZmOrganizer.C_GREEN,ZmOrganizer.C_PURPLE,ZmOrganizer.C_RED,ZmOrganizer.C_YELLOW,ZmOrganizer.C_PINK,ZmOrganizer.C_GRAY,ZmOrganizer.C_ORANGE];\nZmTagTree.prototype.toString=function(){return\"ZmTagTree\"\n};\nZmTagTree.prototype.loadFromJs=function(c,d,e){if(!c||!c.tag||!c.tag.length){return\n}for(var b=0;\nb<c.tag.length;\nb++){ZmTag.createFromJs(this.root,c.tag[b],this,null,e)\n}var a=this.root.children.getArray();\nif(a.length){a.sort(ZmTag.sortCompare)\n}};\nZmTagTree.prototype.getByIndex=function(a){var b=this.asList();\nif(b&&b.length&&(a<b.length)){return b[a]\n}};\nZmTagTree.prototype.reset=function(){this.root=new ZmTag({id:ZmTag.ID_ROOT,tree:this})\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmFolderTree\")){ZmFolderTree=function(a){ZmTree.call(this,a)\n};\nZmFolderTree.prototype=new ZmTree;\nZmFolderTree.prototype.constructor=ZmFolderTree;\nZmFolderTree.IS_PARSED={};\nZmFolderTree.prototype.toString=function(){return\"ZmFolderTree\"\n};\nZmFolderTree.prototype.loadFromJs=function(c,a,b){this.root=(a==\"zimlet\")?ZmZimlet.createFromJs(null,c,this):ZmFolderTree.createFromJs(null,c,this,a,null,b)\n};\nZmFolderTree.createFromJs=function(g,k,m,o,n,a){if(!(k&&k.id)){return\n}if(k&&k.owner&&!appCtxt.get(ZmSetting.SHARING_ENABLED)){return\n}var e;\nif(o==\"search\"){var h;\nvar r=k.id.split(\":\");\nif(!r||(r.length<=1)){if(k.types){var l=k.types.split(\",\");\nh=[];\nvar j=appCtxt.get(ZmSetting.MAIL_ENABLED);\nfor(var q=0;\nq<l.length;\nq++){var c=ZmSearch.TYPE_MAP[l[q]];\nif(!c||(!j&&(c==ZmItem.CONV||c==ZmItem.MSG))){continue\n}h.push(c)\n}if(h.length==0){return null\n}}var s={id:k.id,name:k.name,parent:g,tree:m,numUnread:k.u,query:k.query,types:h,sortBy:k.sortBy,account:a,color:k.color,rgb:k.rgb};\ne=new ZmSearchFolder(s);\nZmFolderTree._fillInFolder(e,k,n);\nZmFolderTree._traverse(e,k,m,(n||[]),o,a)\n}}else{var c=k.view?(ZmOrganizer.TYPE[k.view]):(g?g.type:ZmOrganizer.FOLDER);\nif(!c){return\n}var p=(k.acl&&k.acl.grant&&k.acl.grant.length>0);\nif(appCtxt.inStartup&&ZmOrganizer.DEFERRABLE[c]&&!appCtxt.isOffline){var f=appCtxt.getApp(ZmOrganizer.APP[c]);\nvar d={type:c,parent:g,obj:k,tree:m,path:n,elementType:o,account:a};\nf.addDeferredFolder(d)\n}else{var b=ZmOrganizer.ORG_PACKAGE[c];\nif(b){AjxDispatcher.require(b)\n}e=ZmFolderTree.createFolder(c,g,k,m,n,o,a);\nif(appCtxt.isExternalAccount()&&e.isSystem()&&e.id!=ZmOrganizer.ID_ROOT){return\n}ZmFolderTree._traverse(e,k,m,(n||[]),o,a)\n}}return e\n};\nZmFolderTree.createAllDeferredFolders=function(){var a=appCtxt.getAppController();\nfor(var b in ZmApp.ORGANIZER){var c=a.getApp(b);\nc.createDeferred()\n}};\nZmFolderTree._traverse=function(a,e,n,m,j,h){var c=(a.nId==ZmOrganizer.ID_ROOT);\nif(j===\"hab\"){e.folder=e.habGroup\n}if(e.folder&&e.folder.length){if(!c){m.push(e.name)\n}for(var f=0;\nf<e.folder.length;\nf++){var g=e.folder[f];\nvar d=ZmFolderTree.createFromJs(a,g,n,(j||\"folder\"),m,h);\nif(a&&d){a.children.add(d)\n}}if(!c){m.pop()\n}}if(e.search&&e.search.length){if(!c){m.push(e.name)\n}for(var f=0;\nf<e.search.length;\nf++){var l=e.search[f];\nvar b=ZmFolderTree.createFromJs(a,l,n,\"search\",m,h);\nif(b){a.children.add(b)\n}}if(!c){m.pop()\n}}if(e.link&&e.link.length){for(var f=0;\nf<e.link.length;\nf++){var k=e.link[f];\nvar d=ZmFolderTree.createFromJs(a,k,n,\"link\",m,h);\nif(d){a.children.add(d)\n}}}};\nZmFolderTree.createFolder=function(type,parent,obj,tree,path,elementType,account){var orgClass=eval(ZmOrganizer.ORG_CLASS[type]);\nif(!orgClass){return null\n}var params={id:obj.id,name:obj.name,parent:parent,tree:tree,color:obj.color,rgb:obj.rgb,owner:obj.owner,oname:obj.oname,zid:obj.zid,rid:obj.rid,restUrl:obj.rest,url:obj.url,numUnread:obj.u,numTotal:obj.n,sizeTotal:obj.s,perm:obj.perm,link:elementType==\"link\",broken:obj.broken,account:account,webOfflineSyncDays:obj.webOfflineSyncDays,retentionPolicy:obj.retentionPolicy};\nif(elementType==\"hab\"){params.name=obj._attrs?obj._attrs.displayName:obj.name;\nparams.mail=obj._attrs?obj._attrs.mail:undefined\n}var folder=new orgClass(params);\nZmFolderTree._fillInFolder(folder,obj,path);\nZmFolderTree.IS_PARSED[type]=true;\nreturn folder\n};\nZmFolderTree._fillInFolder=function(a,c,b){if(b&&b.length){a.path=b.join(\"/\")\n}if(c.f&&a._parseFlags){a._parseFlags(c.f)\n}a._setSharesFromJs(c)\n};\nZmFolderTree.prototype.getByType=function(a){return this.root?this.root.getByType(a):null\n};\nZmFolderTree.prototype.getByPath=function(b,a){return this.root?this.root.getByPath(b,a):null\n};\nZmFolderTree.prototype.handleNoSuchFolderError=function(a,g,j){var h=this.getByType(a);\nvar c;\nvar f=false;\nif(h){for(var e=0;\ne<h.length;\ne++){if((h[e].zid==g)&&(h[e].rid==j)){h[e].noSuchFolder=true;\nif(!c){var d=appCtxt.getAppController().getOverviewId();\nc=appCtxt.getOverviewController().getTreeView(d,a)\n}var b=c.getTreeItemById(h[e].id);\nb.setText(h[e].getName(true));\nthis.handleDeleteNoSuchFolder(h[e]);\nf=true\n}}}return f\n};\nZmFolderTree.prototype.handleDeleteNoSuchFolder=function(a){var b=appCtxt.getYesNoMsgDialog();\nb.reset();\nb.registerCallback(DwtDialog.YES_BUTTON,this._deleteOrganizerYesCallback,this,[a,b]);\nb.registerCallback(DwtDialog.NO_BUTTON,appCtxt.getAppController()._clearDialog,this,b);\nvar c=AjxMessageFormat.format(ZmMsg.confirmDeleteMissingFolder,AjxStringUtil.htmlEncode(a.getName(false,0,true)));\nb.setMessage(c,DwtMessageDialog.WARNING_STYLE);\nb.popup()\n};\nZmFolderTree.prototype._deleteOrganizerYesCallback=function(a,b){a._delete();\nappCtxt.getAppController()._clearDialog(b)\n};\nZmFolderTree.prototype.getPermissions=function(g){var e=g.folderIds||this._getItemsWithoutPerms(g.type);\nif(e.length>0){var d=AjxSoapDoc.create(\"BatchRequest\",\"urn:zimbra\");\nd.setMethodAttribute(\"onerror\",\"continue\");\nvar f=d.getDoc();\nfor(var c=0;\nc<e.length;\nc++){var b=d.set(\"GetFolderRequest\",null,null,\"urn:zimbraMail\");\nvar a=f.createElement(\"folder\");\na.setAttribute(\"l\",e[c]);\nb.appendChild(a)\n}var h=new AjxCallback(this,this._handleResponseGetShares,[g.callback,g.skipNotify]);\nappCtxt.getRequestMgr().sendRequest({soapDoc:d,asyncMode:true,callback:h,noBusyOverlay:g.noBusyOverlay,accountName:g.accountName})\n}else{if(g.callback){g.callback.run()\n}}};\nZmFolderTree.prototype._getItemsWithoutPerms=function(e){var f=[];\nvar d=e?[e]:[ZmOrganizer.FOLDER,ZmOrganizer.CALENDAR,ZmOrganizer.TASKS,ZmOrganizer.BRIEFCASE,ZmOrganizer.ADDRBOOK];\nfor(var b=0;\nb<d.length;\nb++){var g=d[b];\nif(!ZmFolderTree.IS_PARSED[g]){continue\n}var a=this.getByType(g);\nfor(var c=0;\nc<a.length;\nc++){if(a[c].link&&a[c].shares==null){f.push(a[c].id)\n}}}return f\n};\nZmFolderTree.prototype._handleResponseGetShares=function(h,d,l){var k=l.getResponse().BatchResponse;\nthis._handleErrorGetShares(k);\nvar a=k.GetFolderResponse;\nif(a){for(var c=0;\nc<a.length;\nc++){var e=a[c].link?a[c].link[0]:null;\nif(e){var f=appCtxt.getById(e.id);\nif(f){f.perm=e.perm;\nif(e.n){f.numTotal=e.n\n}if(e.u){f.numUnread=e.u\n}f._setSharesFromJs(e)\n}if(e.folder&&e.folder.length>0){var g=appCtxt.getById(e.id);\nif(g){for(var b=0;\nb<e.folder.length;\nb++){if(appCtxt.getById(e.folder[b].id)){continue\n}g.notifyCreate(e.folder[b],\"link\",d)\n}}}}}}if(h){h.run()\n}};\nZmFolderTree.prototype._handleErrorGetShares=function(j){var e=j.Fault;\nif(e){var c=[];\nvar b=[];\nfor(var d=0,a=e.length;\nd<a;\nd++){var g=ZmCsfeCommand.faultToEx(e[d]);\nif(g.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER){var h=g.data.itemId[0];\nvar f=h.lastIndexOf(\":\");\nb.push(h.substring(0,f));\nc.push(h.substring(f+1,h.length))\n}}if(b.length){this._markNoSuchFolder(b,c)\n}}};\nZmFolderTree.prototype._markNoSuchFolder=function(b,e){var f=appCtxt.getFolderTree();\nvar a=f&&f.root?f.root.children.getArray():null;\nfor(var d=0;\nd<a.length;\nd++){for(var c=0;\nc<e.length;\nc++){if((a[d].zid==b[c])&&(a[d].rid==e[c])){a[d].noSuchFolder=true\n}}}};\nZmFolderTree.prototype._sortFolder=function(c){var b=c.children;\nif(b&&b.length){b.sort(ZmFolder.sortCompare);\nfor(var a=0;\na<b.length;\na++){this._sortFolder(b[a])\n}}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmList\")){ZmList=function(b,a){if(arguments.length==0){return\n}ZmModel.call(this,b);\nthis.type=b;\nthis.search=a;\nthis._vector=new AjxVector();\nthis._hasMore=false;\nthis._idHash={};\nvar c=appCtxt.getTagTree();\nif(c){this._tagChangeListener=new AjxListener(this,this._tagTreeChangeListener);\nc.addChangeListener(this._tagChangeListener)\n}this.id=\"LIST\"+ZmList.NEXT++;\nappCtxt.cacheSet(this.id,this)\n};\nZmList.prototype=new ZmModel;\nZmList.prototype.constructor=ZmList;\nZmList.prototype.isZmList=true;\nZmList.prototype.toString=function(){return\"ZmList\"\n};\nZmList.NEXT=1;\nZmList.ITEM_CLASS={};\nZmList.NODE={};\nZmList.ITEM_TYPE={};\nZmList.CHUNK_SIZE=100;\nZmList.CHUNK_PAUSE=500;\nZmList.prototype.get=function(a){return this._vector.get(a)\n};\nZmList.prototype.add=function(b,a){this._vector.add(b,a);\nif(b.id){this._idHash[b.id]=b\n}};\nZmList.prototype.remove=function(a){this._vector.remove(a);\nif(a.id){delete this._idHash[a.id]\n}};\nZmList.prototype.create=function(args){var item;\nvar obj=eval(ZmList.ITEM_CLASS[this.type]);\nif(obj){item=new obj(this);\nitem.create(args)\n}return item\n};\nZmList.prototype.size=function(){return this._vector.size()\n};\nZmList.prototype.indexOf=function(a){return this._vector.indexOf(a)\n};\nZmList.prototype.hasMore=function(){return this._hasMore\n};\nZmList.prototype.setHasMore=function(a){this._hasMore=a\n};\nZmList.prototype.getArray=function(){return this._vector.getArray()\n};\nZmList.prototype.getVector=function(){return this._vector\n};\nZmList.prototype.getById=function(a){return this._idHash[a]\n};\nZmList.prototype.clear=function(){var b=this.getArray();\nfor(var c=0;\nc<b.length;\nc++){b[c].clear()\n}this._evtMgr.removeAll(ZmEvent.L_MODIFY);\nthis._vector.removeAll();\nfor(var d in this._idHash){this._idHash[d]=null\n}this._idHash={}\n};\nZmList.prototype.set=function(respNode){this.clear();\nvar nodes=respNode.childNodes;\nvar args={list:this};\nfor(var i=0;\ni<nodes.length;\ni++){var node=nodes[i];\nif(node.nodeName==ZmList.NODE[this.type]){if(parseInt(node.getAttribute(\"l\"))==ZmFolder.ID_TRASH&&(this.type!=ZmItem.CONTACT)){continue\n}var obj=eval(ZmList.ITEM_CLASS[this.type]);\nif(obj){this.add(obj.createFromDom(node,args))\n}}}};\nZmList.prototype.addFromDom=function(node,args){args=args||{};\nargs.list=this;\nvar obj=eval(ZmList.ITEM_CLASS[this.type]);\nif(obj){this.add(obj.createFromDom(node,args))\n}};\nZmList.prototype.getSubList=function(d,c){var e=null;\nvar b=(d+c>this.size())?this.size():d+c;\nvar a=this.getArray();\nif(d<b){e=AjxVector.fromArray(a.slice(d,b))\n}return e\n};\nZmList.prototype.cache=function(e,b){this.getVector().merge(e,b);\nvar d=b.getArray();\nfor(var a=0;\na<d.length;\na++){var c=d[a];\nc.list=this;\nif(c.id){this._idHash[c.id]=c\n}}};\nZmList.prototype.flagItems=function(c){c=Dwt.getParams(arguments,[\"items\",\"op\",\"value\",\"callback\"]);\nc.items=AjxUtil.toArray(c.items);\nif(c.op==\"update\"){c.action=c.op;\nc.attrs={f:c.value}\n}else{c.action=c.value?c.op:\"!\"+c.op\n}if(appCtxt.multiAccounts){var b=this.search.folderId;\nvar a=b&&appCtxt.getById(b);\nif(a&&a.isRemote()){c.accountName=c.items[0].getAccount().name\n}}this._itemAction(c)\n};\nZmList.prototype.tagItems=function(f){f=Dwt.getParams(arguments,[\"items\",\"tagId\",\"doTag\"]);\nvar d=f.tagName||(f.tag&&f.tag.name);\nvar b=AjxUtil.toArray(f.items);\nvar a=[],g=f.doTag;\nif(b[0]&&b[0] instanceof ZmItem){for(var c=0;\nc<b.length;\nc++){var e=b[c];\nif((g&&(!e.hasTag(d)||e.type==ZmItem.CONV))||(!g&&e.hasTag(d))){a.push(e)\n}}}else{a=b\n}f.items=a;\nf.attrs={tn:d};\nf.action=g?\"tag\":\"!tag\";\nf.actionTextKey=g?\"actionTag\":\"actionUntag\";\nf.actionArg=f.tag&&f.tag.name;\nthis._itemAction(f)\n};\nZmList.prototype.removeAllTags=function(e){e=(e&&e.items)?e:{items:e};\nvar b=AjxUtil.toArray(e.items);\nvar a=[];\nif(b[0]&&b[0] instanceof ZmItem){for(var c=0;\nc<b.length;\nc++){var d=b[c];\nif(d.tags&&d.tags.length){a.push(d)\n}}}else{a=b\n}e.items=a;\ne.action=\"update\";\ne.attrs={t:\"\"};\ne.actionTextKey=\"actionRemoveTags\";\nthis._itemAction(e)\n};\nZmList.prototype.moveItems=function(e){e=Dwt.getParams(arguments,[\"items\",\"folder\",\"attrs\",\"callback\",\"errorCallback\",\"finalCallback\",\"noUndo\"]);\nvar c=AjxUtil.hashCopy(e);\nc.items=AjxUtil.toArray(e.items);\nc.attrs=e.attrs||{};\nc.childWin=e.childWin;\nc.closeChildWin=e.closeChildWin;\nif(c.folder.id==ZmFolder.ID_TRASH){c.actionTextKey=\"actionTrash\";\nc.action=\"trash\"\n}else{c.actionTextKey=\"actionMove\";\nc.actionArg=e.folder.getName(false,false,true);\nc.action=\"move\";\nc.attrs.l=e.folder.id\n}c.callback=new AjxCallback(this,this._handleResponseMoveItems,[e]);\nif(e.noToast){c.actionTextKey=null\n}if(appCtxt.multiAccounts){var b=e.items[0].getFolderId&&e.items[0].getFolderId();\nif(!b){var d=e.items[0]&&e.items[0].id;\nb=d&&appCtxt.getById(d)&&appCtxt.getById(d).folderId\n}var a=appCtxt.getById(b);\nif((e.items[0].isDraft&&e.folder.id==ZmFolder.ID_DRAFTS)||(e.folder.isRemote())||(a&&a.isRemote())){c.accountName=e.items[0].getAccount().name\n}}c.errorCallback=e.errorCallback;\nif(this._handleDeleteFromSharedFolder(e,c)){return\n}this._itemAction(c)\n};\nZmList.prototype._handleDeleteFromSharedFolder=function(a,g){if(a.folder&&a.folder.id==ZmFolder.ID_TRASH){var e;\nvar b=[];\nfor(var c=0;\nc<a.items.length;\nc++){var j=a.items[c];\nvar d=j.id.indexOf(\":\");\nif(d!=-1){var h=j.id.substring(0,d);\nif(!appCtxt.accountList.getAccount(h)){e=appCtxt.getById(j.folderId);\nif(e&&!e.isReadOnly()){b.push(j)\n}}}}if(b.length){var f={items:b,folder:a.folder,finalCallback:this._itemAction.bind(this,g,null),actionTextKey:null};\nthis.copyItems(f);\nreturn true\n}}};\nZmList.prototype._handleResponseMoveItems=function(b,j){var e=j.getResponse();\nif(e&&e.length&&(e[0] instanceof ZmItem)){this.moveLocal(e,b.folder.id);\nfor(var c=0;\nc<e.length;\nc++){var g=e[c];\nvar a={oldFolderId:g.folderId};\ng.moveLocal(b.folder.id)\n}var g=e[0];\nif(!g._list[g.list.id]){g._list[g.list.id]=true\n}for(var d in g._list){var h=window.parentAppCtxt||appCtxt;\nvar f=h.getById(d);\nif(!f){continue\n}f._evt.batchMode=true;\nf._evt.item=g;\nf._evt.items=e;\nf._notify(ZmEvent.E_MOVE,a)\n}}if(b.callback){b.callback.run(j)\n}};\nZmList.prototype.copyItems=function(a){a=Dwt.getParams(arguments,[\"items\",\"folder\",\"attrs\",\"actionTextKey\"]);\na.items=AjxUtil.toArray(a.items);\na.attrs=a.attrs||{};\nif(!appCtxt.isExternalAccount()){a.attrs.l=a.folder.id;\na.action=\"copy\";\na.actionTextKey=\"itemCopied\"\n}else{a.action=\"trash\"\n}a.actionArg=a.folder.getName(false,false,true);\na.callback=new AjxCallback(this,this._handleResponseCopyItems,a);\nif(appCtxt.multiAccounts&&a.folder.isRemote()){a.accountName=a.items[0].getAccount().name\n}this._itemAction(a)\n};\nZmList.prototype._handleResponseCopyItems=function(d,a){var c=a.getResponse();\nif(c.length>0){if(d.actionTextKey){var b=AjxMessageFormat.format(ZmMsg[d.actionTextKey],c.length);\nappCtxt.getAppController().setStatusMsg(b)\n}}};\nZmList.prototype.deleteItems=function(d){d=Dwt.getParams(arguments,[\"items\",\"hardDelete\",\"attrs\",\"childWin\"]);\nvar h=d.items=AjxUtil.toArray(d.items);\nvar g=[];\nvar e=[];\nif(d.hardDelete){e=h\n}else{if(h[0]&&h[0] instanceof ZmItem){for(var f=0;\nf<h.length;\nf++){var k=h[f];\nvar b=k.getFolderId();\nvar a=appCtxt.getById(b);\nif(a&&a.isHardDelete()){e.push(k)\n}else{g.push(k)\n}}}else{g=h\n}}if(e.length&&!d.confirmDelete){d.confirmDelete=true;\nvar j=ZmList.prototype.deleteItems.bind(this,d);\nthis._popupDeleteWarningDialog(j,g.length,e.length);\nreturn\n}d.callback=d.childWin&&new AjxCallback(this._handleDeleteNewWindowResponse,d.childWin);\nif(g.length){if(appCtxt.multiAccounts){var c=this._filterItemsByAccount(g);\nif(!d.callback){d.callback=new AjxCallback(this,this._deleteAccountItems,[c,d])\n}this._deleteAccountItems(c,d)\n}else{d.items=g;\nd.folder=appCtxt.getById(ZmFolder.ID_TRASH);\nthis.moveItems(d)\n}}if(e.length){d.items=e;\nd.action=\"delete\";\nd.actionTextKey=\"actionDelete\";\nthis._itemAction(d)\n}};\nZmList.prototype._popupDeleteWarningDialog=function(d,b,c){var a=appCtxt.getOkCancelMsgDialog();\na.reset();\na.setMessage(AjxMessageFormat.format(ZmMsg[b?\"confirmDeleteSomeForever\":\"confirmDeleteForever\"],[c]),DwtMessageDialog.WARNING_STYLE);\na.registerCallback(DwtDialog.OK_BUTTON,this._deleteWarningDialogListener.bind(this,d,a));\na.associateEnterWithButton(DwtDialog.OK_BUTTON);\na.popup(null,DwtDialog.OK_BUTTON)\n};\nZmList.prototype._deleteWarningDialogListener=function(b,a){a.popdown();\nb()\n};\nZmList.prototype._deleteAccountItems=function(d,e){var a;\nfor(var b in d){a=d[b];\nbreak\n}if(a){delete d[b];\nvar c=window.parentAppCtxt||window.appCtxt;\ne.accountName=c.accountList.getAccount(b).name;\ne.items=a;\ne.folder=appCtxt.getById(ZmFolder.ID_TRASH);\nthis.moveItems(e)\n}};\nZmList.prototype._filterItemsByAccount=function(a){var e={};\nif(a[0]&&a[0] instanceof ZmItem){for(var c=0;\nc<a.length;\nc++){var d=a[c];\nvar b=d.getAccount().id;\nif(!e[b]){e[b]=[]\n}e[b].push(d)\n}}else{var f=appCtxt.accountList.mainAccount.id;\ne[f]=a\n}return e\n};\nZmList.prototype._handleDeleteNewWindowResponse=function(b,a){if(b){b.close()\n}};\nZmList.prototype.modifyItem=function(b,a,c){b.modify(a,c)\n};\nZmList.prototype.notifyCreate=function(node){var obj=eval(ZmList.ITEM_CLASS[this.type]);\nif(obj){var item=obj.createFromDom(node,{list:this});\nthis.add(item,this._sortIndex(item));\nthis.createLocal(item);\nthis._notify(ZmEvent.E_CREATE,{items:[item]})\n}};\nZmList.prototype.modifyLocal=function(a,b){};\nZmList.prototype.createLocal=function(a){};\nZmList.prototype.flagLocal=function(b,a,c){};\nZmList.prototype.tagLocal=function(b,a,c){};\nZmList.prototype.removeAllTagsLocal=function(a){};\nZmList.prototype.deleteLocal=function(a){for(var b=0;\nb<a.length;\nb++){this.remove(a[b])\n}};\nZmList.prototype.moveLocal=function(b,a){for(var c=0;\nc<b.length;\nc++){this.remove(b[c])\n}};\nZmList.prototype._itemAction=function(q,i){var h=this._getIds(q.items);\nvar p=h.hash;\nvar k=h.list;\nif(!(k&&k.length)){if(q.callback){q.callback.run(new ZmCsfeResult([]))\n}if(q.finalCallback){q.finalCallback(q)\n}return\n}var c;\nif(q.items.length==1&&q.items[0]&&q.items[0].type){c=q.items[0].type\n}else{c=this.type\n}if(!c){return\n}if(!q.accountName&&appCtxt.multiAccounts){q.accountName=appCtxt.accountList.mainAccount.name\n}var n=ZmItem.SOAP_CMD[c]+\"Request\";\nvar s=i?i._useJson:true;\nvar d,m;\nif(s){d={};\nvar b=this._getActionNamespace();\nd[n]={_jsns:b};\nvar m=d[n].action={};\nm.op=q.action;\nfor(var l in q.attrs){m[l]=q.attrs[l]\n}}else{d=AjxSoapDoc.create(n,this._getActionNamespace());\nm=d.set(\"action\");\nm.setAttribute(\"op\",q.action);\nfor(var l in q.attrs){m.setAttribute(l,q.attrs[l])\n}}var r=window.parentAppCtxt||appCtxt;\nvar g=r.getActionController();\nvar f=!q.noUndo&&(this.type!=ZmItem.CONV||this.search&&this.search.folderId);\nvar j=(f&&g&&g.actionPerformed({op:q.action,ids:k,attrs:q.attrs}))||null;\nvar a=new AjxCallback(this,this._handleResponseItemAction,[q.callback,j]);\nvar o={ids:k,idHash:p,accountName:q.accountName,request:d,action:m,type:c,callback:a,finalCallback:q.finalCallback,errorCallback:q.errorCallback,batchCmd:i,numItems:q.count||0,actionTextKey:q.actionTextKey,actionArg:q.actionArg,actionLogItem:j,childWin:q.childWin,closeChildWin:q.closeChildWin,safeMove:q.safeMove};\nif(k.length>=ZmList.CHUNK_SIZE){var e={state:ZmListController.PROGRESS_DIALOG_INIT,callback:new AjxCallback(this,this._cancelAction,[o])};\nZmListController.handleProgress(e)\n}this._doAction(o)\n};\nZmList.prototype._handleResponseItemAction=function(d,c,b,a){if(c){c.setComplete()\n}if(d){a.set(b);\nd.run(a)\n}};\nZmList.prototype._doAction=function(d){var f=d.ids.splice(0,ZmList.CHUNK_SIZE);\nvar e=f.join(\",\");\nvar b=true;\nif(d.action.setAttribute){d.action.setAttribute(\"id\",e);\nb=false\n}else{d.action.id=e\n}var g=Boolean(d.ids.length&&!d.cancelled);\nvar i=new AjxCallback(this,this._handleResponseDoAction,[d]);\nvar c=this.controller&&this.controller.isOutboxFolder();\nvar a=this._handleOfflineResponseDoAction.bind(this,d,c);\nif(d.batchCmd){d.batchCmd.addRequestParams(d.request,i,d.errorCallback)\n}else{var h={asyncMode:true,callback:i,errorCallback:d.errorCallback,offlineCallback:a,accountName:d.accountName,more:g};\nif(b){h.jsonObj=d.request\n}else{h.soapDoc=d.request\n}if(d.safeMove){h.useChangeToken=true\n}if(c){h.offlineRequest=true\n}d.reqId=appCtxt.getAppController().sendRequest(h)\n}};\nZmList.prototype._handleResponseDoAction=function(b,k){var f;\nvar d=k.getResponse();\nvar c=d[ZmItem.SOAP_CMD[b.type]+\"Response\"];\nif(c&&c.action){var a=c.action.id.split(\",\");\nif(a){var g=[];\nfor(var e=0;\ne<a.length;\ne++){var j=b.idHash[a[e]];\nif(j){g.push(j)\n}}b.numItems+=g.length;\nif(b.callback){b.callback.run(g,k)\n}if(b.actionTextKey){f=ZmList.getActionSummary(b);\nvar h={state:ZmListController.PROGRESS_DIALOG_UPDATE,summary:f};\nZmListController.handleProgress(h)\n}}}if(b.ids.length&&!b.cancelled){AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._doAction,[b]),ZmItem.CHUNK_PAUSE)\n}else{b.reqId=null;\nb.actionSummary=f;\nif(b.finalCallback){b.finalCallback(b)\n}else{ZmListController.handleProgress({state:ZmListController.PROGRESS_DIALOG_CLOSE});\nZmBaseController.showSummary(b.actionSummary,b.actionLogItem,b.closeChildWin)\n}}};\nZmList.prototype._handleOfflineResponseDoAction=function(f,d,c){var b=f.action,g=this._handleOfflineResponseDoActionCallback.bind(this,f,d,c.callback);\nif(d&&b.op===\"trash\"){var a={methodName:\"SendMsgRequest\",id:b.id.split(\",\")};\nZmOfflineDB.deleteItemInRequestQueue(a,g)\n}else{var e=c.jsonObj;\ne.methodName=ZmItem.SOAP_CMD[f.type]+\"Request\";\ne.id=b.id;\nZmOfflineDB.setItem(e,ZmOffline.REQUESTQUEUE,g)\n}};\nZmList.prototype._handleOfflineResponseDoActionCallback=function(e,d,h){var c={},g=this._generateOfflineHeader(e),a,f,b;\nc[ZmItem.SOAP_CMD[e.type]+\"Response\"]=e.request[ZmItem.SOAP_CMD[e.type]+\"Request\"];\na=new ZmCsfeResult(c,false,g);\nf=a.getHeader();\nif(h){h.run(a)\n}if(f){b=f.context.notify[0];\nif(b){appCtxt._requestMgr._notifyHandler(b);\nthis._updateOfflineData(e,d,b)\n}}};\nZmList.prototype._generateOfflineHeader=function(u){var p=u.action,g=p.op,o=p.id.split(\",\"),l=o.length,k,d,e,a,f,v,b,j,s,n=[],t=[],h=[],r;\nfor(var q=0;\nq<l;\nq++){k=o[q];\nd=this.getById(k);\ne=d.flags||\"\";\na=d.getFolderId();\nf=appCtxt.getById(a);\nb={id:k};\nj={id:\"-\"+b.id};\ns={id:a};\nswitch(g){case\"flag\":b.f=e+\"f\";\nbreak;\ncase\"!flag\":b.f=e.replace(\"f\",\"\");\nbreak;\ncase\"read\":b.f=e.replace(\"u\",\"\");\ns.u=f.numUnread-1;\nbreak;\ncase\"!read\":b.f=e+\"u\";\ns.u=f.numUnread+1;\nbreak;\ncase\"trash\":b.l=ZmFolder.ID_TRASH;\nbreak;\ncase\"spam\":b.l=ZmFolder.ID_SPAM;\nbreak;\ncase\"!spam\":b.l=ZmFolder.ID_INBOX;\nbreak;\ncase\"move\":if(p.l){b.l=p.l\n}s.n=f.numTotal-1;\nif(d.isUnread&&f.numUnread>1){s.u=f.numUnread-1\n}v=appCtxt.getById(b.l);\nh.push({id:v.id,n:v.numTotal+1,u:(d.isUnread?v.numUnread+1:v.numUnread)});\nbreak;\ncase\"tag\":d.tags.push(p.tn);\nb.tn=d.tags.join();\nbreak;\ncase\"!tag\":AjxUtil.arrayRemove(d.tags,p.tn);\nb.tn=d.tags.join();\nbreak;\ncase\"update\":if(p.t===\"\"){b.tn=\"\";\nb.t=\"\"\n}break\n}n.push(b);\nt.push(j);\nh.push(s)\n}r={context:{notify:[{modified:{m:n,c:t,folder:h}}]}};\nreturn r\n};\nZmList.prototype._updateOfflineData=function(e,d,c){var b=c.modified;\nif(!b){return\n}var a=b.m;\nif(!a){return\n}var f=this._updateOfflineDataCallback.bind(this,e,a);\nZmOfflineDB.getItem(e.action.id.split(\",\"),ZmApp.MAIL,f)\n};\nZmList.prototype._updateOfflineDataCallback=function(d,b,a){a=ZmOffline.recreateMsg(a);\nvar c=[];\na.forEach(function(e){b.forEach(function(f){if(f.id===e.id){c.push($.extend(e,f))\n}})\n});\nZmOfflineDB.setItem(c,ZmApp.MAIL)\n};\nZmList.getActionSummary=function(b){var h=b.type,i=ZmItem.MSG_KEY[h],f=ZmMsg[i],g=AjxStringUtil.capitalizeFirstLetter(i),c=\"type\"+g,e=b.numItems,d=b.actionTextKey+g,j=ZmMsg[d]||ZmMsg[b.actionTextKey],a=ZmMsg[c],l=AjxStringUtil.htmlEncode(b.actionArg),m=a?AjxMessageFormat.format(a,e):f,k=a?AjxMessageFormat.format(ZmMsg[c],1):f;\nreturn AjxMessageFormat.format(j,[e,m,l,k])\n};\nZmList.prototype._cancelAction=function(a){a.cancelled=true;\nif(a.reqId){appCtxt.getRequestMgr().cancelRequest(a.reqId)\n}if(a.finalCallback){a.finalCallback(a)\n}ZmListController.handleProgress({state:ZmListController.PROGRESS_DIALOG_CLOSE})\n};\nZmList.prototype._getTypedItems=function(b){var a={};\nfor(var c=0;\nc<b.length;\nc++){var d=b[c].type;\nif(!a[d]){a[d]=[]\n}a[d].push(b[c])\n}return a\n};\nZmList.prototype._getIds=function(e){var d={};\nif(e instanceof ZmItem){e=[e]\n}var b=[];\nif((e&&e.length)){for(var a=0;\na<e.length;\na++){var c=e[a];\nvar f=c.id;\nif(f){b.push(f);\nd[f]=c\n}}}return{hash:d,list:b}\n};\nZmList.prototype._sortIndex=function(a){return 0\n};\nZmList.prototype._redoSearch=function(a){var b=appCtxt.getSearchController();\nb.redoSearch(a._currentSearch)\n};\nZmList.prototype._getActionNamespace=function(){return\"urn:zimbraMail\"\n};\nZmList.prototype._folderTreeChangeListener=function(f){if(f.type!=ZmEvent.S_FOLDER){return\n}var e=f.getDetail(\"organizers\")[0];\nvar d=f.getDetail(\"fields\");\nvar c=appCtxt.getCurrentController();\nvar b=(appCtxt.getCurrentList()==this);\nif(f.event==ZmEvent.E_DELETE&&(f.source instanceof ZmFolder)&&f.source.id==ZmFolder.ID_TRASH){var a=c.getListView&&c.getListView();\nif(a){a.offset=0\n}c._resetNavToolBarButtons(view)\n}else{if(b&&c&&c._currentSearch&&(f.event==ZmEvent.E_MOVE||(f.event==ZmEvent.E_MODIFY)&&d&&d[ZmOrganizer.F_NAME])){if(c._currentSearch.replaceFolderTerm(f.getDetail(\"oldPath\"),e.getPath())){appCtxt.getSearchController().setSearchField(c._currentSearch.query)\n}}}};\nZmList.prototype._tagTreeChangeListener=function(m){if(m.type!=ZmEvent.S_TAG){return\n}var s=m.getDetail(\"organizers\")[0];\nvar g=m.getDetail(\"fields\");\nvar p=appCtxt.getCurrentController();\nif(!p){return\n}var n=this.getArray();\nif((m.event==ZmEvent.E_MODIFY)&&g&&g[ZmOrganizer.F_NAME]){var c=m.getDetail(\"oldName\");\nif(p._currentSearch&&p._currentSearch.hasTagTerm(c)){p._currentSearch.replaceTagTerm(c,s.getName());\nappCtxt.getSearchController().setSearchField(p._currentSearch.query)\n}var k=s.name;\nfor(var f=0;\nf<n.length;\nf++){var q=n[f];\nif(!q||!q.isZmItem||!q.hasTag(c)){continue\n}if(q.isShared()){continue\n}var h=q.tagHash;\nvar r=q.tags;\ndelete h[c];\nh[k]=true;\nfor(var d=0;\nd<r.length;\nd++){if(r[d]==c){r[d]=k;\nbreak\n}}}}else{if(m.event==ZmEvent.E_DELETE){var b=this._evtMgr.isListenerRegistered(ZmEvent.L_MODIFY);\nfor(var f=0;\nf<n.length;\nf++){var q=this.getById(n[f].id);\nif(q){if(q.isShared()){continue\n}if(q.hasTag(s.name)){q.tagLocal(s.name,false);\nif(b){this._notify(ZmEvent.E_TAGS,{items:[q]})\n}}}}if(p._currentSearch&&p._currentSearch.hasTagTerm(s.getName())){var o=appCtxt.getCurrentViewId();\nvar e=appCtxt.getCurrentViewType();\np.enablePagination(false,o);\nvar l=p.getListView&&p.getListView();\nif(l&&l.sortingEnabled){l.sortingEnabled=false\n}if(e==ZmId.VIEW_CONVLIST){p._currentSearch.query=\"is:read is:unread\"\n}p._currentSearch.tagId=null;\nappCtxt.getSearchController().setSearchField(\"\")\n}}}}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmAccountList\")){ZmAccountList=function(){this._accounts={};\nthis._count=0;\nthis.visibleAccounts=[];\nthis.mainAccount=null;\nthis.activeAccount=null;\nthis.defaultAccount=null;\nthis._evtMgr=new AjxEventMgr()\n};\nZmAccountList.prototype.constructor=ZmAccountList;\nZmAccountList.DEFAULT_ID=\"main\";\nZmAccountList.prototype.toString=function(){return\"ZmAccountList\"\n};\nZmAccountList.prototype.size=function(a){return(a)?this._count:this.visibleAccounts.length\n};\nZmAccountList.prototype.add=function(a){this._accounts[a.id]=a;\nthis._count++;\nif(a.visible||a.id==ZmAccountList.DEFAULT_ID){this.visibleAccounts.push(a)\n}if(a.id==ZmAccountList.DEFAULT_ID){this.mainAccount=a\n}};\nZmAccountList.prototype.getAccounts=function(){return this._accounts\n};\nZmAccountList.prototype.getAccount=function(a){return a?this._accounts[a]:this.mainAccount\n};\nZmAccountList.prototype.getAccountByName=function(a){for(var b in this._accounts){if(this._accounts[b].name==a){return this._accounts[b]\n}}return null\n};\nZmAccountList.prototype.getAccountByEmail=function(a){for(var b in this._accounts){if(this._accounts[b].getEmail()==a){return this._accounts[b]\n}}return null\n};\nZmAccountList.prototype.getItemCount=function(a,e){var d=0;\nfor(var b=0;\nb<this.visibleAccounts.length;\nb++){var g=this.visibleAccounts[b];\nif(g.isMain){continue\n}var f=ZmOrganizer.getSystemId(a,g);\nvar c=appCtxt.getById(f);\nif(c){d+=(e?c.numUnread:c.numTotal)\n}}return d\n};\nZmAccountList.prototype.generateQuery=function(a,f){var j=f&&f.get(0);\nvar h=[];\nvar g=this.visibleAccounts;\nvar c=a||ZmOrganizer.ID_ROOT;\nvar d=a?\"inid\":\"underid\";\nfor(var e=0;\ne<g.length;\ne++){var k=g[e];\nif((j&&!k.isAppEnabled(ZmItem.APP[j]))||k.isMain){continue\n}var b=[d,':\"',ZmOrganizer.getSystemId(c,k,true),'\"'];\nh.push(b.join(\"\"))\n}if(c==ZmOrganizer.ID_ROOT){h.push([d,':\"',appCtxt.accountList.mainAccount.id,\":\",c,'\"'].join(\"\"))\n}return(h.join(\" OR \"))\n};\nZmAccountList.prototype.loadAccounts=function(b){var a=(new Array()).concat(this.visibleAccounts);\nthis._loadAccount(a,b)\n};\nZmAccountList.prototype._loadAccount=function(b,e){var d=b.shift();\nif(d){var c=new AjxCallback(this,this._loadAccount,[b,e]);\nd.load(c)\n}else{ZmOrganizer.HIDE_EMPTY[ZmOrganizer.TAG]=true;\nZmOrganizer.HIDE_EMPTY[ZmOrganizer.SEARCH]=true;\nfor(var a=0;\na<this.visibleAccounts.length;\na++){if(appCtxt.get(ZmSetting.OFFLINE_SMTP_ENABLED,null,this.visibleAccounts[a])){appCtxt.set(ZmSetting.OFFLINE_COMPOSE_ENABLED,true,null,null,true);\nbreak\n}}if(e){e.run()\n}}};\nZmAccountList.prototype.setActiveAccount=function(b,a){this.activeAccount=b;\nthis._evt=this._evt||new ZmEvent();\nthis._evt.account=b;\nif(!a){this._evtMgr.notifyListeners(\"ACCOUNT\",this._evt)\n}};\nZmAccountList.prototype.addActiveAcountListener=function(b,a){return this._evtMgr.addListener(\"ACCOUNT\",b,a)\n};\nZmAccountList.prototype.isInitialSyncing=function(){for(var a=0;\na<this.visibleAccounts.length;\na++){var b=this.visibleAccounts[a];\nif(b.isMain){continue\n}if(b.isOfflineInitialSync()){return true\n}}return false\n};\nZmAccountList.prototype.isSyncStatus=function(a){for(var b=0;\nb<this.visibleAccounts.length;\nb++){var c=this.visibleAccounts[b];\nif(c.isMain){continue\n}if(c.status==a){return true\n}}return false\n};\nZmAccountList.prototype.accountTypeExists=function(b){for(var a=0;\na<this.visibleAccounts.length;\na++){var c=this.visibleAccounts[a];\nif(b==ZmAccount.TYPE_ZIMBRA&&c.isMain){continue\n}if(c.type==b){return true\n}}return false\n};\nZmAccountList.prototype.syncAll=function(b){var a=(new Array()).concat(this.visibleAccounts);\nthis._sendSync(a,b)\n};\nZmAccountList.prototype._sendSync=function(a,c){var b=a.shift();\nif(b){if(!b.isMain){b.sync()\n}AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._sendSync,[a,c]),500)\n}else{if(c){c.run()\n}}};\nZmAccountList.prototype.createAccounts=function(b,e){var d=appCtxt.accountList.mainAccount;\nd.id=e.id;\nd.name=e.name;\nd.isMain=true;\nd.isZimbraAccount=true;\nd.loaded=true;\nd.visible=true;\nd.settings=b;\nd.type=ZmAccount.TYPE_ZIMBRA;\nd.icon=\"AccountZimbra\";\nd.active=true;\nthis._accounts[d.id]=d;\ndelete this._accounts[ZmAccountList.DEFAULT_ID];\nthis.setActiveAccount(d);\nif(appCtxt.isOffline){d.displayName=ZmMsg.localFolders\n}var c=e.childAccounts&&e.childAccounts.childAccount;\nif(c){for(var a=0;\na<c.length;\na++){this.add(ZmZimbraAccount.createFromDom(c[a]))\n}appCtxt.multiAccounts=this.size()>1;\nappCtxt.isFamilyMbox=appCtxt.multiAccounts&&!appCtxt.isOffline;\nthis.defaultAccount=appCtxt.isFamilyMbox?this.mainAccount:this.visibleAccounts[1]\n}};\nZmAccountList.prototype.resetTrees=function(){for(var b=0;\nb<this.visibleAccounts.length;\nb++){for(var c in trees){var a=trees[c];\nif(a&&a.reset){a.reset()\n}}}};\nZmAccountList.prototype.saveImplicitPrefs=function(){for(var a=0;\na<this.visibleAccounts.length;\na++){this.visibleAccounts[a].saveImplicitPrefs()\n}};\nZmAccountList.prototype.getTooltipForVirtualFolder=function(a){var f=0;\nvar e=0;\nfor(var c=0;\nc<this.visibleAccounts.length;\nc++){var h=this.visibleAccounts[c];\nvar g=ZmOrganizer.getSystemId(a,h);\nvar d=appCtxt.getById(g);\nif(d){f+=d.numTotal;\ne+=d.sizeTotal\n}}var b={itemText:ZmMsg.messages,numTotal:f,sizeTotal:e};\nreturn AjxTemplate.expand(\"share.App#FolderTooltip\",b)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmAccount\")){ZmAccount=function(b,c,a){if(arguments.length==0){return\n}this.id=c;\nthis.name=a;\nthis.type=b||ZmAccount.TYPE_ZIMBRA\n};\nZmAccount.TYPE_AOL=\"AOL\";\nZmAccount.TYPE_GMAIL=\"Gmail\";\nZmAccount.TYPE_IMAP=\"Imap\";\nZmAccount.TYPE_LIVE=\"Live\";\nZmAccount.TYPE_MSE=\"MSE\";\nZmAccount.TYPE_EXCHANGE=\"Xsync\";\nZmAccount.TYPE_PERSONA=\"PERSONA\";\nZmAccount.TYPE_POP=\"Pop\";\nZmAccount.TYPE_YMP=\"YMP\";\nZmAccount.TYPE_ZIMBRA=\"Zimbra\";\nZmAccount.TYPE_CALDAV=\"CalDAV\";\nZmAccount.LOCAL_ACCOUNT_ID=\"ffffffff-ffff-ffff-ffff-ffffffffffff\";\nZmAccount.getTypeName=function(a){switch(a){case ZmAccount.TYPE_AOL:return ZmMsg.aol;\ncase ZmAccount.TYPE_GMAIL:return ZmMsg.gmail;\ncase ZmAccount.TYPE_IMAP:return ZmMsg.accountTypeImap;\ncase ZmAccount.TYPE_LIVE:return ZmMsg.msLive;\ncase ZmAccount.TYPE_MSE:return ZmMsg.msExchange;\ncase ZmAccount.TYPE_EXCHANGE:return ZmMsg.msExchange;\ncase ZmAccount.TYPE_PERSONA:return ZmMsg.accountTypePersona;\ncase ZmAccount.TYPE_POP:return ZmMsg.accountTypePop;\ncase ZmAccount.TYPE_YMP:return ZmMsg.yahooMail;\ncase ZmAccount.TYPE_ZIMBRA:return ZmMsg.zimbraTitle\n}return ZmMsg.unknown\n};\nZmAccount.prototype.toString=function(){return\"ZmAccount\"\n};\nZmAccount.prototype.setName=function(a){this.name=a\n};\nZmAccount.prototype.getName=function(){return this.name\n};\nZmAccount.prototype.setEmail=function(a){throw this.toString()+\"#setEmail\"\n};\nZmAccount.prototype.getEmail=function(){throw this.toString()+\"#getEmail\"\n};\nZmAccount.prototype.getIdentity=function(){throw this.toString()+\"#getIdentity\"\n};\nZmAccount.prototype.isLocal=function(){return this.id==ZmAccount.LOCAL_ACCOUNT_ID\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmZimbraAccount\")){ZmZimbraAccount=function(c,a,b){ZmAccount.call(this,null,c,a);\nthis.visible=(b!==false);\nthis.settings=null;\nthis.trees={};\nthis.loaded=false;\nthis.acl=new ZmAccessControlList();\nthis.metaData=new ZmMetaData(this)\n};\nZmZimbraAccount.prototype=new ZmAccount;\nZmZimbraAccount.prototype.constructor=ZmZimbraAccount;\nZmZimbraAccount.prototype.isZmZimbraAccount=true;\nZmZimbraAccount.prototype.toString=function(){return\"ZmZimbraAccount\"\n};\nZmZimbraAccount.STATUS_UNKNOWN=\"unknown\";\nZmZimbraAccount.STATUS_OFFLINE=\"offline\";\nZmZimbraAccount.STATUS_ONLINE=\"online\";\nZmZimbraAccount.STATUS_RUNNING=\"running\";\nZmZimbraAccount.STATUS_AUTHFAIL=\"authfail\";\nZmZimbraAccount.STATUS_ERROR=\"error\";\nZmZimbraAccount.prototype.setName=function(b){var a=this.getIdentity();\nif(!a){return\n}a.name=b\n};\nZmZimbraAccount.prototype.getName=function(){var a=this.getIdentity();\nvar b=(!a)?this.settings.get(ZmSetting.DISPLAY_NAME):a.name;\nif(!b){b=this.getDisplayName()\n}return a.isDefault&&b==ZmIdentity.DEFAULT_NAME?ZmMsg.accountDefault:b\n};\nZmZimbraAccount.prototype.setEmail=function(a){};\nZmZimbraAccount.prototype.getEmail=function(){return this.name\n};\nZmZimbraAccount.prototype.getDisplayName=function(){if(!this.displayName){var a=this.isMain?this.settings.get(ZmSetting.DISPLAY_NAME):this._displayName;\nthis.displayName=(this._accountName||a||this.name)\n}return this.displayName\n};\nZmZimbraAccount.prototype.getIdentity=function(){var a=appCtxt.getIdentityCollection(this).defaultIdentity;\nif(!appCtxt.isFamilyMbox||this.isMain){return a\n}if(!this.dummyIdentity){this.dummyIdentity=new ZmIdentity(this.name);\nAjxUtil.hashUpdate(this.dummyIdentity,a,true,[\"name\",\"isDefault\"])\n}return this.dummyIdentity\n};\nZmZimbraAccount.prototype.getToolTip=function(){if(this.status||this.lastSync||this.isMain){var c=(this.lastSync&&this.lastSync!=0)?(new Date(parseInt(this.lastSync))):null;\nvar b=appCtxt.get(ZmSetting.QUOTA_USED,null,this);\nvar a;\nif(!c){if(b>0&&!this.isMain){a=ZmMsg.unknown\n}}else{a=AjxDateUtil.computeWordyDateStr(new Date(),c)\n}var d={lastSync:a,hasNotSynced:this.hasNotSynced(),status:this.getStatusMessage(),quota:AjxUtil.formatSize(b,false,1)};\nreturn AjxTemplate.expand(\"share.App#ZimbraAccountTooltip\",d)\n}return\"\"\n};\nZmZimbraAccount.prototype.getDefaultColor=function(){if(this.isMain){return ZmOrganizer.C_GRAY\n}switch(this.type){case ZmAccount.TYPE_GMAIL:return ZmOrganizer.C_RED;\ncase ZmAccount.TYPE_MSE:return ZmOrganizer.C_GREEN;\ncase ZmAccount.TYPE_EXCHANGE:return ZmOrganizer.C_GREEN;\ncase ZmAccount.TYPE_YMP:return ZmOrganizer.C_PURPLE\n}return null\n};\nZmZimbraAccount.prototype.hasNotSynced=function(){return(this.isOfflineInitialSync()&&this.status==ZmZimbraAccount.STATUS_UNKNOWN&&appCtxt.get(ZmSetting.QUOTA_USED,null,this)==0)\n};\nZmZimbraAccount.prototype.isOfflineInitialSync=function(){return(appCtxt.isOffline&&(!this.lastSync||(this.lastSync&&this.lastSync==0)))\n};\nZmZimbraAccount.prototype.isCalDavBased=function(){return(this.type==ZmAccount.TYPE_GMAIL||this.type==ZmAccount.TYPE_YMP)\n};\nZmZimbraAccount.prototype.getDefaultCalendar=function(){var a=appCtxt.getFolderTree(this);\nif(this.isCalDavBased()){var c=a.getByType(ZmOrganizer.CALENDAR);\nfor(var b=0;\nb<c.length;\nb++){if(c[b].nId==ZmOrganizer.ID_CALENDAR){continue\n}return c[b]\n}}return a.getById(ZmOrganizer.ID_CALENDAR)\n};\nZmZimbraAccount.prototype.updateState=function(d){if(this.isMain){return\n}var g=false;\nif(this.lastSync!=d.lastsync){this.lastSync=d.lastsync;\nif(this.visible){g=true\n}}var a=false;\nif(this.status!=d.status){this.status=d.status;\nif(this.visible){a=true\n}}var b=appCtxt.getOverviewController()._overviewContainer;\nfor(var f in b){var h=b[f];\nif(a||g){h.updateAccountInfo(this,a,g)\n}}if(this.visible&&d.unread!=this.unread){this.unread=d.unread\n}this.code=d.code;\nif(d.error){var e=d.error[0];\nthis.errorDetail=e.exception[0]._content;\nthis.errorMessage=e.message\n}};\nZmZimbraAccount.prototype.getStatusIcon=function(){if(this.inNewMailMode){return\"NewMailAlert\"\n}switch(this.status){case ZmZimbraAccount.STATUS_OFFLINE:return\"ImAway\";\ncase ZmZimbraAccount.STATUS_AUTHFAIL:return\"ImDnd\";\ncase ZmZimbraAccount.STATUS_ERROR:return\"Critical\"\n}return null\n};\nZmZimbraAccount.prototype.isError=function(){return(this.status==ZmZimbraAccount.STATUS_AUTHFAIL||this.status==ZmZimbraAccount.STATUS_ERROR)\n};\nZmZimbraAccount.prototype.getIcon=function(){return(this.isMain&&appCtxt.isOffline)?\"LocalFolders\":this.icon\n};\nZmZimbraAccount.prototype.getZdMsg=function(a){var b=((ZdMsg[\"client.\"+a])||(ZdMsg[\"exception.\"+a]));\nif(!b&&a){b=ZdMsg[\"exception.offline.UNEXPECTED\"]\n}return b\n};\nZmZimbraAccount.prototype.getStatusMessage=function(){if(this.inNewMailMode){return AjxMessageFormat.format(ZmMsg.unreadCount,this.unread)\n}switch(this.status){case ZmZimbraAccount.STATUS_OFFLINE:return ZmMsg.netStatusOffline;\ncase ZmZimbraAccount.STATUS_ONLINE:return ZmMsg.netStatusOnline;\ncase ZmZimbraAccount.STATUS_RUNNING:return ZmMsg.running;\ncase ZmZimbraAccount.STATUS_AUTHFAIL:return this.code?this.getZdMsg(this.code):AjxMessageFormat.format(ZmMsg.authFailure,this.getEmail());\ncase ZmZimbraAccount.STATUS_ERROR:return this.code?this.getZdMsg(this.code):ZmMsg.error\n}return\"\"\n};\nZmZimbraAccount.prototype.showErrorMessage=function(){if(!this.isError()){return\n}var c=(this.status==ZmZimbraAccount.STATUS_ERROR)?appCtxt.getErrorDialog():appCtxt.getMsgDialog();\nvar d=this.getZdMsg(this.code);\nif(d==\"\"){d=this.getStatusMessage()\n}c.setMessage(d);\nif(this.status==ZmZimbraAccount.STATUS_ERROR){var b=[];\nvar a=0;\nif(this.errorMessage){b[a++]=\"<p><b>\";\nb[a++]=ZdMsg.DebugMsg;\nb[a++]=\"</b>: \";\nb[a++]=this.errorMessage;\nb[a++]=\"</p>\"\n}if(this.errorDetail){b[a++]=\"<p><b>\";\nb[a++]=ZdMsg.DebugStack;\nb[a++]=\"</b>:</p><p><pre>\";\nb[a++]=this.errorDetail;\nb[a++]=\"</pre></p>\"\n}b[a++]=\"<p><b>\";\nb[a++]=ZdMsg.DebugActionNote;\nb[a++]=\"</b></p>\";\nc.setDetailString(b.join(\"\"))\n}c.popup(null,true)\n};\nZmZimbraAccount.createFromDom=function(a){var b=new ZmZimbraAccount();\nb._loadFromDom(a);\nreturn b\n};\nZmZimbraAccount.prototype.load=function(m){if(!this.loaded){this.settings=new ZmSettings();\nvar g=appCtxt.accountList.mainAccount;\nfor(var d=0;\nd<ZmApp.APPS.length;\nd++){var h=ZmApp.APPS[d];\nvar o=ZmApp.SETTING[h];\nif(o&&appCtxt.get(o,null,g)){var b=appCtxt.getApp(h);\nif(b){b._registerSettings(this.settings)\n}}}var c=new ZmBatchCommand(null,this.name);\nvar e=new AjxCallback(this,this._handleLoadSettings);\nthis.settings.loadUserSettings(e,null,this.name,null,c);\nvar a=AjxSoapDoc.create(\"GetTagRequest\",\"urn:zimbraMail\");\nvar l=new AjxCallback(this,this._handleLoadTags);\nc.addNewRequestParams(a,l);\nthis.loadMetaData(null,c);\nvar k=AjxSoapDoc.create(\"GetFolderRequest\",\"urn:zimbraMail\");\nk.getMethod().setAttribute(\"visible\",\"1\");\nvar j=new AjxCallback(this,this._handleLoadFolders);\nc.addNewRequestParams(k,j);\nvar n=new AjxCallback(this,this._handleLoadUserInfo,m);\nvar f=new AjxCallback(this,this._handleErrorLoad,m);\nc.run(n,f)\n}else{if(m){m.run()\n}}};\nZmZimbraAccount.prototype.loadMetaData=function(d,b){var a=new AjxCallback(this,this._handleLoadMetaData,[d]);\nvar c=[ZmSetting.M_IMPLICIT,ZmSetting.M_OFFLINE];\nthis.metaData.load(c,a,b)\n};\nZmZimbraAccount.prototype.unload=function(){if(!appCtxt.inStartup){this.settings.loadShortcuts(true)\n}};\nZmZimbraAccount.prototype.sync=function(c){var a=AjxSoapDoc.create(\"SyncRequest\",\"urn:zimbraOffline\");\nif(appCtxt.get(ZmSetting.OFFLINE_DEBUG_TRACE)){var b=a.getMethod();\nb.setAttribute(\"debug\",1)\n}appCtxt.getAppController().sendRequest({soapDoc:a,asyncMode:true,noBusyOverlay:true,callback:c,accountName:this.name})\n};\nZmZimbraAccount.prototype.save=function(c,b,a){return(this.getIdentity().save(c,b,a))\n};\nZmZimbraAccount.prototype.saveImplicitPrefs=function(){var b=this.settings?this.settings.get(ZmSetting.IS_EXTERNAL):false;\nif(b){return\n}var c=[];\nfor(var d in ZmSetting.CHANGED_IMPLICIT){var a=this.settings?this.settings.getSetting(d):null;\nif(ZmSetting.IS_GLOBAL[a.id]&&!this.isMain){continue\n}if(a&&(a.getValue(null,true)!=a.getOrigValue(null,true))){c.push(a)\n}}if(c.length>0){this.settings.save(c,null,null,this)\n}};\nZmZimbraAccount.prototype.isAppEnabled=function(a){switch(a){case ZmApp.BRIEFCASE:return appCtxt.get(ZmSetting.BRIEFCASE_ENABLED,null,this);\ncase ZmApp.CALENDAR:return appCtxt.get(ZmSetting.CALENDAR_ENABLED,null,this);\ncase ZmApp.CONTACTS:return appCtxt.get(ZmSetting.CONTACTS_ENABLED,null,this);\ncase ZmApp.MAIL:return appCtxt.get(ZmSetting.MAIL_ENABLED,null,this);\ncase ZmApp.PREFERENCES:return appCtxt.get(ZmSetting.OPTIONS_ENABLED,null,this);\ncase ZmApp.TASKS:return appCtxt.get(ZmSetting.TASKS_ENABLED,null,this)\n}return false\n};\nZmZimbraAccount.prototype._handleLoadSettings=function(a){this.type=appCtxt.isOffline?appCtxt.get(ZmSetting.OFFLINE_ACCOUNT_FLAVOR,null,this):ZmAccount.TYPE_ZIMBRA;\nthis.isZimbraAccount=this.type==ZmAccount.TYPE_ZIMBRA;\nswitch(this.type){case ZmAccount.TYPE_AOL:this.icon=\"AccountAOL\";\nbreak;\ncase ZmAccount.TYPE_GMAIL:this.icon=\"AccountGmail\";\nbreak;\ncase ZmAccount.TYPE_IMAP:this.icon=\"AccountIMAP\";\nbreak;\ncase ZmAccount.TYPE_LIVE:this.icon=\"AccountMSN\";\nbreak;\ncase ZmAccount.TYPE_MSE:this.icon=\"AccountExchange\";\nbreak;\ncase ZmAccount.TYPE_EXCHANGE:this.icon=\"AccountExchange\";\nbreak;\ncase ZmAccount.TYPE_POP:this.icon=\"AccountPOP\";\nbreak;\ncase ZmAccount.TYPE_YMP:this.icon=\"AccountYahoo\";\nbreak;\ncase ZmAccount.TYPE_ZIMBRA:this.icon=\"AccountZimbra\";\nbreak\n}var b=a.getResponse().GetInfoResponse;\nappCtxt.getIdentityCollection(this).initialize(b.identities);\nappCtxt.getDataSourceCollection(this).initialize(b.dataSources);\nappCtxt.getSignatureCollection(this).initialize(b.signatures)\n};\nZmZimbraAccount.prototype._handleLoadFolders=function(a){var c=a.getResponse().GetFolderResponse;\nvar b=c?c.folder[0]:null;\nif(b){appCtxt.getRequestMgr()._loadTree(ZmOrganizer.FOLDER,null,c.folder[0],\"folder\",this)\n}};\nZmZimbraAccount.prototype._handleLoadTags=function(a){var b=a.getResponse().GetTagResponse;\nappCtxt.getRequestMgr()._loadTree(ZmOrganizer.TAG,null,b,null,this)\n};\nZmZimbraAccount.prototype._handleLoadUserInfo=function(b){this.loaded=true;\nvar a=appCtxt.getFolderTree(this);\nif(a){a.getPermissions({noBusyOverlay:true,accountName:this.name})\n}if(b){b.run()\n}};\nZmZimbraAccount.prototype._handleLoadMetaData=function(c,b){for(var a in b){this.settings.createFromJs(b[a])\n}if(c){c.run()\n}};\nZmZimbraAccount.prototype._handleErrorLoad=function(b,a){if(b){b.run()\n}};\nZmZimbraAccount.prototype._loadFromDom=function(a){this.id=a.id;\nthis.name=a.name;\nthis.visible=a.visible;\nthis.active=a.active;\nvar b=a.attrs&&a.attrs._attrs;\nthis._displayName=b?b.displayName:this.email;\nthis._accountName=b&&b.zimbraPrefLabel\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmAccessControlList\")){ZmAccessControlList=function(a){this._aces={}\n};\nZmAccessControlList.prototype.toString=function(){return\"ZmAccessControlList\"\n};\nZmAccessControlList.prototype.load=function(c){var b={GetRightsRequest:{_jsns:\"urn:zimbraAccount\"}};\nvar a=new AjxCallback(this,this._handleResponseLoad,[c]);\nappCtxt.getAppController().sendRequest({jsonObj:b,asyncMode:true,callback:a})\n};\nZmAccessControlList.prototype._handleResponseLoad=function(e,a){var b=a.getResponse();\nvar d=b.GetRightsResponse.ace;\nif(d&&d.length){for(var c=0;\nc<d.length;\nc++){this.add(ZmAccessControlEntry.createFromDom(d[c]))\n}}if(e){e.run()\n}};\nZmAccessControlList.prototype.getACLByRight=function(a){return this._aces[a]\n};\nZmAccessControlList.prototype.getGranteeType=function(n){var b=this._aces[n];\nvar c=ZmSetting.ACL_PUBLIC;\nvar o={};\nif(b&&b.length){for(var g=0;\ng<b.length;\ng++){var e=b[g];\nvar l=(e.granteeType==ZmSetting.ACL_USER||e.granteeType==ZmSetting.ACL_GROUP)?ZmSetting.ACL_USER:e.granteeType;\no[l]=e.negative?-1:1\n}}var m=(o[ZmSetting.ACL_PUBLIC]==1);\nvar d=(o[ZmSetting.ACL_PUBLIC]==-1);\nvar h=(o[ZmSetting.ACL_AUTH]==1);\nvar f=(o[ZmSetting.ACL_AUTH]==-1);\nvar j=(o[ZmSetting.ACL_DOMAIN]==1);\nvar k=(o[ZmSetting.ACL_USER]==1);\nvar a=(d||f)&&(o[ZmSetting.ACL_USER]==null);\nif(m){return ZmSetting.ACL_PUBLIC\n}if(h){return ZmSetting.ACL_AUTH\n}if(d){if(h){return ZmSetting.ACL_AUTH\n}}if(k){return ZmSetting.ACL_USER\n}if(j){return ZmSetting.ACL_DOMAIN\n}if(a){return ZmSetting.ACL_NONE\n}return c\n};\nZmAccessControlList.prototype.getACLByGranteeType=function(d,a){var c=this._aces[d];\nvar f=[];\nif(c&&c.length){for(var b=0;\nb<c.length;\nb++){var e=c[b];\nif(e.granteeType==a){f.push(e)\n}}}f.sort();\nreturn f\n};\nZmAccessControlList.prototype.getGrantees=function(c){var b=this._aces[c];\nvar e=[];\nif(b&&b.length){for(var a=0;\na<b.length;\na++){var d=b[a];\nif(d.granteeType==ZmSetting.ACL_USER||d.granteeType==ZmSetting.ACL_GROUP){e.push(d.grantee)\n}}}e.sort();\nreturn e\n};\nZmAccessControlList.prototype.getGranteesInfo=function(c){var b=this._aces[c];\nvar e=[];\nif(b&&b.length){for(var a=0;\na<b.length;\na++){var d=b[a];\nif(d.granteeType==ZmSetting.ACL_USER||d.granteeType==ZmSetting.ACL_GROUP){e.push({grantee:d.grantee,zid:d.zid})\n}}}e.sort(ZmAccessControlList.sortByGrantee);\nreturn e\n};\nZmAccessControlList.prototype.grant=function(b,c,a){this._setPerms(b,false,c,a)\n};\nZmAccessControlList.prototype.revoke=function(b,c,a){this._setPerms(b,true,c,a)\n};\nZmAccessControlList.prototype._setPerms=function(a,j,h,c){var d=j?\"RevokeRightsRequest\":\"GrantRightsRequest\";\nvar f=AjxSoapDoc.create(d,\"urn:zimbraAccount\");\nfor(var e=0;\ne<a.length;\ne++){var b=a[e];\nvar g=f.set(\"ace\");\ng.setAttribute(\"right\",b.right);\ng.setAttribute(\"gt\",b.granteeType);\nif(b.grantee){g.setAttribute(\"d\",b.grantee)\n}if(b.zid){g.setAttribute(\"zid\",b.zid)\n}if(b.negative){g.setAttribute(\"deny\",1)\n}}var k=new AjxCallback(this,this._handleResponseSetPerms,[j,h]);\nif(c){c.addNewRequestParams(f,k)\n}else{appCtxt.getAppController().sendRequest({soapDoc:f,asyncMode:true,callback:k})\n}};\nZmAccessControlList.prototype._handleResponseSetPerms=function(h,g,j){var e=j.getResponse();\nvar d=h?e.RevokeRightsResponse:e.GrantRightsResponse;\nvar a=d&&d.ace;\nvar b=[];\nif(a&&a.length){for(var f=0;\nf<a.length;\nf++){var c=ZmAccessControlEntry.createFromDom(a[f]);\nb.push(c);\nif(h){this.remove(c)\n}else{this.update(c)\n}}}if(g){g.run(b)\n}};\nZmAccessControlList.prototype.add=function(b){if(!b){return\n}var a=b.right;\nif(!this._aces[a]){this._aces[a]=[]\n}this._aces[a].push(b)\n};\nZmAccessControlList.prototype.remove=function(c){if(!c){return\n}var d=this._aces[c.right];\nvar b=[];\nif(d&&d.length){for(var a=0;\na<d.length;\na++){if(d[a].grantee!=c.grantee){b.push(d[a])\n}}}this._aces[c.right]=b\n};\nZmAccessControlList.prototype.update=function(b,e){if(!b||!b.right){return\n}var d=false;\nif(!this._aces[b.right]){this._aces[b.right]=[]\n}var c=this._aces[b.right];\nif(c.length){for(var a=0;\na<c.length;\na++){if((c[a].grantee==b.grantee)&&(c[a].granteeType==b.granteeType)){this._aces[b.right][a]=b;\nd=true\n}}}if(!d){this._aces[b.right].push(b)\n}};\nZmAccessControlList.prototype.cleanup=function(){this._aces={}\n};\nZmAccessControlList.sortByGrantee=function(e,c){var f=e.grantee||\"\";\nvar d=c.grantee||\"\";\nif(f.toLowerCase()>d.toLowerCase()){return 1\n}if(f.toLowerCase()<d.toLowerCase()){return -1\n}return 0\n};\nZmAccessControlEntry=function(a){this.grantee=a.grantee;\nthis.zid=a.zid;\nthis.granteeType=a.granteeType;\nthis.right=a.right;\nthis.negative=a.negative\n};\nZmAccessControlEntry.prototype.toString=function(){return\"ZmAccessControlEntry\"\n};\nZmAccessControlEntry.createFromDom=function(a){var b={};\nb.grantee=a.d;\nb.granteeType=a.gt;\nb.zid=a.zid;\nb.right=a.right;\nb.negative=(a.deny==\"1\");\nreturn new ZmAccessControlEntry(b)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmDomainList\")){ZmDomainList=function(){ZmModel.call(this)\n};\nZmDomainList.prototype=new ZmModel;\nZmDomainList.prototype.constructor=ZmDomainList;\nZmDomainList.prototype.isZmDomainList=true;\nZmDomainList.prototype.toString=function(){return\"ZmDomainList\"\n};\nZmDomainList.DOMAIN_RE=new RegExp(\"\\\\.\\\\w{2,3}$\");\nZmDomainList.prototype.search=function(c,a,f){var e={BrowseRequest:{_jsns:\"urn:zimbraMail\"}};\nvar b=e.BrowseRequest;\nb.browseBy=\"domains\";\nif(c&&(/[a-z]/i.test(c))){if(ZmDomainList.DOMAIN_RE.test(c)){b.regex=[\".*\",AjxStringUtil.regExEscape(c),\"$\"].join(\"\")\n}else{b.regex=[\"^\",c,\".*\"].join(\"\")\n}}if(a){b.maxToReturn=a\n}var d=ZmDomainList._handleResponseSearch.bind(null,c,f);\nappCtxt.getAppController().sendRequest({jsonObj:e,asyncMode:true,callback:d})\n};\nZmDomainList._handleResponseSearch=function(f,g,b){var a=b.getResponse().BrowseResponse.bd;\nvar e=[];\nif(a){for(var c=0;\nc<a.length;\nc++){var d=a[c];\ne[c]=new ZmDomain(d._content,d.h)\n}}e.sort(ZmDomain.sortCompare);\ng.run(e)\n};\nZmDomain=function(a,b){ZmModel.call(this);\nthis.name=a.toLowerCase();\nthis._headerFlags=b\n};\nZmDomain.prototype=new ZmModel;\nZmDomain.prototype.constructor=ZmDomain;\nZmDomain.prototype.isZmDomain=true;\nZmDomain.prototype.toString=function(){return\"ZmDomain\"\n};\nZmDomain.ADDR_FLAG={};\nZmDomain.ADDR_FLAG[AjxEmailAddress.FROM]=\"f\";\nZmDomain.ADDR_FLAG[AjxEmailAddress.TO]=\"t\";\nZmDomain.ADDR_FLAG[AjxEmailAddress.CC]=\"c\";\nZmDomain.sortCompare=function(e,c){var d=ZmOrganizer.checkSortArgs(e,c);\nif(d!=null){return d\n}if(e.name<c.name){return -1\n}if(e.name>c.name){return 1\n}return 0\n};\nZmDomain.prototype.hasAddress=function(b){var a=ZmDomain.ADDR_FLAG[b];\nreturn a&&this._headerFlags&&(this._headerFlags.indexOf(a)!=-1)\n}\n}if(AjxPackage.define(\"zimbraMail.share.model.ZmAttachmentTypeList\")){ZmAttachmentTypeList=function(){ZmModel.call(this,ZmEvent.S_ATT)\n};\nZmAttachmentTypeList.prototype=new ZmModel;\nZmAttachmentTypeList.prototype.constructor=ZmAttachmentTypeList;\nZmAttachmentTypeList.prototype.isZmAttachmentTypeList=true;\nZmAttachmentTypeList.prototype.toString=function(){return\"ZmAttachmentTypeList\"\n};\nZmAttachmentTypeList.prototype.getAttachments=function(){return this._attachments\n};\nZmAttachmentTypeList.compareEntry=function(d,c){if(d.desc.toLowerCase()<c.desc.toLowerCase()){return -1\n}if(d.desc.toLowerCase()>c.desc.toLowerCase()){return 1\n}return 0\n};\nZmAttachmentTypeList.prototype.load=function(d){this._attachments=[];\nvar c={BrowseRequest:{_jsns:\"urn:zimbraMail\"}};\nvar a=c.BrowseRequest;\na.browseBy=\"attachments\";\nvar b=this._handleResponseLoad.bind(this,d);\nappCtxt.getAppController().sendRequest({jsonObj:c,asyncMode:true,callback:b})\n};\nZmAttachmentTypeList.prototype._handleResponseLoad=function(f,b){var c=this._organizeTypes(b.getResponse().BrowseResponse.bd);\nvar a=false;\nif(c){for(var d=0;\nd<c.length;\nd++){var e=c[d]._content;\nif(!ZmMimeTable.isIgnored(e)){this._attachments.push(ZmMimeTable.getInfo(e,true))\n}}this._attachments.sort(ZmAttachmentTypeList.compareEntry)\n}if(f){f.run(this._attachments)\n}};\nZmAttachmentTypeList.prototype._isSupportedType=function(a){var b=[ZmMimeTable.APP_ADOBE_PDF,ZmMimeTable.APP_MS_WORD,ZmMimeTable.APP_MS_EXCEL,ZmMimeTable.APP_MS_PPT,ZmMimeTable.APP_ZIP,ZmMimeTable.APP_ZIP2,ZmMimeTable.MSG_RFC822,ZmMimeTable.TEXT_HTML,ZmMimeTable.TEXT_CAL];\nreturn AjxUtil.arrayContains(b,a)\n};\nZmAttachmentTypeList.prototype._isSupportedGroup=function(c){var d=[ZmMimeTable.APP,ZmMimeTable.AUDIO,ZmMimeTable.IMG,ZmMimeTable.TEXT,ZmMimeTable.VIDEO];\nvar b=new RegExp(\"^\"+d.join(\"|^\"),\"ig\");\nvar a=c.match(b);\nreturn a&&a[0]\n};\nZmAttachmentTypeList.prototype._organizeTypes=function(b){var e=[];\nif(!(b&&b.length)){return e\n}for(var d=0;\nd<b.length;\nd++){var f=b[d]._content;\nvar h=b[d].freq;\nvar g=true;\nvar a=null;\nif(this._isSupportedType(f)){g=false\n}else{if(f=this._isSupportedGroup(f)){g=false;\nfor(var c=0;\nc<e.length;\nc++){if(e[c]._content===f){e[c].freq+=h;\ng=true;\nbreak\n}}}}if(!g){e.push({_content:f,freq:h})\n}}return e\n}\n}if(AjxPackage.define(\"zimbraMail.core.ZmApp\")){ZmApp=function(c,b,a){if(arguments.length==0){return\n}this._name=c;\nthis._container=b;\nthis._parentController=a;\nthis._active=false;\nthis.currentSearch=null;\nthis._defaultFolderId=null;\nthis._deferredFolders=[];\nthis._deferredFolderHash={};\nthis._deferredNotifications=[];\nthis._sessionController={};\nthis._nextSessionId={};\nthis._curSessionId={};\nZmApp.DROP_TARGETS[c]={};\nthis._defineAPI();\nif(!a){this._registerSettings()\n}this._registerOperations();\nthis._registerItems();\nthis._registerOrganizers();\nif(!a){this._setupSearchToolbar()\n}this._registerApp()\n};\nZmApp.CLASS={};\nZmApp.SETTING={};\nZmApp.UPSELL_SETTING={};\nZmApp.LOAD_SORT={};\nZmApp.BUTTON_ID={};\nZmApp.MAIN_PKG={};\nZmApp.NAME={};\nZmApp.ICON={};\nZmApp.TEXT_PRECEDENCE={};\nZmApp.IMAGE_PRECEDENCE={};\nZmApp.QS_ARG={};\nZmApp.QS_ARG_R={};\nZmApp.CHOOSER_TOOLTIP={};\nZmApp.VIEW_TOOLTIP={};\nZmApp.DEFAULT_SEARCH={};\nZmApp.ORGANIZER={};\nZmApp.OVERVIEW_TREES={};\nZmApp.HIDE_ZIMLETS={};\nZmApp.SEARCH_TYPES={};\nZmApp.SEARCH_TYPES_R={};\nZmApp.GOTO_ACTION_CODE={};\nZmApp.GOTO_ACTION_CODE_R={};\nZmApp.NEW_ACTION_CODE={};\nZmApp.ACTION_CODES={};\nZmApp.ACTION_CODES_R={};\nZmApp.OPS={};\nZmApp.OPS_R={};\nZmApp.QS_VIEWS={};\nZmApp.TRASH_VIEW_OP={};\nZmApp.UPSELL_URL={};\nZmApp.DROP_TARGETS={};\nZmApp.SEARCH_RESULTS_TAB={};\nZmApp.CHOOSER_SORT={};\nZmApp.DEFAULT_SORT={};\nZmApp.ENABLED_APPS={};\nZmApp.APPS=[];\nZmApp.DEFAULT_APPS=[];\nZmApp.OVERVIEW_ID=\"main\";\nZmApp.BATCH_NOTIF_LIMIT=25;\nZmApp.MAIN_SESSION=\"main\";\nZmApp.HIDDEN_SESSION=\"hidden\";\nZmApp.initialize=function(){if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){ZmApp.ACTION_CODES[ZmKeyMap.NEW_FOLDER]=ZmOperation.NEW_FOLDER;\nZmApp.ACTION_CODES[ZmKeyMap.NEW_TAG]=ZmOperation.NEW_TAG\n}};\nZmApp.registerApp=function(e,d){if(d.mainPkg){ZmApp.MAIN_PKG[e]=d.mainPkg\n}if(d.nameKey){ZmApp.NAME[e]=d.nameKey\n}if(d.icon){ZmApp.ICON[e]=d.icon\n}if(d.textPrecedence){ZmApp.TEXT_PRECEDENCE[e]=d.textPrecedence\n}if(d.imagePrecedence){ZmApp.IMAGE_PRECEDENCE[e]=d.imagePrecedence\n}if(d.chooserTooltipKey){ZmApp.CHOOSER_TOOLTIP[e]=d.chooserTooltipKey\n}if(d.viewTooltipKey){ZmApp.VIEW_TOOLTIP[e]=d.viewTooltipKey\n}if(d.defaultSearch){ZmApp.DEFAULT_SEARCH[e]=d.defaultSearch\n}if(d.organizer){ZmApp.ORGANIZER[e]=d.organizer\n}if(d.overviewTrees){ZmApp.OVERVIEW_TREES[e]=d.overviewTrees\n}if(d.hideZimlets){ZmApp.HIDE_ZIMLETS[e]=d.hideZimlets\n}if(d.searchTypes){ZmApp.SEARCH_TYPES[e]=d.searchTypes\n}if(d.gotoActionCode){ZmApp.GOTO_ACTION_CODE[e]=d.gotoActionCode\n}if(d.newActionCode){ZmApp.NEW_ACTION_CODE[e]=d.newActionCode\n}if(d.qsViews){ZmApp.QS_VIEWS[e]=d.qsViews\n}if(d.chooserSort){ZmApp.CHOOSER_SORT[e]=d.chooserSort\n}if(d.defaultSort){ZmApp.DEFAULT_SORT[e]=d.defaultSort\n}if(d.trashViewOp){ZmApp.TRASH_VIEW_OP[e]=d.trashViewOp\n}if(d.upsellUrl){ZmApp.UPSELL_URL[e]=d.upsellUrl\n}if(d.searchResultsTab){ZmApp.SEARCH_RESULTS_TAB[e]=d.searchResultsTab\n}if(d.searchTypes){ZmApp.SEARCH_TYPES_R[e]={};\nfor(var b=0;\nb<d.searchTypes.length;\nb++){ZmApp.SEARCH_TYPES_R[e][d.searchTypes[b]]=true\n}}if(d.gotoActionCode){ZmApp.GOTO_ACTION_CODE_R[d.gotoActionCode]=e\n}if(d.actionCodes){for(var c in d.actionCodes){if(!c){continue\n}ZmApp.ACTION_CODES_R[c]=e;\nZmApp.ACTION_CODES[c]=d.actionCodes[c]\n}}var a=appCtxt.get(ZmApp.SETTING[e]);\nif(d.newItemOps&&a){for(var f in d.newItemOps){if(!f){continue\n}ZmApp.OPS_R[f]=e;\nZmOperation.NEW_ITEM_OPS.push(f);\nZmOperation.NEW_ITEM_KEY[f]=d.newItemOps[f]\n}}if(d.newOrgOps&&a){for(var f in d.newOrgOps){if(!f){continue\n}ZmApp.OPS_R[f]=e;\nZmOperation.NEW_ORG_OPS.push(f);\nZmOperation.NEW_ORG_KEY[f]=d.newOrgOps[f]\n}}if(d.qsViews){for(var b=0;\nb<d.qsViews.length;\nb++){ZmApp.QS_VIEWS[d.qsViews[b]]=e\n}}};\nZmApp.runAppFunction=function(d){var b;\nfor(var a in ZmApp.CLASS){var e=window[ZmApp.CLASS[a]];\nvar c=e&&e[d];\nif(c&&(typeof(c)==\"function\")){b=b||Array.prototype.slice.call(arguments,1);\nc.apply(e,b)\n}}};\nZmApp.prototype.toString=function(){return\"ZmApp\"\n};\nZmApp.prototype._defineAPI=function(){};\nZmApp.prototype._registerSettings=function(){};\nZmApp.prototype._registerOperations=function(){};\nZmApp.prototype._registerItems=function(){};\nZmApp.prototype._registerOrganizers=function(){};\nZmApp.prototype._setupSearchToolbar=function(){};\nZmApp.prototype._registerApp=function(){};\nZmApp.prototype._registerPrefs=function(){};\nZmApp.prototype.startup=function(a){};\nZmApp.prototype.preNotify=function(a){};\nZmApp.prototype.deleteNotify=function(a){};\nZmApp.prototype.createNotify=function(a){};\nZmApp.prototype.modifyNotify=function(a){};\nZmApp.prototype.postNotify=function(a){};\nZmApp.prototype.refresh=function(a){};\nZmApp.prototype.handleOp=function(b,a){};\nZmApp.prototype.getName=function(){return this._name\n};\nZmApp.prototype.getDisplayName=function(){return ZmMsg[ZmApp.NAME[this._name]]||ZmApp.NAME[this._name]\n};\nZmApp.prototype.getInitialSearchType=function(){return null\n};\nZmApp.prototype.getLimit=function(a){return appCtxt.get(ZmSetting.PAGE_SIZE)\n};\nZmApp.prototype.setAppView=function(a){appCtxt.getAppViewMgr().setAppView(this._name,a)\n};\nZmApp.prototype.createView=function(a){a.appName=this._name;\nreturn appCtxt.getAppViewMgr().createView(a)\n};\nZmApp.prototype.pushView=function(a,b){return appCtxt.getAppViewMgr().pushView(a,b)\n};\nZmApp.prototype.popView=function(b,a,c){return appCtxt.getAppViewMgr().popView(b,a,c)\n};\nZmApp.prototype.setView=function(a,b){return appCtxt.getAppViewMgr().setView(a,b)\n};\nZmApp.prototype.stageView=function(a){return appCtxt.getAppViewMgr().stageView(a)\n};\nZmApp.prototype.addDeferredFolder=function(a){var b=a.obj&&a.obj.id;\nif(b&&!this._deferredFolderHash[b]){this._deferredFolders.push(a);\nthis._deferredFolderHash[b]=true;\nappCtxt.cacheSetDeferred(b,this._name)\n}};\nZmApp.prototype.getRemoteFolderIds=function(g){var f=[];\nif(appCtxt.getOverviewController(true)){var d=ZmApp.ORGANIZER[this.getName()];\nif(this._deferredFolders.length){this._createDeferredFolders(d)\n}var a=appCtxt.getFolderTree(g);\nvar c=a?a.getByType(d):[];\nfor(var b=0;\nb<c.length;\nb++){var e=c[b];\nif(e.isRemote()){f.push(e.id)\n}}}return f\n};\nZmApp.prototype.getOverviewPanelContent=function(){if(!this._overviewPanelContent){var b=this._getOverviewParams();\nb.overviewId=this.getOverviewId();\nvar a=this._overviewPanelContent=appCtxt.getOverviewController().createOverview(b);\na.set(this._getOverviewTrees())\n}return this._overviewPanelContent\n};\nZmApp.prototype.getOverviewContainer=function(c){if(!this._overviewContainer&&!c){var a={appName:this._name,containerId:([ZmApp.OVERVIEW_ID,this._name].join(\"_\")),posStyle:Dwt.ABSOLUTE_STYLE};\nvar b=this._getOverviewParams();\nb.overviewTrees=this._getOverviewTrees();\nthis._overviewContainer=appCtxt.getOverviewController().createOverviewContainer(a,b)\n}return this._overviewContainer\n};\nZmApp.prototype.setOverviewPanelContent=function(d){if(d){this._overviewPanelContent=null;\nthis._overviewContainer=null\n}var a=appCtxt.getAppViewMgr();\nif(!a.isFullScreen()){Dwt.setLoadingTime(this.toString()+\"-overviewPanel\");\nvar b=((appCtxt.multiAccounts&&appCtxt.accountList.size()>1)||this.getName()==ZmApp.VOICE)?this.getOverviewContainer():this.getOverviewPanelContent();\nvar c={};\nc[ZmAppViewMgr.C_TREE]=b;\na.setViewComponents(ZmAppViewMgr.APP,c,true,this.getName());\nDwt.setLoadedTime(this.toString()+\"-overviewPanel\")\n}};\nZmApp.prototype.getOverview=function(){var a=appCtxt.getOverviewController();\nreturn a&&a.getOverview(this.getOverviewId())\n};\nZmApp.prototype.resetOverview=function(b){var n=b?appCtxt.getOverviewController().getOverview(b):this.getOverview();\nif(n){var f=[];\nvar m=n.getTreeViews(),k=m.length;\nfor(var e=0;\ne<k;\ne++){var h=m[e];\nvar a=n.getTreeView(h);\nif(a){var l=a.getTreeItemList();\nvar d=l.length;\nfor(var c=0;\nc<d;\nc++){var g=l[c];\nif(g._expanded){f.push(g._htmlElId)\n}}}}n.clear();\nn.set(this._getOverviewTrees());\nk=f.length;\nfor(var e=0;\ne<k;\ne++){var g=DwtControl.fromElementId(f[e]);\nif(g&&!g._expanded){g.setExpanded(true)\n}}}};\nZmApp.prototype.getOverviewId=function(a){return appCtxt.getOverviewId([ZmApp.OVERVIEW_ID,this._name],a)\n};\nZmApp.prototype._getOverviewParams=function(){var a=[];\nfor(var c in ZmOverviewController.CONTROLLER){a.push(c)\n}var b=function(e,d){return(ZmOrganizer.DISPLAY_ORDER[e]||9999)-(ZmOrganizer.DISPLAY_ORDER[d]||9999)\n};\na.sort(b);\nreturn{posStyle:Dwt.ABSOLUTE_STYLE,selectionSupported:true,actionSupported:true,dndSupported:true,showUnread:true,showNewButtons:true,isAppOverview:true,treeIds:a,appName:this._name,account:appCtxt.getActiveAccount()}\n};\nZmApp.prototype._getOverviewTrees=function(){var d=ZmApp.OVERVIEW_TREES[this._name]||[];\nvar b=[];\nfor(var a=0,c=d.length;\na<c;\na++){if((d[a]==ZmOrganizer.FOLDER&&!appCtxt.get(ZmSetting.MAIL_ENABLED))){continue\n}b.push(d[a])\n}if(!appCtxt.multiAccounts&&window[ZmOverviewController.CONTROLLER[ZmOrganizer.ZIMLET]]&&!ZmApp.HIDE_ZIMLETS[this._name]){b.push(ZmOrganizer.ZIMLET)\n}return b\n};\nZmApp.prototype.getNumSessionControllers=function(b){var c=this._sessionController[b]||[];\nvar a=0;\nfor(var d in c){if(!c[d].inactive){a++\n}}return a\n};\nZmApp.prototype.getTypeFromController=function(controllerClass){var controller=eval(controllerClass);\nif(!controller.getDefaultViewType){throw new AjxException(\"Session controller \"+controllerClass+\" must implement getDefaultViewType()\")\n}return controller.getDefaultViewType()\n};\nZmApp.prototype.getSessionController=function(params){var type=this.getTypeFromController(params.controllerClass);\nif(!this._sessionController[type]){this._sessionController[type]={};\nthis._nextSessionId[type]=1\n}var sessionId=params.sessionId;\nif(sessionId&&this._sessionController[type][sessionId]){return this._sessionController[type][sessionId]\n}var controller;\nif(!sessionId){var controllers=this._sessionController[type];\nfor(var id in controllers){if(controllers[id].inactive&&!controllers[id].isPinned&&!controllers[id].isHidden){controller=controllers[id];\nbreak\n}}}sessionId=(controller&&controller.getSessionId())||sessionId||String(this._nextSessionId[type]++);\nif(!controller){var ctlrClass=eval(params.controllerClass);\ncontroller=this._sessionController[type][sessionId]=new ctlrClass(this._container,this,type,sessionId,params.searchResultsController)\n}this._curSessionId[type]=sessionId;\ncontroller.inactive=false;\nreturn controller\n};\nZmApp.prototype.deleteSessionController=function(c){var a=this.getTypeFromController(c.controllerClass);\nvar b=c.sessionId;\nif(!this._sessionController[a]){return\n}delete this._sessionController[a][b]\n};\nZmApp.prototype.getCurrentSessionId=function(a){return this._curSessionId[a]\n};\nZmApp.prototype.getAllControllers=function(){var e=[];\nfor(var c in this._sessionController){var d=this._sessionController[c];\nif(d){for(var b in d){var a=d[b];\nif(a){e.push(a)\n}}}}return e\n};\nZmApp.prototype._addSettingsChangeListeners=function(){if(!this._settingListener){this._settingListener=new AjxListener(this,this._settingChangeListener)\n}};\nZmApp.prototype._settingChangeListener=function(a){};\nZmApp.prototype.getNewButtonProps=function(){return{}\n};\nZmApp.prototype.getSearchParams=function(a){return(a||{})\n};\nZmApp.prototype._postLoadCore=function(){if(!appCtxt.isChildWindow){this._setupDropTargets()\n}};\nZmApp.prototype._postLoad=function(a){if(a){this._createDeferredFolders(a)\n}this._handleDeferredNotifications();\nif(appCtxt.isExternalAccount()){this._handleExternalAccountSettings(a)\n}};\nZmApp.prototype.containsWritableFolder=function(){return appCtxt.isExternalAccount()?(this._containsWritableFolder?true:false):true\n};\nZmApp.prototype.getDefaultFolderId=function(){return this._defaultFolderId\n};\nZmApp.prototype._handleExternalAccountSettings=function(d){var f=appCtxt.getTree(d,appCtxt.getActiveAccount()),c=f?f.getByType(d):[],a=c.length,e,b;\nthis._containsWritableFolder=false;\nfor(b=0;\nb<a;\nb++){e=c[b];\nif(!this._defaultFolderId){this._defaultFolderId=e.id\n}if(e.isPermAllowed(ZmOrganizer.PERM_WRITE)){this._containsWritableFolder=true\n}}};\nZmApp.prototype._setupDropTargets=function(){var c=ZmApp.DROP_TARGETS[this._name];\nfor(var f in c){var b=c[f];\nfor(var d=0;\nd<b.length;\nd++){var g=b[d];\nvar a=appCtxt.getOverviewController().getTreeController(g,true);\nvar e=ZmList.ITEM_CLASS[f]||ZmOrganizer.ORG_CLASS[f];\nif(a){a._dropTgt.addTransferType(e)\n}else{if(!ZmTreeController.DROP_SOURCES[g]){ZmTreeController.DROP_SOURCES[g]=[]\n}ZmTreeController.DROP_SOURCES[g].push(e)\n}}}};\nZmApp.prototype.disposeTreeControllers=function(){var a=appCtxt.getOverviewController(true);\nif(!a){return\n}var c=ZmApp.DROP_TARGETS[this._name];\nfor(var e in c){var b=c[e];\nfor(var d=0;\nd<b.length;\nd++){var g=b[d];\nvar f=a.getTreeController(g,true);\nif(!f){continue\n}f.dispose()\n}}};\nZmApp.prototype.createDeferred=function(){var c=ZmOrganizer.APP2ORGANIZER[this._name]||[];\nfor(var b=0;\nb<c.length;\nb++){var d=c[b];\nvar a=ZmOrganizer.ORG_PACKAGE[d];\nAjxDispatcher.require(a);\nthis._createDeferredFolders(d)\n}};\nZmApp.prototype._createDeferredFolders=function(b){for(var a=0;\na<this._deferredFolders.length;\na++){var d=this._deferredFolders[a];\nvar c=ZmFolderTree.createFolder(d.type,d.parent,d.obj,d.tree,d.path,d.elementType);\nif(appCtxt.isExternalAccount()&&c.isSystem()){continue\n}d.parent.children.add(c);\nc.parent=d.parent;\nZmFolderTree._traverse(c,d.obj,d.tree,d.path||[])\n}this._clearDeferredFolders()\n};\nZmApp.prototype._clearDeferredFolders=function(){this._deferredFolders=[];\nthis._deferredFolderHash={}\n};\nZmApp.prototype._deferNotifications=function(b,c){var a=ZmApp.MAIN_PKG[this._name];\nif(a&&!AjxDispatcher.loaded(a)){this._deferredNotifications.push({type:b,data:c});\nreturn true\n}else{this._noDefer=true;\nreturn false\n}};\nZmApp.prototype._handleDeferredNotifications=function(){var b=this._deferredNotifications;\nfor(var c=0;\nc<b.length;\nc++){var a=b[c];\nif(a.type==\"delete\"){this.deleteNotify(a.data,true)\n}else{if(a.type==\"create\"){this.createNotify(a.data,true)\n}else{if(a.type==\"modify\"){this.modifyNotify(a.data,true)\n}}}}};\nZmApp.prototype._batchNotify=function(j){if(!(j&&j.length>=ZmApp.BATCH_NOTIF_LIMIT)){return\n}var b={},k,c=false;\nfor(var d=0,e=j.length;\nd<e;\nd++){var h=j[d];\nk=appCtxt.cacheGet(h.id);\nif(k){var g=k.notifyModify(h,true);\nif(g){if(!b[g]){b[g]=[]\n}h.item=k;\nb[g].push(h);\nc=true\n}}}if(!c||!k){return\n}var f=k.list;\nif(!f){return\n}f._evt.batchMode=true;\nf._evt.item=k;\nf._evt.items=null;\nfor(var g in b){var a={notifs:b[g]};\nf._notify(g,a)\n}};\nZmApp.prototype._inNewWindow=function(b){if(appCtxt.isWebClientOffline()){return false\n}else{var a=appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE);\nreturn !b?a:((!a&&b&&b.shiftKey)||(a&&b&&!b.shiftKey))\n}};\nZmApp.prototype._handleCreateFolder=function(a,c){var b=appCtxt.getById(a.l);\nif(b&&(ZmOrganizer.VIEW_HASH[c][a.view])){b.notifyCreate(a,\"folder\");\na._handled=true\n}};\nZmApp.prototype._handleCreateLink=function(b,d){var c=appCtxt.getById(b.l);\nvar a=b.view||\"message\";\nif(c&&c.supportsSharing()&&(ZmOrganizer.VIEW_HASH[d][a])){c.notifyCreate(b,\"link\");\nb._handled=true\n}};\nZmApp.prototype.launch=function(a,b){this.createDeferred();\nif(b){b.run()\n}};\nZmApp.prototype.activate=function(b,a){this._active=b;\nif(b){appCtxt.getAppController().setNewButtonProps(this.getNewButtonProps());\nthis.setOverviewPanelContent();\nthis.stopAlert();\nif(appCtxt.isWebClientOfflineSupported){this.resetWebClientOfflineOperations()\n}this._setRefreshButtonTooltip()\n}};\nZmApp.prototype.resetWebClientOfflineOperations=function(){var c=!appCtxt.isWebClientOffline();\nvar d=this.getOverview();\nif(d){var a=d.getTreeView(ZmOrganizer.ZIMLET);\nif(a){a.setVisible(c)\n}d.actionSupported=c;\nd.dndSupported=c\n}var b=appCtxt.getAppController().getNewButton();\nif(b){if(ZmController._defaultNewId===ZmOperation.NEW_MESSAGE){b._setDropDownCellMouseHandlers(c)\n}else{b.setEnabled(c)\n}}};\nZmApp.prototype.isActive=function(){return this._active\n};\nZmApp.prototype.reset=function(a){};\nZmApp.prototype.startAlert=function(){AjxDispatcher.require(\"Alert\");\nthis._alert=this._alert||new ZmAppAlert(this);\nthis._alert.start()\n};\nZmApp.prototype.stopAlert=function(){if(this._alert){this._alert.stop()\n}};\nZmApp.prototype._setRefreshButtonTooltip=function(){if(appCtxt.refreshButton){appCtxt.refreshButton.setToolTipContent(this._getRefreshButtonTooltip())\n}};\nZmApp.prototype._getRefreshButtonTooltip=function(){return ZmMsg.checkMailPrefUpdate\n};\nZmApp.prototype._notifyRendered=function(){if(!this._hasRendered){appCtxt.getAppController().appRendered(this._name);\nthis._hasRendered=true\n}this.stopAlert()\n};\nZmApp.prototype._getExternalAccount=function(){var b;\nif(appCtxt.multiAccounts){var c=appCtxt.accountList.visibleAccounts;\nfor(var a=0;\na<c.length;\na++){var d=c[a];\nif(d.isMain){continue\n}if(appCtxt.get(ZmApp.SETTING[this.name],null,d)){b=d;\nbreak\n}}}return b\n};\nZmApp.prototype._setLaunchTime=function(a,b){if(!window.isPerfMetric){return\n}var d=a+\"_launched\";\nif(!b){b=new Date()\n}if(!document.getElementById(d)){var c=document.createElement(\"DIV\");\nc.id=d;\nc.innerHTML=b.getTime();\nc.style.display=\"none\";\ndocument.body.appendChild(c)\n}if(window.appDevMode){console.profile(d)\n}};\nZmApp.prototype._setLoadedTime=function(a,b){if(!window.isPerfMetric){return\n}var d=a+\"_loaded\";\nif(!b){b=new Date()\n}if(!document.getElementById(d)){var c=document.createElement(\"DIV\");\nc.id=d;\nc.innerHTML=b.getTime();\nc.style.display=\"none\";\ndocument.body.appendChild(c)\n}if(window.appDevMode){console.profileEnd()\n}}\n}if(AjxPackage.define(\"zimbraMail.share.ZmSearchApp\")){ZmSearchApp=function(b,a){ZmApp.call(this,ZmApp.SEARCH,b,a);\nthis._groupBy=appCtxt.get(ZmSetting.GROUP_MAIL_BY)\n};\nZmSearchApp.prototype=new ZmApp;\nZmSearchApp.prototype.constructor=ZmSearchApp;\nZmSearchApp.prototype.isZmSearchApp=true;\nZmSearchApp.prototype.toString=function(){return\"ZmSearchApp\"\n};\nZmApp.SEARCH=ZmId.APP_SEARCH;\nZmApp.CLASS[ZmApp.SEARCH]=\"ZmSearchApp\";\nZmApp.SETTING[ZmApp.SEARCH]=ZmSetting.SEARCH_ENABLED;\nZmSearchApp.CONTROLLER_CLASS=\"ZmSearchResultsController\";\nZmSearchApp.prototype.getSearchResultsController=function(b,a){return this.getSessionController({controllerClass:ZmSearchApp.CONTROLLER_CLASS,sessionId:b,appName:a})\n};\nZmSearchApp.prototype.activate=function(a){this._active=a\n};\nZmSearchApp.prototype.resetWebClientOfflineOperations=function(b){ZmApp.prototype.resetWebClientOfflineOperations.apply(this);\nif(!b){var e=this.getTypeFromController(ZmSearchApp.CONTROLLER_CLASS);\nvar d=this.getCurrentSessionId(e);\nb=this.getSearchResultsController(d)\n}var c=b&&b._toolbar;\nvar a=c&&c.getButton(ZmSearchToolBar.SAVE_BUTTON);\nif(a){a.setEnabled(!appCtxt.isWebClientOffline())\n}};\nZmSearchApp.prototype.getGroupMailBy=function(){return ZmMailApp.prototype.getGroupMailBy.call(this)\n};\nZmSearchApp.prototype.setGroupMailBy=function(a){this._groupBy=a\n}\n}if(AjxPackage.define(\"zimbraMail.share.ZmSocialApp\")){ZmSocialApp=function(a){ZmApp.call(this,ZmApp.SOCIAL,a)\n};\nZmSocialApp.prototype=new ZmApp;\nZmSocialApp.prototype.constructor=ZmSocialApp;\nZmSocialApp.prototype.isZmSocialApp=true;\nZmSocialApp.prototype.toString=function(){return\"ZmSocialApp\"\n};\nZmApp.SOCIAL=ZmId.APP_SOCIAL;\nZmApp.CLASS[ZmApp.SOCIAL]=\"ZmSocialApp\";\nZmApp.SETTING[ZmApp.SOCIAL]=ZmSetting.SOCIAL_ENABLED;\nZmApp.UPSELL_SETTING[ZmApp.SOCIAL]=ZmSetting.SOCIAL_EXTERNAL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.SOCIAL]=100;\nZmSocialApp.prototype._registerApp=function(){ZmApp.registerApp(ZmApp.SOCIAL,{nameKey:\"communityName\",icon:\"Globe\",chooserTooltipKey:\"goToSocial\",chooserSort:32,defaultSort:100,upsellUrl:ZmSetting.SOCIAL_EXTERNAL_URL});\nvar a=appCtxt.get(ZmSetting.SOCIAL_NAME);\nif(a){ZmMsg[ZmApp.NAME[this._name]]=a\n}};\nZmSocialApp.prototype.runRefresh=function(){var a=appCtxt.getAppController(),b=a._appIframeView[ZmApp.SOCIAL];\nif(b){b.runRefresh()\n}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmPopupMenu\")){ZmPopupMenu=function(c,b,e,a){if(arguments.length==0){return\n}var d=Dwt.getParams(arguments,ZmPopupMenu.PARAMS);\nd.className=d.className?d.className:\"ActionMenu\";\nd.style=d.style||DwtMenu.POPUP_STYLE;\nd.id=d.id||\"POPUP_\"+Dwt.getNextId();\nDwtMenu.call(this,d);\na=a||appCtxt.getCurrentController();\nif(a){this._controller=a;\nthis._keyMap=this._controller.getKeyMapName()\n}this._menuItems={}\n};\nZmPopupMenu.PARAMS=[\"parent\",\"className\",\"id\",\"controller\"];\nZmPopupMenu.prototype=new DwtMenu;\nZmPopupMenu.prototype.constructor=ZmPopupMenu;\nZmPopupMenu.prototype.isZmPopupMenu=true;\nZmPopupMenu.prototype.toString=function(){return\"ZmPopupMenu\"\n};\nZmPopupMenu.prototype.addSelectionListener=function(d,c,a){var b=this._menuItems[d];\nif(b){b.addSelectionListener(c,a)\n}};\nZmPopupMenu.prototype.removeSelectionListener=function(c,b){var a=this._menuItems[c];\nif(a){a.removeSelectionListener(b)\n}};\nZmPopupMenu.prototype.popup=function(b,a,d,c){b=b?b:0;\na=(a!=null)?a:Dwt.DEFAULT;\nd=(d!=null)?d:Dwt.DEFAULT;\nDwtMenu.prototype.popup.call(this,b,a,d,c)\n};\nZmPopupMenu.prototype.enable=function(c,a){c=(c instanceof Array)?c:[c];\nfor(var b=0;\nb<c.length;\nb++){if(this._menuItems[c[b]]){this._menuItems[c[b]].setEnabled(a)\n}}};\nZmPopupMenu.prototype.enableAll=function(a){for(var b in this._menuItems){this._menuItems[b].setEnabled(a)\n}};\nZmPopupMenu.prototype.createMenuItem=function(e,d,b){var a=this._menuItems[e]=new DwtMenuItem({parent:this,style:d.style,radioGroupId:d.radioGroupId,id:(b||d.id||e),index:d.index});\nif(d.image){a.setImage(d.image)\n}if(d.text){a.setText(AjxStringUtil.htmlEncode(d.text))\n}if(d.shortcut){a.setShortcut(appCtxt.getShortcutHint(this._keyMap,d.shortcut))\n}a.setEnabled(d.enabled!==false);\na.setData(ZmOperation.MENUITEM_ID,e);\nvar c=a.getRowElement();\nif(c){c.setAttribute(\"id\",\"POPUP_\"+a.getHTMLElId().toString().replace(/\\s/g,\"\"))\n}return a\n};\nZmPopupMenu.prototype.getMenuItem=function(a){return this._menuItems[a]\n};\nZmPopupMenu.prototype.setItemVisible=function(c,b){var a=this.getMenuItem(c);\nif(!a){return\n}a.setVisible(b)\n};\nZmPopupMenu.prototype.getMenuItems=function(){return this._menuItems\n};\nZmPopupMenu.prototype.getSearchMenu=function(){var a=this.getMenuItem(ZmOperation.SEARCH_MENU);\nif(a){return a.getMenu()\n}};\nZmPopupMenu.prototype.getContactGroupMenu=function(){var a=this.getMenuItem(ZmOperation.CONTACTGROUP_MENU);\nif(a){return a.getMenu()\n}};\nZmPopupMenu.prototype.createSeparator=function(){new DwtMenuItem({parent:this,style:DwtMenuItem.SEPARATOR_STYLE})\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmActionMenu\")){ZmActionMenu=function(b){var c=b.id||(b.context?ZmId.getMenuId(b.context,b.menuType):null);\nZmPopupMenu.call(this,b.parent,null,c,b.controller);\nvar a=b.menuItems;\nif(!a){a=[ZmOperation.TAG_MENU,ZmOperation.PRINT,ZmOperation.DELETE]\n}else{if(a==ZmOperation.NONE){a=null\n}}this.opList=ZmOperation.filterOperations(a);\nthis._context=b.context;\nthis._menuType=b.menuType;\nthis._menuItems=ZmOperation.createOperations(this,this.opList,b.overrides)\n};\nZmActionMenu.prototype=new ZmPopupMenu;\nZmActionMenu.prototype.constructor=ZmActionMenu;\nZmActionMenu.prototype.isZmActionMenu=true;\nZmActionMenu.prototype.toString=function(){return\"ZmActionMenu\"\n};\nZmActionMenu.prototype.createOp=function(d,c,b){c.id=this._context?ZmId.getMenuItemId(this._context,d,this._menuType):null;\nvar a=this.createMenuItem(d,c,b);\na.setData(ZmOperation.KEY_ID,d);\nreturn a\n};\nZmActionMenu.prototype.addOp=function(a){ZmOperation.addOperation(this,a,this._menuItems)\n};\nZmActionMenu.prototype.removeOp=function(a){ZmOperation.removeOperation(this,a,this._menuItems)\n};\nZmActionMenu.prototype.getOp=function(a){return this.getMenuItem(a)\n};\nZmActionMenu.prototype.getTagMenu=function(){var a=this.getMenuItem(ZmOperation.TAG_MENU);\nif(a){return a.getMenu()\n}};\nZmActionMenu.prototype._menuItemId=function(a){return a.getData(ZmOperation.KEY_ID)\n};\nZmActionMenu.prototype.removeMenuItemById=function(b){var a=this.getMenuItem(b);\nthis.removeMenuItem(a)\n};\nZmActionMenu.prototype.removeMenuItem=function(a){if(!a){return\n}this.removeChild(a);\na.dispose()\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmToolBar\")){ZmToolBar=function(b){if(arguments.length==0){return\n}b.posStyle=b.posStyle||DwtControl.ABSOLUTE_STYLE;\nDwtToolBar.call(this,b);\nvar a=b.controller||appCtxt.getCurrentController();\nif(a){this._controller=a;\nthis._keyMap=this._controller.getKeyMapName()\n}this._refElementId=b.refElementId;\nthis._buttons={}\n};\nZmToolBar.prototype=new DwtToolBar;\nZmToolBar.prototype.constructor=ZmToolBar;\nZmToolBar.prototype.isZmToolBar=true;\nZmToolBar.prototype.toString=function(){return\"ZmToolBar\"\n};\nZmToolBar.prototype.addSelectionListener=function(b,c){var a=this._buttons[b];\nif(a){a.addSelectionListener(c)\n}};\nZmToolBar.prototype.removeSelectionListener=function(b,c){var a=this._buttons[b];\nif(a){a.removeSelectionListener(c)\n}};\nZmToolBar.prototype.getButton=function(a){return this._buttons[a]\n};\nZmToolBar.prototype.setItemVisible=function(b,c){var a=this.getButton(b);\nif(!a){return\n}a.setVisible(c)\n};\nZmToolBar.prototype.setData=function(b,a,c){this._buttons[b].setData(a,c)\n};\nZmToolBar.prototype.enable=function(c,a){c=(c instanceof Array)?c:[c];\nfor(var b=0;\nb<c.length;\nb++){if(this._buttons[c[b]]){this._buttons[c[b]].setEnabled(a)\n}}};\nZmToolBar.prototype.setSelected=function(c){var a=this._selectedId?this._buttons[this._selectedId]:null;\nvar b=c?this._buttons[c]:null;\nif(a){a.setSelected(false)\n}if(b){b.setSelected(true);\nthis._selectedId=c\n}};\nZmToolBar.prototype.enableAll=function(a){for(var b in this._buttons){this._buttons[b].setEnabled(a)\n}};\nZmToolBar.prototype.createButton=function(d,c){var a=this._buttons[d]=this._createButton(c);\nif(c.image){a.setImage(c.image)\n}if(c.text){a.setText(c.text)\n}if(c.tooltip){a.setToolTipContent(ZmOperation.getToolTip(d,this._keyMap)||c.tooltip,true)\n}a.setEnabled(c.enabled!==false);\na.setData(\"_buttonId\",d);\nif(c.menu){a.setMenu(c.menu,false,null,c.menuAbove)\n}return a\n};\nZmToolBar.prototype.SEPARATOR_TEMPLATE=\"share.Widgets#ZmToolBarSeparator\";\nZmToolBar.prototype._createButton=function(d,b){var c=d.ctor||DwtToolBarButton;\nvar a=new c({parent:this,style:d.style,className:b,index:d.index,id:d.id,template:d.template});\na.textPrecedence=d.textPrecedence;\na.imagePrecedence=d.imagePrecedence;\na.whatToShow=d.whatToShow;\nreturn a\n};\nZmToolBar.prototype._buttonId=function(a){return a.getData(\"_buttonId\")\n};\nZmToolBar.prototype._createPrecedenceList=function(){this._precedenceList=[];\nfor(var e in this._buttons){if(ZmOperation.isSep(e)){continue\n}var a=this._buttons[e];\nvar d=a.textPrecedence;\nif(d){this._precedenceList.push({id:e,type:\"text\",precedence:d})\n}var c=a.imagePrecedence;\nif(c){this._precedenceList.push({id:e,type:\"image\",precedence:c})\n}}this._precedenceList.sort(function(g,f){return(g.precedence>f.precedence)?1:(g.precedence<f.precedence)?-1:0\n})\n};\nZmToolBar.prototype.setSize=function(b,a){var c=this.getSize();\nif(c&&(b!=c.x||a!=c.y)){DwtToolBar.prototype.setSize.apply(this,arguments)\n}};\nZmToolBar.prototype.adjustSize=function(){if(!this._refElementId||!this._inited){return\n}if(!this._refElement){this._refElement=document.getElementById(this._refElementId)\n}var a=this._refElement&&this._refElement.parentNode;\nvar c;\nif(a&&((c=a.offsetWidth)>=30)){var b=this._refElement.style;\nb.maxWidth=b.width=(c-30)+\"px\";\nb.overflow=\"hidden\"\n}};\nZmToolBar.addButton=function(e){if(e.setting&&!appCtxt.get(e.setting)){return\n}var c;\nvar b=e.parent._htmlElId+(e.tdId||e.buttonId);\nvar a=document.getElementById(b);\nif(a){var f={parent:e.parent,index:e.index,style:e.style,id:e.buttonId,template:e.template,className:e.className};\nc=(e.type&&e.type==\"toolbar\")?(new DwtToolBarButton(f)):(new DwtButton(f));\nvar d=Dwt.getAttr(a,\"hint\");\nZmToolBar._setButtonStyle(c,d,e.lbl,e.icon);\nif(e.tooltip){c.setToolTipContent(e.tooltip,true)\n}c.reparentHtmlElement(b)\n}return c\n};\nZmToolBar._setButtonStyle=function(a,d,c,b){if(d==\"text\"){a.whatToShow={showText:true}\n}else{if(d==\"icon\"){a.whatToShow={showImage:true}\n}else{a.whatToShow={showImage:true,showText:true}\n}}a.setText(c);\na.setImage(b)\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmButtonToolBar\")){ZmButtonToolBar=function(f){if(arguments.length==0){return\n}if(!f.className&&(f.controller&&f.controller._elementsToHide==ZmAppViewMgr.LEFT_NAV)){f.className=\"ZToolbar itemToolbar\"\n}f.className=f.className||\"ZToolbar\";\nf.id=f.context?ZmId.getToolbarId(f.context,f.toolbarType):null;\nZmToolBar.call(this,f);\nthis._context=f.context;\nthis._toolbarType=f.toolbarType;\nthis._buttonStyle=f.buttonClassName;\nvar a=f.buttons;\nif(!a){a=[ZmOperation.NEW_MENU,ZmOperation.TAG_MENU,ZmOperation.PRINT,ZmOperation.DELETE]\n}else{if(a==ZmOperation.NONE){a=null\n}}this.opList=ZmOperation.filterOperations(a);\nthis._zimletButtonLocation=this.opList.length;\nvar d=ZmOperation.filterOperations(f.secondaryButtons);\nif(d&&d.length){this.opList.push(ZmOperation.SEP,ZmOperation.ACTIONS_MENU)\n}var e=ZmOperation.filterOperations(f.rightSideButtons);\nif(e.length>0||f.addTextElement){this.opList.push(ZmOperation.FILLER)\n}if(f.addTextElement){this.opList.push(ZmOperation.TEXT)\n}if(e.length>0){this.opList=this.opList.concat(e)\n}this._buttons=ZmOperation.createOperations(this,this.opList,f.overrides);\nif(d&&d.length){var c=this._secondaryButton=this.getButton(ZmOperation.ACTIONS_MENU);\nc.noMenuBar=true;\nvar b=this._secondaryButtonMenu=new ZmActionMenu({parent:c,menuItems:ZmOperation.NONE,context:this._context,controller:f.controller});\nvar h=ZmOperation.createOperations(b,d,f.overrides);\nc.setMenu(b);\nfor(var g in h){this._buttons[g]=h[g]\n}this.opList=this.opList.concat(d)\n}this._createPrecedenceList();\nthis._inited=true\n};\nZmButtonToolBar.prototype=new ZmToolBar;\nZmButtonToolBar.prototype.constructor=ZmButtonToolBar;\nZmButtonToolBar.prototype.isZmButtonToolBar=true;\nZmButtonToolBar.prototype.toString=function(){return\"ZmButtonToolBar\"\n};\nZmButtonToolBar.prototype.createOp=function(g,f){f.className=this._buttonStyle;\nvar a;\nif(g==ZmOperation.TEXT){var g;\nif(this._context){var d=this._toolbarType?[this._context,this._toolbarType].join(\"_\"):this._context;\ng=[ZmId.WIDGET,AjxStringUtil.toMixed(d,\"_\",true),AjxStringUtil.toMixed(g,\"_\")].join(\"\")\n}f.textClassName=f.textClassName||\"DwtText ZWidgetTitle\";\na=new DwtText({parent:this,className:f.textClassName,id:g})\n}else{f.id=f.domId||(this._context?ZmId.getButtonId(this._context,g,this._toolbarType):null);\nf.textPrecedence=ZmOperation.getProp(g,\"textPrecedence\");\nf.iconPrecedence=ZmOperation.getProp(g,\"iconPrecedence\");\nvar e=f.showImageInToolbar||false;\nvar c=!e||f.showTextInToolbar;\ne=e||!f.text;\nc=c||!f.image;\nf.image=e&&f.image;\nf.whatToShow={showImage:e,showText:c};\na=this.createButton(g,f)\n}a.setData(ZmOperation.KEY_ID,g);\nreturn a\n};\nZmButtonToolBar.prototype.createZimletOp=function(b,a){a.index=this._zimletButtonLocation;\nreturn this.createOp(b,a)\n};\nZmButtonToolBar.prototype.addOp=function(b,a){if(this.getOp(b)){return\n}ZmOperation.addOperation(this,b,this._buttons,a);\nAjxUtil.arrayAdd(this.opList,b,a)\n};\nZmButtonToolBar.prototype.removeOp=function(a){ZmOperation.removeOperation(this,a,this._buttons);\nAjxUtil.arrayRemove(this.opList,a)\n};\nZmButtonToolBar.prototype.getOp=function(a){return this.getButton(a)\n};\nZmButtonToolBar.prototype.getTagMenu=function(){var a=this.getButton(ZmOperation.TAG_MENU);\nif(a){return a.getMenu()\n}};\nZmButtonToolBar.prototype.getActionsMenu=function(){return this._secondaryButtonMenu\n};\nZmButtonToolBar.prototype.getActionsButton=function(){return this._secondaryButton\n};\nZmButtonToolBar.prototype._buttonId=function(a){return a.getData(ZmOperation.KEY_ID)\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmNavToolBar\")){ZmNavToolBar=function(b){b.className=b.className||\"ZmNavToolBar\";\nvar a=(b.hasText!==false);\nb.buttons=this._getButtons(a);\nb.toolbarType=ZmId.TB_NAV;\nb.posStyle=b.posStyle||DwtControl.STATIC_STYLE;\nZmButtonToolBar.call(this,b);\nif(a){this._textButton=this.getButton(ZmOperation.TEXT)\n}};\nZmNavToolBar.prototype=new ZmButtonToolBar;\nZmNavToolBar.prototype.constructor=ZmNavToolBar;\nZmNavToolBar.prototype.toString=function(){return\"ZmNavToolBar\"\n};\nZmNavToolBar.prototype.enable=function(d,a){ZmButtonToolBar.prototype.enable.call(this,d,a);\nif(!a){if(!(d instanceof Array)){d=[d]\n}for(var c=0;\nc<d.length;\nc++){var b=this.getButton(d[c]);\nif(b){b.setToolTipContent(null)\n}}}};\nZmNavToolBar.prototype.setToolTip=function(b,c){var a=this.getButton(b);\nif(a){a.setToolTipContent(c)\n}};\nZmNavToolBar.prototype.setText=function(a){if(!this._textButton){return\n}this._textButton.setText(a)\n};\nZmNavToolBar.prototype._getButtons=function(a){var b=[];\nb.push(ZmOperation.PAGE_BACK);\nif(a){b.push(ZmOperation.TEXT)\n}b.push(ZmOperation.PAGE_FORWARD);\nreturn b\n};\nZmNavToolBar.prototype.createOp=function(b,a){a.textClassName=\"ZWidgetTitle ZmNavToolBarTitle\";\nreturn ZmButtonToolBar.prototype.createOp.apply(this,arguments)\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmSearchToolBar\")){ZmSearchToolBar=function(a){if(arguments.length==0){return\n}a.className=a.className||\"ZmSearchToolbar\";\nthis._button={};\nDwtToolBar.apply(this,arguments);\nthis._origin=ZmId.SEARCH;\nthis._searchMenu=null\n};\nZmSearchToolBar.prototype=new DwtToolBar;\nZmSearchToolBar.prototype.constructor=ZmSearchToolBar;\nZmSearchToolBar.prototype.isZmSearchToolBar=true;\nZmSearchToolBar.prototype.toString=function(){return\"ZmSearchToolBar\"\n};\nZmSearchToolBar.prototype.role=\"toolbar\";\nZmSearchToolBar.TYPES_BUTTON=\"TYPES\";\nZmSearchToolBar.SEARCH_BUTTON=\"SEARCH\";\nZmSearchToolBar.SAVE_BUTTON=\"SAVE\";\nZmSearchToolBar.SEARCH_MENU_BUTTON=ZmSearchToolBar.TYPES_BUTTON;\nZmSearchToolBar.MENU_ITEMS=[];\nZmSearchToolBar.SETTING={};\nZmSearchToolBar.MSG_KEY={};\nZmSearchToolBar.TT_MSG_KEY={};\nZmSearchToolBar.ICON={};\nZmSearchToolBar.SHARE_ICON={};\nZmSearchToolBar.ID={};\nZmSearchToolBar.DISABLE_OFFLINE={};\nZmSearchToolBar.addMenuItem=function(b,a){if(a.msgKey){ZmSearchToolBar.MSG_KEY[b]=a.msgKey\n}if(a.tooltipKey){ZmSearchToolBar.TT_MSG_KEY[b]=a.tooltipKey\n}if(a.icon){ZmSearchToolBar.ICON[b]=a.icon\n}if(a.shareIcon){ZmSearchToolBar.SHARE_ICON[b]=a.shareIcon\n}if(a.setting){ZmSearchToolBar.SETTING[b]=a.setting\n}if(a.id){ZmSearchToolBar.ID[b]=a.id\n}if(a.disableOffline){ZmSearchToolBar.DISABLE_OFFLINE[b]=a.disableOffline\n}if(a.index==null||a.index<0||a.index>=ZmSearchToolBar.MENU_ITEMS.length){ZmSearchToolBar.MENU_ITEMS.push(b)\n}else{ZmSearchToolBar.MENU_ITEMS.splice(a.index,0,b)\n}};\nZmSearchToolBar.prototype.removeMenuItem=function(c){var b=this._searchMenu;\nif(b){var a=b.getItemById(ZmOperation.MENUITEM_ID,c);\nif(a){b.removeChild(a);\na.dispose()\n}this._cleanupSeparators(b)\n}};\nZmSearchToolBar.prototype._cleanupSeparators=function(f){var d=this._button[ZmSearchToolBar.TYPES_BUTTON];\nf=f||(d&&d.getMenu());\nif(!f){return\n}var b=f.getItems();\nvar e=[];\nfor(var c=0;\nc<b.length;\nc++){var a=b[c];\nif(a.isSeparator()&&(c==0||c==b.length-1||b[c-1].isSeparator())){e.push(a)\n}}for(var c=0;\nc<e.length;\nc++){var a=e[c];\nf.removeChild(a);\na.dispose()\n}};\nZmSearchToolBar.prototype.getSearchField=function(){return this._searchField.getInputElement()\n};\nZmSearchToolBar.prototype.registerEnterCallback=function(a){this._enterCallback=a\n};\nZmSearchToolBar.prototype.addSelectionListener=function(b,c){var a=this._button[b];\nif(a){a.addSelectionListener(c)\n}};\nZmSearchToolBar.prototype.getButton=function(a){return this._button[a]\n};\nZmSearchToolBar.prototype.getButtons=function(){return AjxUtil.values(this._button)\n};\nZmSearchToolBar.prototype.focus=function(a){if(a){return DwtToolBar.prototype.focus.apply(this,arguments)\n}else{if(this._searchField){this._searchField.focus();\nthis._searchField.moveCursorToEnd();\nreturn this._searchField\n}}};\nZmSearchToolBar.prototype.blur=function(){if(this._searchField){this._searchField.blur()\n}};\nZmSearchToolBar.prototype.setEnabled=function(a){if(this._searchField){this._searchField.setEnabled(a)\n}for(var b in this._button){this._button[b].setEnabled(a)\n}};\nZmSearchToolBar.prototype.setSearchFieldValue=function(a){if(this._searchField&&a!=this.getSearchFieldValue()){this._searchField.setValue(a)\n}};\nZmSearchToolBar.prototype.getSearchFieldValue=function(){return this._searchField?this._searchField.getValue():null\n};\nZmSearchToolBar.prototype._handleKeyDown=function(b){var a=DwtKeyEvent.getCharCode(b);\nif(DwtKeyEvent.IS_RETURN[a]){return this._handleEnterKeyPress(b)\n}return true\n};\nZmSearchToolBar.prototype._handleEnterKeyPress=function(a){if(this._enterCallback){this._enterCallback.run({ev:a,zimletEvent:\"onKeyPressSearchField\",origin:this._origin})\n}return false\n};\nZmSearchToolBar.prototype.initAutocomplete=function(){if(!this._acList){this._acList=new ZmAutocompleteListView(this._getAutocompleteParams());\nthis._acList.handle(this.getSearchField())\n}};\nZmSearchToolBar.prototype._getAutocompleteParams=function(){var a={dataClass:new ZmSearchAutocomplete(),matchValue:\"matchText\",delims:[\" \",\"\\t\"],delimCodes:[3,13,9],separator:\" \",keyDownCallback:this._handleKeyDown.bind(this),contextId:this.toString(),locationCallback:this._getAcLocation.bind(this)};\nreturn a\n};\nZmSearchToolBar.prototype.getAutocompleteListView=function(){return this._acList\n};\nZmSearchToolBar.prototype._getAcLocation=function(){var d=this._searchField.getInputElement();\nif(!d){return{}\n}var c=Dwt.getLocation(d);\nvar b=Dwt.getSize(d);\nvar e=AjxStringUtil.getWidth(d.value);\nif(AjxEnv.isWindows&&(AjxEnv.isFirefox||AjxEnv.isSafari||AjxEnv.isChrome)){e=e*1.2\n}var a=c.x+e;\nvar f=c.y+b.y;\nDwtPoint.tmp.set(a,f);\nreturn DwtPoint.tmp\n};\nZmMainSearchToolBar=function(b){if(arguments.length==0){return\n}ZmSearchToolBar.apply(this,arguments);\nthis._initialize();\nvar a={msgKey:\"searchShared\",tooltipKey:\"searchShared\",icon:\"Group\",setting:ZmSetting.SHARING_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_SHARED),disableOffline:true};\nZmSearchToolBar.addMenuItem(ZmId.SEARCH_SHARED,a);\nif(appCtxt.multiAccounts){var a={msgKey:\"searchAllAccounts\",icon:\"Globe\",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_ALL_ACCOUNTS)};\nZmSearchToolBar.addMenuItem(ZmId.SEARCH_ALL_ACCOUNTS,a)\n}};\nZmMainSearchToolBar.prototype=new ZmSearchToolBar;\nZmMainSearchToolBar.prototype.constructor=ZmMainSearchToolBar;\nZmMainSearchToolBar.prototype.isZmMainSearchToolBar=true;\nZmMainSearchToolBar.prototype.toString=function(){return\"ZmMainSearchToolBar\"\n};\nZmMainSearchToolBar.CUSTOM_ITEM_ID=\"CustomSearchItem\";\nZmMainSearchToolBar.CUSTOM_BUTTON=\"CUSTOM\";\nZmMainSearchToolBar.prototype._initialize=function(){var c=appCtxt.isExternalAccount();\nvar e=ZmSearchToolBar.MENU_ITEMS[0];\nvar b=ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_MENU);\nvar a=this._button[ZmSearchToolBar.TYPES_BUTTON]=new DwtButton({parent:this,index:0,id:b});\na.setImage(ZmSearchToolBar.ICON[e]);\na.setToolTipContent(ZmMsg[ZmSearchToolBar.TT_MSG_KEY[e]],true);\nvar f=new AjxCallback(this,this._createSearchMenu);\na.setMenu(f,false,DwtMenuItem.RADIO_STYLE);\nif(c){a.setEnabled(false)\n}var g=this._searchField=new DwtInputField({parent:this,hint:ZmMsg.searchInput,label:ZmMsg.searchInput,inputId:ZmId.SEARCH_INPUTFIELD});\nvar d=g.getInputElement();\nd.className=\"search_input\";\nthis._searchField._showHint();\nthis._searchField.addListener(DwtEvent.ONFOCUS,this._onInputFocus.bind(this));\nthis._searchField.addListener(DwtEvent.ONBLUR,this._onInputBlur.bind(this));\nif(c){this._searchField.setEnabled(false)\n}g.addListener(DwtEvent.ONFOCUS,this._childFocusListener.bind(this));\na=this._button[ZmSearchToolBar.SEARCH_BUTTON]=new DwtButton({parent:this,className:\"ZmSearchButton\",id:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_SEARCH)});\na.setImage(\"Search2\");\na.setToolTipContent(ZmMsg.searchTooltip,true);\nif(c){if(this._button[ZmSearchToolBar.SEARCH_BUTTON]){this._button[ZmSearchToolBar.SEARCH_BUTTON].setEnabled(false)\n}}};\nZmMainSearchToolBar.prototype._createSearchMenu=function(){var g=this._searchMenu=new DwtMenu({parent:this._button[ZmSearchToolBar.TYPES_BUTTON],className:\"ActionMenu\",id:ZmId.getMenuId(ZmId.SEARCH)});\nvar b;\nif(this._customSearchMenuItems){for(var d=0;\nd<this._customSearchMenuItems.length;\nd++){var c=this._customSearchMenuItems[d];\nthis._createCustomSearchMenuItem(g,c.icon,c.text,c.listener)\n}}var f={parent:g,enabled:true,radioGroupId:0,style:DwtMenuItem.RADIO_STYLE};\nfor(var d=0;\nd<ZmSearchToolBar.MENU_ITEMS.length;\nd++){var h=ZmSearchToolBar.MENU_ITEMS[d];\nif(h==ZmId.SEARCH_SHARED){if(ZmSearchToolBar.MENU_ITEMS.length<=1){continue\n}b=new DwtMenuItem({parent:g,style:DwtMenuItem.SEPARATOR_STYLE})\n}var e=ZmSearchToolBar.SETTING[h];\nif(e&&!appCtxt.get(e)){continue\n}var a=(h==ZmId.SEARCH_SHARED||h==ZmId.SEARCH_ALL_ACCOUNTS);\nif(a){f.style=DwtMenuItem.CHECK_STYLE\n}f.style=(h==ZmId.SEARCH_SHARED||h==ZmId.SEARCH_ALL_ACCOUNTS)?DwtMenuItem.CHECK_STYLE:DwtMenuItem.RADIO_STYLE;\nf.imageInfo=ZmSearchToolBar.ICON[h];\nf.text=ZmMsg[ZmSearchToolBar.MSG_KEY[h]];\nf.id=ZmSearchToolBar.ID[h];\nb=DwtMenuItem.create(f);\nb.setData(ZmOperation.MENUITEM_ID,h);\nif(!a){b.setAttribute(\"aria-label\",ZmMsg[ZmSearchToolBar.TT_MSG_KEY[h]])\n}}this._checkSharedMenuItem();\nappCtxt.getSettings().getSetting(ZmSetting.SEARCH_INCLUDES_SHARED).addChangeListener(this._checkSharedMenuItem.bind(this));\nappCtxt.getSearchController()._addMenuListeners(g);\nthis._searchMenuCreated=true;\nreturn g\n};\nZmMainSearchToolBar.prototype.setOfflineState=function(a){var d=this._button[ZmSearchToolBar.TYPES_BUTTON];\nvar f=d&&d.getMenu();\nvar c=f.getItemCount();\nfor(var b=0;\nb<c;\nb++){var e=f.getItem(b);\nif(e){var g=e.getData(ZmOperation.MENUITEM_ID);\nif(g&&ZmSearchToolBar.DISABLE_OFFLINE[g]){e.setEnabled(!a)\n}}}};\nZmMainSearchToolBar.prototype.getSearchType=function(){var a=this._button[ZmSearchToolBar.TYPES_BUTTON];\nvar d=a&&a.getMenu();\nvar b=d?d.getSelectedItem()||d.getItems()[0]:null;\nvar c=b?b.getData(ZmMainSearchToolBar.CUSTOM_ITEM_ID)||b.getData(ZmOperation.MENUITEM_ID):ZmSearchToolBar.MENU_ITEMS[0];\nreturn c\n};\nZmMainSearchToolBar.prototype.createCustomSearchBtn=function(h,i,d,b){if(!this._customSearchListener){this._customSearchListener=this._customSearchBtnListener.bind(this)\n}var k=document.getElementById(this._htmlElId+\"_customSearchButton\");\nif(k){var f={icon:h,text:i,listener:d};\nvar g=this._button[ZmSearchToolBar.CUSTOM_BUTTON];\nif(!g){g=this._button[ZmSearchToolBar.CUSTOM_BUTTON]=ZmToolBar.addButton({parent:this,tdId:\"_customSearchButton\",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_CUSTOM),lbl:i,icon:h});\ng.setData(ZmMainSearchToolBar.CUSTOM_ITEM_ID,f);\ng.addSelectionListener(this._customSearchListener);\nvar l=document.getElementById(this._htmlElId+\"_customSearchButtonSep\");\nif(l){Dwt.setVisible(l,true)\n}}else{var c=g&&g.getMenu();\nvar j;\nvar e={parent:c,enabled:true,style:DwtMenuItem.RADIO_STYLE,radioGroupId:0,id:b};\nif(!c){var a=g.getData(ZmMainSearchToolBar.CUSTOM_ITEM_ID);\nc=new DwtMenu({parent:g,className:\"ActionMenu\",id:ZmId.getMenuId(ZmId.SEARCH,ZmId.SEARCH_CUSTOM)});\ng.setMenu(c,false,DwtMenuItem.RADIO_STYLE);\ne.imageInfo=a.icon;\ne.text=a.text;\nj=DwtMenuItem.create(e);\nj.setData(ZmMainSearchToolBar.CUSTOM_ITEM_ID,a);\nj.setData(ZmOperation.MENUITEM_ID,ZmId.SEARCH_CUSTOM);\nj.setChecked(true,true);\nj.addSelectionListener(this._customSearchListener)\n}e.imageInfo=h;\ne.text=i;\nj=DwtMenuItem.create(e);\nj.setData(ZmMainSearchToolBar.CUSTOM_ITEM_ID,f);\nj.addSelectionListener(this._customSearchListener)\n}}else{if(this._searchMenuCreated){var c=this._button[ZmSearchToolBar.TYPES_BUTTON].getMenu();\nthis._createCustomSearchMenuItem(c,h,i,d,b)\n}else{if(!this._customSearchMenuItems){this._customSearchMenuItems=[]\n}this._customSearchMenuItems.push({icon:h,text:i,listener:d,id:b})\n}}};\nZmMainSearchToolBar.prototype._createCustomSearchMenuItem=function(g,b,f,d,h){var a=g.getItem(0);\nvar e={parent:g,imageInfo:b,text:f,enabled:true,style:DwtMenuItem.RADIO_STYLE,radioGroupId:0,index:0,id:h};\na=DwtMenuItem.create(e);\nvar c={icon:b,text:f,listener:d};\na.setData(ZmMainSearchToolBar.CUSTOM_ITEM_ID,c);\na.setData(ZmOperation.MENUITEM_ID,ZmId.SEARCH_CUSTOM);\na.addSelectionListener(this._customSearchListener);\nif(!(a&&a.getData(ZmMainSearchToolBar.CUSTOM_ITEM_ID))){a=new DwtMenuItem({parent:g,style:DwtMenuItem.SEPARATOR_STYLE,index:1})\n}};\nZmMainSearchToolBar.prototype._customSearchBtnListener=function(d){var c=d.item;\nif(!c){return\n}var e=c.getData(ZmMainSearchToolBar.CUSTOM_ITEM_ID);\nif(!e){return\n}if(this._customSearchBtn){if(c.isDwtMenuItem){if(d.detail!=DwtMenuItem.CHECKED){return\n}this._customSearchBtn.setToolTipContent(e[1]);\nthis._customSearchBtn.setData(ZmMainSearchToolBar.CUSTOM_ITEM_ID,e)\n}e.listener.run(d)\n}else{var b=this._button[ZmSearchToolBar.TYPES_BUTTON];\nb.setToolTipContent(e.text);\nvar f=c.parent;\nvar a=f?f.getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_SHARED):null;\nif(a){a.setChecked(false,true);\na.setEnabled(false)\n}b.setImage(e.icon);\nb.setText(e.text)\n}};\nZmMainSearchToolBar.prototype._onInputFocus=function(a){this._setInputExpanded(true)\n};\nZmMainSearchToolBar.prototype._onInputBlur=function(b){var a=appCtxt.getKeyboardMgr().getFocusObj();\nif(a!==this._button[ZmSearchToolBar.TYPES_BUTTON]&&a!==this._button[ZmSearchToolBar.SEARCH_BUTTON]&&!this._movingFocus){this._setInputExpanded(false)\n}this._movingFocus=false\n};\nZmMainSearchToolBar.prototype._moveFocus=function(a){this._movingFocus=true;\nZmSearchToolBar.prototype._moveFocus.apply(this,arguments)\n};\nZmMainSearchToolBar.prototype._setInputExpanded=function(c){if(!c&&this._searchMenu&&this._searchMenu.isPoppedUp()){return\n}var b=this._searchField.getInputElement();\nvar a=c?\"search_input-expanded\":\"search_input\";\nif(AjxEnv.isIE9){setTimeout(function(){b.className=a\n},0)\n}else{b.className=a\n}};\nZmMainSearchToolBar.prototype._checkSharedMenuItem=function(){var a=this._searchMenu&&this._searchMenu.getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_SHARED);\nif(a){a.setChecked(appCtxt.get(ZmSetting.SEARCH_INCLUDES_SHARED))\n}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmSearchResultsToolBar\")){ZmSearchResultsToolBar=function(a){a.posStyle=Dwt.ABSOLUTE_STYLE;\na.className=\"ZmSearchResultsToolBar\";\nthis._controller=a.controller;\nZmSearchToolBar.apply(this,arguments);\nthis._bubbleId={};\nthis._origin=ZmId.SEARCHRESULTS;\nthis.initAutocomplete()\n};\nZmSearchResultsToolBar.prototype=new ZmSearchToolBar;\nZmSearchResultsToolBar.prototype.constructor=ZmSearchResultsToolBar;\nZmSearchResultsToolBar.prototype.isZmSearchResultsToolBar=true;\nZmSearchResultsToolBar.prototype.toString=function(){return\"ZmSearchResultsToolBar\"\n};\nZmSearchResultsToolBar.prototype.TEMPLATE=\"share.Widgets#ZmSearchResultsToolBar\";\nZmSearchResultsToolBar.prototype.PENDING_BUBBLE_CONTAINER_CLASS=\"addrBubbleContainerPending\";\nZmSearchResultsToolBar.prototype.PENDING_SEARCH_DELAY=2000;\nZmSearchResultsToolBar.prototype._createHtml=function(){this.getHtmlElement().innerHTML=AjxTemplate.expand(this.TEMPLATE,{id:this._htmlElId});\nvar a=this._controller.getCurrentViewId();\nthis._label=document.getElementById(this._htmlElId+\"_label\");\nthis._iconDiv=document.getElementById(this._htmlElId+\"_icon\");\nvar d=this._htmlElId+\"_inputFieldCell\";\nvar c=document.getElementById(d);\nif(c){var b={parent:this,strictMode:false,id:DwtId.makeId(ZmId.WIDGET_INPUT,a),bubbleAddedCallback:this._bubbleChange.bind(this),bubbleRemovedCallback:this._bubbleChange.bind(this),noOutsideListening:true,type:ZmId.SEARCH};\nvar e=this._searchField=new ZmAddressInputField(b);\ne.reparentHtmlElement(c);\nvar f=this._searchField.getInputElement();\nf.className=\"search_results_input\"\n}this._button[ZmSearchToolBar.SEARCH_BUTTON]=ZmToolBar.addButton({parent:this,tdId:\"_searchButton\",buttonId:ZmId.getButtonId(a,ZmId.SEARCHRESULTS_SEARCH),lbl:ZmMsg.search,tooltip:ZmMsg.searchTooltip});\nthis._button[ZmSearchToolBar.SAVE_BUTTON]=ZmToolBar.addButton({parent:this,setting:ZmSetting.SAVED_SEARCHES_ENABLED,tdId:\"_saveButton\",buttonId:ZmId.getButtonId(a,ZmId.SEARCHRESULTS_SAVE),lbl:ZmMsg.save,tooltip:ZmMsg.saveSearchTooltip})\n};\nZmSearchResultsToolBar.prototype.initAutocomplete=function(){if(!this._acList){this._acList=new ZmAutocompleteListView(this._getAutocompleteParams());\nthis._acList.handle(this.getSearchField(),this._searchField._htmlElId)\n}this._searchField.setAutocompleteListView(this._acList)\n};\nZmSearchResultsToolBar.prototype._getAutocompleteParams=function(){var a=ZmSearchToolBar.prototype._getAutocompleteParams.apply(this,arguments);\na.options={noBubbleParse:true};\nreturn a\n};\nZmSearchResultsToolBar.prototype.setSearch=function(k){this._settingSearch=true;\nthis._searchField.clear(true);\nvar g=k.getTokens();\nif(k.query&&g&&g.length){for(var d=0,e=g.length;\nd<e;\nd++){var c=g[d],a=g[d-1],b=g[d+1];\nvar j=(a&&a.op==ZmParsedQuery.GROUP_CLOSE)||(b&&b.op==ZmParsedQuery.GROUP_OPEN);\nvar h=c.toString(j);\nif(h){var f=this._searchField.addBubble({address:h,noParse:true});\nthis._bubbleId[h]=f.id\n}}}this._settingSearch=false\n};\nZmSearchResultsToolBar.prototype.setLabel=function(b,a){this._label.innerHTML=b;\nthis._iconDiv.style.display=a?\"inline-block\":\"none\"\n};\nZmSearchResultsToolBar.prototype._bubbleChange=function(b,c){this._clearPendingSearchTimeout();\nif(this._settingSearch){return\n}var a=new ZmParsedQuery(b.address);\nvar d=a.getTokens();\nif(d&&d[0]&&d[0].type==ZmParsedQuery.COND){return\n}Dwt.addClass(this._searchField._elRef,this.PENDING_BUBBLE_CONTAINER_CLASS);\nthis._pendingSearchTimeout=setTimeout(this._handleEnterKeyPress.bind(this),this.PENDING_SEARCH_DELAY)\n};\nZmSearchResultsToolBar.prototype._clearPendingSearchTimeout=function(){if(!this._pendingSearchTimeout){return\n}clearTimeout(this._pendingSearchTimeout);\nthis._pendingSearchTimeout=null\n};\nZmSearchResultsToolBar.prototype._handleKeyDown=function(a){this._clearPendingSearchTimeout();\nZmSearchToolBar.prototype._handleKeyDown.apply(this,arguments)\n};\nZmSearchResultsToolBar.prototype._handleEnterKeyPress=function(a){this._clearPendingSearchTimeout();\nDwt.delClass(this._searchField._elRef,this.PENDING_BUBBLE_CONTAINER_CLASS);\nthis.setLabel(ZmMsg.searching);\nZmSearchToolBar.prototype._handleEnterKeyPress.apply(this,arguments)\n};\nZmSearchResultsToolBar.prototype.addSearchTerm=function(b,f,a){var j=b.toString(a);\nvar e;\nif(a){var h=this._searchField._getBubbleList();\nvar d=h.getArray();\nfor(var c=0;\nc<d.length;\nc++){if(h.isSelected(d[c])){e=c;\nbreak\n}}}var g=this._searchField.addBubble({address:j,addClass:b.type,skipNotify:f,index:e});\nif(g){this._bubbleId[j]=g.id;\nreturn g.id\n}};\nZmSearchResultsToolBar.prototype.removeSearchTerm=function(b,a){if(!b){return\n}var c=b.toString();\nvar d=b.isZmSearchToken?this._bubbleId[c]:b;\nif(d){this._searchField.removeBubble(d,a);\ndelete this._bubbleId[c]\n}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmSearchResultsFilterPanel\")){ZmSearchResultsFilterPanel=function(a){a.className=a.className||\"ZmSearchResultsFilterPanel\";\na.posStyle=Dwt.ABSOLUTE_STYLE;\nDwtComposite.apply(this,arguments);\nif(!ZmSearchResultsFilterPanel.BASIC_FILTER){ZmSearchResultsFilterPanel._initConstants()\n}this._controller=a.controller;\nthis._resultsApp=a.resultsApp;\nthis._viewId=this._controller.getCurrentViewId();\nthis._checkbox={};\nthis._menu={};\nthis._advancedFilterHandlers={};\nthis._createHtml();\nthis._addFilters();\nthis._addConditionals()\n};\nZmSearchResultsFilterPanel.prototype=new DwtComposite;\nZmSearchResultsFilterPanel.prototype.constructor=ZmSearchResultsFilterPanel;\nZmSearchResultsFilterPanel.prototype.isZmSearchResultsFilterPanel=true;\nZmSearchResultsFilterPanel.prototype.toString=function(){return\"ZmSearchResultsFilterPanel\"\n};\nZmSearchResultsFilterPanel.prototype.TEMPLATE=\"share.Widgets#ZmSearchResultsFilterPanel\";\nZmSearchResultsFilterPanel.BASIC=\"BasicFilter\";\nZmSearchResultsFilterPanel.ADVANCED=\"AdvancedFilter\";\nZmSearchResultsFilterPanel.ID_ATTACHMENT=\"ATTACHMENT\";\nZmSearchResultsFilterPanel.ID_FLAGGED=\"FLAGGED\";\nZmSearchResultsFilterPanel.ID_UNREAD=\"UNREAD\";\nZmSearchResultsFilterPanel.ID_TO=\"TO\";\nZmSearchResultsFilterPanel.ID_FROM=\"FROM\";\nZmSearchResultsFilterPanel.ID_DATE=\"DATE\";\nZmSearchResultsFilterPanel.ID_DATE_BRIEFCASE=\"DATE_BRIEFCASE\";\nZmSearchResultsFilterPanel.ID_DATE_SENT=\"DATE_SENT\";\nZmSearchResultsFilterPanel.ID_SIZE=\"SIZE\";\nZmSearchResultsFilterPanel.ID_STATUS=\"STATUS\";\nZmSearchResultsFilterPanel.ID_TAG=\"TAG\";\nZmSearchResultsFilterPanel.ID_FOLDER=\"FOLDER\";\nZmSearchResultsFilterPanel.ALL_APPS=\"ALL\";\nZmSearchResultsFilterPanel.BASIC_FILTER_LIST=[ZmSearchResultsFilterPanel.ID_ATTACHMENT,ZmSearchResultsFilterPanel.ID_FLAGGED,ZmSearchResultsFilterPanel.ID_UNREAD];\nZmSearchResultsFilterPanel.ADVANCED_FILTER_LIST=[ZmSearchResultsFilterPanel.ID_FROM,ZmSearchResultsFilterPanel.ID_TO,ZmSearchResultsFilterPanel.ID_DATE,ZmSearchResultsFilterPanel.ID_DATE_BRIEFCASE,ZmSearchResultsFilterPanel.ID_DATE_SENT,ZmSearchResultsFilterPanel.ID_ATTACHMENT,ZmSearchResultsFilterPanel.ID_SIZE,ZmSearchResultsFilterPanel.ID_STATUS,ZmSearchResultsFilterPanel.ID_TAG,ZmSearchResultsFilterPanel.ID_FOLDER];\nZmSearchResultsFilterPanel._initConstants=function(){ZmSearchResultsFilterPanel.BASIC_FILTER={};\nZmSearchResultsFilterPanel.BASIC_FILTER[ZmSearchResultsFilterPanel.ID_ATTACHMENT]={text:ZmMsg.filterHasAttachment,term:new ZmSearchToken(\"has\",\"attachment\"),apps:[ZmApp.MAIL,ZmApp.CALENDAR,ZmApp.TASKS]};\nZmSearchResultsFilterPanel.BASIC_FILTER[ZmSearchResultsFilterPanel.ID_FLAGGED]={text:ZmMsg.filterIsFlagged,term:new ZmSearchToken(\"is\",\"flagged\"),precondition:ZmSetting.FLAGGING_ENABLED};\nZmSearchResultsFilterPanel.BASIC_FILTER[ZmSearchResultsFilterPanel.ID_UNREAD]={text:ZmMsg.filterisUnread,term:new ZmSearchToken(\"is\",\"unread\")};\nZmSearchResultsFilterPanel.ADVANCED_FILTER={};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_FROM]={text:ZmMsg.filterReceivedFrom,handler:\"ZmAddressSearchFilter\",searchOp:\"from\"};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_TO]={text:ZmMsg.filterSentTo,handler:\"ZmAddressSearchFilter\",searchOp:\"to\"};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_DATE]={text:ZmMsg.filterDate,handler:\"ZmApptDateSearchFilter\",apps:[ZmApp.CALENDAR,ZmApp.TASKS]};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_DATE_SENT]={text:ZmMsg.filterDateSent,handler:\"ZmDateSearchFilter\"};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_DATE_BRIEFCASE]={text:ZmMsg.filterDate,handler:\"ZmDateSearchFilter\",apps:[ZmApp.BRIEFCASE]};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_ATTACHMENT]={text:ZmMsg.filterAttachments,handler:\"ZmAttachmentSearchFilter\",searchOp:\"attachment\",apps:[ZmApp.MAIL,ZmApp.CALENDAR,ZmApp.TASKS]};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_SIZE]={text:ZmMsg.filterSize,handler:\"ZmSizeSearchFilter\",apps:[ZmApp.MAIL,ZmApp.BRIEFCASE]};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_STATUS]={text:ZmMsg.filterStatus,handler:\"ZmStatusSearchFilter\",searchOp:\"is\"};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_TAG]={text:ZmMsg.filterTag,handler:\"ZmTagSearchFilter\",searchOp:\"tag\",apps:ZmSearchResultsFilterPanel.ALL_APPS,precondition:appCtxt.getTagTree()&&appCtxt.getTagTree().size()>0};\nZmSearchResultsFilterPanel.ADVANCED_FILTER[ZmSearchResultsFilterPanel.ID_FOLDER]={text:ZmMsg.filterFolder,handler:\"ZmFolderSearchFilter\",searchOp:\"in\",noMenu:true,apps:ZmSearchResultsFilterPanel.ALL_APPS}\n};\nZmSearchResultsFilterPanel.CONDITIONALS=[ZmParsedQuery.COND_AND,ZmParsedQuery.COND_OR,ZmParsedQuery.COND_NOT,ZmParsedQuery.GROUP_OPEN,ZmParsedQuery.GROUP_CLOSE];\nZmSearchResultsFilterPanel.prototype._createHtml=function(){this.getHtmlElement().innerHTML=AjxTemplate.expand(this.TEMPLATE,{id:this._htmlElId});\nthis._basicPanel=document.getElementById(this._htmlElId+\"_basicPanel\");\nthis._basicContainer=document.getElementById(this._htmlElId+\"_basic\");\nthis._advancedPanel=document.getElementById(this._htmlElId+\"_advancedPanel\");\nthis._advancedContainer=document.getElementById(this._htmlElId+\"_advanced\");\nthis._conditionalsContainer=document.getElementById(this._htmlElId+\"_conditionals\")\n};\nZmSearchResultsFilterPanel.prototype._getApplicableFilters=function(d,f){var c=[];\nfor(var a=0;\na<d.length;\na++){var g=d[a];\nvar b=f[g];\nb.index=a;\nif(!appCtxt.checkPrecondition(b.precondition)){continue\n}var e=(b.apps==ZmSearchResultsFilterPanel.ALL_APPS)?b.apps:AjxUtil.arrayAsHash(b.apps||[ZmApp.MAIL]);\nif((b.apps==ZmSearchResultsFilterPanel.ALL_APPS)||e[this._resultsApp]){c.push({id:g,filter:b})\n}}return c\n};\nZmSearchResultsFilterPanel.prototype._addFilters=function(){var c=this._getApplicableFilters(ZmSearchResultsFilterPanel.BASIC_FILTER_LIST,ZmSearchResultsFilterPanel.BASIC_FILTER);\nDwt.setVisible(this._basicPanel,(c.length>0));\nfor(var b=0;\nb<c.length;\nb++){var a=c[b];\nthis._addBasicFilter(a.id,a.filter.text)\n}var c=this._getApplicableFilters(ZmSearchResultsFilterPanel.ADVANCED_FILTER_LIST,ZmSearchResultsFilterPanel.ADVANCED_FILTER);\nDwt.setVisible(this._advancedPanel,(c.length>0));\nthis._addAdvancedFilters()\n};\nZmSearchResultsFilterPanel.prototype._addAdvancedFilters=function(b){ZmSearchResultsFilterPanel.attTypes=b;\nvar d=this._getApplicableFilters(ZmSearchResultsFilterPanel.ADVANCED_FILTER_LIST,ZmSearchResultsFilterPanel.ADVANCED_FILTER);\nDwt.setVisible(this._advancedPanel,(d.length>0));\nfor(var c=0;\nc<d.length;\nc++){var a=d[c];\nthis._addAdvancedFilter(a.id,a.filter.text)\n}};\nZmSearchResultsFilterPanel.prototype._addBasicFilter=function(c,b){var a=this._checkbox[c]=new DwtCheckbox({parent:this,className:\"filter\",parentElement:this._basicContainer,id:DwtId.makeId(ZmId.WIDGET_CHECKBOX,this._viewId,ZmSearchResultsFilterPanel.BASIC,c)});\na.setText(b);\na.addSelectionListener(this._checkboxListener.bind(this,c))\n};\nZmSearchResultsFilterPanel.prototype._checkboxListener=function(e,d){var a=this._checkbox[e];\nif(!a){return\n}var c=ZmSearchResultsFilterPanel.BASIC_FILTER[e];\nvar b=c&&c.term;\nif(b){if(a.isSelected()){this._controller.addSearchTerm(b)\n}else{this._controller.removeSearchTerm(b)\n}}};\nZmSearchResultsFilterPanel.prototype._addAdvancedFilter=function(h,g){var b,f;\nb=new DwtButton({parent:this,parentElement:this._advancedContainer,id:ZmId.getButtonId(this._viewId,h)});\nb.setText(g);\nvar a=b.getHtmlElement();\nvar d=a&&a.firstChild;\nif(d&&d.tagName&&(d.tagName.toLowerCase()==\"table\")){d.style.width=\"100%\"\n}var c=ZmSearchResultsFilterPanel.ADVANCED_FILTER[h];\nif(!c.noMenu){var e={parent:b,id:ZmId.getMenuId(this._viewId,h),style:DwtMenu.POPUP_STYLE};\nf=new AjxCallback(this,this._createMenu,[e,h,c]);\nb.setMenu({menu:f,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE})\n}else{this._createFilter(b,h,c)\n}};\nZmSearchResultsFilterPanel.prototype._createMenu=function(d,e,b,a){var c=this._menu[e]=new DwtMenu(d);\nthis._createFilter(c,e,b);\nreturn c\n};\nZmSearchResultsFilterPanel.prototype._createFilter=function(parent,id,filter){var handler=filter&&filter.handler;\nvar updateCallback=this.update.bind(this,id);\nvar params={parent:parent,id:id,viewId:this._viewId,searchOp:filter.searchOp,updateCallback:updateCallback,resultsApp:this._resultsApp};\nvar filterClass=eval(handler);\nthis._advancedFilterHandlers[id]=new filterClass(params)\n};\nZmSearchResultsFilterPanel.prototype.update=function(a,h,e){if(!a||!h){return\n}h=AjxUtil.toArray(h);\nvar l=this._controller.getSearchTerms();\nif(l&&l.length){var b=AjxUtil.arrayAsHash(AjxUtil.map(l,function(i){return i.op\n}));\nvar c=b[ZmParsedQuery.COND_OR];\nfor(var g=0;\ng<l.length;\ng++){var d=l[g];\nfor(var f=0;\nf<h.length;\nf++){var k=h[f];\nif(this._areExclusiveTerms(d,k,c)){this._controller.removeSearchTerm(d,true)\n}}}}for(var g=0;\ng<h.length;\ng++){this._controller.addSearchTerm(h[g])\n}if(this._menu[a]&&!e){this._menu[a].popdown()\n}};\nZmSearchResultsFilterPanel.prototype.reset=function(){for(var d in this._checkbox){var a=this._checkbox[d];\nif(a){a.setSelected(false)\n}}for(var b in this._advancedFilterHandlers){var c=this._advancedFilterHandlers[b];\nif(c&&c.reset){c.reset()\n}}};\nZmSearchResultsFilterPanel.prototype.resetBasicFiltersToQuery=function(e){var b=ZmSearchResultsFilterPanel.BASIC_FILTER_LIST;\nfor(var c=0;\nc<b.length;\nc++){var f=b[c];\nvar a=this._checkbox[f];\nif(!a){continue\n}var d=ZmSearchResultsFilterPanel.BASIC_FILTER[f];\na.setSelected(e.indexOf(d.term.toString())!==-1)\n}};\nZmSearchResultsFilterPanel.prototype._areExclusiveTerms=function(b,a,c){b=this._translateTerm(b);\na=this._translateTerm(a);\nreturn(ZmParsedQuery.areExclusive(b,a)||(!c&&(b.op==a.op)&&!ZmParsedQuery.isMultiple(b)))\n};\nZmSearchResultsFilterPanel.prototype._translateTerm=function(b){var a;\nif(b.op==\"appt-start\"){var c=b.arg.substr(0,1);\na=(c==\"<\")?\"before\":(c==\">\")?\"after\":\"date\"\n}return a?new ZmSearchToken(a,b.arg):b\n};\nZmSearchResultsFilterPanel.prototype._addConditionals=function(){var d=ZmSearchResultsFilterPanel.CONDITIONALS;\nfor(var c=0;\nc<d.length;\nc++){var e=d[c];\nvar b={parent:appCtxt.getShell(),parentElement:this._conditionalsContainer,address:e,addClass:ZmParsedQuery.COND_OP[e]?ZmParsedQuery.COND:ZmParsedQuery.GROUP};\nvar a=new ZmAddressBubble(b);\na.addSelectionListener(this._conditionalSelectionListener.bind(this))\n}};\nZmSearchResultsFilterPanel.prototype._conditionalSelectionListener=function(b){var a=b.item;\nthis._controller.addSearchTerm(new ZmSearchToken(a.address),true,true)\n};\nZmSearchFilter=function(a){if(arguments.length==0){return\n}this.parent=a.parent;\nthis.id=a.id;\nthis._viewId=a.viewId;\nthis._searchOp=a.searchOp;\nthis._updateCallback=a.updateCallback;\nthis._resultsApp=a.resultsApp;\nthis._setUi(a.parent)\n};\nZmSearchFilter.prototype.isZmSearchFilter=true;\nZmSearchFilter.prototype.toString=function(){return\"ZmSearchFilter\"\n};\nZmSearchFilter.DATA_KEY=\"DATA\";\nZmSearchFilter.prototype._setUi=function(a){};\nZmSearchFilter.prototype._selectionListener=function(b){var c=b&&b.dwtObj&&b.dwtObj.getData(ZmSearchFilter.DATA_KEY);\nif(c&&this._searchOp){var a=new ZmSearchToken(this._searchOp,c);\nthis._updateCallback(a)\n}};\nZmAddressSearchFilter=function(a){ZmSearchFilter.apply(this,arguments)\n};\nZmAddressSearchFilter.prototype=new ZmSearchFilter;\nZmAddressSearchFilter.prototype.constructor=ZmAddressSearchFilter;\nZmAddressSearchFilter.prototype.isZmAddressSearchFilter=true;\nZmAddressSearchFilter.prototype.toString=function(){return\"ZmAddressSearchFilter\"\n};\nZmAddressSearchFilter.ADDRESS=\"address\";\nZmAddressSearchFilter.DOMAIN=\"domain\";\nZmAddressSearchFilter.ADDR={};\nZmAddressSearchFilter.ADDR.from=AjxEmailAddress.FROM;\nZmAddressSearchFilter.ADDR.to=AjxEmailAddress.TO;\nZmAddressSearchFilter.INPUT_WIDTH=25;\nZmAddressSearchFilter.NUM_DOMAINS_TO_FETCH=100;\nZmAddressSearchFilter.NUM_DOMAINS_TO_SHOW=10;\nZmAddressSearchFilter.prototype._addInput=function(f,e,d){var c=new DwtMenuItem({parent:f,id:ZmId.getMenuItemId(this._viewId,this.id,ZmAddressSearchFilter.ADDRESS)});\nc.setText(e);\nvar b=new DwtMenu({parent:c,id:ZmId.getMenuId(this._viewId,this.id,ZmAddressSearchFilter.ADDRESS),style:DwtMenu.GENERIC_WIDGET_STYLE});\nc.setMenu({menu:b,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE});\nvar a=new DwtInputField({parent:b,id:DwtId.makeId(ZmId.WIDGET_INPUT,this._viewId,this.id,ZmAddressSearchFilter.ADDRESS),size:d});\nreturn a\n};\nZmAddressSearchFilter.prototype._addComboBox=function(f,e,c){var b=new DwtMenuItem({parent:f,id:ZmId.getMenuItemId(this._viewId,this.id,ZmAddressSearchFilter.DOMAIN)});\nb.setText(e);\nvar a=new DwtMenu({parent:b,id:ZmId.getMenuId(this._viewId,this.id,ZmAddressSearchFilter.DOMAIN),style:DwtMenu.GENERIC_WIDGET_STYLE});\nb.setMenu({menu:a,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE});\nvar d=new DwtComboBox({parent:a,id:DwtId.makeId(ZmId.WIDGET_COMBOBOX,this._viewId,this.id,ZmAddressSearchFilter.ADDRESS),inputParams:{size:c},maxRows:ZmAddressSearchFilter.NUM_DOMAINS_TO_SHOW,layout:DwtMenu.LAYOUT_SCROLL,autoScroll:true});\nd.addChangeListener(this._domainChangeListener.bind(this));\nd.input.addListener(DwtEvent.ONKEYUP,this._keyUpListener.bind(this));\na.addPopdownListener(d.popdown.bind(d));\nreturn d\n};\nZmAddressSearchFilter.prototype._initAutocomplete=function(){if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)||appCtxt.get(ZmSetting.GAL_ENABLED)||appCtxt.isOffline){var b={dataClass:appCtxt.getAutocompleter(),matchValue:ZmAutocomplete.AC_VALUE_EMAIL,compCallback:this._acCompHandler.bind(this),separator:\"\",contextId:[this._viewId,this.id].join(\"-\")};\nvar a=new ZmAutocompleteListView(b);\na.handle(this._addressBox.getInputElement())\n}};\nZmAddressSearchFilter.prototype._acCompHandler=function(){this._doUpdate(this._addressBox.getValue());\nthis._addressBox.clear()\n};\nZmAddressSearchFilter.prototype._domainChangeListener=function(a){if(a&&a.dwtObj){this._doUpdate(a._args.newValue)\n}};\nZmAddressSearchFilter.prototype._keyUpListener=function(a){var b=DwtKeyEvent.getCharCode(a);\nif(b==13||b==3){this._doUpdate(this._domainBox.getText())\n}};\nZmAddressSearchFilter.prototype._doUpdate=function(a){if(a){var b=new ZmSearchToken(this._searchOp,a);\nthis._updateCallback(b)\n}};\nZmAddressSearchFilter.prototype._setUi=function(b){this._addressBox=this._addInput(b,ZmMsg.address,ZmAddressSearchFilter.INPUT_WIDTH);\nthis._initAutocomplete();\nif(!ZmSearchResultsFilterPanel.domains){var a=new ZmDomainList();\na.search(\"\",ZmAddressSearchFilter.NUM_DOMAINS_TO_FETCH,this._addDomains.bind(this,b))\n}else{this._addDomains(b,ZmSearchResultsFilterPanel.domains)\n}};\nZmAddressSearchFilter.prototype._addDomains=function(e,a){ZmSearchResultsFilterPanel.domains=a;\nthis._domainBox=this._addComboBox(e,ZmMsg.domain,ZmAddressSearchFilter.INPUT_WIDTH);\nif(a&&a.length){for(var b=0;\nb<a.length;\nb++){var c=a[b];\nvar d=ZmAddressSearchFilter.ADDR[this._searchOp];\nif(c.hasAddress(d)){this._domainBox.add(c.name,c.name)\n}}}};\nZmAddressSearchFilter.prototype.reset=function(){if(this._domainBox){this._domainBox.setText(\"\")\n}if(this._addressBox){this._addressBox.setValue(\"\")\n}};\nZmDateSearchFilter=function(a){this._calendar={};\nZmSearchFilter.apply(this,arguments);\nthis._formatter=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT)\n};\nZmDateSearchFilter.prototype=new ZmSearchFilter;\nZmDateSearchFilter.prototype.constructor=ZmDateSearchFilter;\nZmDateSearchFilter.prototype.isZmDateSearchFilter=true;\nZmDateSearchFilter.prototype.toString=function(){return\"ZmDateSearchFilter\"\n};\nZmDateSearchFilter.BEFORE=\"BEFORE\";\nZmDateSearchFilter.AFTER=\"AFTER\";\nZmDateSearchFilter.ON=\"ON\";\nZmDateSearchFilter.TEXT_KEY={};\nZmDateSearchFilter.TEXT_KEY[ZmDateSearchFilter.BEFORE]=\"filterBefore\";\nZmDateSearchFilter.TEXT_KEY[ZmDateSearchFilter.AFTER]=\"filterAfter\";\nZmDateSearchFilter.TEXT_KEY[ZmDateSearchFilter.ON]=\"filterOn\";\nZmDateSearchFilter.OP={};\nZmDateSearchFilter.OP[ZmDateSearchFilter.BEFORE]=\"before\";\nZmDateSearchFilter.OP[ZmDateSearchFilter.AFTER]=\"after\";\nZmDateSearchFilter.OP[ZmDateSearchFilter.ON]=\"date\";\nZmDateSearchFilter.prototype._createCalendar=function(e,c){var b=new DwtMenuItem({parent:e,id:ZmId.getMenuItemId(this._viewId,this.id,c)});\nb.setText(ZmMsg[ZmDateSearchFilter.TEXT_KEY[c]]);\nvar a=new DwtMenu({parent:b,id:ZmId.getMenuId(this._viewId,this.id,c),style:DwtMenu.CALENDAR_PICKER_STYLE});\nb.setMenu({menu:a,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE});\nvar d=new DwtCalendar({parent:a,id:DwtId.makeId(ZmId.WIDGET_CALENDAR,this._viewId,this.id,c)});\nd.addSelectionListener(this._doUpdate.bind(this,c));\nreturn d\n};\nZmDateSearchFilter.prototype._doUpdate=function(c){var d=this._calendar[c];\nvar a=this._formatter.format(d.getDate());\nvar b=this._getSearchTerm(c,a);\nthis._updateCallback(b,true)\n};\nZmDateSearchFilter.prototype._getTypes=function(){return[ZmDateSearchFilter.BEFORE,ZmDateSearchFilter.AFTER,ZmDateSearchFilter.ON]\n};\nZmDateSearchFilter.prototype._getSearchTerm=function(b,a){return new ZmSearchToken(ZmDateSearchFilter.OP[b],a)\n};\nZmDateSearchFilter.prototype._setUi=function(c){var b=this._getTypes();\nfor(var a=0;\na<b.length;\na++){var d=b[a];\nthis._calendar[d]=this._createCalendar(c,d)\n}};\nZmApptDateSearchFilter=function(a){ZmDateSearchFilter.apply(this,arguments)\n};\nZmApptDateSearchFilter.prototype=new ZmDateSearchFilter;\nZmApptDateSearchFilter.prototype.constructor=ZmApptDateSearchFilter;\nZmApptDateSearchFilter.prototype.isZmApptDateSearchFilter=true;\nZmApptDateSearchFilter.prototype.toString=function(){return\"ZmApptDateSearchFilter\"\n};\nZmApptDateSearchFilter.prototype._getSearchTerm=function(b,a){if(b==ZmDateSearchFilter.BEFORE){return new ZmSearchToken(\"appt-start\",\"<\"+a)\n}else{if(b==ZmDateSearchFilter.AFTER){return new ZmSearchToken(\"appt-end\",\">\"+a)\n}else{if(b==ZmDateSearchFilter.ON){return[new ZmSearchToken(\"appt-start\",\"<=\"+a),new ZmSearchToken(\"appt-end\",\">=\"+a)]\n}}}};\nZmAttachmentSearchFilter=function(a){ZmSearchFilter.apply(this,arguments)\n};\nZmAttachmentSearchFilter.prototype=new ZmSearchFilter;\nZmAttachmentSearchFilter.prototype.constructor=ZmAttachmentSearchFilter;\nZmAttachmentSearchFilter.prototype.isZmAttachmentSearchFilter=true;\nZmAttachmentSearchFilter.prototype.toString=function(){return\"ZmAttachmentSearchFilter\"\n};\nZmAttachmentSearchFilter.prototype._setUi=function(b){if(!ZmSearchResultsFilterPanel.attTypes){var a=new ZmAttachmentTypeList();\na.load(this._addAttachmentTypes.bind(this,b))\n}else{this._addAttachmentTypes(b,ZmSearchResultsFilterPanel.attTypes)\n}};\nZmAttachmentSearchFilter.prototype._addAttachmentTypes=function(f,b){ZmSearchResultsFilterPanel.attTypes=b;\nvar e={};\nif(b&&b.length){for(var c=0;\nc<b.length;\nc++){var a=b[c];\nif(e[a.desc]){continue\n}var d=new DwtMenuItem({parent:f,id:ZmId.getMenuItemId(this._viewId,this.id,a.type.replace(\"/\",\":\"))});\nd.setText(a.desc);\nd.setImage(a.image);\nd.setData(ZmSearchFilter.DATA_KEY,a.query||a.type);\ne[a.desc]=true\n}}else{var d=new DwtMenuItem({parent:f});\nd.setText(ZmMsg.noAtt)\n}f.addSelectionListener(this._selectionListener.bind(this))\n};\nZmAttachmentSearchFilter.prototype._selectionListener=function(c){var d=c&&c.dwtObj&&c.dwtObj.getData(ZmSearchFilter.DATA_KEY);\nif(d&&this._searchOp){var b=[];\nif(d==ZmMimeTable.APP_ZIP||d==ZmMimeTable.APP_ZIP2){var a=(d==ZmMimeTable.APP_ZIP)?ZmMimeTable.APP_ZIP2:ZmMimeTable.APP_ZIP;\nb.push(new ZmSearchToken(this._searchOp,d));\nb.push(new ZmSearchToken(ZmParsedQuery.COND_OR));\nb.push(new ZmSearchToken(this._searchOp,a))\n}else{b.push(new ZmSearchToken(this._searchOp,d))\n}this._updateCallback(b)\n}};\nZmSizeSearchFilter=function(a){this._input={};\nZmSearchFilter.apply(this,arguments)\n};\nZmSizeSearchFilter.prototype=new ZmSearchFilter;\nZmSizeSearchFilter.prototype.constructor=ZmSizeSearchFilter;\nZmSizeSearchFilter.prototype.isZmSizeSearchFilter=true;\nZmSizeSearchFilter.prototype.toString=function(){return\"ZmSizeSearchFilter\"\n};\nZmSizeSearchFilter.LARGER=\"LARGER\";\nZmSizeSearchFilter.SMALLER=\"SMALLER\";\nZmSizeSearchFilter.UNIT=\"unit\";\nZmSizeSearchFilter.COMBO_INPUT_WIDTH=2;\nZmSizeSearchFilter.TYPES=[ZmSizeSearchFilter.LARGER,ZmSizeSearchFilter.SMALLER];\nZmSizeSearchFilter.TEXT_KEY={};\nZmSizeSearchFilter.TEXT_KEY[ZmSizeSearchFilter.LARGER]=\"filterLarger\";\nZmSizeSearchFilter.TEXT_KEY[ZmSizeSearchFilter.SMALLER]=\"filterSmaller\";\nZmSizeSearchFilter.OP={};\nZmSizeSearchFilter.OP[ZmSizeSearchFilter.LARGER]=\"larger\";\nZmSizeSearchFilter.OP[ZmSizeSearchFilter.SMALLER]=\"smaller\";\nZmSizeSearchFilter.prototype._setUi=function(h){var d=ZmSizeSearchFilter.TYPES;\nfor(var c=0;\nc<d.length;\nc++){var f=d[c];\nvar e=new DwtMenuItem({parent:h,id:ZmId.getMenuItemId(this._viewId,this.id,f)});\ne.setText(ZmMsg[ZmSizeSearchFilter.TEXT_KEY[f]]);\nvar b=new DwtMenu({parent:e,id:ZmId.getMenuId(this._viewId,this.id,f),style:DwtMenu.GENERIC_WIDGET_STYLE});\nb.addClassName(this.toString()+\"SubMenu\");\ne.setMenu({menu:b,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE});\nvar a=this._input[f]=new DwtInputField({parent:b,type:DwtInputField.FLOAT,errorIconStyle:DwtInputField.ERROR_ICON_LEFT,validationStyle:DwtInputField.CONTINUAL_VALIDATION,size:5});\na.setValidNumberRange(0,1000000);\nvar g=new DwtComboBox({parent:a,parentElement:a.getInputElement().parentNode,id:DwtId.makeId(ZmId.WIDGET_COMBOBOX,this._viewId,this.id,f+ZmSizeSearchFilter.UNIT),inputParams:{size:ZmSizeSearchFilter.COMBO_INPUT_WIDTH},useLabel:true,posStyle:DwtControl.ABSOLUTE_STYLE,className:this.toString()+\"Combobox\"});\na.addListener(DwtEvent.ONKEYUP,this._keyUpListener.bind(this,f,g));\ng.addChangeListener(this._unitChangeListener.bind(this,f,g));\ng.add(ZmMsg.kb,\"KB\",true);\ng.add(ZmMsg.mb,\"MB\")\n}};\nZmSizeSearchFilter.prototype._unitChangeListener=function(b,e,c){var d=this._input[b].getValue();\nif(d&&d!=\"\"){var a=new ZmSearchToken(ZmSizeSearchFilter.OP[b],d+e.getValue());\nthis._updateCallback(a)\n}};\nZmSizeSearchFilter.prototype._keyUpListener=function(c,g,e){var f=DwtKeyEvent.getCharCode(e);\nvar a=this._input[c];\nif(f==13||f==3){var d=a.getValidationError();\nif(d){appCtxt.setStatusMsg(d,ZmStatusView.LEVEL_WARNING)\n}else{var b=new ZmSearchToken(ZmSizeSearchFilter.OP[c],a.getValue()+g.getValue());\nthis._updateCallback(b)\n}}};\nZmStatusSearchFilter=function(a){ZmSearchFilter.apply(this,arguments)\n};\nZmStatusSearchFilter.prototype=new ZmSearchFilter;\nZmStatusSearchFilter.prototype.constructor=ZmStatusSearchFilter;\nZmStatusSearchFilter.prototype.isZmStatusSearchFilter=true;\nZmStatusSearchFilter.prototype.toString=function(){return\"ZmStatusSearchFilter\"\n};\nZmStatusSearchFilter.prototype._setUi=function(e){var a=ZmParsedQuery.IS_VALUES;\nfor(var b=0;\nb<a.length;\nb++){var d=a[b];\nvar c=new DwtMenuItem({parent:e,id:ZmId.getMenuItemId(this._viewId,this.id,d)});\nc.setText(ZmMsg[\"QUERY_IS_\"+d]);\nc.setData(ZmSearchFilter.DATA_KEY,d)\n}e.addSelectionListener(this._selectionListener.bind(this))\n};\nZmTagSearchFilter=function(a){ZmSearchFilter.apply(this,arguments);\nthis._tagList=appCtxt.getTagTree();\nif(this._tagList){this._tagList.addChangeListener(this._tagChangeListener.bind(this))\n}};\nZmTagSearchFilter.prototype=new ZmSearchFilter;\nZmTagSearchFilter.prototype.constructor=ZmTagSearchFilter;\nZmTagSearchFilter.prototype.isZmTagSearchFilter=true;\nZmTagSearchFilter.prototype.toString=function(){return\"ZmTagSearchFilter\"\n};\nZmTagSearchFilter.prototype._setUi=function(e){this._menu=e;\nvar b=appCtxt.getTagTree().asList();\nif(b&&b.length){for(var c=0;\nc<b.length;\nc++){var a=b[c];\nif(a.id==ZmOrganizer.ID_ROOT){continue\n}var d=new DwtMenuItem({parent:e,id:ZmId.getMenuItemId(this._viewId,this.id,a.id)});\nd.setText(a.getName());\nd.setImage(a.getIconWithColor());\nd.setData(ZmSearchFilter.DATA_KEY,a.getName(false,null,true))\n}}e.addSelectionListener(this._selectionListener.bind(this))\n};\nZmTagSearchFilter.prototype._tagChangeListener=function(a){if(this._menu){this._menu.removeChildren();\nthis._setUi(this._menu)\n}};\nZmFolderSearchFilter=function(b){ZmSearchFilter.apply(this,arguments);\nif(!ZmFolderSearchFilter.TEXT_KEY){ZmFolderSearchFilter._initConstants()\n}var a=ZmMsg[ZmFolderSearchFilter.TEXT_KEY[this._resultsApp]]||ZmMsg.filterFolder;\nb.parent.setText(a)\n};\nZmFolderSearchFilter.prototype=new ZmSearchFilter;\nZmFolderSearchFilter.prototype.constructor=ZmFolderSearchFilter;\nZmFolderSearchFilter.prototype.isZmFolderSearchFilter=true;\nZmFolderSearchFilter.prototype.toString=function(){return\"ZmFolderSearchFilter\"\n};\nZmFolderSearchFilter._initConstants=function(a){ZmFolderSearchFilter.TEXT_KEY={};\nZmFolderSearchFilter.TEXT_KEY[ZmApp.MAIL]=\"filterFolder\";\nZmFolderSearchFilter.TEXT_KEY[ZmApp.CALENDAR]=\"filterCalendar\";\nZmFolderSearchFilter.TEXT_KEY[ZmApp.CONTACTS]=\"filterAddressBook\";\nZmFolderSearchFilter.TEXT_KEY[ZmApp.TASKS]=\"filterTasksFolder\";\nZmFolderSearchFilter.TEXT_KEY[ZmApp.BRIEFCASE]=\"filterBriefcase\"\n};\nZmFolderSearchFilter.prototype._setUi=function(a){var d=this._moveMenu=new DwtMenu({parent:a,id:ZmId.getMenuId(this._viewId,this.id)});\nd.getHtmlElement().style.width=\"auto\";\na.setMenu({menu:d,menuPopupStyle:DwtButton.MENU_POPUP_STYLE_CASCADE});\nvar b=this._folderChooser=new ZmFolderChooser({parent:d,id:DwtId.makeId(ZmId.WIDGET_CHOOSER,this._viewId,this.id),hideNewButton:true});\nvar c=this._getMoveParams(b);\nb.setupFolderChooser(c,this._selectionListener.bind(this))\n};\nZmFolderSearchFilter.prototype._getMoveParams=function(a){return{overviewId:a.getOverviewId([this.toString(),this._resultsApp,this._viewId].join(\"_\")),treeIds:[ZmApp.ORGANIZER[this._resultsApp]],noRootSelect:true,treeStyle:DwtTree.SINGLE_STYLE}\n};\nZmFolderSearchFilter.prototype._selectionListener=function(b){if(b){var a=new ZmSearchToken(\"in\",b.createQuery(true));\nthis._updateCallback(a);\nthis._moveMenu.popdown()\n}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmTreeView\")){ZmTreeView=function(a){if(arguments.length==0){return\n}DwtTree.call(this,{parent:a.parent,parentElement:a.parentElement,style:a.treeStyle,isCheckedByDefault:a.isCheckedByDefault,className:(a.className||\"OverviewTree\"),posStyle:a.posStyle,id:a.id});\nthis._headerClass=a.headerClass||\"overviewHeader\";\nthis.overviewId=a.overviewId;\nthis.type=a.type;\nthis.allowedTypes=a.allowedTypes;\nthis.allowedSubTypes=a.allowedSubTypes;\nthis._overview=appCtxt.getOverviewController().getOverview(this.overviewId);\nthis._dragSrc=a.dragSrc;\nthis._dropTgt=a.dropTgt;\nthis.actionSupported=a.actionSupported!==undefined?a.actionSupported:this._overview.actionSupported;\nthis.dynamicWidth=this._overview.dynamicWidth;\nthis._dataTree=null;\nthis._treeItemHash={};\nthis._idToOrganizer={}\n};\nZmTreeView.KEY_TYPE=\"_type_\";\nZmTreeView.KEY_ID=\"_treeId_\";\nZmTreeView.COMPARE_FUNC={};\nZmTreeView.ADD_SEP={};\nZmTreeView.ADD_SEP[ZmFolder.ID_TRASH]=true;\nZmTreeView.MAX_ITEMS=50;\nZmTreeView.getSortIndex=function(f,b,a){if(!a){return null\n}var e=f.getItemCount();\nvar d=f.getItems();\nfor(var c=0;\nc<d.length;\nc++){if(d[c]._isSeparator){continue\n}var h=d[c].getData(Dwt.KEY_OBJECT);\nif(!h){continue\n}var g=a(b,h);\nif(g==-1){return c\n}}return c\n};\nZmTreeView.prototype=new DwtTree;\nZmTreeView.prototype.constructor=ZmTreeView;\nZmTreeView.prototype.toString=function(){return\"ZmTreeView\"\n};\nZmTreeView.prototype.set=function(f){this._showUnread=f.showUnread;\nthis._dataTree=f.dataTree;\nthis._optButton=f.optButton;\nthis.clearItems();\nvar b=this._dataTree.root;\nvar e=(appCtxt.multiAccounts&&(this.type==ZmOrganizer.SEARCH||this.type==ZmOrganizer.TAG));\nvar a=this._getHeaderTreeItemImage();\nvar d=this._headerItem=new DwtHeaderTreeItem({parent:this,className:e?\"DwtTreeItem\":this._headerClass,imageInfo:a,id:ZmId.getTreeItemId(this.overviewId,null,this.type),optButton:f.optButton,dndScrollCallback:this._overview&&this._overview._dndScrollCallback,dndScrollId:this._overview&&this._overview._scrollableContainerId});\nd._isHeader=true;\nvar c=ZmMsg[ZmOrganizer.LABEL[this.type]]||b.name;\nif(c){d.setText(c)\n}d.setData(Dwt.KEY_ID,b.id);\nd.setData(Dwt.KEY_OBJECT,b);\nd.setData(ZmTreeView.KEY_ID,this.overviewId);\nd.setData(ZmTreeView.KEY_TYPE,this.type);\nif(this._dropTgt){d.setDropTarget(this._dropTgt)\n}this._treeItemHash[b.id]=d;\nd.getHtmlElement().style.overflow=\"hidden\";\nf.treeNode=d;\nf.organizer=b;\nthis._render(f);\nd.setExpanded(!f.collapsed,null,true);\nif(!appCtxt.multiAccounts){this.addSeparator()\n}if(appCtxt.getSkinHint(\"noOverviewHeaders\")||this._hideHeaderTreeItem()){d.setVisible(false,true)\n}};\nZmTreeView.prototype.getTreeItemById=function(a){return this._treeItemHash[a]\n};\nZmTreeView.prototype.getHeaderItem=function(){return this._headerItem\n};\nZmTreeView.prototype.getSelected=function(){if(this.isCheckedStyle){var c=[];\nfor(var a in this._treeItemHash){var b=this._treeItemHash[a];\nif(b&&b.getChecked()){c.push(b.getData(Dwt.KEY_OBJECT))\n}}return c\n}else{return(this.getSelectionCount()!=1)?null:this.getSelection()[0].getData(Dwt.KEY_OBJECT)\n}};\nZmTreeView.prototype.setSelected=function(a,b,d){var c=ZmOrganizer.getSystemId((a instanceof ZmOrganizer)?a.id:a);\nif(!c||!this._treeItemHash[c]){return\n}this.setSelection(this._treeItemHash[c],b,false,d)\n};\nZmTreeView.prototype._render=function(params){params.omit=params.omit||{};\nthis._setOmit(params.omit,params.dataTree);\nvar org=params.organizer;\nvar children=org.children.getArray();\nif(org.isDataSource(ZmAccount.TYPE_IMAP)){children.sort(ZmImapAccount.sortCompare)\n}else{if(ZmTreeView.COMPARE_FUNC[this.type]){if(appCtxt.isOffline&&this.type==ZmOrganizer.SEARCH){var local=[];\nfor(var j=0;\nj<children.length;\nj++){var child=children[j];\nif(child&&child.type==ZmOrganizer.SEARCH&&!child.isOfflineGlobalSearch){local.push(child)\n}}children=local\n}if(appCtxt.isChildWindow&&AjxEnv.isIE){var children1=[];\nfor(var i=0,len=children.length;\ni<len;\ni++){children1.push(children[i])\n}children=children1\n}children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]))\n}}var addSep=true;\nvar numItems=0;\nvar len=children.length;\nif(params.startPos===undefined&&params.lastRenderedFolder){for(var i=0,len=children.length;\ni<len;\ni++){if(params.lastRenderedFolder==children[i]){params.startPos=i+1;\nbreak\n}}}for(var i=params.startPos||0;\ni<len;\ni++){var child=children[i];\nif(!child||(params.omit&&params.omit[child.nId])){continue\n}if(!(params.include&&params.include[child.nId])){if(!this._isAllowed(org,child)){if(params.omitParents){continue\n}var proxy=AjxUtil.createProxy(params);\nproxy.treeNode=null;\nproxy.organizer=child;\nthis._render(proxy);\ncontinue\n}}if(child.numTotal==0&&(child.nId==ZmFolder.ID_SYNC_FAILURES)){continue\n}var parentNode=params.treeNode;\nvar account=appCtxt.multiAccounts&&child.getAccount();\nif(account&&account.isCalDavBased()&&child.parent.nId==ZmOrganizer.ID_CALENDAR){parentNode=parentNode.parent\n}if(numItems>=ZmTreeView.MAX_ITEMS){if(params.startPos){params.startPos=i;\nparams.len=(params.startPos+ZmTreeView.MAX_ITEMS>=len)?len:0;\nthis._showRemainingFolders(params);\nreturn\n}else{if(numItems>=ZmTreeView.MAX_ITEMS*2){var orgs=ZmMsg[ZmOrganizer.LABEL[this.type]].toLowerCase();\nvar name=AjxMessageFormat.format(ZmMsg.showRemainingFolders,orgs);\nchild=new ZmFolder({id:ZmFolder.ID_LOAD_FOLDERS,name:name,parent:org});\nchild._tooltip=AjxMessageFormat.format(ZmMsg.showRemainingFoldersTooltip,[(children.length-i),orgs]);\nvar ti=this._addNew(parentNode,child);\nti.enableSelection(true);\nif(this.isCheckedStyle){ti.showCheckBox(false)\n}params.lastRenderedFolder=children[i-1];\nparams.showRemainingFoldersNode=ti;\nchild._showFoldersCallback=new AjxCallback(this,this._showRemainingFolders,[params]);\nif(this._dragSrc){ti._dragHover=this._showRemainingFolders.bind(this,params)\n}return\n}}}if((org.nId==ZmOrganizer.ID_ROOT)&&child.link&&addSep){params.treeNode.addSeparator();\naddSep=false\n}this._addNew(parentNode,child,null,params.noTooltips,params.omit);\nnumItems++\n}};\nZmTreeView.prototype._setOmit=function(c,d){for(var e in ZmFolder.HIDE_ID){c[e]=true\n}d=this.type!==ZmOrganizer.VOICE&&d;\nif(!d){return\n}for(var a in ZmFolder.HIDE_NAME){var b=d.getByName(a);\nif(b){c[b.id]=true\n}}};\nZmTreeView.prototype._isAllowed=function(d,c){if(!d){return true\n}if(this.type===ZmOrganizer.SEARCH&&c.type===ZmOrganizer.SEARCH&&this._overview.appName){var a=c.search.types&&c.search.types.getArray();\nif(!a||a.length===0){a=[ZmItem.MSG]\n}var b=AjxUtil.intersection(a,ZmApp.SEARCH_TYPES[this._overview.appName]||ZmApp.SEARCH_TYPES[appCtxt.getCurrentAppName()]);\nif(b.length===0){return false\n}}if(d.nId==ZmOrganizer.ID_ROOT){return this.allowedTypes[c.type]\n}if(this.allowedTypes[c.type]){return true\n}if(this.allowedSubTypes[c.type]){return this._isAllowed(d.parent,d)\n}return false\n};\nZmTreeView.prototype._addNew=function(h,m,i,l,c){var b;\nvar n;\nvar a=(m.type==ZmOrganizer.FOLDER)&&appCtxt.getDataSourceCollection();\nvar k=a&&a.getByFolderId(m.nId);\nvar d=(k&&k.length>0)?k[0]:null;\nif(d&&d.type==ZmAccount.TYPE_IMAP){var g=appCtxt.isFamilyMbox?null:this._headerClass;\nb=new DwtHeaderTreeItem({parent:this,text:m.getName(),className:g})\n}else{if(!h){var j=[];\nvar f=m.parent;\nif(f){while((h=this.getTreeItemById(f.id))==null){j.push(f);\nf=f.parent\n}}while(f=j.pop()){h=this.getTreeItemById(f.parent.id);\nn=ZmId.getTreeItemId(this.overviewId,f.id);\nh=new DwtTreeItem({parent:h,text:f.getName(),imageInfo:f.getIconWithColor(),forceNotifySelection:true,arrowDisabled:!this.actionSupported,dynamicWidth:this.dynamicWidth,dndScrollCallback:this._overview&&this._overview._dndScrollCallback,dndScrollId:this._overview&&this._overview._scrollableContainerId,id:n});\nh.setData(Dwt.KEY_ID,f.id);\nh.setData(Dwt.KEY_OBJECT,f);\nh.setData(ZmTreeView.KEY_ID,this.overviewId);\nh.setData(ZmTreeView.KEY_TYPE,f.type);\nthis._treeItemHash[f.id]=h;\nthis._idToOrganizer[n]=f.id\n}}var e={parent:h,index:i,text:m.getName(this._showUnread),arrowDisabled:!this.actionSupported,dynamicWidth:this.dynamicWidth,dndScrollCallback:this._overview&&this._overview._dndScrollCallback,dndScrollId:this._overview&&this._overview._scrollableContainerId,imageInfo:m.getIconWithColor(),id:ZmId.getTreeItemId(this.overviewId,m.id)};\nb=new DwtTreeItem(e);\nthis._idToOrganizer[e.id]=m.id\n}if(appCtxt.multiAccounts&&(m.type==ZmOrganizer.SEARCH||m.type==ZmOrganizer.TAG)){b.addClassName(\"DwtTreeItemChildDiv\")\n}b.setDndText(m.getName());\nb.setData(Dwt.KEY_ID,m.id);\nb.setData(Dwt.KEY_OBJECT,m);\nb.setData(ZmTreeView.KEY_ID,this.overviewId);\nb.setData(ZmTreeView.KEY_TYPE,m.type);\nif(!l){var o=m.getToolTip();\nif(o){b.setToolTipContent(o)\n}}if(this._dragSrc){b.setDragSource(this._dragSrc)\n}if(this._dropTgt){b.setDropTarget(this._dropTgt)\n}this._treeItemHash[m.id]=b;\nif(ZmTreeView.ADD_SEP[m.nId]){h.addSeparator()\n}if(m.children&&m.children.size()){this._render({treeNode:b,organizer:m,omit:c})\n}if(d&&d.type==ZmAccount.TYPE_IMAP){b.setExpanded(!appCtxt.get(ZmSetting.COLLAPSE_IMAP_TREES))\n}return b\n};\nZmTreeView.prototype.getNextData=function(b){var g=this.getTreeItemById(b);\nif(!g||!g.parent){return null\n}while(g&&g.parent){var d=g.parent;\nif(!(d instanceof DwtTreeItem)){return null\n}var a=d.getItems();\nvar j=null;\nif(a&&a.length>1){for(var e=0;\ne<a.length;\ne++){var f=a[e];\nif(f==g){var h=this.findNext(g,a,e);\nif(h){return h\n}var c=this.findPrev(g,a,e);\nif(c){return c\n}}}}g=g.parent\n}return null\n};\nZmTreeView.prototype.findNext=function(e,d,b){for(var a=b+1;\na<d.length;\na++){var c=d[a];\nif(c&&c.getData){return c.getData(Dwt.KEY_OBJECT)\n}}return null\n};\nZmTreeView.prototype.findPrev=function(e,d,b){for(var a=b-1;\na>=0;\na--){var c=d[a];\nif(c&&c.getData){return c.getData(Dwt.KEY_OBJECT)\n}}return null\n};\nZmTreeView.prototype._showRemainingFolders=function(a){if(a.showRemainingFoldersNode){a.showRemainingFoldersNode.dispose()\n}AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){this._render(a);\nif(a.len){var b=ZmMsg[ZmOrganizer.LABEL[this.type]].toLowerCase();\nappCtxt.setStatusMsg(AjxMessageFormat.format(ZmMsg.foldersShown,[a.len,b]));\na.len=0\n}}),100)\n};\nZmTreeView.prototype._getNextTreeItem=function(b){var a=DwtTree.prototype._getNextTreeItem.apply(this,arguments);\nreturn a||(this._overview&&this._overview._getNextTreeItem(b,this))\n};\nZmTreeView.prototype._getFirstTreeItem=function(){if(!this._overview){return DwtTree.prototype._getFirstTreeItem.call(a)\n}var b=this._overview.getTreeViews();\nvar a=this._overview.getTreeView(b[0]);\nreturn a&&DwtTree.prototype._getFirstTreeItem.call(a)\n};\nZmTreeView.prototype._getLastTreeItem=function(){if(!this._overview){return DwtTree.prototype._getLastTreeItem.call(a)\n}var b=this._overview.getTreeViews();\nvar a=this._overview.getTreeView(b[b.length-1]);\nreturn a&&DwtTree.prototype._getLastTreeItem.call(a)\n};\nZmTreeView.prototype._hideHeaderTreeItem=function(){return(appCtxt.multiAccounts&&appCtxt.accountList.size()>1&&(this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK||this.type==ZmOrganizer.CALENDAR||this.type==ZmOrganizer.TASKS||this.type==ZmOrganizer.BRIEFCASE||this.type==ZmOrganizer.PREF_PAGE||this.type==ZmOrganizer.ZIMLET))\n};\nZmTreeView.prototype._getHeaderTreeItemImage=function(){if(appCtxt.multiAccounts){if(this.type==ZmOrganizer.SEARCH){return\"SearchFolder\"\n}if(this.type==ZmOrganizer.TAG){return\"TagStack\"\n}}return null\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmTagMenu\")){ZmTagMenu=function(b,a){ZmPopupMenu.call(this,b,null,b.getHTMLElId()+\"|MENU\",a);\nb.setMenu(this);\nthis._addHash={};\nthis._removeHash={};\nthis._evtMgr=new AjxEventMgr();\nthis._desiredState=true;\nthis._items=null;\nthis._dirty=true;\nif(b instanceof DwtMenuItem){b.setHoverDelay(ZmTagMenu._HOVER_TIME)\n}};\nZmTagMenu.prototype=new ZmPopupMenu;\nZmTagMenu.prototype.constructor=ZmTagMenu;\nZmTagMenu.KEY_TAG_EVENT=\"_tagEvent_\";\nZmTagMenu.KEY_TAG_ADDED=\"_tagAdded_\";\nZmTagMenu.MENU_ITEM_ADD_ID=\"tag_add\";\nZmTagMenu.MENU_ITEM_REM_ID=\"tag_remove\";\nZmTagMenu._HOVER_TIME=200;\nZmTagMenu.prototype.toString=function(){return\"ZmTagMenu\"\n};\nZmTagMenu.prototype.addSelectionListener=function(a){this._evtMgr.addListener(DwtEvent.SELECTION,a)\n};\nZmTagMenu.prototype.removeSelectionListener=function(a){this._evtMgr.removeListener(DwtEvent.SELECTION,a)\n};\nZmTagMenu.prototype.setEnabled=function(a){this._desiredState=a;\nif(a&&!this._tagList){return\n}this.parent.setEnabled(a)\n};\nZmTagMenu.prototype.set=function(a,b){this._tagList=b;\nthis._items=a;\nthis._dirty=true;\nif(this.parent instanceof DwtMenuItem){this.parent.setHoverDelay(ZmTagMenu._HOVER_TIME)\n}};\nZmTagMenu.prototype._doPopup=function(b,e,c){if(this._dirty){this.removeChildren();\nif(this._tagList){var d=this._tagList.root;\nvar a=this._getAddRemove(this._items,d);\nthis._render(d,a)\n}this._dirty=false;\nif(this.parent instanceof DwtMenuItem){this.parent.setHoverDelay(0)\n}}ZmPopupMenu.prototype._doPopup.call(this,b,e,c)\n};\nZmTagMenu.prototype._getAddRemove=function(g,k){var h={};\nvar f={};\nfor(var e=0;\ne<g.length;\ne++){var n=g[e];\nif(!n.tags){continue\n}for(var c=0;\nc<n.tags.length;\nc++){var b=n.tags[c];\nh[b]=h[b]||0;\nf[b]=true;\nif(!n.canAddTag(b)){h[b]+=1\n}}}var d=AjxUtil.keys(f);\nvar m=[];\nvar l=k.children.getArray();\nfor(e=0;\ne<l.length;\ne++){var o=l[e];\nb=o.name;\nif(!h[b]||(h[b]<g.length)){m.push(b)\n}}return{add:m,remove:d}\n};\nZmTagMenu.prototype._render=function(j,k){for(var f=0;\nf<k.add.length;\nf++){var c=k.add[f];\nthis._addNewTag(this,c,j,true,null,this._addHash)\n}if(k.add.length){new DwtMenuItem({parent:this,style:DwtMenuItem.SEPARATOR_STYLE})\n}var a=appCtxt.getCurrentController()&&appCtxt.getCurrentController().getKeyMapName();\nvar e=a?(a+\"_newtag\"):this._htmlElId+\"|NEWTAG\";\nvar d=a?(a+\"_removetag\"):this._htmlElId+\"|REMOVETAG\";\nvar l=this._menuItems[ZmTagMenu.MENU_ITEM_ADD_ID]=new DwtMenuItem({parent:this,id:e});\nl.setText(ZmMsg.newTag);\nl.setImage(\"NewTag\");\nl.setShortcut(appCtxt.getShortcutHint(this._keyMap,ZmKeyMap.NEW_TAG));\nl.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_CREATE);\nl.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0);\nl.setEnabled(!appCtxt.isWebClientOffline());\nvar n=this._menuItems[ZmTagMenu.MENU_ITEM_REM_ID]=new DwtMenuItem({parent:this,id:d});\nn.setEnabled(false);\nn.setText(ZmMsg.removeTag);\nn.setImage(\"DeleteTag\");\nvar h=k.remove;\nif(h.length>0){n.setEnabled(true);\nvar b=null;\nif(h.length>1){for(f=0;\nf<h.length;\nf++){if(!b){b=new DwtMenu({parent:n,className:this._className});\nn.setMenu(b);\nb.setHtmlElementId(\"REMOVE_TAG_MENU_\"+this.getHTMLElId())\n}var c=h[f];\nvar m=\"Remove_tag_\"+f;\nthis._addNewTag(b,c,j,false,null,this._removeHash,m)\n}new DwtMenuItem({parent:b,style:DwtMenuItem.SEPARATOR_STYLE});\nvar g=new DwtMenuItem({parent:b,id:\"REMOVE_ALL_TAGS\"});\ng.setText(ZmMsg.allTags);\ng.setImage(\"TagStack\");\ng.setShortcut(appCtxt.getShortcutHint(this._keyMap,ZmKeyMap.UNTAG));\ng.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_REMOVE_ALL);\ng.setData(Dwt.KEY_OBJECT,h);\ng.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0)\n}else{var o=j.getByNameOrRemote(h[0]);\nn.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_TAGS);\nn.setData(ZmTagMenu.KEY_TAG_ADDED,false);\nn.setData(Dwt.KEY_OBJECT,o);\nn.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0)\n}}};\nZmTagMenu.tagNameLength=20;\nZmTagMenu.prototype._addNewTag=function(a,c,h,j,f,e,i){var k=h.getByNameOrRemote(c);\nvar d=new DwtMenuItem({parent:a,index:f,id:i});\nvar b=AjxStringUtil.clipByLength(k.getName(false),ZmTagMenu.tagNameLength);\nvar g=k.notLocal?AjxMessageFormat.format(ZmMsg.tagNotLocal,b):b;\nd.setText(g);\nd.setImage(k.getIconWithColor());\nd.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_TAGS);\nd.setData(ZmTagMenu.KEY_TAG_ADDED,j);\nd.setData(Dwt.KEY_OBJECT,k);\nd.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0);\ne[k.id]=d\n};\nZmTagMenu.prototype._menuItemSelectionListener=function(a){if(a.item.getData(ZmTagMenu.KEY_TAG_EVENT)){this._evtMgr.notifyListeners(DwtEvent.SELECTION,a)\n}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmListView\")){ZmListView=function(d){if(arguments.length==0){return\n}d.id=d.id||ZmId.getViewId(d.view);\nDwtListView.call(this,d);\nthis.view=d.view;\nthis.type=d.type;\nthis._controller=d.controller;\nthis.setDropTarget(d.dropTgt);\nthis._listChangeListener=new AjxListener(this,this._changeListener);\nthis._tagListChangeListener=new AjxListener(this,this._tagChangeListener);\nvar c=appCtxt.getTagTree();\nif(c){c.addChangeListener(this._tagListChangeListener)\n}var b=appCtxt.getFolderTree();\nif(b){this._boundFolderChangeListener=this._folderChangeListener.bind(this);\nb.addChangeListener(this._boundFolderChangeListener)\n}this._handleEventType={};\nthis._handleEventType[this.type]=true;\nthis._disallowSelection={};\nthis._disallowSelection[ZmItem.F_FLAG]=true;\nthis._disallowSelection[ZmItem.F_MSG_PRIORITY]=true;\nthis._selectAllEnabled=false;\nif(d.dropTgt){var a={container:this._parentEl,threshold:15,amount:5,interval:10,id:d.id};\nthis._dndScrollCallback=new AjxCallback(null,DwtControl._dndScrollCallback,[a]);\nthis._dndScrollId=d.id\n}this._isPageless=d.pageless;\nif(this._isPageless){Dwt.setHandler(this._getScrollDiv(),DwtEvent.ONSCROLL,ZmListView.handleScroll)\n}this._state={}\n};\nZmListView.prototype=new DwtListView;\nZmListView.prototype.constructor=ZmListView;\nZmListView.prototype.isZmListView=true;\nZmListView.prototype.toString=function(){return\"ZmListView\"\n};\nZmListView.KEY_ID=\"_keyId\";\nZmListView.COL_WIDTH_ICON=19;\nZmListView.COL_WIDTH_NARROW_ICON=11;\nZmListView.FIELD_CLASS={};\nZmListView.FIELD_CLASS[ZmItem.F_TYPE]=\"ListViewIcon\";\nZmListView.FIELD_CLASS[ZmItem.F_FLAG]=\"Flag\";\nZmListView.FIELD_CLASS[ZmItem.F_TAG]=\"Tag\";\nZmListView.FIELD_CLASS[ZmItem.F_ATTACHMENT]=\"Attach\";\nZmListView.ITEM_FLAG_CLICKED=DwtListView._LAST_REASON+1;\nZmListView.DEFAULT_REPLENISH_THRESHOLD=0;\nZmListView.COL_JOIN=\"|\";\nZmListView.CHECKED_IMAGE=\"CheckboxChecked\";\nZmListView.UNCHECKED_IMAGE=\"CheckboxUnchecked\";\nZmListView.CHECKED_CLASS=\"ImgCheckboxChecked\";\nZmListView.UNCHECKED_CLASS=\"ImgCheckboxUnchecked\";\nZmListView.ITEM_CHECKED_ATT_NAME=\"itemChecked\";\nZmListView.prototype._getHeaderList=function(){};\nZmListView.prototype.getController=function(){return this._controller\n};\nZmListView.prototype.set=function(e,c){this._sortByString=this._controller._currentSearch&&this._controller._currentSearch.sortBy;\nif(this._sortByString){this._sortByString=this._sortByString.replace(\"asc\",\"Asc\").replace(\"desc\",\"Desc\")\n}var d=appCtxt.getSettings();\nif(!appCtxt.isExternalAccount()&&this.view){appCtxt.set(ZmSetting.SORTING_PREF,this._sortByString,this.view,false,false,null,d&&!d.persistImplicitSortPrefs(this.view))\n}this.setSelectionHdrCbox(false);\nif(appCtxt.multiAccounts){var f=appCtxt.getTagTree();\nif(f){f.addChangeListener(this._tagListChangeListener)\n}}if(this._isPageless){if(this._itemsToAdd){if(this._itemsToAdd.length){this.addItems(this._itemsToAdd);\nthis._itemsToAdd=null\n}}else{var b=e;\nif(e&&e.isZmList){e.addChangeListener(this._listChangeListener);\nb=e.getSubList(0,e.size())\n}DwtListView.prototype.set.call(this,b,c)\n}this._setRowHeight()\n}else{var a;\nif(e&&e.isZmList){e.addChangeListener(this._listChangeListener);\na=e.getSubList(this.offset,this.getLimit())\n}else{a=e\n}DwtListView.prototype.set.call(this,a,c)\n}this._rendered=true;\nif(this._isPageless){AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._checkItemCount),1000)\n}};\nZmListView.prototype.reset=function(){this._rendered=false\n};\nZmListView.prototype.setUI=function(a){DwtListView.prototype.setUI.call(this,a);\nthis._resetColWidth()\n};\nZmListView.prototype.getLimit=function(b){if(this._isPageless){var a=appCtxt.get(ZmSetting.PAGE_SIZE);\nreturn b?a:2*a\n}else{return appCtxt.get(ZmSetting.PAGE_SIZE)\n}};\nZmListView.prototype.getPagelessThreshold=function(){return Math.ceil(this.getLimit()/5)\n};\nZmListView.prototype.getReplenishThreshold=function(){return ZmListView.DEFAULT_REPLENISH_THRESHOLD\n};\nZmListView.prototype.getItemList=function(){return this._controller&&this._controller._list\n};\nZmListView.prototype._changeListener=function(m){var n=this._getItemFromEvent(m);\nif(!n||m.handled||!this._handleEventType[n.type]){return\n}if(m.event===ZmEvent.E_TAGS||m.event===ZmEvent.E_REMOVE_ALL){this._replaceTagImage(n,ZmItem.F_TAG,this._getClasses(ZmItem.F_TAG))\n}if(m.event===ZmEvent.E_FLAGS){var a=m.getDetail(\"flags\");\nfor(var b=0;\nb<a.length;\nb++){var k=a[b];\nvar f=n[ZmItem.FLAG_PROP[k]];\nif(k===ZmItem.FLAG_FLAGGED){this._setImage(n,ZmItem.F_FLAG,f?\"FlagRed\":\"FlagDis\",this._getClasses(ZmItem.F_FLAG))\n}else{if(k===ZmItem.FLAG_ATTACH){this._setImage(n,ZmItem.F_ATTACHMENT,f?\"Attachment\":null,this._getClasses(ZmItem.F_ATTACHMENT))\n}else{if(k===ZmItem.FLAG_PRIORITY){this._setImage(n,ZmItem.F_MSG_PRIORITY,f?\"Priority\":\"PriorityDis\",this._getClasses(ZmItem.F_MSG_PRIORITY))\n}}}}}if(m.event===ZmEvent.E_DELETE||m.event===ZmEvent.E_MOVE){var h=m.batchMode?this._getItemsFromBatchEvent(m):[n];\nvar l=false;\nfor(var c=0,e=h.length;\nc<e;\nc++){var n=h[c];\nvar g=(n.type===ZmId.ITEM_CONV)?n.folders[this._folderId]:n.folderId===this._folderId;\nif(g&&m.event===ZmEvent.E_MOVE){if(this._getRowIndex(n)===null){this.addItem(n);\nl=true\n}}else{if(m.event===ZmEvent.E_DELETE||this.view==appCtxt.getCurrentViewId()||this._controller._currentSearch.matches(n)===false){this.removeItem(n,true,m.batchMode);\nvar d=this.getItemList();\nif(m.event!==ZmEvent.E_MOVE||!d.isCanonical){d.remove(n)\n}}}}if(l){this._saveState({scroll:true,selection:true,focus:true});\nthis._redoSearch(this._restoreState.bind(this,this._state))\n}if(m.batchMode){this._fixAlternation(0)\n}this._checkReplenishOnTimer();\nthis._controller._resetToolbarOperations()\n}this._updateLabelForItem(n)\n};\nZmListView.prototype._getItemFromEvent=function(c){var b=c.item;\nif(!b){var a=c.getDetail(\"items\");\nb=(a&&a.length)?a[0]:null\n}return b\n};\nZmListView.prototype._getItemsFromBatchEvent=function(e){if(!e.batchMode){return[]\n}var b=e.items;\nif(!b){b=[];\nvar f=e.getDetail(\"notifs\");\nif(f&&f.length){for(var d=0,a=f.length;\nd<a;\nd++){var c=f[d];\nb.push(c.item||appCtxt.cacheGet(c.id))\n}}}return b\n};\nZmListView.prototype._updateField=function(d,e){var a=this._getFieldId(d,e);\nvar c=document.getElementById(a);\nif(c){var b=[];\nvar f=this._headerHash[e]&&this._headerHash[e]._index;\nthis._getCellContents(b,0,d,e,f,new Date());\nc.innerHTML=$(b.join(\"\")).html()\n}this._updateLabelForItem(d)\n};\nZmListView.prototype._checkReplenishOnTimer=function(a){if(!this.allSelected){if(!this._isPageless){this._controller._app._checkReplenishListView=this\n}else{if(!this._replenishTimedAction){this._replenishTimedAction=new AjxTimedAction(this,this._handleResponseCheckReplenish)\n}AjxTimedAction.scheduleAction(this._replenishTimedAction,10)\n}}};\nZmListView.prototype._checkReplenish=function(b,a){var c=new AjxCallback(this,this._handleResponseCheckReplenish,[false,b,a]);\nthis._controller._checkReplenish(c)\n};\nZmListView.prototype._handleResponseCheckReplenish=function(c,b,a){if(this.size()==0){this._controller._handleEmptyList(this)\n}else{this._controller._resetNavToolBarButtons()\n}if(!c){this._setNextSelection(b,a)\n}};\nZmListView.prototype._folderChangeListener=function(d){if(appCtxt.getCurrentController()!=this._controller){return\n}if(this._controller._app._checkReplenishListView==this){return\n}var c=d.getDetail(\"organizers\");\nvar b=(c&&c.length)?c[0]:d.source;\nvar e=b.id;\nvar a=d.getDetail(\"fields\");\nif(d.event==ZmEvent.E_MODIFY){if(!a){return\n}if(a[ZmOrganizer.F_TOTAL]){this._controller._resetNavToolBarButtons()\n}}};\nZmListView.prototype._tagChangeListener=function(f){if(f.type!=ZmEvent.S_TAG){return\n}var b=f.getDetail(\"fields\");\nvar d=this._getChildren();\nvar a=f.getDetail(\"organizers\")[0];\nfor(var c=0;\nc<d.length;\nc++){var e=this.getItemFromElement(d[c]);\nif(!e||!e.tags||!e.hasTag(a.name)){continue\n}var g=false;\nif(f.event==ZmEvent.E_MODIFY&&(b&&(b[ZmOrganizer.F_COLOR]||b[ZmOrganizer.F_NAME]))){g=e.tags.length==1\n}else{if(f.event==ZmEvent.E_DELETE){g=true\n}else{if(f.event==ZmEvent.E_CREATE){g=true\n}}}if(g){this._replaceTagImage(e,ZmItem.F_TAG,this._getClasses(ZmItem.F_TAG))\n}}};\nZmListView.prototype._getChildren=function(){return this._parentEl.childNodes\n};\nZmListView.prototype._getRowId=function(a){return DwtId.getListViewItemId(DwtId.WIDGET_ITEM_FIELD,this._view,a?a.id:Dwt.getNextId(),ZmItem.F_ITEM_ROW)\n};\nZmListView.prototype._getCellId=function(a,b){if(b==ZmItem.F_DATE){return this._getFieldId(a,b)\n}else{if(b==ZmItem.F_SELECTION){return this._getFieldId(a,ZmItem.F_SELECTION_CELL)\n}else{return DwtListView.prototype._getCellId.apply(this,arguments)\n}}};\nZmListView.prototype._getCellClass=function(a,b,c){return ZmListView.FIELD_CLASS[b]\n};\nZmListView.prototype._getCellContents=function(b,a,d,e,h,g,c){if(e==ZmItem.F_SELECTION){a=this._getImageHtml(b,a,\"CheckboxUnchecked\",this._getFieldId(d,e),c)\n}else{if(e==ZmItem.F_TYPE){a=this._getImageHtml(b,a,ZmItem.ICON[d.type],this._getFieldId(d,e),c)\n}else{if(e==ZmItem.F_FLAG){a=this._getImageHtml(b,a,this._getFlagIcon(d.isFlagged),this._getFieldId(d,e),c)\n}else{if(e==ZmItem.F_TAG){a=this._getImageHtml(b,a,d.getTagImageInfo(),this._getFieldId(d,e),c)\n}else{if(e==ZmItem.F_ATTACHMENT){a=this._getImageHtml(b,a,d.hasAttach?\"Attachment\":null,this._getFieldId(d,e),c)\n}else{if(e==ZmItem.F_DATE){b[a++]=AjxDateUtil.computeDateStr(g.now||new Date(),d.date)\n}else{if(e==ZmItem.F_PRIORITY){var f=null;\nif(d.isHighPriority){f=\"PriorityHigh_list\"\n}else{if(d.isLowPriority){f=\"PriorityLow_list\"\n}}if(f){a=this._getImageHtml(b,a,f,this._getFieldId(d,e),c)\n}else{b[a++]=\"<div id='\"+this._getFieldId(d,e)+\"' \"+AjxUtil.getClassAttr(c)+\"></div>\"\n}}else{a=DwtListView.prototype._getCellContents.apply(this,arguments)\n}}}}}}}return a\n};\nZmListView.prototype._getImageHtml=function(c,b,a,e,d){c[b++]=\"<div\";\nif(e){c[b++]=[\" id='\",e,\"' \"].join(\"\")\n}c[b++]=AjxUtil.getClassAttr(d);\nc[b++]=\">\";\nc[b++]=AjxImg.getImageHtml(a||\"Blank_16\");\nc[b++]=\"</div>\";\nreturn b\n};\nZmListView.prototype._getClasses=function(b,a){if(this.isMultiColumn&&this.isMultiColumn()&&this._headerHash[b]){a=a||[];\na=[this._headerHash[b]._cssClass]\n}return a\n};\nZmListView.prototype._setImage=function(d,e,b,c){var a=this._getElement(d,e);\nif(a){if(c){a.className=AjxUtil.uniq(c).join(\" \")\n}a.innerHTML=AjxImg.getImageHtml(b||\"Blank_16\")\n}};\nZmListView.prototype._replaceTagImage=function(b,c,a){this._setImage(b,c,b.getTagImageInfo(),a)\n};\nZmListView.prototype._getFragmentSpan=function(a){return[\"<span class='ZmConvListFragment' aria-hidden='true' id='\",this._getFieldId(a,ZmItem.F_FRAGMENT),\"'>\",this._getFragmentHtml(a),\"</span>\"].join(\"\")\n};\nZmListView.prototype._getFragmentHtml=function(a){return[\" - \",AjxStringUtil.htmlEncode(a.fragment,true)].join(\"\")\n};\nZmListView.prototype._getFlagIcon=function(c,a,b){if(!c&&!a){return\"Blank_16\"\n}else{if(b){return\"FlagDis\"\n}else{return\"FlagRed\"\n}}};\nZmListView.prototype._parseId=function(b){var a=b.split(DwtId.SEP);\nif(a&&a.length){return{view:a[1],item:a[2],field:a[3],participant:a[4]}\n}else{return null\n}};\nZmListView.prototype._mouseDownAction=function(a,b){return !Dwt.ffScrollbarCheck(a)\n};\nZmListView.prototype._mouseUpAction=function(a,b){return !Dwt.ffScrollbarCheck(a)\n};\nZmListView.prototype._getField=function(c,g){var e=this._getEventTarget(c);\nvar f=e&&e.id||g.id;\nif(!f){return null\n}var d=this._data[g.id];\nvar b=d.type;\nif(!b||b!=DwtListView.TYPE_LIST_ITEM){return null\n}var a=this._parseId(f);\nif(!a||!a.field){return null\n}return a.field\n};\nZmListView.prototype._mouseOutAction=function(b,e){DwtListView.prototype._mouseOutAction.call(this,b,e);\nvar d=this._getField(b,e);\nif(!d){return true\n}if(d==ZmItem.F_FLAG){var a=this.getItemFromElement(e);\nif(!a.isFlagged){var c=this._getEventTarget(b);\nAjxImg.setImage(c,this._getFlagIcon(a.isFlagged,false),false,false);\nc.className=this._getClasses(d)\n}}return true\n};\nZmListView.prototype._mouseOverAction=function(b,e){DwtListView.prototype._mouseOverAction.call(this,b,e);\nvar d=this._getField(b,e);\nif(!d){return true\n}if(d===ZmItem.F_FLAG){var a=this.getItemFromElement(e);\nif(!a.isReadOnly()&&!a.isFlagged){var c=this._getEventTarget(b);\nAjxImg.setDisabledImage(c,this._getFlagIcon(a.isFlagged,true),false);\nc.className=this._getClasses(d)\n}}return true\n};\nZmListView.prototype._doubleClickAction=function(b,e){var c=this._getEventTarget(b);\nvar d=c&&c.id||e.id;\nif(!d){return true\n}var a=this._parseId(d);\nreturn(!(a&&(a.field==ZmItem.F_FLAG)))\n};\nZmListView.prototype._itemClicked=function(d,h){if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)&&h.button==DwtMouseEvent.LEFT){if(!h.shiftKey&&!h.ctrlKey){var g=this._getEventTarget(h);\nvar b=(g&&g.id&&g.id.indexOf(\"AjxImg\")==-1)?g.id:d.id;\nvar e=b?this._parseId(b):null;\nif(e&&(e.field==ZmItem.F_SELECTION||e.field==ZmItem.F_SELECTION_CELL)){if(this._selectedItems.size()==1){var c=this._selectedItems.get(0);\nvar k=this.getItemFromElement(c);\nvar i=k?this._getFieldId(k,ZmItem.F_SELECTION):null;\nvar j=i?document.getElementById(i):null;\nif(j&&c==d){var f=this._getItemData(c,ZmListView.ITEM_CHECKED_ATT_NAME);\nthis._setImage(k,ZmItem.F_SELECTION,f?ZmListView.UNCHECKED_IMAGE:ZmListView.CHECKED_IMAGE);\nthis._setItemData(c,ZmListView.ITEM_CHECKED_ATT_NAME,!f);\nif(!f){return\n}}else{if(j&&!this._getItemData(c,ZmListView.ITEM_CHECKED_ATT_NAME)){this.deselectAll();\nthis._markUnselectedViewedItem(true)\n}}}var a=this._selectedItems.contains(d);\nthis.setMultiSelection(d,a);\nthis._controller._setItemSelectionCountText();\nreturn\n}}else{if(h.shiftKey){this._checkSelectedItems(false);\nDwtListView.prototype._itemClicked.call(this,d,h);\nthis._checkSelectedItems(true);\nreturn\n}}}DwtListView.prototype._itemClicked.call(this,d,h)\n};\nZmListView.prototype._columnClicked=function(b,a){DwtListView.prototype._columnClicked.call(this,b,a);\nthis._checkSelectionColumnClicked(b,a)\n};\nZmListView.prototype._checkSelectionColumnClicked=function(g,e){if(!appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){return\n}var f=this.getList();\nvar c=f?f.size():null;\nif(c>0){var a=this._data[g.id].index;\nvar d=this._headerList[a];\nif(d&&(d._field==ZmItem.F_SELECTION)){var b=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,d._field);\nvar h=document.getElementById(b);\nif(h){if(h.className==ZmListView.CHECKED_CLASS){if(e.shiftKey&&!this.allSelected){this.selectAll(e.shiftKey)\n}else{this.deselectAll();\nh.className=ZmListView.UNCHECKED_CLASS\n}}else{this.allSelected=false;\nh.className=ZmListView.CHECKED_CLASS;\nthis.selectAll(e.shiftKey)\n}}}this._controller._resetToolbarOperations()\n}};\nZmListView.prototype.handleKeyAction=function(a,b){var c=DwtListView.prototype.handleKeyAction.call(this,a,b);\nif(a==DwtKeyMap.SELECT_ALL){this._controller._resetToolbarOperations()\n}return c\n};\nZmListView.prototype.setMultiSelection=function(a,c,b){if(b&&b.ctrlKey&&this._selectedItems.size()==1){this._checkSelectedItems(true)\n}DwtListView.prototype.setMultiSelection.call(this,a,c);\nthis.setSelectionCbox(a,c);\nthis.setSelectionHdrCbox(this._isAllChecked());\nthis._controller._resetToolbarOperations()\n};\nZmListView.prototype._isAllChecked=function(){var a=this.getList();\nreturn(a&&(this.getSelection().length==a.size()))\n};\nZmListView.prototype.setSelectionCbox=function(e,d){if(!e){return\n}var b=e.tagName?this.getItemFromElement(e):e;\nvar a=b?this._getFieldId(b,ZmItem.F_SELECTION):null;\nvar c=a?document.getElementById(a):null;\nif(c){this._setImage(b,ZmItem.F_SELECTION,d?ZmListView.UNCHECKED_IMAGE:ZmListView.CHECKED_IMAGE);\nthis._setItemData(this._getElFromItem(b),ZmListView.ITEM_CHECKED_ATT_NAME,!d)\n}};\nZmListView.prototype.setSelectionHdrCbox=function(b){var c=this._headerHash?this._headerHash[ZmItem.F_SELECTION]:null;\nvar a=c?DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,c._field):null;\nvar d=a?document.getElementById(a):null;\nif(d){d.className=b?ZmListView.CHECKED_CLASS:ZmListView.UNCHECKED_CLASS\n}};\nZmListView.prototype.setSelectedItems=function(b,a){DwtListView.prototype.setSelectedItems.call(this,b);\nif(!a&&appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){this._checkSelectedItems(true,true)\n}};\nZmListView.prototype.selectAll=function(c){DwtListView.prototype.selectAll.apply(this,arguments);\nif(this._selectAllEnabled){var l=this._controller._activeSearch;\nif(l&&l.getAttribute(\"more\")){var h=this.getList(),k=this.type,d=\"type\"+AjxStringUtil.capitalize(ZmItem.MSG_KEY[k]),g=AjxMessageFormat.format(ZmMsg[d],h?h.size():2),e=appCtxt.getShortcutHint(null,ZmKeyMap.SELECT_ALL),j=[h?h.size():ZmMsg.all,g,e,\"ZmListView.selectAllResults()\"],b=AjxMessageFormat.format(ZmMsg.allPageSelected,j);\nif(c){this.allSelected=true;\nb=ZmMsg.allSearchSelected\n}appCtxt.setStatusMsg(b)\n}var a=this._selectedItems.getArray();\nfor(var f=0;\nf<a.length;\nf++){this.setSelectionCbox(a[f],false)\n}}};\nZmListView.selectAllResults=function(){var a=appCtxt.getCurrentController();\nvar b=a&&a.getListView();\nif(b&&b.selectAll){b.selectAll(true)\n}};\nZmListView.prototype.deselectAll=function(){this.allSelected=false;\nif(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){this._checkSelectedItems(false);\nvar a=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,ZmItem.F_SELECTION);\nvar d=document.getElementById(a);\nif(d){d.className=ZmListView.UNCHECKED_CLASS\n}var c=this._selectedItems.getArray();\nfor(var b=0;\nb<c.length;\nb++){this.setSelectionCbox(c[b],true)\n}}DwtListView.prototype.deselectAll.call(this)\n};\nZmListView.prototype._checkSelectedItems=function(a){var e=this.getSelection();\nfor(var c=0;\nc<e.length;\nc++){this.setSelectionCbox(e[c],!a)\n}var d=this.getList();\nvar b=d&&d.size();\nthis.setSelectionHdrCbox(b&&e.length==b)\n};\nZmListView.prototype._setNoResultsHtml=function(){DwtListView.prototype._setNoResultsHtml.call(this);\nthis.setSelectionHdrCbox(false);\nthis._rendered=true\n};\nZmListView.prototype._clearRightSel=function(){DwtListView.prototype._clearRightSel.call(this);\nthis._controller._resetToolbarOperations()\n};\nZmListView.prototype._getSortMenu=function(e,c,h){var b=new ZmPopupMenu(h||this,null,Dwt.getNextId(\"SORT_MENU_\"));\nvar a=this._sortMenuListener.bind(this);\nfor(var f=0;\nf<e.length;\nf++){var d=e[f];\nvar j=ZmMsg[d.msg];\nvar g=b.createMenuItem(d.field,{text:h&&h.isDwtMenuItem?j:AjxMessageFormat.format(ZmMsg.arrangeBy,j),style:DwtMenuItem.RADIO_STYLE});\nif(d.field==c){g.setChecked(true,true)\n}g.setData(ZmListView.KEY_ID,d.field);\nb.addSelectionListener(d.field,a)\n}return b\n};\nZmListView.prototype._sortMenuListener=function(d){var c;\nif(this.isMultiColumn()){var b=d&&d.item&&d.item.getData(ZmOperation.MENUITEM_ID);\nc=this._headerHash[b]\n}else{c=this._headerHash[ZmItem.F_SORTED_BY];\nvar a=document.getElementById(DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c._field));\nif(a){var e=d.item.getText();\na.innerHTML=e&&e.replace(ZmMsg.sortBy,ZmMsg.sortedBy)\n}c._sortable=d.item.getData(ZmListView.KEY_ID)\n}this._bSortAsc=(c._sortable===this._currentSortColId)?!this._bSortAsc:this._isDefaultSortAscending(c);\nthis._sortColumn(c,this._bSortAsc)\n};\nZmListView.prototype._getActionMenuForColHeader=function(c,j,e){var f;\nif(!this._colHeaderActionMenu||c){f=new ZmPopupMenu(j||this);\nvar b=this._colHeaderActionListener.bind(this);\nfor(var g=0;\ng<this._headerList.length;\ng++){var d=this._headerList[g];\nif(d._width){var a=ZmId.getMenuItemId([this._view,e].join(\"_\"),d._field);\nvar h=f.createMenuItem(a,{text:d._name,style:DwtMenuItem.CHECK_STYLE});\nh.setData(ZmListView.KEY_ID,d._id);\nh.setChecked(d._visible,true);\nif(d._noRemove){h.setEnabled(false)\n}f.addSelectionListener(a,b)\n}}}return f\n};\nZmListView.prototype._colHeaderActionListener=function(c){var d=c.item.getData(ZmListView.KEY_ID);\nfor(var b=0;\nb<this._headerList.length;\nb++){var a=this._headerList[b];\nif(a._id==d){a._visible=!a._visible;\nbreak\n}}this._relayout()\n};\nZmListView.prototype.getToolTipContent=function(i){var a=this.getTargetItemDiv(i);\nif(!a){return\"\"\n}var g=Dwt.findAncestor(this._getEventTarget(i),\"id\"),c=(g&&g.id)||a.id;\nif(!c){return\"\"\n}var e=this._data[a.id];\nvar h=e.type;\nvar l;\nif(h&&h==DwtListView.TYPE_HEADER_ITEM){var b=e.index;\nvar j=this._headerList[b]._field;\nl=this._getHeaderToolTip(j,b)\n}else{var f=this._parseId(c);\nif(f&&f.field){var k=this.getItemFromElement(a);\nvar d={field:f.field,item:k,ev:i,div:a,match:f};\nl=this._getToolTip(d)\n}}return l\n};\nZmListView.prototype.getTooltipBase=function(a){return a?DwtUiEvent.getTargetWithProp(a.object,\"id\"):DwtListView.prototype.getTooltipBase.apply(this,arguments)\n};\nZmListView.prototype._getHeaderToolTip=function(c,a,e){var b=null;\nvar d=this._headerList[a]._sortable;\nif(c==ZmItem.F_SELECTION){b=ZmMsg.selectionColumn\n}else{if(c==ZmItem.F_FLAG){b=ZmMsg.flagHeaderToolTip\n}else{if(c==ZmItem.F_PRIORITY){b=ZmMsg.priorityHeaderTooltip\n}else{if(c==ZmItem.F_TAG){b=ZmMsg.tag\n}else{if(c==ZmItem.F_ATTACHMENT){b=ZmMsg.attachmentHeaderToolTip\n}else{if(c==ZmItem.F_SUBJECT){b=d?ZmMsg.sortBySubject:ZmMsg.subject\n}else{if(c==ZmItem.F_DATE){if(d){if(e){b=(this._folderId==ZmFolder.ID_DRAFTS)?ZmMsg.sortByLastSaved:ZmMsg.sortBySent\n}else{b=ZmMsg.sortByReceived\n}}else{b=ZmMsg.date\n}}else{if(c==ZmItem.F_FROM){b=d?e?ZmMsg.sortByTo:ZmMsg.sortByFrom:e?ZmMsg.to:ZmMsg.from\n}else{if(c==ZmItem.F_SIZE){b=d?ZmMsg.sortBySize:ZmMsg.sizeToolTip\n}else{if(c==ZmItem.F_ACCOUNT){b=ZmMsg.account\n}else{if(c==ZmItem.F_FOLDER){b=ZmMsg.folder\n}else{if(c==ZmItem.F_MSG_PRIORITY){b=ZmMsg.messagePriority\n}}}}}}}}}}}}return b\n};\nZmListView.prototype._getToolTip=function(d){var b,c=d.field,a=d.item,e=d.div;\nif(c==ZmItem.F_FLAG){return null\n}else{if(c==ZmItem.F_PRIORITY){if(a.isHighPriority){b=ZmMsg.highPriorityTooltip\n}else{if(a.isLowPriority){b=ZmMsg.lowPriorityTooltip\n}}}else{if(c==ZmItem.F_TAG){b=this._getTagToolTip(a)\n}else{if(c==ZmItem.F_ATTACHMENT){}else{if(e&&(c==ZmItem.F_DATE)){b=this._getDateToolTip(a,e)\n}}}}}return b\n};\nZmListView.prototype._getLabelFieldList=function(){var a=this._getHeaderList();\nif(a){return AjxUtil.map(a,function(b){return b._field\n})\n}};\nZmListView.prototype._getLabelForField=function(a,c){var b=this._getToolTip({item:a,field:c});\nreturn AjxStringUtil.stripTags(b)\n};\nZmListView.prototype._updateLabelForItem=function(f){var a=this._getLabelFieldList();\nvar b=this._getElFromItem(f);\nif(!f||!a||!b){return\n}var d=[];\nfor(var e=0;\ne<a.length;\ne++){var c=this._getLabelForField(f,a[e]);\nif(c){d.push(c)\n}}if(d.length>0){b.setAttribute(\"aria-label\",d.join(\", \"))\n}else{b.removeAttribute(\"aria-label\")\n}};\nZmListView.prototype._getTagToolTip=function(g){if(!g){return\n}var c=g.tags&&g.tags.length;\nif(!c){return\n}var e=appCtxt.getAccountTagList(g);\nvar h=g.tags;\nvar b=[];\nvar f=0;\nfor(var a=0;\na<c;\na++){var j=e.getByNameOrRemote(h[a]);\nif(!j){continue\n}var d=j.notLocal?AjxMessageFormat.format(ZmMsg.tagNotLocal,j.name):j.name;\nb[f++]=\"<table><tr><td>\";\nb[f++]=AjxImg.getImageHtml(j.getIconWithColor());\nb[f++]=\"</td><td valign='middle'>\";\nb[f++]=AjxStringUtil.htmlEncode(d);\nb[f++]=\"</td></tr></table>\"\n}return b.join(\"\")\n};\nZmListView.prototype._getAttachmentToolTip=function(a){var b=null;\nvar d=a&&a.attachments?a.attachments:[];\nif(d.length==1){var c=ZmMimeTable.getInfo(d[0].ct);\nb=c?c.desc:null\n}else{if(d.length>1){b=AjxMessageFormat.format(ZmMsg.multipleAttachmentsTooltip,[d.length])\n}}return b\n};\nZmListView.prototype._getDateToolTip=function(a,b){b._dateStr=b._dateStr||this._getDateToolTipText(a.date);\nreturn b._dateStr\n};\nZmListView.prototype._getDateToolTipText=function(b,e){if(!b){return\"\"\n}var a=[];\nvar c=0;\na[c++]=e;\nvar d=AjxDateFormat.getDateTimeInstance(AjxDateFormat.FULL,AjxDateFormat.MEDIUM);\na[c++]=d.format(new Date(b));\nvar f=AjxDateUtil.computeDateDelta(b);\nif(f){a[c++]=\"<br><center><span style='white-space:nowrap'>(\";\na[c++]=f;\na[c++]=\")</span></center>\"\n}return a.join(\"\")\n};\nZmListView.prototype._setListEvent=function(d,f,b){DwtListView.prototype._setListEvent.call(this,d,f,b);\nvar e=this._getEventTarget(d);\nvar g=(e&&e.id&&e.id.indexOf(\"AjxImg\")==-1)?e.id:b.id;\nif(!g){return false\n}var a=this._parseId(g);\nif(d.button==DwtMouseEvent.LEFT){this._selEv.field=a?a.field:null\n}else{if(d.button==DwtMouseEvent.RIGHT){this._actionEv.field=a?a.field:null;\nif(a&&a.field){if(a.field==ZmItem.F_PARTICIPANT){var c=this.getItemFromElement(b);\nthis._actionEv.detail=c.participants?c.participants.get(a.participant):null\n}}}}return true\n};\nZmListView.prototype._allowLeftSelection=function(d,e,b){if(!(e instanceof DwtMouseEvent)){return true\n}var g=this._getEventTarget(e);\nvar h=(g&&g.id&&g.id.indexOf(\"AjxImg\")==-1)?g.id:d.id;\nvar f=this._data[d.id];\nvar c=f.type;\nif(h&&c&&c==DwtListView.TYPE_LIST_ITEM){var a=this._parseId(h);\nif(a&&a.field){return this._allowFieldSelection(a.item,a.field)\n}}return true\n};\nZmListView.prototype._allowFieldSelection=function(b,a){return(!this._disallowSelection[a])\n};\nZmListView.prototype._redoSearch=function(e){var a=this._controller._currentSearch;\nif(!a){return\n}var d=this.getSelection();\nvar c=d&&d[0];\nvar b={isRedo:true,selectedItem:c};\nappCtxt.getSearchController().redoSearch(a,false,b,e)\n};\nZmListView.prototype._sortColumn=function(d,f,h){var g;\nswitch(d._sortable){case ZmItem.F_FROM:g=f?ZmSearch.NAME_ASC:ZmSearch.NAME_DESC;\nbreak;\ncase ZmItem.F_TO:g=f?ZmSearch.RCPT_ASC:ZmSearch.RCPT_DESC;\nbreak;\ncase ZmItem.F_NAME:g=f?ZmSearch.SUBJ_ASC:ZmSearch.SUBJ_DESC;\nbreak;\ncase ZmItem.F_SUBJECT:g=f?ZmSearch.SUBJ_ASC:ZmSearch.SUBJ_DESC;\nbreak;\ncase ZmItem.F_DATE:g=f?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC;\nbreak;\ncase ZmItem.F_SIZE:g=f?ZmSearch.SIZE_ASC:ZmSearch.SIZE_DESC;\nbreak;\ncase ZmItem.F_FLAG:g=f?ZmSearch.FLAG_ASC:ZmSearch.FLAG_DESC;\nbreak;\ncase ZmItem.F_ATTACHMENT:g=f?ZmSearch.ATTACH_ASC:ZmSearch.ATTACH_DESC;\nbreak;\ncase ZmItem.F_READ:g=f?ZmSearch.READ_ASC:ZmSearch.READ_DESC;\nbreak;\ncase ZmItem.F_PRIORITY:g=f?ZmSearch.PRIORITY_ASC:ZmSearch.PRIORITY_DESC;\nbreak;\ncase ZmItem.F_SORTED_BY:g=f?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC;\nbreak\n}if(g){this._currentSortColId=d._sortable;\nif(d._sortable!=ZmItem.F_READ&&(this._sortByString==ZmSearch.READ_ASC||this._sortByString==ZmSearch.READ_DESC)){var b=this._controller;\nvar e=b.getSearchString();\nif(e){b.setSearchString(AjxStringUtil.trim(e.replace(\"is:unread\",\"\")))\n}}this._sortByString=g;\nvar a=this._folderId?true:false;\nif(!appCtxt.isExternalAccount()){var c=appCtxt.getSettings();\nappCtxt.set(ZmSetting.SORTING_PREF,g,this.view,false,a,null,c&&!c.persistImplicitSortPrefs(this.view));\nif(this._folderId){appCtxt.set(ZmSetting.SORTING_PREF,g,this._folderId)\n}}if(!this._isMultiColumn){this._setSortedColStyle(d._id)\n}}if(h){h.run()\n}};\nZmListView.prototype._setNextSelection=function(b,a){if(this.firstSelIndex<0){this.firstSelIndex=0\n}if(this._list&&!b){b=this._list.get(this.firstSelIndex)||this._list.getLast()\n}if(b){this.setSelection(b,false,a)\n}};\nZmListView.prototype._relayout=function(){DwtListView.prototype._relayout.call(this);\nthis._checkColumns()\n};\nZmListView.prototype._checkColumns=function(){var d=this._headerList.length;\nvar a=[];\nfor(var b=0;\nb<d;\nb++){var e=this._headerList[b];\nif(e&&e._field!=ZmItem.F_ACCOUNT){a.push(e._field+(e._visible?\"\":\"*\"))\n}}var c=a.join(ZmListView.COL_JOIN);\nc=(c==this._defaultCols)?\"\":c;\nif(!appCtxt.isExternalAccount()&&!this._controller.isSearchResults){appCtxt.set(ZmSetting.LIST_VIEW_COLUMNS,c,appCtxt.getViewTypeFromId(this.view))\n}this._colHeaderActionMenu=this._getActionMenuForColHeader(true)\n};\nZmListView.handleScroll=function(a){var b=DwtUiEvent.getTarget(a);\nvar c=DwtControl.findControl(b);\nif(c){c._checkItemCount()\n}};\nZmListView.prototype._checkItemCount=function(){var a=this._getItemsNeeded();\nif(a){this._controller._paginate(this._view,true,null,a)\n}};\nZmListView.prototype._getItemsNeeded=function(d){if(!d){var a=this.getItemList();\nif(!(a&&a.hasMore())||!this._list){return 0\n}}if(!this._rendered||!this._rowHeight){return 0\n}var b=new AjxCallback(null,AjxTimedAction.scheduleAction,[new AjxTimedAction(this,this._resetColWidth),100]);\nvar c={scrollDiv:this._getScrollDiv(),rowHeight:this._rowHeight,threshold:this.getPagelessThreshold(),limit:this.getLimit(1),listSize:this._list.size(),sbCallback:b};\nreturn ZmListView.getRowsNeeded(c)\n};\nZmListView.prototype._getScrollDiv=function(){return this._parentEl\n};\nZmListView.getRowsNeeded=function(c){var b=c.scrollDiv;\nvar e=b.scrollHeight,j=b.scrollTop,g=c.rowHeight;\nvar d=b.clientHeight||Dwt.getSize(b).y;\nvar f=d+(c.threshold*g);\nvar a=e-j;\nif(a==d){a=(c.listSize*g)-j;\nif(j==0&&c.sbCallback){c.sbCallback.run()\n}}var i=0;\nif(a<f){i=Math.max(Math.floor((f-a)/g),c.limit)\n}return i\n};\nZmListView.prototype._sizeChildren=function(a){if(DwtListView.prototype._sizeChildren.apply(this,arguments)){this._checkItemCount()\n}};\nZmListView.prototype._getItemCountType=function(){return this.type\n};\nZmListView.prototype.hasItem=function(e){var f=(typeof e==\"string\")?e:e&&e.id;\nif(f&&this._list){var c=this._list.getArray();\nfor(var d=0,b=c.length;\nd<b;\nd++){var e=c[d];\nif(e&&e.id==f){return true\n}}}return false\n};\nZmListView.prototype._saveState=function(c){var b=this._state={};\nc=c||{};\nif(c.selection){b.selected=this.getSelection();\nif(b.selected.length==1){var a=this._getElFromItem(b.selected[0]);\nb.singleItemChecked=this._getItemData(a,ZmListView.ITEM_CHECKED_ATT_NAME)\n}}if(c.focus){b.focused=this.hasFocus();\nb.anchorItem=this._kbAnchor&&this.getItemFromElement(this._kbAnchor)\n}if(c.scroll){b.rowHeight=this._rowHeight;\nb.scrollTop=this._listDiv.scrollTop\n}};\nZmListView.prototype._restoreState=function(d){var c=d||this._state;\nif(c.selected&&c.selected.length){var b=c.selected.length==1&&!c.singleItemChecked;\nthis.setSelectedItems(c.selected,b)\n}if(c.anchorItem){var a=this._getElFromItem(c.anchorItem);\nif(a){this._setKbFocusElement(a)\n}}if(c.focused){this.focus()\n}if(c.rowHeight){this._listDiv.scrollTop=c.scrollTop*(this._rowHeight/c.rowHeight)\n}this._state={}\n};\nZmListView.prototype._renderList=function(g,f,c){var l=this._group;\nif(!l){return DwtListView.prototype._renderList.call(this,g,f,c)\n}if(g instanceof AjxVector&&g.size()){var b=new Date();\nvar o=g.size();\nvar m=[];\nvar k;\nvar h;\nfor(var e=0;\ne<o;\ne++){var n=g.get(e);\nvar a=this._createItemHtml(n,{now:b},!c,e);\nif(a){if(a instanceof Array){for(var d=0;\nd<a.length;\nd++){k=l.addMsgToSection(n,a[d]);\nif(l.getSectionSize(k)==1){h=this._getSectionHeaderDiv(l,k);\nthis._addRow(h)\n}this._addRow(a[d])\n}}else{if(a.tagName||c){k=l.addMsgToSection(n,a);\nif(l.getSectionSize(k)==1){h=this._getSectionHeaderDiv(l,k);\nthis._addRow(h)\n}this._addRow(a)\n}else{l.addMsgToSection(n,a)\n}}}}if(l&&!c){l.resetSectionHeaders();\nm.push(l.getAllSections(this._bSortAsc))\n}if(m.length&&!c){this._parentEl.innerHTML=m.join(\"\")\n}}else{if(!f){this._setNoResultsHtml()\n}}};\nZmListView.prototype._addRow=function(b,a){DwtListView.prototype._addRow.apply(this,arguments);\nthis._updateLabelForItem(this.getItemFromElement(b))\n};\nZmListView.prototype._itemAdded=function(a){a.refCount++\n};\nZmListView.prototype._getSectionHeaderDiv=function(e,d){if(e&&d){var c=document.createElement(\"div\");\nvar a=e.getSectionTitle(d);\nvar b=e.getSectionHeader(a);\nc.innerHTML=b;\nreturn c.firstChild\n}};\nZmListView.prototype.deactivate=function(){this._controller.inactive=true\n};\nZmListView.prototype._getEventTarget=function(a){var b=a&&a.target;\nif(b&&(b.nodeName===\"IMG\"||(b.className&&b.className.match(/\\bImg/)))){return b.parentNode\n}return b\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmAppChooser\")){ZmAppChooser=function(c){c.className=c.className||\"ZmAppChooser\";\nc.width=appCtxt.getSkinHint(\"appChooser\",\"fullWidth\")?\"100%\":null;\nZmToolBar.call(this,c);\nDwt.setLocation(this.getHtmlElement(),Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);\nthis.setScrollStyle(Dwt.CLIP);\nthis._buttonListener=new AjxListener(this,this._handleButton);\nthis._initOverFlowTabs();\nvar b=c.buttons;\nfor(var a=0;\na<b.length;\na++){var d=b[a];\nif(d==ZmAppChooser.SPACER){this.addSpacer(ZmAppChooser.SPACER_HEIGHT)\n}else{this._createButton(d)\n}}this._createPrecedenceList();\nthis._inited=true\n};\nZmAppChooser.prototype=new ZmToolBar;\nZmAppChooser.prototype.constructor=ZmAppChooser;\nZmAppChooser.prototype.role=\"tablist\";\nZmAppChooser.prototype._initOverFlowTabs=function(){this._leftOverflow=document.getElementById(\"moreTabsLeftContainer\");\nthis._rightOverflow=document.getElementById(\"moreTabsRightContainer\");\nif(this._leftOverflow){this._leftOverflow.onclick=this._showLeftTab.bind(this)\n}if(this._rightOverflow){this._rightOverflow.onclick=this._showRightTab.bind(this)\n}this._leftBtnIndex=-1;\nthis._deletedButtons=[]\n};\nZmAppChooser.prototype._showLeftTab=function(){var a=this.getItems();\nif(this._leftBtnIndex>-1){a[this._leftBtnIndex].setVisible(true);\nthis._leftBtnIndex--\n}this._checkArrowVisibility()\n};\nZmAppChooser.prototype._showRightTab=function(){var a=this.getItems();\nthis._leftBtnIndex++;\na[this._leftBtnIndex].setVisible(false);\nthis._checkArrowVisibility()\n};\nZmAppChooser.prototype._showTab=function(e,c){var b=this._buttons[e];\nthis._moreTabsBtn.getMenu().popdown();\nif(!b){return\n}if(!b.getVisible()){var d=false;\nfor(var a in this._buttons){if(!d&&this._buttons[a].getHTMLElId()==b.getHTMLElId()){d=true\n}else{if(this._buttons[a].getVisible()){break\n}}if(d){this._buttons[a].setVisible(true);\nthis._leftBtnIndex--\n}}}else{while(this._isTabOverflow(b.getHtmlElement())){this._showRightTab()\n}}this._checkArrowVisibility();\nappCtxt.getAppController()._appButtonListener(c)\n};\nZmAppChooser.prototype._attachMoreTabMenuItems=function(e){for(var d=0;\nd<this._deletedButtons.length;\nd++){var a=e.getItemById(ZmOperation.MENUITEM_ID,this._deletedButtons[d]+\"_menu\");\nif(a){e.removeChild(a);\na.dispose()\n}}this._deletedButtons=[];\nfor(var b in this._buttons){var c=e.getItemById(ZmOperation.MENUITEM_ID,b+\"_menu\");\nif(c){if(c.getText()!=this._buttons[b].getText()){c.setText(this._buttons[b].getText())\n}}else{var a=new DwtMenuItem({parent:e,style:DwtMenuItem.CASCADE_STYLE,id:b+\"_menu\"});\na.setData(ZmOperation.MENUITEM_ID,b+\"_menu\");\na.setData(Dwt.KEY_ID,b);\na.addSelectionListener(this._showTab.bind(this,b));\na.setText(this._buttons[b].getText())\n}}if(e.getHtmlElement().style.width==\"0px\"){this._moreTabsBtn.popup()\n}};\nZmAppChooser.prototype._showOverflowTabsMenu=function(){var a=new DwtMenu({parent:this._moreTabsBtn});\na.addPopupListener(new AjxListener(this,this._attachMoreTabMenuItems,[a]));\nreturn a\n};\nZmAppChooser.prototype._checkArrowVisibility=function(){var a=this.getItems();\nif(this._leftBtnIndex<0){this._setArrowVisibility(this._leftOverflow,\"none\")\n}else{this._setArrowVisibility(this._leftOverflow,\"\")\n}if(!this._isTabOverflow(a[a.length-1].getHtmlElement())){this._setArrowVisibility(this._rightOverflow,\"none\")\n}else{this._setArrowVisibility(this._rightOverflow,\"\")\n}this._adjustWidth()\n};\nZmAppChooser.prototype._setArrowVisibility=function(c,d){if(!c){return\n}c.style.display=d||\"\";\nvar f=((this._leftOverflow&&this._leftOverflow.style.display==\"none\")&&(this._rightOverflow&&this._rightOverflow.style.display==\"none\"))?\"none\":\"\";\nvar a=document.getElementById(\"moreTabsMenu\");\nif(a){a.style.display=f\n}if(f!=\"none\"&&!this._moreTabsBtn&&a){var e=a;\nvar b=new DwtToolBarButton({parent:DwtShell.getShell(window),id:\"moreTabsMenuBtn\",style:\"background:none no-repeat scroll 0 0 transparent; border: none\"});\nb.setToolTipContent(ZmMsg.more,true);\nb.setText(\"\");\nb.reparentHtmlElement(a);\nb.setMenu(new AjxListener(this,this._showOverflowTabsMenu));\nthis._moreTabsBtn=b\n}};\nZmAppChooser.prototype.toString=function(){return\"ZmAppChooser\"\n};\nZmAppChooser.SPACER=\"spacer\";\nZmAppChooser.B_HELP=\"Help\";\nZmAppChooser.B_LOGOUT=\"Logout\";\nZmApp.CHOOSER_SORT[ZmAppChooser.SPACER]=160;\nZmApp.CHOOSER_SORT[ZmAppChooser.B_HELP]=170;\nZmApp.CHOOSER_SORT[ZmAppChooser.B_LOGOUT]=190;\nZmApp.ICON[ZmAppChooser.B_HELP]=\"Help\";\nZmApp.ICON[ZmAppChooser.B_LOGOUT]=\"Logoff\";\nZmApp.CHOOSER_TOOLTIP[ZmAppChooser.B_HELP]=\"goToHelp\";\nZmApp.CHOOSER_TOOLTIP[ZmAppChooser.B_LOGOUT]=\"logOff\";\nZmAppChooser.SPACER_HEIGHT=10;\nZmAppChooser.prototype.TEMPLATE=\"share.Widgets#ZmAppChooser\";\nZmAppChooser.prototype.ITEM_TEMPLATE=\"share.Widgets#ZmAppChooserItem\";\nZmAppChooser.prototype.SPACER_TEMPLATE=\"dwt.Widgets#ZmAppChooserSpacer\";\nZmAppChooser.prototype.addSelectionListener=function(a){this.addListener(DwtEvent.SELECTION,a)\n};\nZmAppChooser.prototype._checkTabOverflowAdd=function(a){var b=\"none\";\nif(this._isTabOverflow(a)){b=\"\"\n}this._setArrowVisibility(this._rightOverflow,b);\nthis._adjustWidth()\n};\nZmAppChooser.prototype._isTabOverflow=function(d){var b=d.offsetLeft+d.clientWidth+30;\nif(!this._refElement){this._refElement=document.getElementById(this._refElementId)\n}var a=this._refElement&&this._refElement.parentNode;\nif(!a){return false\n}var c=a.offsetWidth;\nreturn(c<b)\n};\nZmAppChooser.prototype._adjustWidth=function(){var a=this._refElement&&this._refElement.parentNode;\nif(a&&a.offsetWidth>=30){this._refElement.style.maxWidth=this._refElement.style.width=a.offsetWidth-30+\"px\";\nthis._refElement.style.overflow=\"hidden\"\n}};\nZmAppChooser.prototype._checkTabOverflowDelete=function(b){var a=this.getItems();\nif(this._isTabOverflow(a[a.length-1])){return\n}this._showLeftTab()\n};\nZmAppChooser.prototype.addButton=function(d,c){var b={parent:this,id:ZmId.getButtonId(ZmId.APP,d),text:c.text,image:c.image,leftImage:c.leftImage,rightImage:c.rightImage,index:c.index};\nb.style=c.style?c.style:DwtLabel.IMAGE_LEFT;\nvar a=new ZmAppButton(b);\na.setToolTipContent(c.tooltip,true);\na.textPrecedence=c.textPrecedence;\na.imagePrecedence=c.imagePrecedence;\na.setData(Dwt.KEY_ID,d);\na.addSelectionListener(this._buttonListener);\nthis._buttons[d]=a;\nthis._checkTabOverflowAdd(a.getHtmlElement());\nreturn a\n};\nZmAppChooser.prototype.removeButton=function(c){var b=this._buttons[c];\nif(b){var a=this.__getButtonIndex(c);\nb.dispose();\nthis._buttons[c]=null;\ndelete this._buttons[c];\nif(this._moreTabsBtn&&this._moreTabsBtn.getMenu()&&this._moreTabsBtn.getMenu().getItemCount()>0){this._deletedButtons.push(c)\n}this._checkTabOverflowDelete(a)\n}};\nZmAppChooser.prototype.replaceButton=function(c,a,b){if(!this._buttons[c]){return null\n}b.index=this.__getButtonIndex(c);\nthis.removeButton(c);\nreturn this.addButton(a,b)\n};\nZmAppChooser.prototype.getButton=function(a){return this._buttons[a]\n};\nZmAppChooser.prototype.setSelected=function(c){var a=this._buttons[this._selectedId];\nif(this._selectedId&&a){this.__markPrevNext(this._selectedId,false);\na.setSelected(false)\n}var b=this._buttons[c];\nif(b){b.setSelected(true);\nthis.setAttribute(\"aria-activedescendant\",b.getHTMLElId());\nif(b._toggleText!=null&&b._toggleText!=\"\"){if(a){a._toggleText=(a._toggleText!=null&&a._toggleText!=\"\")?a._toggleText:a.getText();\na.setText(\"\")\n}b.setText(b._toggleText);\nb._toggleText=null\n}}this._selectedId=c\n};\nZmAppChooser.prototype._createButton=function(a){this.addButton(a,{text:ZmMsg[ZmApp.NAME[a]]||ZmApp.NAME[a],image:ZmApp.ICON[a],tooltip:ZmMsg[ZmApp.CHOOSER_TOOLTIP[a]],textPrecedence:ZmApp.TEXT_PRECEDENCE[a],imagePrecedence:ZmApp.IMAGE_PRECEDENCE[a]})\n};\nZmAppChooser.prototype._handleButton=function(a){this.notifyListeners(DwtEvent.SELECTION,a)\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmAppButton\")){ZmAppButton=function(a){if(arguments.length==0){return\n}a.style=a.style?a.style:DwtLabel.IMAGE_LEFT;\na.posStyle=DwtControl.RELATIVE_STYLE;\nDwtButton.call(this,a);\nif(a.image){this.setImage(a.image)\n}else{if(a.leftImage){this.setImage(a.leftImage,DwtLabel.LEFT)\n}if(a.rightImage){this.setImage(a.rightImage,DwtLabel.RIGHT)\n}}if(a.hoverImage){this.setHoverImage(a.hoverImage)\n}else{if(a.leftHoverImage){this.setHoverImage(a.leftHoverImage,DwtLabel.LEFT)\n}if(a.rightHoverImage){this.setHoverImage(a.rightHoverImage,DwtLabel.RIGHT)\n}}this.setText(a.text)\n};\nZmAppButton.prototype=new DwtButton;\nZmAppButton.prototype.constructor=ZmAppButton;\nZmAppButton.prototype.role=\"tab\";\nZmAppButton.prototype.toString=function(){return\"ZmAppButton\"\n};\nZmAppButton.prototype.TEMPLATE=\"share.Widgets#ZmAppChooserButton\";\nZmAppButton.prototype.setSelected=function(a){this.isSelected=a;\nthis.setDisplayState(a?DwtControl.SELECTED:DwtControl.NORMAL)\n};\nZmAppButton.prototype.setDisplayState=function(a){if(this.isSelected&&a!=DwtControl.SELECTED){a=[DwtControl.SELECTED,a].join(\" \")\n}DwtButton.prototype.setDisplayState.call(this,a)\n};\nZmAppButton.prototype.handleKeyAction=function(a,b){switch(a){case DwtKeyMap.SELECT:if(this.isListenerRegistered(DwtEvent.SELECTION)){var c=DwtShell.selectionEvent;\nc.item=this;\nthis.notifyListeners(DwtEvent.SELECTION,c)\n}break;\ndefault:return false\n}return true\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmStatusView\")){ZmStatusView=function(c,b,a,d){DwtControl.call(this,{parent:c,className:(b||\"ZmStatus\"),posStyle:a,id:d});\nthis._toast=this._standardToast=new ZmToast(this,ZmId.TOAST);\nthis._statusQueue=[]\n};\nZmStatusView.prototype=new DwtControl;\nZmStatusView.prototype.constructor=ZmStatusView;\nZmStatusView.LEVEL_INFO=1;\nZmStatusView.LEVEL_WARNING=2;\nZmStatusView.LEVEL_CRITICAL=3;\nZmStatusView.MSG_PARAMS=[\"msg\",\"level\",\"detail\",\"transitions\",\"toast\",\"force\",\"dismissCallback\",\"finishCallback\"];\nZmStatusView.prototype.toString=function(){return\"ZmStatusView\"\n};\nZmStatusView.prototype.setStatusMsg=function(c){c=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);\nif(typeof c==\"string\"){c={msg:c}\n}var a={msg:c.msg,level:c.level||ZmStatusView.LEVEL_INFO,detail:c.detail,date:new Date(),transitions:c.transitions,toast:c.toast||this._standardToast,dismissCallback:(c.dismissCallback instanceof AjxCallback)?c.dismissCallback:null,finishCallback:(c.finishCallback instanceof AjxCallback)?c.finishCallback:null,dismissed:false};\nif(c.force){for(var b=0;\nb<this._statusQueue.length;\nb++){this._statusQueue[b].dismissed=true\n}}this._statusQueue.push(a);\nif(!this._toast.isPoppedUp()){this._updateStatusMsg()\n}else{if(c.force){this.dismissStatusMsg()\n}}};\nZmStatusView.prototype.nextStatus=function(){if(this._statusQueue.length>0){this._updateStatusMsg();\nreturn true\n}return false\n};\nZmStatusView.prototype.dismissStatusMsg=function(b){if(b){for(var a=0;\na<this._statusQueue.length;\na++){this._statusQueue[a].dismissed=true\n}}this._toast.dismiss()\n};\nZmStatusView.prototype._updateStatusMsg=function(){var a=this._statusQueue.shift();\nif(!a){return\n}if(a.dismissed){if(a.dismissCallback){a.dismissCallback.run()\n}this.nextStatus()\n}else{this._toast=a.toast;\nthis._toast.popup(a)\n}};\nZmToast=function(a,b){if(arguments.length==0){return\n}DwtComposite.call(this,{parent:a.shell,className:\"ZToast\",posStyle:Dwt.ABSOLUTE_STYLE,id:b});\nthis._statusView=a;\nthis._createHtml();\nthis._funcs={};\nthis._funcs.position=AjxCallback.simpleClosure(this.__position,this);\nthis._funcs.show=AjxCallback.simpleClosure(this.__show,this);\nthis._funcs.hide=AjxCallback.simpleClosure(this.__hide,this);\nthis._funcs.pause=AjxCallback.simpleClosure(this.__pause,this);\nthis._funcs.hold=AjxCallback.simpleClosure(this.__hold,this);\nthis._funcs.idle=AjxCallback.simpleClosure(this.__idle,this);\nthis._funcs.fade=AjxCallback.simpleClosure(this.__fade,this);\nthis._funcs[\"fade-in\"]=this._funcs.fade;\nthis._funcs[\"fade-out\"]=this._funcs.fade;\nthis._funcs.slide=AjxCallback.simpleClosure(this.__slide,this);\nthis._funcs[\"slide-in\"]=this._funcs.slide;\nthis._funcs[\"slide-out\"]=this._funcs.slide;\nthis._funcs.next=AjxCallback.simpleClosure(this.transition,this)\n};\nZmToast.prototype=new DwtComposite;\nZmToast.prototype.constructor=ZmToast;\nZmToast.prototype.toString=function(){return\"ZmToast\"\n};\nZmToast.prototype.role=\"alert\";\nZmToast.prototype.isFocusable=true;\nZmToast.FADE={type:\"fade\"};\nZmToast.FADE_IN={type:\"fade-in\"};\nZmToast.FADE_OUT={type:\"fade-out\"};\nZmToast.SLIDE={type:\"slide\"};\nZmToast.SLIDE_IN={type:\"slide-in\"};\nZmToast.SLIDE_OUT={type:\"slide-out\"};\nZmToast.PAUSE={type:\"pause\"};\nZmToast.HOLD={type:\"hold\"};\nZmToast.IDLE={type:\"idle\"};\nZmToast.SHOW={type:\"show\"};\nZmToast.DEFAULT_TRANSITIONS=[ZmToast.SLIDE_IN,ZmToast.PAUSE,ZmToast.SLIDE_OUT];\nZmToast.DEFAULT_STATE={};\nZmToast.DEFAULT_STATE.position={location:\"C\"};\nZmToast.DEFAULT_STATE.pause={duration:1200};\nZmToast.DEFAULT_STATE.hold={};\nZmToast.DEFAULT_STATE.fade={duration:100,multiplier:1};\nZmToast.DEFAULT_STATE[\"fade-in\"]={start:0,end:99,step:10,duration:200,multiplier:1};\nZmToast.DEFAULT_STATE[\"fade-out\"]={start:99,end:0,step:-10,duration:200,multiplier:1};\nZmToast.DEFAULT_STATE.slide={duration:100,multiplier:1};\nZmToast.DEFAULT_STATE[\"slide-in\"]={start:-40,end:0,step:1,duration:100,multiplier:1};\nZmToast.DEFAULT_STATE[\"slide-out\"]={start:0,end:-40,step:-1,duration:100,multiplier:1};\nZmToast.LEVEL_RE=/\\b(ZToastCrit|ZToastWarn|ZToastInfo)\\b/g;\nZmToast.DISMISSABLE_STATES=[ZmToast.HOLD];\nZmToast.prototype.TEMPLATE=\"share.Widgets#ZToast\";\nZmToast.prototype.dispose=function(){this._textEl=null;\nthis._iconEl=null;\nthis._detailEl=null;\nDwtComposite.prototype.dispose.call(this)\n};\nZmToast.prototype.popup=function(b){this.__clear();\nthis._poppedUp=true;\nthis._dismissed=false;\nthis._dismissCallback=b.dismissCallback;\nthis._finishCallback=b.finishCallback;\nvar g,f,c;\nswitch(b.level){case ZmStatusView.LEVEL_CRITICAL:f=\"ZToastCrit\";\ng=\"Critical\";\nc=AjxMsg.criticalMsg;\nbreak;\ncase ZmStatusView.LEVEL_WARNING:f=\"ZToastWarn\";\ng=\"Warning\";\nc=AjxMsg.warningMsg;\nbreak;\ncase ZmStatusView.LEVEL_INFO:default:f=\"ZToastInfo\";\ng=\"Success\";\nc=AjxMsg.infoMsg;\nbreak\n}var e=this.getHtmlElement();\nDwt.delClass(e,ZmToast.LEVEL_RE,f);\nif(this._iconEl){this._iconEl.innerHTML=AjxImg.getImageHtml({imageName:g,altText:c})\n}if(this._textEl){var d=document.createElement(\"SPAN\");\nd.innerHTML=b.msg||\"\";\nDwt.removeChildren(this._textEl);\nthis._textEl.appendChild(d)\n}var a=appCtxt.getSkinHint(\"toast\",\"location\");\nvar h=(b.transitions||appCtxt.getSkinHint(\"toast\",\"transitions\")||ZmToast.DEFAULT_TRANSITIONS);\nh=[].concat({type:\"position\",location:a},h,{type:\"hide\"});\nthis._transitions=h;\nthis.transition()\n};\nZmToast.prototype.popdown=function(){this.__clear();\nthis.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);\nthis._poppedUp=false;\nif(!this._dismissed){if(this._finishCallback){this._finishCallback.run()\n}}this._dismissed=false\n};\nZmToast.prototype.isPoppedUp=function(){return this._poppedUp\n};\nZmToast.prototype.transition=function(){if(this._pauseTimer){clearTimeout(this._pauseTimer);\nthis._pauseTimer=null\n}if(this._held){this._held=false\n}var b=this._transitions&&this._transitions.shift();\nif(!b){this._poppedUp=false;\nif(!this._statusView.nextStatus()){this.popdown()\n}return\n}var a=this._state=this._createState(b);\nthis.setLocation(a.x,a.y);\nthis._funcs[b.type||\"next\"]()\n};\nZmToast.prototype._createHtml=function(a){var c={id:this._htmlElId};\nthis._createHtmlFromTemplate(a||this.TEMPLATE,c);\nthis.setZIndex(Dwt.Z_TOAST);\nvar b=this.getHtmlElement();\nb.setAttribute(\"aria-live\",\"assertive\");\nb.setAttribute(\"aria-relevant\",\"additions\");\nb.setAttribute(\"aria-atomic\",true)\n};\nZmToast.prototype._createHtmlFromTemplate=function(a,b){DwtComposite.prototype._createHtmlFromTemplate.call(this,a,b);\nthis._textEl=document.getElementById(b.id+\"_text\");\nthis._iconEl=document.getElementById(b.id+\"_icon\");\nthis._detailEl=document.getElementById(b.id+\"_detail\")\n};\nZmToast.prototype._createState=function(d){var b=AjxUtil.createProxy(d);\nvar c=ZmToast.DEFAULT_STATE[b.type];\nfor(var a in c){if(!b[a]){b[a]=c[a]\n}}switch(b.type){case\"fade-in\":this.setOpacity(0);\nthis.setLocation(null,0);\nb.value=b.start;\nbreak;\ncase\"fade-out\":case\"fade\":this.setLocation(null,0);\nb.value=b.start;\nbreak;\ncase\"slide-in\":case\"slide-out\":case\"slide\":this.setLocation(null,-36);\nthis.setOpacity(100);\nb.value=b.start;\nbreak\n}return b\n};\nZmToast.prototype.__clear=function(){clearTimeout(this._actionId);\nclearInterval(this._actionId);\nthis._actionId=-1\n};\nZmToast.prototype.__position=function(){var d=this._state.location||\"C\";\nvar c=\"skin_container_toast\";\nvar b=Dwt.byId(c)||this.shell.getHtmlElement();\nvar g=Dwt.getSize(b);\nvar e=this.getSize();\nvar a=(g.x-e.x)/2;\nvar h=(g.y-e.y)/2;\nswitch(d.toUpperCase()){case\"N\":h=0-e.y;\nbreak;\ncase\"S\":h=g.y-e.y;\nbreak;\ncase\"E\":a=g.x-e.x;\nbreak;\ncase\"W\":a=0;\nbreak;\ncase\"NE\":a=g.x-e.x;\nh=0;\nbreak;\ncase\"NW\":a=0;\nh=0;\nbreak;\ncase\"SE\":a=g.x-e.x;\nh=g.y-e.y;\nbreak;\ncase\"SW\":a=0;\nh=g.y-e.y;\nbreak;\ncase\"C\":default:break\n}var f=Dwt.toWindow(b);\na+=f.x;\nh+=f.y;\nthis.setLocation(a,h);\nthis._funcs.next()\n};\nZmToast.prototype.__show=function(){this.setVisible(true);\nthis.setVisibility(true);\nthis._funcs.next()\n};\nZmToast.prototype.__hide=function(){this.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);\nif(this._textEl){Dwt.removeChildren(this._textEl)\n}if(this._iconEl){Dwt.removeChildren(this._iconEl)\n}this._funcs.next()\n};\nZmToast.prototype.__pause=function(){if(this._dismissed&&ZmToast.__mayDismiss(ZmToast.PAUSE)){this._funcs.next()\n}else{this._pauseTimer=setTimeout(this._funcs.next,this._state.duration)\n}};\nZmToast.prototype.__hold=function(){if(this._dismissed&&ZmToast.__mayDismiss(ZmToast.HOLD)!=-1){this._funcs.next()\n}else{this._held=true\n}};\nZmToast.__mayDismiss=function(a){return AjxUtil.indexOf(ZmToast.DISMISSABLE_STATES,a)!=-1\n};\nZmToast.prototype.dismiss=function(){if(!this._dismissed&&this._poppedUp){var a=(this._pauseTimer&&ZmToast.__mayDismiss(ZmToast.PAUSE))||(this._held&&ZmToast.__mayDismiss(ZmToast.HOLD));\nif(a){this._funcs.next()\n}this._dismissed=true;\nif(this._dismissCallback instanceof AjxCallback){this._dismissCallback.run()\n}}};\nZmToast.prototype.__idle=function(){if(!this._idleTimer){this._idleTimer=new DwtIdleTimer(0,new AjxCallback(this,this.__idleCallback))\n}else{this._idleTimer.resurrect(0)\n}};\nZmToast.prototype.__idleCallback=function(a){if(!a){this.transition();\nthis._idleTimer.kill()\n}};\nZmToast.prototype.__move=function(){this._funcs.next()\n};\nZmToast.prototype.__fade=function(){var a=this._state.value;\nvar b=this._state.step;\nvar d=b>0?a>=this._state.end:a<=this._state.end;\nif(d){a=this._state.end\n}this.setOpacity(a);\nif(d){this.__clear();\nsetTimeout(this._funcs.next,0);\nreturn\n}if(this._actionId==-1){var c=this._state.duration;\nvar e=c/Math.abs(b);\nthis._actionId=setInterval(this._funcs.fade,e)\n}this._state.value+=b;\nthis._state.step*=this._state.multiplier\n};\nZmToast.prototype.__slide=function(){var c=this._state.value;\nvar a=this._state.step;\nvar d=a>0?c>=this._state.end:c<=this._state.end;\nif(d){c=this._state.end\n}this.setLocation(null,c);\nif(d){this.__clear();\nsetTimeout(this._funcs.next,0);\nreturn\n}if(this._actionId==-1){var b=this._state.duration;\nvar e=b/Math.abs(a);\nthis._actionId=setInterval(this._funcs.slide,e)\n}this._state.value+=a;\nthis._state.step*=this._state.multiplier\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmOverviewContainer\")){ZmOverviewContainer=function(a){if(arguments.length==0){return\n}a.className=a.className||\"ZmOverviewContainer\";\na.id=a.id||ZmId.getOverviewContainerId(a.containerId);\nDwtTree.call(this,a);\nthis.setScrollStyle(a.scroll||Dwt.SCROLL_Y);\nthis.containerId=a.containerId;\nthis._appName=a.appName;\nthis._controller=a.controller;\nthis._headerItems={};\nthis._overview={};\nthis.addSelectionListener(new AjxListener(this,this._treeViewListener));\nthis.addTreeListener(new AjxListener(this,this._treeListener))\n};\nZmOverviewContainer.prototype=new DwtTree;\nZmOverviewContainer.prototype.constructor=ZmOverviewContainer;\nZmOverviewContainer.prototype.toString=function(){return\"ZmOverviewContainer\"\n};\nZmOverviewContainer.prototype.initialize=function(a){};\nZmOverviewContainer.prototype.getOverview=function(a){return this._overview[a]\n};\nZmOverviewContainer.prototype.getOverviews=function(){return this._overview\n};\nZmOverviewContainer.prototype.getHeaderItem=function(){};\nZmOverviewContainer.prototype.getSelected=function(){var b;\nfor(var a in this._overview){b=this._overview[a].getSelected();\nif(b){return b\n}}};\nZmOverviewContainer.prototype.deselectAll=function(a){DwtTree.prototype.deselectAll.call(this);\nthis._deselectAllTreeViews(a)\n};\nZmOverviewContainer.prototype.setOverviewTrees=function(a){for(var b in this._overview){this._overview[b].set(a)\n}};\nZmOverviewContainer.prototype.resetOperations=function(b,a){};\nZmOverviewContainer.prototype._treeViewListener=function(a){};\nZmOverviewContainer.prototype._treeListener=function(a){};\nZmOverviewContainer.prototype._initializeActionMenu=function(a){};\nZmOverviewContainer.prototype._getActionMenu=function(a){if(this._actionMenu instanceof AjxCallback){var b=this._actionMenu;\nthis._actionMenu=b.run()\n}return this._actionMenu\n};\nZmOverviewContainer.prototype._createActionMenu=function(b,a,c){};\nZmOverviewContainer.prototype._actionMenuListener=function(a){};\nZmOverviewContainer.prototype._deselectAllTreeViews=function(d){for(var c in this._overview){var e=this._overview[c];\nif(d&&d==e){continue\n}var b=e._treeHash;\nfor(var a in b){if(b[a].getSelectionCount()>0){b[a].deselectAll();\nbreak\n}}}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmAccountOverviewContainer\")){ZmAccountOverviewContainer=function(b){if(arguments.length==0){return\n}ZmOverviewContainer.call(this,b);\nthis._vFolderTreeItemMap={};\nthis._settingChangeListener=new AjxListener(this,this._handleSettingChange);\nvar a=new AjxListener(this,this._mouseListener);\nthis.addListener(DwtEvent.ONMOUSEDOWN,a);\nthis.addListener(DwtEvent.ONMOUSEUP,a)\n};\nZmAccountOverviewContainer.prototype=new ZmOverviewContainer;\nZmAccountOverviewContainer.prototype.constructor=ZmAccountOverviewContainer;\nZmAccountOverviewContainer.VIRTUAL_FOLDERS=[ZmFolder.ID_INBOX,ZmFolder.ID_SENT,ZmFolder.ID_DRAFTS,ZmFolder.ID_SPAM,ZmFolder.ID_OUTBOX,ZmFolder.ID_TRASH];\nZmAccountOverviewContainer.prototype.toString=function(){return\"ZmAccountOverviewContainer\"\n};\nZmAccountOverviewContainer.prototype.getHeaderItem=function(a){return a&&this._headerItems[a.id]\n};\nZmAccountOverviewContainer.prototype.expandAccountOnly=function(b){if(!b){b=appCtxt.getActiveAccount()\n}for(var a in this._headerItems){this._headerItems[a].setExpanded((a==b.id),false,false)\n}};\nZmAccountOverviewContainer.prototype.getSelected=function(){var b=ZmOverviewContainer.prototype.getSelected.call(this);\nif(!b){b=this.getSelection()[0];\nvar c=b&&appCtxt.accountList.getAccount(b.getData(Dwt.KEY_ID));\nvar a=c&&appCtxt.getFolderTree(c);\nreturn a&&a.root\n}return b\n};\nZmAccountOverviewContainer.prototype.initialize=function(F){var y,l;\nvar k=appCtxt.accountList.visibleAccounts;\nvar t=(appCtxt.isOffline&&this._appName==ZmApp.MAIL&&(k.length>2));\nvar o=t;\nvar e=appCtxt.accountList.mainAccount;\nvar D=F.omit;\nfor(var z=0;\nz<k.length;\nz++){l=k[z];\nif(appCtxt.isOffline&&l.isMain&&this._appName!=ZmApp.PREFERENCES){continue\n}if(!l.active){continue\n}F.omit={};\nif(l.type==ZmAccount.TYPE_POP){F.omit[ZmFolder.ID_SPAM]=true;\nF.omit[ZmFolder.ID_OUTBOX]=true\n}if(F.overviewId&&!F.isAppOverview){var r=F.overviewId.split(\":\")[1];\nif(r&&(r==\"ZmNewOrganizerDialog\")){F.omit[ZmFolder.ID_DRAFTS]=true\n}}this._addAccount(F,l,o,null,\"account\"+z);\ny=this.getHeaderItem(l);\nif(y){this._setupHeader(y,l)\n}this.updateAccountInfo(l,true,true);\no=!o\n}u=D&&D[ZmOrganizer.ID_ALL_MAILBOXES];\nif(t&&!u){var m=ZmMsg[ZmFolder.MSG_KEY[ZmOrganizer.ID_ALL_MAILBOXES]];\nvar f=appCtxt.get(ZmSetting.OFFLINE_ALL_MAILBOXES_TREE_OPEN)?m:this._getFolderLabel(ZmOrganizer.ID_INBOX,m);\nvar B={parent:this,text:f,imageInfo:\"AccountAll\"};\nvar q=appCtxt.get(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES);\nvar d=this._allMailboxesTreeHeader=new DwtTreeItem(B);\nd.setData(Dwt.KEY_ID,ZmOrganizer.ID_ALL_MAILBOXES);\nd.addClassName(\"ZmOverviewGlobalInbox\");\nd._initialize(0,true);\nd.setVisible(q);\nd.__origText=m;\nif(q){this.highlightAllMboxes()\n}var s=appCtxt.getSettings(e).getSetting(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES);\ns.addChangeListener(this._settingChangeListener);\nvar C=ZmAccountOverviewContainer.VIRTUAL_FOLDERS;\nfor(var z=0;\nz<C.length;\nz++){var a=C[z];\nB={parent:d,text:this._getFolderLabel(a,ZmMsg[ZmFolder.MSG_KEY[a]]),imageInfo:ZmFolder.ICON[a]};\nvar g=this._vFolderTreeItemMap[a]=new DwtTreeItem(B);\ng.setData(Dwt.KEY_ID,a);\ng.addClassName(\"DwtTreeItemChildDiv\");\ng._initialize(null,true);\ng.setToolTipContent(appCtxt.accountList.getTooltipForVirtualFolder(a))\n}B={parent:d,text:ZmMsg.globalSearches,imageInfo:\"SearchFolder\"};\nvar w=this._searchTreeHeader=new DwtTreeItem(B);\nw.addClassName(\"DwtTreeItemChildDiv\");\nw._initialize(null,true);\nw.__isSearch=true;\nvar v=appCtxt.getById(ZmOrganizer.ID_ROOT,e);\nvar n=v.getByType(ZmOrganizer.SEARCH);\nfor(var z=0;\nz<n.length;\nz++){var j=n[z];\nif(j.id!=ZmOrganizer.ID_ALL_MAILBOXES&&j.isOfflineGlobalSearch){this.addSearchFolder(j)\n}}w.setVisible(w.getItemCount()>0);\nif(appCtxt.get(ZmSetting.OFFLINE_SAVED_SEARCHES_TREE_OPEN)){w.setExpanded(true,null,true)\n}if(appCtxt.get(ZmSetting.OFFLINE_ALL_MAILBOXES_TREE_OPEN)){d.setExpanded(true,null,true)\n}}if(appCtxt.isOffline){var A=AjxUtil.hashCopy(F);\nA.omit={};\nif(this._appName!=ZmApp.PREFERENCES){this._addAccount(A,e,o,\"ZmOverviewLocalHeader\",\"LocalFolders\");\ny=this.getHeaderItem(e);\ny.setExpanded(appCtxt.get(ZmSetting.ACCOUNT_TREE_OPEN,null,e));\nthis.updateAccountInfo(e,false,true)\n}else{var x={parent:this,text:e.getDisplayName(),imageInfo:e.getIcon()};\nvar p=new DwtTreeItem(x);\np._initialize(null,true);\nvar h=appCtxt.getOverviewId(this.containerId,e);\nvar H=this._overview[h].getTreeView(ZmOrganizer.PREF_PAGE);\nvar G=H.getTreeItemById(\"PREF_PAGE_IMPORT_EXPORT\");\nH.getHeaderItem().removeChild(G);\np._addItem(G);\nG.addClassName(\"DwtTreeItemChildDiv\");\np.setExpanded(true,null,true)\n}}var u=F.omit&&F.omit[ZmOrganizer.ID_ZIMLET];\nif(!appCtxt.inStartup&&!u&&appCtxt.getZimletMgr().getPanelZimlets().length==0){u=true\n}if(!u){AjxDispatcher.require(\"Zimlet\")\n}if(!u&&window[ZmOverviewController.CONTROLLER[ZmOrganizer.ZIMLET]]&&this._appName!=ZmApp.PREFERENCES){var c=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];\nvar E=F.overviewId=appCtxt.getOverviewId([this.containerId,c],null);\nvar b={label:ZmMsg[c],icon:\"Zimlet\",dataId:E,className:\"ZmOverviewZimletHeader\"};\nF.overviewTrees=[ZmOrganizer.ZIMLET];\nthis._addSection(b,null,F);\nvar y=this._headerItems[E];\nif(y){y.__isZimlet=true;\ny.setExpanded(appCtxt.get(ZmSetting.ZIMLET_TREE_OPEN,null,e))\n}}this._initializeActionMenu()\n};\nZmAccountOverviewContainer.prototype.addSearchFolder=function(b){if(!this._searchTreeHeader){return\n}var c={parent:this._searchTreeHeader,text:b.getName(),imageInfo:b.getIcon()};\nvar a=new DwtTreeItem(c);\na.setData(Dwt.KEY_ID,b);\na._initialize(null,true);\nif(!this._searchTreeHeader.getVisible()){this._searchTreeHeader.setVisible(true)\n}};\nZmAccountOverviewContainer.prototype.updateAccountInfo=function(f,a,e){var b=appCtxt.getApp(this._appName)&&this.getHeaderItem(f);\nif(b){if(a){var d=(f.status==ZmZimbraAccount.STATUS_RUNNING)?(\"<img src='/img/animated/ImgSpinner.gif' width=16 height=16 border=0>\"):(AjxImg.getImageHtml(f.getStatusIcon()));\nif(b._extraCell){b._extraCell.innerHTML=(d||\"\")\n}if(appCtxt.isOffline&&f.status==ZmZimbraAccount.STATUS_AUTHFAIL){var c=appCtxt.getPasswordChangeDialog();\nc.popup(f)\n}}if(e||a){b.setToolTipContent(f.getToolTip())\n}}};\nZmAccountOverviewContainer.prototype.updateLabel=function(a){if(a.nId==ZmOrganizer.ID_INBOX){var e=a.getAccount();\nvar d=this.getHeaderItem(e);\nif(d&&!d.getExpanded()){d.setText(this._getAccountHeaderLabel(e))\n}}var b=this._vFolderTreeItemMap[a.nId];\nif(b){b.setText(this._getFolderLabel(a.nId,a.name));\nif(a.nId==ZmOrganizer.ID_INBOX&&!this._allMailboxesTreeHeader.getExpanded()){var c=this._getFolderLabel(a.nId,this._allMailboxesTreeHeader.__origText);\nthis._allMailboxesTreeHeader.setText(c)\n}}};\nZmAccountOverviewContainer.prototype.updateTooltip=function(a){var b=this._allMailboxesTreeHeader&&this._vFolderTreeItemMap[a];\nif(b){b.setToolTipContent(appCtxt.accountList.getTooltipForVirtualFolder(a))\n}};\nZmAccountOverviewContainer.prototype.resetOperations=function(c,e){var d=c.getOp(ZmOperation.EMPTY_FOLDER);\nif(e instanceof ZmSearchFolder){c.getOp(ZmOperation.MARK_ALL_READ).setVisible(false);\nd.setVisible(false);\nc.getOp(this._newOp).setVisible(false);\nif(appCtxt.isOffline){c.getOp(ZmOperation.SYNC).setVisible(false)\n}c.getOp(ZmOperation.DELETE).setVisible(true);\nreturn\n}var g=appCtxt.accountList.getAccount(e);\nvar b=(g||e==ZmOrganizer.ID_ALL_MAILBOXES);\nc.getOp(ZmOperation.MARK_ALL_READ).setVisible(!b);\nd.setVisible(false);\nc.getOp(this._newOp).setVisible(b&&e!=ZmOrganizer.ID_ALL_MAILBOXES);\nif(appCtxt.isOffline){c.getOp(ZmOperation.SYNC).setVisible(b&&(!g||(g&&!g.isMain)))\n}c.getOp(ZmOperation.DELETE).setVisible(false);\nif(b){c.enable(this._newOp,true);\nc.enable(ZmOperation.SYNC,(!g||(g&&!g.isMain)))\n}else{var a=false;\nif(e!=ZmOrganizer.ID_OUTBOX&&e!=ZmFolder.ID_DRAFTS&&this._actionedHeaderItem.getText().indexOf(\"bold\")!=-1){a=true\n}c.enable(ZmOperation.MARK_ALL_READ,a);\nif(e==ZmOrganizer.ID_TRASH||e==ZmOrganizer.ID_SPAM){var f=(e==ZmOrganizer.ID_TRASH)?ZmMsg.emptyTrash:ZmMsg.emptyJunk;\nd.setText(f);\nd.setVisible(true);\nc.enable(ZmOperation.EMPTY_FOLDER,!this._isFolderEmpty(e))\n}}};\nZmAccountOverviewContainer.prototype.removeZimletSection=function(){var a=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];\nvar b=appCtxt.getOverviewId([this.containerId,a],null);\nvar c=this._headerItems[b];\nif(c){this.removeChild(c)\n}};\nZmAccountOverviewContainer.prototype.highlightAllMboxes=function(){this.deselectAll();\nthis.setSelection(this._allMailboxesTreeHeader,true)\n};\nZmAccountOverviewContainer.prototype._addAccount=function(g,h,b,j,a){g.overviewId=appCtxt.getOverviewId(this.containerId,h);\ng.account=h;\nvar e=appCtxt.getApp(this._appName);\nvar c=(!e||(e&&appCtxt.get(ZmApp.SETTING[this._appName],null,h)));\nif(this._appName==ZmApp.PREFERENCES||c){var d=g.omitPerAcct?g.omitPerAcct[h.id]:g.omit;\nvar i,f;\nif(this._appName==ZmApp.PREFERENCES&&h.isMain&&appCtxt.isOffline){i=ZmMsg.allAccounts;\nf=\"AccountAll\"\n}else{i=h.getDisplayName();\nif(!appCtxt.isFamilyMbox){f=h.getIcon()\n}}var k={label:i,icon:f,dataId:h.id,className:j,predictableId:a};\nthis._addSection(k,d,g,b)\n}var l=appCtxt.getSettings(h).getSetting(ZmSetting.QUOTA_USED);\nl.addChangeListener(this._settingChangeListener)\n};\nZmAccountOverviewContainer.prototype._addSection=function(h,d,e,c){var f={parent:this,text:h.label,imageInfo:h.icon,selectable:e.selectable,className:h.className,id:this.getHTMLElId()+\"__\"+(h.predictableId||h.dataId)+\"__SECTION\"};\nvar g=this._headerItems[h.dataId]=new DwtTreeItem(f);\ng.setData(Dwt.KEY_ID,h.dataId);\ng.setScrollStyle(Dwt.CLIP);\ng._initialize(null,true,true);\ng.addClassName(c?\"ZmOverviewSectionHilite\":\"ZmOverviewSection\");\ne.id=ZmId.getOverviewId(e.overviewId);\ne.parent=g;\ne.scroll=Dwt.CLIP;\ne.posStyle=Dwt.STATIC_STYLE;\nvar b=this._controller._overview[e.overviewId]=this._overview[e.overviewId]=new ZmOverview(e,this._controller);\ng._dndScrollCallback=this._overview._dndScrollCallback,g._dndScrollId=this._overview._scrollableContainerId,g._addItem(b,null,true);\nvar a=e.overviewTrees||e.treeIds;\nb.set(a,d)\n};\nZmAccountOverviewContainer.prototype._setupHeader=function(e,d){if(this._appName==ZmApp.PREFERENCES){e.setExpanded(true,false,true);\ne.enableSelection(false)\n}else{var c=appCtxt.get(ZmSetting.ACCOUNT_TREE_OPEN,null,d);\ne.setExpanded(c);\nif(!c){e.setText(this._getAccountHeaderLabel(d))\n}}if(e._extraCell){e._extraCell.onclick=AjxCallback.simpleClosure(this._handleStatusClick,this,d)\n}var a=this._controller.getTreeController(ZmOrganizer.FOLDER).getDropTarget();\nvar b=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,d);\ne.setDropTarget(a);\ne.setData(Dwt.KEY_OBJECT,appCtxt.getById(b))\n};\nZmAccountOverviewContainer.prototype._isFolderEmpty=function(a){var d=appCtxt.accountList.visibleAccounts;\nfor(var b=0;\nb<d.length;\nb++){var c=appCtxt.getById(ZmOrganizer.getSystemId(a,d[b]));\nif(c&&c.numTotal>0){return false\n}}return true\n};\nZmAccountOverviewContainer.prototype._syncAccount=function(a,b){a.popdown();\nb.sync()\n};\nZmAccountOverviewContainer.prototype._treeViewListener=function(n){if(n.detail!=DwtTree.ITEM_ACTIONED&&n.detail!=DwtTree.ITEM_SELECTED&&n.detail!=DwtTree.ITEM_DBL_CLICKED){return\n}var o=this._actionedHeaderItem=n.item;\nif(o&&(o.__isZimlet||o.__isSearch)){return\n}var g=o&&o.getData(Dwt.KEY_ID);\nif(n.detail==DwtTree.ITEM_ACTIONED&&appCtxt.getApp(this._appName)){var m=this._getActionMenu(g);\nif(m){this.resetOperations(m,g);\nm.popup(0,n.docX,n.docY)\n}}else{if((n.detail==DwtTree.ITEM_SELECTED)&&o){if(this._appName==ZmApp.CALENDAR||this._appName==ZmApp.PREFERENCES){return\n}this._deselectAllTreeViews();\nif(!ZmApp.NAME[this._appName]){return\n}if(g){var l=appCtxt.getSearchController();\nvar j=appCtxt.accountList.getAccount(g);\nif(j){if(appCtxt.isOffline&&j.inNewMailMode){j.inNewMailMode=false;\nvar c=appCtxt.getOverviewController()._overviewContainer;\nfor(var h in c){c[h].updateAccountInfo(j,true,true)\n}}if((n.target.parentNode==n.item._extraCell)&&j.isError()){return\n}l.searchAllAccounts=false;\nappCtxt.accountList.setActiveAccount(j);\nif(appCtxt.isOffline&&j.hasNotSynced()&&!j.__syncAsked){j.__syncAsked=true;\nvar k=appCtxt.getYesNoMsgDialog();\nk.registerCallback(DwtDialog.YES_BUTTON,this._syncAccount,this,[k,j]);\nk.setMessage(ZmMsg.neverSyncedAsk,DwtMessageDialog.INFO_STYLE);\nk.popup()\n}var d=ZmOrganizer.DEFAULT_FOLDER[ZmApp.ORGANIZER[this._appName]];\nvar b=appCtxt.getById(ZmOrganizer.getSystemId(d,j));\nif(!(b instanceof ZmFolder)){return\n}var a=(this._appName==ZmApp.TASKS)?ZmSearch.DUE_DATE_DESC:ZmSearch.DATE_DESC;\nvar f={query:b.createQuery(),getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),searchFor:(ZmApp.DEFAULT_SEARCH[this._appName]),sortBy:((l.currentSearch&&b.nId==l.currentSearch.folderId)?null:a),accountName:(j&&j.name),noUpdateOverview:true}\n}else{var e=appCtxt.accountList.mainAccount;\nl.resetSearchAllAccounts();\nl.searchAllAccounts=true;\nif(g instanceof ZmSearchFolder){f={searchAllAccounts:true,accountName:e.name,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),noUpdateOverview:true};\nl.redoSearch(g.search,false,f);\nreturn\n}if(g==ZmOrganizer.ID_ALL_MAILBOXES){g=ZmFolder.ID_INBOX\n}f={queryHint:appCtxt.accountList.generateQuery(g),folderId:null,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML,null,e),searchFor:(ZmApp.DEFAULT_SEARCH[this._appName]),sortBy:ZmSearch.DATE_DESC,accountName:e.name,noUpdateOverview:true}\n}l.search(f)\n}}else{}}};\nZmAccountOverviewContainer.prototype._treeListener=function(b){if(b.detail!=DwtTree.ITEM_COLLAPSED&&b.detail!=DwtTree.ITEM_EXPANDED){return\n}var f=b.item;\nvar a=b.detail==DwtTree.ITEM_EXPANDED;\nvar e;\nif(f){if(f.__isSearch){appCtxt.set(ZmSetting.OFFLINE_SAVED_SEARCHES_TREE_OPEN,a);\nreturn\n}var c=f.getData(Dwt.KEY_ID);\nif(c==ZmOrganizer.ID_ALL_MAILBOXES){var d=a?f.__origText:this._getFolderLabel(ZmOrganizer.ID_INBOX,f.__origText);\nf.setText(d);\nappCtxt.set(ZmSetting.OFFLINE_ALL_MAILBOXES_TREE_OPEN,a);\nreturn\n}e=f.__isZimlet?appCtxt.accountList.mainAccount:appCtxt.accountList.getAccount(c)\n}if(e&&appCtxt.getCurrentAppName()!=ZmApp.PREFERENCES){if(!appCtxt.inStartup){appCtxt.accountList.setActiveAccount(e);\nappCtxt.set(ZmSetting.ACCOUNT_TREE_OPEN,a,null,null,null,e)\n}if(!f.__isZimlet){var d=a?e.getDisplayName():this._getAccountHeaderLabel(e);\nf.setText(d)\n}}};\nZmAccountOverviewContainer.prototype._mouseListener=function(a){return !Dwt.ffScrollbarCheck(a)\n};\nZmAccountOverviewContainer.prototype._handleSettingChange=function(c){if(c.type!=ZmEvent.S_SETTING){return\n}var b=c.source;\nif(b.id==ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES){var a=b.getValue();\nthis._allMailboxesTreeHeader.setVisible(a);\nif(!a){if(appCtxt.getActiveAccount().isMain){appCtxt.accountList.setActiveAccount(appCtxt.accountList.defaultAccount)\n}appCtxt.getSearchController().searchAllAccounts=false;\nappCtxt.getApp(ZmApp.MAIL).mailSearch()\n}else{this._deselect(this._allMailboxesTreeHeader)\n}}else{if(b.id==ZmSetting.QUOTA_USED){this.updateAccountInfo(c.getDetails().account,false,true)\n}}};\nZmAccountOverviewContainer.prototype._getAccountHeaderLabel=function(e,d){var b=(this._appName==ZmApp.MAIL)?ZmOrganizer.getSystemId(ZmOrganizer.ID_INBOX,e,true):null;\nvar c=b&&appCtxt.getById(b);\nif(c&&c.numUnread>0){var a=AjxMessageFormat.format(ZmMsg.folderUnread,[e.getDisplayName(),c.numUnread]);\nreturn([\"<span style='font-weight:bold;'>\",a,\"</span>\"].join(\"\"))\n}return e.getDisplayName()\n};\nZmAccountOverviewContainer.prototype._getFolderLabel=function(a,c){var e=(a!=ZmFolder.ID_DRAFTS&&a!=ZmFolder.ID_OUTBOX);\nvar d=appCtxt.accountList.getItemCount(a,e);\nif(d>0){var b=AjxMessageFormat.format(ZmMsg.folderUnread,[c,d]);\nreturn([\"<span style='font-weight:bold;'>\",b,\"</span>\"].join(\"\"))\n}return c\n};\nZmAccountOverviewContainer.prototype._initializeActionMenu=function(){if(!this._actionMenu){var b=ZmApp.ORGANIZER[this._appName];\nthis._newOp=ZmOrganizer.NEW_OP[b];\nvar a=[this._newOp];\nif(appCtxt.isOffline){a.push(ZmOperation.SYNC)\n}a.push(ZmOperation.MARK_ALL_READ,ZmOperation.EMPTY_FOLDER,ZmOperation.DELETE);\nthis._actionMenu=new AjxCallback(this,this._createActionMenu,[a])\n}};\nZmAccountOverviewContainer.prototype._createActionMenu=function(c){var e=new AjxListener(this,this._actionMenuListener);\nvar d=new ZmActionMenu({parent:appCtxt.getShell(),menuItems:c});\nc=d.opList;\nfor(var b=0;\nb<c.length;\nb++){var a=d.getItem(b);\nvar f=c[b];\nif(f==ZmOperation.SYNC){a.setText(ZmMsg.sendReceive)\n}d.addSelectionListener(f,e)\n}d.addPopdownListener(new AjxListener(this,this._menuPopdownActionListener));\nreturn d\n};\nZmAccountOverviewContainer.prototype._menuPopdownActionListener=function(){this._actionedHeaderItem._setActioned(false)\n};\nZmAccountOverviewContainer.prototype._actionMenuListener=function(d){var b=d.item.getData(ZmOperation.KEY_ID);\nvar g=this._actionedHeaderItem.getData(Dwt.KEY_ID);\nif(b==this._newOp){var f=ZmApp.ORGANIZER[this._appName];\nvar a=this._controller.getTreeController(f,true);\nif(a){a._actionedOrganizer=null;\nvar e=appCtxt.accountList.getAccount(g);\na._actionedOrganizer=appCtxt.getFolderTree(e).root;\na._newListener(d,e)\n}}else{if(b==ZmOperation.SYNC){if(g==ZmOrganizer.ID_ALL_MAILBOXES){appCtxt.accountList.syncAll()\n}else{var e=appCtxt.accountList.getAccount(g);\nif(e){e.sync()\n}}}else{if(b==ZmOperation.MARK_ALL_READ){this._doAction(g,b)\n}else{if(b==ZmOperation.EMPTY_FOLDER){this._confirmEmptyAction(g,b)\n}else{if(b==ZmOperation.DELETE){g._delete();\nvar c=this._actionedHeaderItem.parent;\nc.removeChild(this._actionedHeaderItem);\nc.setVisible(c.getItemCount()>0)\n}}}}}};\nZmAccountOverviewContainer.prototype._confirmEmptyAction=function(c,a){var b=appCtxt.getOkCancelMsgDialog();\nb.reset();\nb.registerCallback(DwtDialog.OK_BUTTON,this._emptyCallback,this,[b,c,a]);\nvar d=(c==ZmFolder.ID_TRASH)?ZmMsg.confirmEmptyTrashFolder:(AjxMessageFormat.format(ZmMsg.confirmEmptyFolder,ZmMsg[ZmFolder.MSG_KEY[c]]));\nb.setMessage(d,DwtMessageDialog.WARNING_STYLE);\nb.popup()\n};\nZmAccountOverviewContainer.prototype._emptyCallback=function(c,b,a){c.popdown();\nthis._doAction(b,a)\n};\nZmAccountOverviewContainer.prototype._doAction=function(b,a){var g=new ZmBatchCommand(true,appCtxt.accountList.mainAccount.name);\nvar e=appCtxt.accountList.visibleAccounts;\nfor(var c=0;\nc<e.length;\nc++){var f=e[c];\nif(f.isMain){continue\n}var h=ZmOrganizer.getSystemId(b,f);\nvar d=appCtxt.getById(h);\nif(d){if(a==ZmOperation.MARK_ALL_READ){d.markAllRead(g)\n}else{d.empty(null,g)\n}g.curId++\n}}g.run();\nif(appCtxt.isOffline){appCtxt.getApp(ZmApp.MAIL).clearNewMailBadge()\n}};\nZmAccountOverviewContainer.prototype._handleStatusClick=function(c,b){if(!c.isError()){return\n}else{if(appCtxt.isOffline&&(c.status==ZmZimbraAccount.STATUS_AUTHFAIL)){var a=appCtxt.getPasswordChangeDialog();\na.popup(c)\n}else{c.showErrorMessage()\n}}}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmOverview\")){ZmOverview=function(c,f){var j=c.overviewClass?c.overviewClass:\"ZmOverview\";\nc.id=c.id||ZmId.getOverviewId(c.overviewId);\nDwtComposite.call(this,{parent:c.parent,className:j,posStyle:c.posStyle,id:c.id});\nthis._controller=f;\nthis.setScrollStyle(c.scroll||Dwt.SCROLL_Y);\nthis.overviewId=c.overviewId;\nthis.containerId=c.containerId;\nthis.account=c.account;\nthis.selectionSupported=c.selectionSupported;\nthis.actionSupported=c.actionSupported;\nthis.dynamicWidth=c.dynamicWidth;\nthis.dndSupported=c.dndSupported;\nthis.headerClass=c.headerClass;\nthis.showUnread=c.showUnread;\nthis.showNewButtons=c.showNewButtons;\nthis.treeStyle=c.treeStyle;\nthis.isCheckedByDefault=c.isCheckedByDefault;\nthis.noTooltips=c.noTooltips;\nthis.isAppOverview=c.isAppOverview;\nthis.skipImplicit=c.skipImplicit;\nthis.appName=c.appName;\nthis._treeIds=[];\nthis._treeHash={};\nthis._treeParents={};\nvar k=document;\nvar d=this.getHtmlElement();\nif(c.treeIds){for(var e=0,h=c.treeIds.length;\ne<h;\ne++){var b=k.createElement(\"DIV\");\nvar g=c.treeIds[e];\nthis._treeParents[g]=b.id=[this.overviewId,g].join(\"-parent-\");\nd.appendChild(b)\n}}if(this.dndSupported){this._scrollableContainerId=this.containerId||this.overviewId;\nvar a=this.containerId?document.getElementById(this.containerId):this.getHtmlElement();\nvar c={container:a,threshold:15,amount:5,interval:10,id:this._scrollableContainerId};\nthis._dndScrollCallback=new AjxCallback(null,DwtControl._dndScrollCallback,[c])\n}this.setAttribute(\"aria-label\",ZmMsg.overviewLabel);\nthis.tabGroupMember=this\n};\nZmOverview.prototype=new DwtComposite;\nZmOverview.prototype.constructor=ZmOverview;\nZmOverview.prototype.isZmOverview=true;\nZmOverview.prototype.toString=function(){return\"ZmOverview\"\n};\nZmOverview.prototype.role=\"navigation\";\nZmOverview.prototype.getTreeParent=function(a){return this._treeParents[a]\n};\nZmOverview.prototype.set=function(a,c){if(a&&a.length){for(var b=0;\nb<a.length;\nb++){this.setTreeView(a[b],c)\n}}};\nZmOverview.prototype.setTreeView=function(b,a){if(!appCtxt.checkPrecondition(ZmOrganizer.PRECONDITION[b])){return\n}AjxDispatcher.require(ZmOrganizer.ORG_PACKAGE[b]);\nvar c=this._controller.getTreeController(b);\nif(!c){return\n}if(this._treeHash[b]){c.clearTreeView(this.overviewId)\n}else{this._treeIds.push(b)\n}var d={overviewId:this.overviewId,omit:a,showUnread:this.showUnread,account:this.account};\nthis._treeHash[b]=c.show(d)\n};\nZmOverview.prototype.clearChangeListener=function(b){for(var c=0;\nc<b.length;\nc++){var e=this._controller.getTreeController(b[c]);\nvar a=e._getTreeChangeListener();\nif(a){var d=appCtxt.getFolderTree();\nif(d){d.removeChangeListener(a)\n}}}};\nZmOverview.prototype.getTreeView=function(a){return this._treeHash[a]\n};\nZmOverview.prototype.getTreeViews=function(){return this._treeIds\n};\nZmOverview.prototype.getTreeItemById=function(e,c){if(!e){return null\n}for(var b=0;\nb<this._treeIds.length;\nb++){var a=this._treeHash[this._treeIds[b]];\nif(a){var d=a.getTreeItemById&&a.getTreeItemById(e);\nif(d&&(!c||(this._treeIds[b]==c))){return d\n}}}return null\n};\nZmOverview.prototype.getSelected=function(b){for(var c=0;\nc<this._treeIds.length;\nc++){var a=this._treeHash[this._treeIds[c]];\nif(a){var d=a.getSelected();\nif(d){return b?a.type:d\n}}}return null\n};\nZmOverview.prototype.deselectAllTreeViews=function(){for(var b=0;\nb<this._treeIds.length;\nb++){var a=this._treeHash[this._treeIds[b]];\nif(a){a.deselectAll()\n}}};\nZmOverview.prototype.setSelected=function(d,c){var b,a;\nif(c){a=this._treeHash[c];\nb=a&&a.getTreeItemById(d)\n}else{for(var c in this._treeHash){a=this._treeHash[c];\nb=a&&a.getTreeItemById(d);\nif(b){break\n}}}if(b&&(this._selectedTreeItem!=b)){a.setSelected(d,true,true)\n}this.itemSelected(b)\n};\nZmOverview.prototype.itemSelected=function(c){if(appCtxt.multiAccounts&&c){var b=this.overviewId.substring(0,this.overviewId.indexOf(\":\"));\nvar a=this._controller.getOverviewContainer(b);\nif(a){a.deselectAll(this)\n}}if(this._selectedTreeItem&&(this._selectedTreeItem._tree!=(c&&c._tree))){this._selectedTreeItem._tree.deselectAll()\n}this._selectedTreeItem=c\n};\nZmOverview.prototype.clear=function(){for(var a=0;\na<this._treeIds.length;\na++){var b=this._treeIds[a];\nif(this._treeHash[b]){var c=this._controller.getTreeController(b);\nc.clearTreeView(this.overviewId);\ndelete this._treeHash[b]\n}}};\nZmOverview.prototype.clearSelection=function(){if(this._selectedTreeItem){this._selectedTreeItem._tree.deselectAll()\n}};\nZmOverview.prototype._initialize=function(){};\nZmOverview.prototype.focus=function(){var b=this._selectedTreeItem;\nif(!b){var a=this._treeHash[this._treeIds[0]];\nif(a){b=a._getNextTreeItem(true)\n}}if(b){b.focus();\nb._tree.setSelection(b,false,true);\nreturn b\n}};\nZmOverview.prototype.blur=function(){var a=this._selectedTreeItem;\nif(a){a._blur()\n}};\nZmOverview.prototype._getNextTreeItem=function(e,c){for(var d=0;\nd<this._treeIds.length;\nd++){if(this._treeHash[this._treeIds[d]]==c){break\n}}var b=null;\nvar a=e?d+1:d-1;\nc=this._treeHash[this._treeIds[a]];\nwhile(c){b=DwtTree.prototype._getNextTreeItem.call(c,e);\nif(b){break\n}a=e?a+1:a-1;\nc=this._treeHash[this._treeIds[a]]\n}return b\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmAppIframeView\")){ZmAppIframeView=function(a){if(arguments.length===0){return\n}DwtControl.call(this,{parent:appCtxt.getShell(),posStyle:Dwt.ABSOLUTE_STYLE,className:\"ZmAppIframeView\"});\nthis._createFrame(a)\n};\nZmAppIframeView.prototype=new DwtControl;\nZmAppIframeView.prototype.constructor=ZmAppIframeView;\nZmAppIframeView.prototype.isZmAppIframeView=true;\nZmAppIframeView.prototype.toString=function(){return\"ZmAppIframeView\"\n};\nZmAppIframeView.prototype._createFrame=function(e){e=e||{};\nvar d=this._appName=e.appName,c=appCtxt.get(ZmApp.UPSELL_URL[d]),b=[],a=0;\nvar f=this._iframeId=this._getIframeId();\nb[a++]=\"<iframe id='\"+f+\"' width='100%' height='100%' frameborder='0' src='\";\nb[a++]=c;\nb[a++]=\"'>\";\nthis.setContent(b.join(\"\"))\n};\nZmAppIframeView.prototype._getIframeId=function(){return\"iframe_\"+this.getHTMLElId()\n};\nZmAppIframeView.prototype.activate=function(a){};\nZmAppIframeView.prototype.runRefresh=function(){};\nZmAppIframeView.prototype.setBounds=function(b,h,d,a,f){var e=0;\nif(!f){e=this._getToolbarHeight()\n}DwtControl.prototype.setBounds.call(this,b,h-e,d,a+e);\nvar g=\"iframe_\"+this.getHTMLElId();\nvar c=document.getElementById(g);\nif(c){c.width=d;\nc.height=a+e\n}};\nZmAppIframeView.prototype._getToolbarHeight=function(){var b=appCtxt.getAppViewMgr().getViewComponent(ZmAppViewMgr.C_TOOLBAR_TOP);\nif(b){var c=b.getSize();\nvar a=c.y?c.y:b.getHtmlElement().clientHeight;\nreturn a\n}return 0\n};\nZmAppIframeView.prototype.getTitle=function(){return[ZmMsg.zimbraTitle,appCtxt.getApp(this._appName).getDisplayName()].join(\": \")\n}\n}if(AjxPackage.define(\"zimbraMail.share.view.ZmCommunityView\")){ZmCommunityView=function(a){ZmAppIframeView.apply(this,arguments);\nthis._createFrame(a);\nthis._setupMessageHandling()\n};\nZmCommunityView.prototype=new ZmAppIframeView;\nZmCommunityView.prototype.constructor=ZmCommunityView;\nZmCommunityView.prototype.isZmCommunityView=true;\nZmCommunityView.prototype.toString=function(){return\"ZmCommunityView\"\n};\nZmCommunityView.prototype._setupMessageHandling=function(b){var a=document.getElementById(this._iframeId);\nif(a){var c=ZmCommunityView.handleMessage.bind(null,this);\nif(window.addEventListener){window.addEventListener(\"message\",c,false)\n}else{if(window.attachEvent){window.attachEvent(\"onmessage\",c)\n}}}};\nZmCommunityView.prototype._getIframeId=function(){return\"fragment-41812_iframe\"\n};\nZmCommunityView.handleMessage=function(a,c){var b=document.getElementById(a._iframeId);\nif(b&&c.source===b.contentWindow){var d=AjxStringUtil.parseQueryString(c.data||\"\");\nvar e=(d.unread&&d.unread.toLowerCase()===\"true\");\nif(d.type===\"community-notification\"&&e){appCtxt.getApp(a._appName).startAlert();\na.getUpdates()\n}}};\nZmCommunityView.prototype.getUpdates=function(){var a=document.getElementById(this._iframeId);\nif(a){a.contentWindow.postMessage(\"type=community-update\",\"*\")\n}};\nZmCommunityView.prototype.activate=function(a){if(a){this.getUpdates()\n}};\nZmCommunityView.prototype.runRefresh=function(){this.getUpdates()\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmController\")){ZmController=function(a,d,b,c){if(arguments.length==0){return\n}this.setCurrentViewType(this.getDefaultViewType());\nthis.setCurrentViewId(this.getDefaultViewType());\nif(c){this.setSessionId(c,b)\n}this._container=a;\nthis._app=d;\nthis._shell=appCtxt.getShell();\nthis._appViews={};\nthis._authenticating=false;\nthis.isHidden=(c==ZmApp.HIDDEN_SESSION);\nthis._elementsToHide=null\n};\nZmController.prototype.isZmController=true;\nZmController.prototype.toString=function(){return\"ZmController\"\n};\nZmController.SESSION_ID_SEP=\"-\";\nZmController.prototype._setView=function(){};\nZmController.getDefaultViewType=function(){};\nZmController.prototype.getDefaultViewType=function(){};\nZmController.prototype._defaultView=ZmController.prototype.getDefaultViewType;\nZmController.prototype.getSessionId=function(){return this._sessionId\n};\nZmController.prototype.setSessionId=function(b,a){this._sessionId=b;\nif(a){this.setCurrentViewType(a);\nthis.setCurrentViewId(b?[a,b].join(ZmController.SESSION_ID_SEP):a);\nthis.tabId=b?[\"tab\",this.getCurrentViewId()].join(\"_\"):\"\"\n}this.sessionId=this._sessionId;\nthis.viewId=this.getCurrentViewId()\n};\nZmController.prototype.getCurrentViewType=function(a){return this._currentViewType\n};\nZmController.prototype._getViewType=ZmController.prototype.getCurrentViewType;\nZmController.prototype.setCurrentViewType=function(a){this._currentViewType=a\n};\nZmController.prototype.getCurrentViewId=function(){return this._currentViewIdOverride||this._currentViewId\n};\nZmController.prototype.setCurrentViewId=function(a){this._currentViewId=a;\nthis._currentView=this._currentViewId\n};\nZmController.prototype.getApp=function(){return this._app\n};\nZmController.prototype.getViewElements=function(a,b,c){var d={};\nc=c||this._toolbar[a];\nd[ZmAppViewMgr.C_TOOLBAR_TOP]=c;\nd[ZmAppViewMgr.C_APP_CONTENT]=b;\nreturn d\n};\nZmController.prototype.popupErrorDialog=function(a,n,p,m,l,c){var h=appCtxt.getErrorDialog();\nvar d=\"\";\nif(typeof n==\"string\"){d=n\n}else{if(n instanceof Object){n.msg=n.msg||a;\nvar k=[\"method\",\"msg\",\"code\",\"detail\",\"trace\",\"request\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"stack\"];\nvar g=[],f=0;\ng[f++]=\"<table>\";\nfor(var e=0;\ne<k.length;\ne++){var b=k[e];\nvar q=AjxStringUtil.htmlEncode(n[b]);\nif(q){if(b==\"request\"){q=[\"<pre>\",q,\"</pre>\"].join(\"\");\nvar o=document.getElementById(h._msgCellId);\nif(o){o.className=\"DwtMsgDialog-wide\"\n}}g[f++]=[\"<tr><td valign='top'>\",k[e],\":</td><td valign='top'>\",q,\"</td></tr>\"].join(\"\")\n}}g[f++]=\"</table>\";\nd=g.join(\"\")\n}}h.registerCallback(DwtDialog.OK_BUTTON,this._errorDialogCallback,this);\nif(!c){a=AjxStringUtil.htmlEncode(a)\n}h.setMessage(a,d,DwtMessageDialog.CRITICAL_STYLE,ZmMsg.zimbraTitle);\nh.popup(null,m);\nif(l){h.showDetail()\n}};\nZmController.prototype.popupUploadErrorDialog=function(e,b,c){var a=appCtxt.getMsgDialog();\nvar d=DwtMessageDialog.CRITICAL_STYLE;\nvar f=this.createErrorMessage(e,b,c);\nif(f.length>0){a.setMessage(f,d);\na.popup()\n}};\nZmController.prototype.createErrorMessage=function(d,a,b){var f=\"\";\nswitch(a){case AjxPost.SC_OK:break;\ncase AjxPost.SC_REQUEST_ENTITY_TOO_LARGE:var c=d&&ZmMsg[\"attachmentSizeError_\"+d]||ZmMsg.attachmentSizeError;\nvar e=AjxUtil.formatSize(appCtxt.get(ZmSetting.MESSAGE_SIZE_LIMIT));\nf=AjxMessageFormat.format(c,e);\nbreak;\ndefault:var c=d&&ZmMsg[\"errorAttachment_\"+d]||ZmMsg.errorAttachment;\nf=AjxMessageFormat.format(c,a||AjxPost.SC_NO_CONTENT);\nbreak\n}if((f.length>0)&&b){f+=\"<br /><br />\";\nf+=b\n}return f\n};\nZmController.handleScriptError=function(b,f){var h=[];\nvar e=\"<br/>\";\nif(b){var g=ZmMsg.scriptError+\": \"+b.message;\nvar a=b.fileName&&b.fileName.match(/(\\w+\\.js)/);\nif(a&&a.length){g+=\" - \"+a[1]+\":\"+b.lineNumber\n}if(b.fileName){h.push(\"File: \"+b.fileName)\n}if(b.lineNumber){h.push(\"Line: \"+b.lineNumber)\n}if(b.name){h.push(\"Error: \"+b.name)\n}if(b.stack){h.push(\"Stack: \"+b.stack.replace(\"\\n\",e,\"g\"))\n}}var d=h.join(e);\nvar c=[g,d].join(e+e);\nif(f){}else{AjxDebug.println(AjxDebug.EXCEPTION,c);\nappCtxt.getAppController().popupErrorDialog(g,d,null,false,true)\n}};\nZmController.prototype.getKeyMapName=function(){return ZmKeyMap.MAP_GLOBAL\n};\nZmController.prototype.handleKeyAction=function(i,j){var c=this.getTabView?this.getTabView():null;\nif(c&&c.handleKeyAction(i)){return true\n}var k=appCtxt.isExternalAccount();\nvar a=ZmApp.ACTION_CODES_R[i];\nif(a){var e=ZmApp.ACTION_CODES[i];\nif(e){if(k){return true\n}appCtxt.getApp(a).handleOp(e);\nreturn true\n}}switch(i){case ZmKeyMap.NEW:if(k){break\n}a=appCtxt.getCurrentAppName();\nvar g=ZmApp.NEW_ACTION_CODE[a];\nif(g){var e=ZmApp.ACTION_CODES[g];\nif(e){appCtxt.getApp(a).handleOp(e);\nreturn true\n}}break;\ncase ZmKeyMap.NEW_FOLDER:case ZmKeyMap.NEW_TAG:if(k||appCtxt.isWebClientOffline()){break\n}var e=ZmApp.ACTION_CODES[i];\nif(e){this._newListener(null,e)\n}break;\ncase ZmKeyMap.NEW_SEARCH:appCtxt.getSearchController().openNewSearchTab();\nbreak;\ncase ZmKeyMap.SAVED_SEARCH:if(k){break\n}var f=appCtxt.getFolderTree().getByType(ZmOrganizer.SEARCH);\nif(f&&f.length>0){var h=appCtxt.getChooseFolderDialog();\nvar d={treeIds:[ZmOrganizer.SEARCH],overviewId:h.getOverviewId(ZmOrganizer.SEARCH,this._app._name),appName:this._app._name,title:ZmMsg.selectSearch};\nZmController.showDialog(h,new AjxCallback(null,ZmController._searchSelectionCallback,[h]),d)\n}break;\ncase ZmKeyMap.VISIT:var h=appCtxt.getChooseFolderDialog();\nvar b=ZmApp.ORGANIZER[this._app._name]||ZmOrganizer.FOLDER;\nvar d={treeIds:[b],overviewId:h.getOverviewId(ZmOrganizer.APP[b]),appName:this._app._name,noRootSelect:true,title:AjxMessageFormat.format(ZmMsg.goToFolder,ZmMsg[ZmOrganizer.MSG_KEY[b]])};\nZmController.showDialog(h,new AjxCallback(null,ZmController._visitOrgCallback,[h,b]),d);\nbreak;\ncase ZmKeyMap.VISIT_TAG:if(appCtxt.getTagTree().size()>0){var h=appCtxt.getPickTagDialog();\nZmController.showDialog(h,new AjxCallback(null,ZmController._visitOrgCallback,[h,ZmOrganizer.TAG]))\n}break;\ndefault:return false\n}return true\n};\nZmController._searchSelectionCallback=function(b,a){if(a){appCtxt.getSearchController().redoSearch(a.search)\n}b.popdown()\n};\nZmController._visitOrgCallback=function(b,c,d){if(d){var a=appCtxt.getOverviewController().getTreeController(c);\nif(a&&a._itemClicked){a._itemClicked(d)\n}}b.popdown()\n};\nZmController.prototype.mapSupported=function(a){return false\n};\nZmController.prototype._newListener=function(a,b){switch(b){case ZmOperation.NEW_FOLDER:ZmController.showDialog(appCtxt.getNewFolderDialog(),this.getNewFolderCallback());\nbreak;\ncase ZmOperation.NEW_TAG:if(!this._newTagCb){this._newTagCb=new AjxCallback(this,this._newTagCallback)\n}ZmController.showDialog(appCtxt.getNewTagDialog(),this._newTagCb);\nbreak\n}};\nZmController.prototype._newFolderCallback=function(f,d,b,c){var e=appCtxt.getNewFolderDialog();\ne.popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.FOLDER)._doCreate(f,d,b,c)\n};\nZmController.prototype._newTagCallback=function(b){appCtxt.getNewTagDialog().popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.TAG)._doCreate(b)\n};\nZmController.prototype._createTabGroup=function(a){a=a?a:this.toString();\nthis._tabGroup=new DwtTabGroup(a);\nreturn this._tabGroup\n};\nZmController.prototype._setTabGroup=function(a){this._tabGroup=a\n};\nZmController.prototype.getTabGroup=function(){return this._tabGroup\n};\nZmController.prototype.getNewFolderCallback=function(){if(!this._newFolderCb){this._newFolderCb=new AjxCallback(this,this._newFolderCallback)\n}return this._newFolderCb\n};\nZmController.prototype._saveFocus=function(){var b=appCtxt.getRootTabGroup().getFocusMember();\nvar a=this.getTabGroup();\nthis._savedFocusMember=(b&&a&&a.contains(b))?b:null;\nreturn this._savedFocusMember\n};\nZmController.prototype._restoreFocus=function(f,h){var d=appCtxt.getRootTabGroup();\nvar c=appCtxt.getCurrentApp();\nvar g=c&&c.getOverviewId();\nvar e=g&&appCtxt.getOverviewController().getOverview(g);\nif(d&&e&&(e!=ZmController._currentOverview)){var b=ZmController._currentOverview&&ZmController._currentOverview.getTabGroupMember();\nd.replaceMember(b,e.getTabGroupMember(),false,false,null,true);\nZmController._currentOverview=e\n}var a=this.getTabGroup();\nf=f||this._savedFocusMember||this._getDefaultFocusItem()||d.getFocusMember();\nh=h||ZmController.noFocus;\nZmController.noFocus=false;\nif(d&&a&&(a!=ZmController._currentAppViewTabGroup)){d.replaceMember(ZmController._currentAppViewTabGroup,a,false,false,f,h);\nZmController._currentAppViewTabGroup=a\n}else{if(f&&!h){appCtxt.getKeyboardMgr().grabFocus(f)\n}}};\nZmController.prototype._getDefaultFocusItem=function(){var a=this.getTabGroup();\nreturn a?a.getFirstMember(true):null\n};\nZmController.prototype._preUnloadCallback=function(){return true\n};\nZmController.prototype._postHideCallback=function(){return true\n};\nZmController.prototype._postRemoveCallback=function(){return true\n};\nZmController.prototype._preShowCallback=function(){return true\n};\nZmController.prototype._preHideCallback=function(){this._saveFocus();\nreturn true\n};\nZmController.prototype._postShowCallback=function(){this._restoreFocus();\nreturn true\n};\nZmController.prototype._handleError=function(b,a){this._handleException(b,a)\n};\nZmController.prototype._handleException=function(d,b){if(d.code==AjxSoapException.INVALID_PDU){d.code=ZmCsfeException.SVC_FAILURE;\nd.detail=[\"contact your administrator (\",d.msg,\")\"].join(\"\");\nd.msg=\"Service failure\"\n}if(d.code==ZmCsfeException.SVC_AUTH_EXPIRED||d.code==ZmCsfeException.SVC_AUTH_REQUIRED||d.code==ZmCsfeException.NO_AUTH_TOKEN){ZmCsfeCommand.noAuth=true;\nZmZimbraMail.logOff(null,true);\nreturn\n}if(d.code==ZmCsfeException.MAIL_NO_SUCH_MSG){var a=appCtxt.getCurrentViewId();\nif(a==ZmId.VIEW_CONVLIST||a==ZmId.VIEW_TRAD){var e=appCtxt.getApp(ZmApp.MAIL);\nvar g=appCtxt.isOffline?new AjxCallback(this,this._handleMailSearch,e):null;\ne.mailSearch(null,g);\nreturn\n}}if(d.method!==\"NoOpRequest\"){var c;\nif(d.code===ZmCsfeException.MAIL_NO_SUCH_ITEM){c=d.data.itemId\n}else{if(d.code===ZmCsfeException.MAIL_SEND_FAILURE){c=d.code\n}else{if(d.code===ZmCsfeException.MAIL_INVALID_NAME){c=d.data.name\n}else{if(d.code===ZmCsfeException.SVC_UNKNOWN_DOCUMENT){c=d.msg.split(\": \")[1]\n}}}}if(d.lineNumber&&!d.detail){ZmController.handleScriptError(d)\n}else{var f;\nif(b&&b.restUri&&b.restUri.indexOf(\"zimbraim\")!==-1){f=ZmMsg.chatXMPPError\n}else{f=d.getErrorMsg?d.getErrorMsg(c):d.msg||d.message\n}this.popupErrorDialog(f,d,true,this._hideSendReportBtn(d))\n}}};\nZmController.prototype._handleMailSearch=function(a){if(appCtxt.get(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES)){a.getOverviewContainer().highlightAllMboxes()\n}};\nZmController.prototype._hideSendReportBtn=function(a){return(a.code==ZmCsfeException.MAIL_TOO_MANY_TERMS||a.code==ZmCsfeException.MAIL_MAINTENANCE_MODE||a.code==ZmCsfeException.MAIL_MESSAGE_TOO_BIG||a.code==ZmCsfeException.NETWORK_ERROR||a.code==ZmCsfeException.EMPTY_RESPONSE||a.code==ZmCsfeException.BAD_JSON_RESPONSE||a.code==ZmCsfeException.TOO_MANY_TAGS||a.code==ZmCsfeException.OFFLINE_ONLINE_ONLY_OP)\n};\nZmController.prototype._errorDialogCallback=function(){appCtxt.getErrorDialog().popdown()\n};\nZmController.showDialog=function(a,d,c,b){a.reset(b);\na.registerCallback(DwtDialog.OK_BUTTON,d);\na.popup(c,b)\n};\nZmController.prototype._clearDialog=function(a){a.popdown();\nthis._pendingActionData=null\n};\nZmController.prototype._menuPopdownActionListener=function(){};\nZmController.prototype.isTransient=function(a,b){return false\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmBaseController\")){ZmBaseController=function(a,e,b,d,c){if(arguments.length==0){return\n}ZmController.apply(this,arguments);\nthis.setSessionId(d,b||this.getDefaultViewType(),c);\nthis._view={};\nthis._toolbar={};\nthis._tabGroups={};\nthis._tagList=appCtxt.getTagTree();\nif(this._tagList){this._boundTagChangeListener=this._tagChangeListener.bind(this);\nthis._tagList.addChangeListener(this._boundTagChangeListener)\n}this._listeners={};\nthis._listeners[ZmOperation.NEW_MENU]=this._newListener.bind(this);\nthis._listeners[ZmOperation.TAG_MENU]=this._tagButtonListener.bind(this);\nthis._listeners[ZmOperation.MOVE_MENU]=this._moveButtonListener.bind(this);\nthis._listeners[ZmOperation.ACTIONS_MENU]=this._actionsButtonListener.bind(this);\nthis._listeners[ZmOperation.TAG]=this._tagListener.bind(this);\nthis._listeners[ZmOperation.PRINT]=this._printListener.bind(this);\nthis._listeners[ZmOperation.DELETE]=this._deleteListener.bind(this);\nthis._listeners[ZmOperation.DELETE_WITHOUT_SHORTCUT]=this._deleteListener.bind(this);\nthis._listeners[ZmOperation.CLOSE]=this._backListener.bind(this);\nthis._listeners[ZmOperation.MOVE]=this._moveListener.bind(this);\nthis._listeners[ZmOperation.SEARCH]=this._searchListener.bind(this);\nthis._listeners[ZmOperation.NEW_MESSAGE]=this._composeListener.bind(this);\nthis._listeners[ZmOperation.CONTACT]=this._contactListener.bind(this);\nthis._listeners[ZmOperation.VIEW]=this._viewMenuItemListener.bind(this);\nthis._listeners[ZmOperation.GO_TO_URL]=this._goToUrlListener.bind(this);\nif(window.ZmImApp){this._listeners[ZmOperation.IM]=ZmImApp.getImMenuItemListener()\n}this.operationsToEnableOnZeroSelection=[ZmOperation.NEW_MENU];\nthis.operationsToEnableOnMultiSelection=[ZmOperation.NEW_MENU,ZmOperation.TAG_MENU,ZmOperation.DELETE,ZmOperation.MOVE,ZmOperation.MOVE_MENU,ZmOperation.FORWARD,ZmOperation.ACTIONS_MENU];\nthis.operationsToDisableOnSingleSelection=[]\n};\nZmBaseController.prototype=new ZmController;\nZmBaseController.prototype.constructor=ZmBaseController;\nZmBaseController.prototype.isZmBaseController=true;\nZmBaseController.prototype.toString=function(){return\"ZmBaseController\"\n};\nZmBaseController.prototype.setSessionId=function(c,a,b){ZmController.prototype.setSessionId.apply(this,arguments);\nthis.searchResultsController=b;\nthis.isSearchResults=Boolean(b)\n};\nZmBaseController.prototype.getCurrentView=function(){return this._view[this._currentViewId]\n};\nZmBaseController.prototype.getItemView=function(){return null\n};\nZmBaseController.prototype.getCurrentToolbar=function(){return this._toolbar[this._currentViewId]\n};\nZmBaseController.prototype.getItems=function(){};\nZmBaseController.prototype.getItemCount=function(){};\nZmBaseController.prototype.handleKeyAction=function(b,d){var c=appCtxt.isExternalAccount();\nswitch(b){case ZmKeyMap.MOVE:if(c){break\n}var a=this.getItems();\nif(a&&a.length){this._moveListener()\n}break;\ncase ZmKeyMap.PRINT:if(appCtxt.get(ZmSetting.PRINT_ENABLED)&&!appCtxt.isWebClientOffline()){this._printListener()\n}break;\ncase ZmKeyMap.TAG:if(c){break\n}var a=this.getItems();\nif(a&&a.length&&(appCtxt.getTagTree().size()>0)){var e=appCtxt.getPickTagDialog();\nZmController.showDialog(e,new AjxCallback(this,this._tagSelectionCallback,[a,e]))\n}break;\ncase ZmKeyMap.UNTAG:if(c){break\n}if(appCtxt.get(ZmSetting.TAGGING_ENABLED)){var a=this.getItems();\nif(a&&a.length){this._doRemoveAllTags(a)\n}}break;\ndefault:return ZmController.prototype.handleKeyAction.apply(this,arguments)\n}return true\n};\nZmBaseController.prototype.isCurrent=function(){return(this._currentViewId==appCtxt.getCurrentViewId())\n};\nZmBaseController.prototype.supportsDnD=function(){return !appCtxt.isExternalAccount()\n};\nZmBaseController.prototype._createNewView=function(){};\nZmBaseController.prototype._setViewContents=function(a){};\nZmBaseController.prototype._getTagMenuMsg=function(a){};\nZmBaseController.prototype._getMoveDialogTitle=function(a){};\nZmBaseController.prototype._getToolBarOps=function(){};\nZmBaseController.prototype._getSecondaryToolBarOps=function(){};\nZmBaseController.prototype._getRightSideToolBarOps=function(){};\nZmBaseController.prototype._setup=function(a){this._initialize(a);\nthis._resetOperations(this._toolbar[a],0)\n};\nZmBaseController.prototype._initialize=function(a){this._initializeToolBar(a);\nthis._initializeView(a);\nthis._initializeTabGroup(a)\n};\nZmBaseController.prototype._standardToolBarOps=function(){return[ZmOperation.DELETE,ZmOperation.MOVE_MENU,ZmOperation.PRINT]\n};\nZmBaseController.prototype._initializeToolBar=function(j,g){if(this._toolbar[j]){return\n}var h=this._getToolBarOps();\nvar b=this._getSecondaryToolBarOps()||[];\nvar m=this._getRightSideToolBarOps()||[];\nif(!(h||b)){return\n}var k={parent:this._container,buttons:h,secondaryButtons:b,rightSideButtons:m,overrides:this._getButtonOverrides(h.concat(b).concat(m)),context:j,controller:this,refElementId:ZmId.SKIN_APP_TOP_TOOLBAR,addTextElement:true,className:g};\nvar c=this._toolbar[j]=new ZmButtonToolBar(k);\nvar l=c.getButton(ZmOperation.TEXT);\nif(l){l.addClassName(\"itemCountText\")\n}var e;\nfor(var d=0;\nd<c.opList.length;\nd++){e=c.opList[d];\nif(this._listeners[e]){c.addSelectionListener(e,this._listeners[e])\n}}e=c.getButton(ZmOperation.TAG_MENU);\nif(e){e.noMenuBar=true;\nthis._setupTagMenu(c)\n}e=c.getButton(ZmOperation.MOVE_MENU);\nif(e){e.noMenuBar=true;\nthis._setupMoveMenu(c)\n}var f=c.getActionsButton();\nif(f){f.addDropDownSelectionListener(this._listeners[ZmOperation.ACTIONS_MENU])\n}var a=c.getActionsMenu();\nif(a){this._setSearchMenu(a,true)\n}appCtxt.notifyZimlets(\"initializeToolbar\",[this._app,c,this,j],{waitUntilLoaded:true})\n};\nZmBaseController.prototype._getButtonOverrides=function(a){};\nZmBaseController.prototype._initializeView=function(a){if(this._view[a]){return\n}this._view[a]=this._createNewView(a);\nthis._view[a].addSelectionListener(this._listSelectionListener.bind(this));\nthis._view[a].addActionListener(this._listActionListener.bind(this))\n};\nZmBaseController.prototype._initializeListView=ZmBaseController.prototype._initializeView;\nZmBaseController.prototype._initializeTabGroup=function(a){if(this._tabGroups[a]){return\n}this._tabGroups[a]=this._createTabGroup();\nthis._tabGroups[a].newParent(appCtxt.getRootTabGroup());\nthis._tabGroups[a].addMember(this._toolbar[a].getTabGroupMember());\nthis._tabGroups[a].addMember(this._view[a].getTabGroupMember())\n};\nZmBaseController.prototype._setView=function(c){var a=c.view;\nif(!this._appViews[a]){var b={};\nb[ZmAppViewMgr.CB_PRE_HIDE]=this._preHideCallback.bind(this);\nb[ZmAppViewMgr.CB_PRE_UNLOAD]=this._preUnloadCallback.bind(this);\nb[ZmAppViewMgr.CB_POST_HIDE]=this._postHideCallback.bind(this);\nb[ZmAppViewMgr.CB_POST_REMOVE]=this._postRemoveCallback.bind(this);\nb[ZmAppViewMgr.CB_PRE_SHOW]=this._preShowCallback.bind(this);\nb[ZmAppViewMgr.CB_POST_SHOW]=this._postShowCallback.bind(this);\nc.callbacks=b;\nc.viewId=a;\nc.controller=this;\nthis._app.createView(c);\nthis._appViews[a]=true\n}if(!c.pushOnly){this._setViewContents(a)\n}if(c.stageView){this._app.stageView(a)\n}else{if(!c.noPush){return(c.clear?this._app.setView(a):this._app.pushView(a))\n}}};\nZmBaseController.prototype._tagButtonListener=function(b){var a=this._toolbar[this._currentViewId];\nif(b.item.parent==a){this._setTagMenu(a)\n}};\nZmBaseController.prototype._moveButtonListener=function(d,e){this._pendingActionData=e||this.getItems();\nvar c=this._toolbar[this._currentViewId];\nvar a=c.getOp(ZmOperation.MOVE_MENU);\nif(!a){return\n}if(!this._moveButtonInitialized){this._moveButtonInitialized=true;\nappCtxt.getShell().setBusy(true);\nthis._setMoveButton(a);\nappCtxt.getShell().setBusy(false)\n}else{this._folderChooser.updateData(this._getMoveParams(this._folderChooser).data)\n}var b=this._folderChooser._getNewButton();\nif(b){b.setVisible(!appCtxt.isWebClientOffline())\n}a.popup();\na.getMenu().getHtmlElement().style.width=\"auto\";\nthis._folderChooser.focus()\n};\nZmBaseController.prototype._actionsButtonListener=function(a){var b=this.getCurrentToolbar().getActionsMenu();\nb.parent.popup()\n};\nZmBaseController.prototype._tagListener=function(c,a){if(this.isCurrent()){var b=c.item;\nvar f=b.getData(ZmTagMenu.KEY_TAG_EVENT);\nvar e=b.getData(ZmTagMenu.KEY_TAG_ADDED);\na=a||this.getItems();\nif(f==ZmEvent.E_TAGS&&e){this._doTag(a,b.getData(Dwt.KEY_OBJECT),true)\n}else{if(f==ZmEvent.E_CREATE){this._pendingActionData=a;\nvar d=appCtxt.getNewTagDialog();\nif(!this._newTagCb){this._newTagCb=new AjxCallback(this,this._newTagCallback)\n}ZmController.showDialog(d,this._newTagCb);\nd.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,d)\n}else{if(f==ZmEvent.E_TAGS&&!e){this._doTag(a,b.getData(Dwt.KEY_OBJECT),false)\n}else{if(f==ZmEvent.E_REMOVE_ALL){this._doRemoveAllTags(a)\n}}}}}};\nZmBaseController.prototype._tagSelectionCallback=function(b,c,a){if(a){this._doTag(b,a,true)\n}c.popdown()\n};\nZmBaseController.prototype._printListener=function(b){var a=this.getItems();\nif(a&&a[0]){window.open(a[0].getRestUrl(),\"_blank\")\n}};\nZmBaseController.prototype._backListener=function(a){this._app.popView()\n};\nZmBaseController.prototype._deleteListener=function(a){this._doDelete(this.getItems(),a.shiftKey)\n};\nZmBaseController.prototype._moveListener=function(a,c){this._pendingActionData=c||this.getItems();\nvar b=appCtxt.getChooseFolderDialog();\nif(!this._moveCb){this._moveCb=new AjxCallback(this,this._moveCallback)\n}ZmController.showDialog(b,this._moveCb,this._getMoveParams(b));\nb.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,b)\n};\nZmBaseController.prototype._getMoveParams=function(a){var b=ZmApp.ORGANIZER[this._app._name]||ZmOrganizer.FOLDER;\nreturn{overviewId:a.getOverviewId(this._app._name),data:this._pendingActionData,treeIds:[b],title:this._getMoveDialogTitle(this._pendingActionData.length,this._pendingActionData),description:ZmMsg.targetFolder,treeStyle:DwtTree.SINGLE_STYLE,noRootSelect:true,appName:this._app._name}\n};\nZmBaseController.prototype._viewMenuItemListener=function(a){if(a.detail==DwtMenuItem.CHECKED||a.detail==DwtMenuItem.UNCHECKED){this.switchView(a.item.getData(ZmOperation.MENUITEM_ID))\n}};\nZmBaseController.prototype._tagChangeListener=function(b){if(this.isCurrent()){if(b.type==ZmEvent.S_TAG&&b.event==ZmEvent.E_CREATE&&this._pendingActionData){var a=b.getDetail(\"organizers\")[0];\nthis._doTag(this._pendingActionData,a,true);\nthis._pendingActionData=null;\nthis._menuPopdownActionListener()\n}}};\nZmBaseController.prototype._moveCallback=function(a){this._doMove(this._pendingActionData,a);\nthis._clearDialog(appCtxt.getChooseFolderDialog());\nthis._pendingActionData=null\n};\nZmBaseController.prototype._moveMenuCallback=function(a,b){this._doMove(this._pendingActionData,b);\na.getMenu().popdown();\nthis._pendingActionData=null\n};\nZmBaseController.prototype._getList=function(a){a=AjxUtil.toArray(a);\nvar b=a[0];\nreturn b&&b.list\n};\nZmBaseController.prototype._getAllDoneCallback=function(){};\nZmBaseController.showSummary=function(c,f,e){if(!c){return\n}var a=e?parentAppCtxt:appCtxt;\nvar d=a.getActionController();\nvar b=f&&d&&d.getUndoLink(f);\nif(b&&d){d.onPopup();\na.setStatusMsg({msg:c+b,transitions:d.getStatusTransitions()})\n}else{a.setStatusMsg(c)\n}};\nZmBaseController.prototype._doFlag=function(c,b){c=AjxUtil.toArray(c);\nif(!c.length){return\n}if(c[0].isZmItem){if(b!==true&&b!==false){b=!c[0].isFlagged\n}var a=[];\nfor(var d=0;\nd<c.length;\nd++){if(c[d].isFlagged!=b){a.push(c[d])\n}}}else{a=c\n}var f={items:a,op:\"flag\",value:b};\nf.actionTextKey=b?\"actionFlag\":\"actionUnflag\";\nvar e=f.list=this._getList(f.items);\nthis._setupContinuation(this._doFlag,[b],f);\ne.flagItems(f)\n};\nZmBaseController.prototype._doMsgPriority=function(c,b){c=AjxUtil.toArray(c);\nif(!c.length){return\n}if(c[0].isZmItem){if(b!==true&&b!==false){b=!c[0].isPriority\n}var a=[];\nfor(var d=0;\nd<c.length;\nd++){if(c[d].isPriority!=b){a.push(c[d])\n}}}else{a=c\n}var f={items:a,op:\"priority\",value:b};\nf.actionTextKey=b?\"actionMsgPriority\":\"actionUnMsgPriority\";\nvar e=f.list=this._getList(f.items);\nthis._setupContinuation(this._doMsgPriority,[b],f);\ne.flagItems(f)\n};\nZmBaseController.prototype._doTag=function(b,a,f){b=AjxUtil.toArray(b);\nif(!b.length){return\n}for(var c=0;\nc<b.length;\nc++){if(b[c].cloneOf){b[c]=b[c].cloneOf\n}}var e={items:b,tag:a,doTag:f};\nvar d=e.list=this._getList(e.items);\nthis._setupContinuation(this._doTag,[a,f],e);\nd.tagItems(e)\n};\nZmBaseController.prototype._doRemoveAllTags=function(a){a=AjxUtil.toArray(a);\nif(!a.length){return\n}for(var b=0;\nb<a.length;\nb++){if(a[b].cloneOf){a[b]=a[b].cloneOf\n}}var d={items:a};\nvar c=d.list=this._getList(d.items);\nthis._setupContinuation(this._doRemoveAllTags,null,d);\nc.removeAllTags(d)\n};\nZmBaseController.prototype._doDelete=function(j,g,l,d){j=AjxUtil.toArray(j);\nif(!j.length){return\n}var b=this._getSearchFolder();\nvar k=(b&&b.nId==ZmFolder.ID_TRASH);\nif(k){g=true\n}var e={items:j,hardDelete:g,attrs:l,childWin:appCtxt.isChildWindow&&window,closeChildWin:appCtxt.isChildWindow,confirmDelete:d};\nvar m=this._getAllDoneCallback();\nvar h=e.list=this._getList(e.items);\nthis._setupContinuation(this._doDelete,[g,l,true],e,m);\nif(!g){var a=false;\nfor(var f=0,c=j.length;\nf<c;\nf++){if(j[f]&&j[f].isScheduled){a=true;\nbreak\n}}if(a){e.noUndo=true;\nthis._popupScheduledWarningDialog(h.deleteItems.bind(h,e))\n}else{h.deleteItems(e)\n}}else{h.deleteItems(e)\n}};\nZmBaseController.prototype._doMove=function(m,c,o,j,e){m=AjxUtil.toArray(m);\nif(!m.length){return\n}var f=[];\nvar b=[];\nif(m[0].isZmItem){for(var h=0;\nh<m.length;\nh++){var p=m[h];\nif(!p.folderId||(p.folderId!=c.id||(o&&o.op==\"recover\"))){if(!this._isItemMovable(p,j,c)){b.push(p)\n}else{f.push(p)\n}}}}else{f=m\n}var g={folder:c,attrs:o,noUndo:e};\ng.errorCallback=this._actionErrorCallback.bind(this);\nvar r=this._getAllDoneCallback();\nif(f.length){g.items=f;\nvar l=g.list=this._getList(g.items);\nthis._setupContinuation(this._doMove,[c,o,j],g,r);\nif(c.isInTrash()){var a=false;\nvar n=AjxUtil.toArray(f);\nfor(var h=0,d=n.length;\nh<d;\nh++){if(n[h]&&n[h].isScheduled){a=true;\nbreak\n}}if(a){g.noUndo=true;\nthis._popupScheduledWarningDialog(l.moveItems.bind(l,g))\n}else{l.moveItems(g)\n}}else{if(c.id==appCtxt.get(ZmSetting.MAIL_ACTIVITYSTREAM_FOLDER)&&m.length==1){l.moveItems(g);\nvar q=appCtxt.getActivityStreamFilterDialog();\nq.setFields(m[0]);\nq.popup()\n}else{if(m.length==1&&c.id==ZmFolder.ID_INBOX){l.moveItems(g);\nvar k=appCtxt.getById(m[0].folderId);\nif(k&&k.id==appCtxt.get(ZmSetting.MAIL_ACTIVITYSTREAM_FOLDER)){var q=appCtxt.getActivityToInboxFilterDialog();\nq.setFields(m[0]);\nq.popup()\n}}else{l.moveItems(g)\n}}}}if(b.length){g.items=b;\nvar l=g.list=this._getList(g.items);\nthis._setupContinuation(this._doMove,[c,o,j],g,r,true);\nl.copyItems(g)\n}};\nZmBaseController.prototype._actionErrorCallback=function(a){return false\n};\nZmBaseController.prototype._popupScheduledWarningDialog=function(b){var a=appCtxt.getOkCancelMsgDialog();\na.reset();\na.setMessage(ZmMsg.moveScheduledMessageWarning,DwtMessageDialog.WARNING_STYLE);\na.registerCallback(DwtDialog.OK_BUTTON,this._scheduledWarningDialogListener.bind(this,b,a));\na.associateEnterWithButton(DwtDialog.OK_BUTTON);\na.popup(null,DwtDialog.OK_BUTTON)\n};\nZmBaseController.prototype._scheduledWarningDialogListener=function(b,a){a.popdown();\nb()\n};\nZmBaseController.prototype._isItemMovable=function(c,a,b){return(!a&&!c.isReadOnly()&&!b.isReadOnly())\n};\nZmBaseController.prototype._doModify=function(b,a){var c=this._getList(b);\nc.modifyItem(b,a)\n};\nZmBaseController.prototype._doCreate=function(b,a){b.create(a)\n};\nZmBaseController.prototype._setupTagMenu=function(b,c){if(!b){return\n}var d=b.getTagMenu();\nc=c||this._listeners[ZmOperation.TAG];\nif(d){d.addSelectionListener(c)\n}if(b.isZmButtonToolBar){var a=b.getOp(ZmOperation.TAG_MENU);\nif(a){a.addDropDownSelectionListener(this._listeners[ZmOperation.TAG_MENU])\n}}};\nZmBaseController.prototype._setupMoveMenu=function(b){if(!b){return\n}if(!b.isZmButtonToolBar){return\n}var a=b.getOp(ZmOperation.MOVE_MENU);\nif(a){a.addDropDownSelectionListener(this._listeners[ZmOperation.MOVE_MENU])\n}};\nZmBaseController.prototype._setTagMenu=function(e,b){if(!e){return\n}var d=e.getOp(ZmOperation.TAG_MENU);\nif(d){var g=e.getTagMenu();\nif(!g){return\n}b=b||AjxUtil.toArray(this.getItems());\nfor(var c=0;\nc<b.length;\nc++){if(b[c].cloneOf){b[c]=b[c].cloneOf\n}}var f=(appCtxt.multiAccounts&&b.length==1)?b[0].getAccount():null;\ng.set(b,appCtxt.getTagTree(f));\nif(e.isZmActionMenu){d.setText(this._getTagMenuMsg(b.length,b))\n}else{g.parent.popup();\nif(appCtxt.isChildWindow||appCtxt.isWebClientOffline()){var a=g.getMenuItem(ZmTagMenu.MENU_ITEM_ADD_ID);\nif(a){a.setVisible(false)\n}}}}};\nZmBaseController.prototype._setMoveButton=function(a){var d=new DwtMenu({parent:a,style:DwtMenu.CALENDAR_PICKER_STYLE,id:\"ZmMoveButton_\"+this.getCurrentViewId()});\nd.getHtmlElement().style.width=\"auto\";\na.setMenu(d,true);\nvar b=this._folderChooser=new ZmFolderChooser({parent:d});\nvar c=this._getMoveParams(b);\nc.overviewId+=this._currentViewId;\nb.setupFolderChooser(c,this._moveMenuCallback.bind(this,a));\nreturn a\n};\nZmBaseController.prototype._resetOperations=function(b,a){if(!b){return\n}if(a==0){b.enableAll(false);\nb.enable(this.operationsToEnableOnZeroSelection,true)\n}else{if(a==1){b.enableAll(true);\nb.enable(this.operationsToDisableOnSingleSelection,false)\n}else{if(a>1){b.enableAll(false);\nb.enable(this.operationsToEnableOnMultiSelection,true)\n}}}var c=(a>0)&&this._getSearchFolder();\nif(c&&c.isReadOnly()){b.enable(ZmOperation.TAG_MENU,false)\n}};\nZmBaseController.prototype._resetOperation=function(b,a,c){};\nZmBaseController.prototype._resetToolbarOperations=function(){this._resetOperations(this._toolbar[this._currentViewId],this.getItemCount())\n};\nZmBaseController.prototype._getDefaultFocusItem=function(){return this.getCurrentView()\n};\nZmBaseController.prototype._setupContinuation=function(b,a,d,c){d.finalCallback=this._continueAction.bind(this,{allDoneCallback:c})\n};\nZmBaseController.prototype._continueAction=function(a){if(a.allDoneCallback){a.allDoneCallback()\n}ZmBaseController.showSummary(a.actionSummary,a.actionLogItem,a.closeChildWin)\n};\nZmBaseController.prototype._bubbleSelectionListener=function(c){this._actionEv=c;\nvar b=c.item;\nif(c.detail===DwtEvent.ONDBLCLICK){this._actionEv.bubble=b;\nthis._actionEv.address=b.addrObj||b.address;\nthis._composeListener(c)\n}else{var a=this.getItemView(),d=a&&a._bubbleList;\nif(d&&d.selectAddressText){d.selectAddressText()\n}}};\nZmBaseController.prototype._bubbleActionListener=function(c,e){this._actionEv=c;\nvar b=this._actionEv.bubble=c.item,a=this._actionEv.address=e||b.addrObj||b.address,d=this._getBubbleActionMenu();\nif(d){d.enable([ZmOperation.CONTACT,ZmOperation.ADD_TO_FILTER_RULE],!appCtxt.isWebClientOffline());\nthis._loadContactForMenu(d,a,c)\n}};\nZmBaseController.prototype._getBubbleActionMenu=function(){if(this._bubbleActionMenu){return this._bubbleActionMenu\n}var b=this._getBubbleActionMenuOps();\nvar e=this._bubbleActionMenu=new ZmActionMenu({parent:this._shell,menuItems:b,controller:this,id:ZmId.create({componentType:ZmId.WIDGET_MENU,componentName:this._currentViewId,app:this._app})});\nif(appCtxt.get(ZmSetting.SEARCH_ENABLED)){this._setSearchMenu(e,false)\n}if(appCtxt.get(ZmSetting.FILTERS_ENABLED)&&this._setAddToFilterMenu){this._setAddToFilterMenu(e)\n}e.addPopdownListener(this._bubbleMenuPopdownListener.bind(this));\nfor(var a=0;\na<b.length;\na++){var c=b[a];\nif(this._listeners[c]){e.addSelectionListener(c,this._listeners[c])\n}}e.setVisible(true);\nvar d=appCtxt.getClipboard();\nif(d){d.init(e.getOp(ZmOperation.COPY),{onMouseDown:this._clipCopy.bind(this),onComplete:this._clipCopyComplete.bind(this)})\n}return e\n};\nZmBaseController.prototype._getBubbleActionMenuOps=function(){var a=[];\nif(AjxClipboard.isSupported()){a.push(ZmOperation.COPY)\n}a.push(ZmOperation.SEARCH_MENU);\na.push(ZmOperation.NEW_MESSAGE);\nif(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){a.push(ZmOperation.CONTACT)\n}a.push(ZmOperation.GO_TO_URL);\nif(appCtxt.get(ZmSetting.FILTERS_ENABLED)&&this._filterListener){a.push(ZmOperation.ADD_TO_FILTER_RULE)\n}return a\n};\nZmBaseController.prototype._clipCopy=function(a){a.setText(this._actionEv.address+AjxEmailAddress.SEPARATOR)\n};\nZmBaseController.prototype._clipCopyComplete=function(a){this._bubbleActionMenu.popdown()\n};\nZmBaseController.prototype._bubbleMenuPopdownListener=function(){var b=this.getItemView(),c=b&&b._bubbleList,a=this._actionEv&&this._actionEv.bubble;\nif(c){c.clearRightSelection();\nif(a){a.setClassName(c._normalClass)\n}}this._actionEv.bubble=null\n};\nZmBaseController.prototype._dlAddrSelected=function(a,b){this._actionEv.address=a;\nthis._composeListener(b)\n};\nZmBaseController.prototype._loadContactForMenu=function(b,h,f,a){var j=window.parentAppCtxt||appCtxt;\nvar g=j.getApp(ZmApp.CONTACTS),h=h.isAjxEmailAddress?h:new AjxEmailAddress(h),e=h.getAddress();\nif(!e){return\n}var d=g&&g.getContactByEmail(e);\nif(d){this._handleResponseGetContact(b,h,f,a,d);\nreturn\n}var c=b.getOp(ZmOperation.CONTACT);\nif(c){c.setText(ZmMsg.loading)\n}if(a){if(ZmImApp.updateImMenuItemByAddress(a,h,false)){a.setText(ZmMsg.loading)\n}else{a=null\n}}b.popup(0,f.docX||f.item.getXW(),f.docY||f.item.getYH());\nvar i=this._handleResponseGetContact.bind(this,b,h,f,a);\ng&&g.getContactByEmail(e,i)\n};\nZmBaseController.prototype._handleResponseGetContact=function(e,b,d,c,a){this._actionEv.contact=a;\nthis._setContactText(a,e);\nif(c){if(a){ZmImApp.updateImMenuItemByContact(c,a,b)\n}else{ZmImApp.handleResponseGetContact(c,b,true)\n}}e.popup(0,d.docX||d.item.getXW(),d.docY||d.item.getYH())\n};\nZmBaseController.prototype._setContactText=function(a,b){ZmBaseController.setContactTextOnMenu(a,b||this._actionMenu)\n};\nZmBaseController.setContactTextOnMenu=function(a,d){if(!d){return\n}var b=ZmOperation.EDIT_CONTACT;\nvar c=null;\nif(a&&a.isDistributionList()){c=ZmMsg.AB_EDIT_DL\n}else{if(a&&a.isGroup()){c=ZmMsg.AB_EDIT_GROUP\n}else{if(!a||a.isGal){c=ZmMsg.AB_ADD_CONTACT;\nb=ZmOperation.NEW_CONTACT\n}}}ZmOperation.setOperation(d,ZmOperation.CONTACT,b,c);\nif(appCtxt.isWebClientOffline()){d.enable(ZmOperation.CONTACT,false)\n}};\nZmBaseController.prototype._setSearchMenu=function(a,c){var b=a&&a.getSearchMenu&&a.getSearchMenu();\nif(!b){return\n}b.addSelectionListener(ZmOperation.SEARCH,this._searchListener.bind(this,AjxEmailAddress.FROM,c));\nb.addSelectionListener(ZmOperation.SEARCH_TO,this._searchListener.bind(this,AjxEmailAddress.TO,c));\nif(this.getSearchFromText()){b.getMenuItem(ZmOperation.SEARCH).setText(this.getSearchFromText())\n}if(this.getSearchToText()){b.getMenuItem(ZmOperation.SEARCH_TO).setText(this.getSearchToText())\n}};\nZmBaseController.prototype._searchListener=function(g,c,h){var b=this._getSearchFolder(),k=this._actionEv.item,i=this._actionEv.address,a;\nif(k&&k.isZmMailMsg&&b&&b.isOutbound()){var d=k.getAddresses(AjxEmailAddress.TO).getArray(),e=k.getAddresses(AjxEmailAddress.CC).getArray();\na=d.concat(e)\n}else{if(i){a=i.isAjxEmailAddress?i.getAddress():i\n}}if(a){var j=window.parentAppCtxt||window.appCtxt;\nvar f=j.getSearchController();\nif(g===AjxEmailAddress.FROM){f.fromSearch(a)\n}else{if(g===AjxEmailAddress.TO){f.toSearch(a)\n}}}};\nZmBaseController.prototype._composeListener=function(b,c){var c=c||(this._actionEv&&this._actionEv.address),a=c&&c.toString();\nif(a){AjxDispatcher.run(\"Compose\",{action:ZmOperation.NEW_MESSAGE,inNewWindow:this._app._inNewWindow(b),toOverride:a+AjxEmailAddress.SEPARATOR})\n}};\nZmBaseController.prototype._contactListener=function(b){var a=this._handleLoadContactListener.bind(this);\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,a,null,true)\n};\nZmBaseController.prototype._handleLoadContactListener=function(){var d=appCtxt.isChildWindow?window.parentAppCtxt.getApp(ZmApp.CONTACTS).getContactController():AjxDispatcher.run(\"GetContactController\");\nvar a=this._actionEv.contact;\nif(a){if(a.isDistributionList()){this._editListener(this._actionEv,a);\nreturn\n}if(a.isLoaded){var b=a.isGal;\nd.show(a,b)\n}else{var c=this._loadContactCallback.bind(this);\na.load(c)\n}}else{var a=d._createNewContact(this._actionEv);\nd.show(a,true)\n}if(appCtxt.isChildWindow){window.close()\n}};\nZmBaseController.prototype.getSearchFromText=function(){return null\n};\nZmBaseController.prototype.getSearchToText=function(){return null\n};\nZmBaseController.prototype._createNewContact=function(b){var a=new ZmContact(null);\na.initFromEmail(b.address);\nreturn a\n};\nZmBaseController.prototype._loadContactCallback=function(b,a){AjxDispatcher.run(\"GetContactController\").show(a)\n};\nZmBaseController.prototype._getSearchFolder=function(){var a=this._getSearchFolderId();\nreturn a&&appCtxt.getById(a)\n};\nZmBaseController.prototype._getSearchFolderId=function(a){var b=this._activeSearch&&this._activeSearch.search;\nreturn b&&(a||b.isSimple())&&b.folderId\n};\nZmBaseController.prototype._goToUrlListener=function(c){var f=this._getAddress(this._actionEv.address);\nvar e=f.split(\"@\");\nif(!e.length){return\n}var d=e[1];\nvar b=d.split(\".\");\nvar a=\"http://\"+(b.length<=2?\"www.\"+d:d);\nwindow.open(a,\"_blank\")\n};\nZmBaseController.prototype._getAddress=function(a){return a.isAjxEmailAddress?a.address:a\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmListController\")){ZmListController=function(a,e,b,d,c){if(arguments.length==0){return\n}ZmBaseController.apply(this,arguments);\nthis._navToolBar={};\nthis._listView=this._view;\nthis._list=null;\nthis._activeSearch=null;\nthis._newButton=null;\nthis._actionMenu=null;\nthis._actionEv=null;\nthis._lastSelectedListItem=null;\nif(this.supportsDnD()){this._dropTgt=new DwtDropTarget(\"ZmTag\");\nthis._dropTgt.markAsMultiple();\nthis._dropTgt.addDropListener(this._dropListener.bind(this))\n}this._menuPopdownListener=this._menuPopdownActionListener.bind(this);\nthis._itemCountText={};\nthis._continuation={count:0,totalItems:0}\n};\nZmListController.prototype=new ZmBaseController;\nZmListController.prototype.constructor=ZmListController;\nZmListController.prototype.isZmListController=true;\nZmListController.prototype.toString=function(){return\"ZmListController\"\n};\nZmListController.CONTINUATION_SEARCH_ITEMS=500;\nZmListController.PROGRESS_DIALOG_INIT=\"INIT\";\nZmListController.PROGRESS_DIALOG_UPDATE=\"UPDATE\";\nZmListController.PROGRESS_DIALOG_CLOSE=\"CLOSE\";\nZmListController.prototype.show=function(a){this._activeSearch=a;\nif(a){this._currentSearch=a.search;\nthis._activeSearch.viewId=this._currentSearch.viewId=this._currentViewId\n}this.currentPage=1;\nthis.maxPage=1\n};\nZmListController.prototype.getListView=function(){return this._view[this._currentViewId]\n};\nZmListController.prototype.getCurrentSearchResults=function(){return this._activeSearch\n};\nZmListController.prototype.getSearchString=function(){return this._currentSearch?this._currentSearch.query:\"\"\n};\nZmListController.prototype.setSearchString=function(a){this._currentSearch.query=a\n};\nZmListController.prototype.getSearchStringHint=function(){return this._currentSearch?this._currentSearch.queryHint:\"\"\n};\nZmListController.prototype.getSelection=function(a){a=a||this.getListView();\nreturn a?a.getSelection():[]\n};\nZmListController.prototype.getSelectionCount=function(a){a=a||this.getListView();\nreturn a?a.getSelectionCount():0\n};\nZmListController.prototype.getList=function(){return this._list\n};\nZmListController.prototype.setList=function(a){if(a!=this._list&&a.isZmList){if(this._list){this._list.clear()\n}this._list=a;\nthis._list.controller=this\n}};\nZmListController.prototype.setHasMore=function(a){if(a&&this._list){this._list.setHasMore(a);\nthis._resetNavToolBarButtons()\n}};\nZmListController.prototype.getItems=function(){return this.getSelection()\n};\nZmListController.prototype.getItemCount=function(){return this.getSelectionCount()\n};\nZmListController.prototype.handleKeyAction=function(e,f){var g=this._view[this._currentViewId];\nvar i=false;\nvar a=document.activeElement;\nswitch(e){case DwtKeyMap.DBLCLICK:if(a&&a.nodeName&&a.nodeName.toLowerCase()===\"a\"){return false\n}return g.handleKeyAction(e);\ncase ZmKeyMap.SHIFT_DEL:case ZmKeyMap.DEL:var c=this.getCurrentToolbar();\nvar d=c&&(c.getButton(ZmOperation.DELETE)||c.getButton(ZmOperation.DELETE_MENU));\nif(d&&d.getEnabled()){this._doDelete(this.getSelection(),(e==ZmKeyMap.SHIFT_DEL));\ni=true\n}break;\ncase ZmKeyMap.NEXT_PAGE:var b=this._navToolBar[this._currentViewId];\nvar d=b?b.getButton(ZmOperation.PAGE_FORWARD):null;\nif(d&&d.getEnabled()){this._paginate(this._currentViewId,true);\ni=true\n}break;\ncase ZmKeyMap.PREV_PAGE:var b=this._navToolBar[this._currentViewId];\nvar d=b?b.getButton(ZmOperation.PAGE_BACK):null;\nif(d&&d.getEnabled()){this._paginate(this._currentViewId,false);\ni=true\n}break;\ncase ZmKeyMap.CANCEL:var h=this.isSearchResults&&this.searchResultsController;\nif(h){h._closeListener()\n}break;\ndefault:return ZmBaseController.prototype.handleKeyAction.apply(this,arguments)\n}return i\n};\nZmListController.prototype._getActionMenuOps=function(){};\nZmListController.prototype._standardActionMenuOps=function(){return[ZmOperation.TAG_MENU,ZmOperation.MOVE,ZmOperation.PRINT]\n};\nZmListController.prototype._participantOps=function(){var a=[ZmOperation.SEARCH_MENU];\nif(appCtxt.get(ZmSetting.MAIL_ENABLED)){a.push(ZmOperation.NEW_MESSAGE)\n}if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){a.push(ZmOperation.CONTACT)\n}return a\n};\nZmListController.prototype._initializeActionMenu=function(){if(this._actionMenu){return\n}var a=this._getActionMenuOps();\nif(!a){return\n}var b={parent:this._shell,menuItems:a,context:this._getMenuContext(),controller:this};\nthis._actionMenu=new ZmActionMenu(b);\nthis._addMenuListeners(this._actionMenu);\nif(appCtxt.get(ZmSetting.TAGGING_ENABLED)){this._setupTagMenu(this._actionMenu)\n}};\nZmListController.prototype._initializeTabGroup=function(b){if(this._tabGroups[b]){return\n}ZmBaseController.prototype._initializeTabGroup.apply(this,arguments);\nvar a=this._navToolBar[b];\nif(a){this._tabGroups[b].addMember(a.getTabGroupMember())\n}};\nZmListController.prototype.getTabGroup=function(){return this._tabGroups[this._currentViewId]\n};\nZmListController.prototype._addMenuListeners=function(d){var b=d.opList;\nfor(var a=0;\na<b.length;\na++){var c=b[a];\nif(this._listeners[c]){d.addSelectionListener(c,this._listeners[c],0)\n}}d.addPopdownListener(this._menuPopdownListener)\n};\nZmListController.prototype._menuPopdownActionListener=function(c){var a=this.getListView();\nif(!this._pendingActionData){if(a&&a.handleActionPopdown){a.handleActionPopdown(c)\n}}var b=a?a.getSelectionCount():-1;\nif(b<=1){this._setItemCountText()\n}};\nZmListController.prototype._listSelectionListener=function(a){if(a.field==ZmItem.F_FLAG){this._doFlag([a.item]);\nreturn true\n}else{var b=this._listView[this._currentViewId];\nif(b){if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)&&!a.ctrlKey){if(b.setSelectionHdrCbox){b.setSelectionHdrCbox(false)\n}}this._resetOperations(this.getCurrentToolbar(),b.getSelectionCount());\nif(a.shiftKey){this._setItemSelectionCountText()\n}else{this._setItemCountText()\n}}}return false\n};\nZmListController.prototype._listActionListener=function(a){this._actionEv=a;\nvar b=this.getActionMenu();\nif(appCtxt.get(ZmSetting.TAGGING_ENABLED)){this._setTagMenu(b)\n}if(appCtxt.get(ZmSetting.SEARCH_ENABLED)){this._setSearchMenu(b)\n}this._resetOperations(b,this.getSelectionCount());\nthis._setItemSelectionCountText()\n};\nZmListController.prototype._navBarListener=function(a){if(!this.isCurrent()){return\n}var b=a.item.getData(ZmOperation.KEY_ID);\nif(b==ZmOperation.PAGE_BACK||b==ZmOperation.PAGE_FORWARD){this._paginate(this._currentViewId,(b==ZmOperation.PAGE_FORWARD))\n}};\nZmListController.prototype._dragListener=function(a){if(this.isSearchResults&&a.action==DwtDragEvent.DRAG_START){this.searchResultsController.showOverview(true)\n}else{if(a.action==DwtDragEvent.SET_DATA){a.srcData={data:a.srcControl.getDnDSelection(),controller:this}\n}else{if(this.isSearchResults&&(a.action==DwtDragEvent.DRAG_END||a.action==DwtDragEvent.DRAG_CANCEL)){this.searchResultsController.showOverview(false)\n}}}};\nZmListController.prototype._dropListener=function(g){var h=this._view[this._currentViewId];\nvar a=h.getTargetItemDiv(g.uiEvent);\nvar j=h.getItemFromElement(a);\nvar d=g.srcData.data;\nif(g.action==DwtDropEvent.DRAG_ENTER){g.doIt=(j&&(j instanceof ZmItem)&&!j.isReadOnly()&&this._dropTgt.isValidTarget(d));\nif(appCtxt.multiAccounts){var i=j?j.getAccount().id:null;\nvar e=(d.account&&d.account.id)||d[0].account.id;\nif(i!=e){g.doIt=false\n}}if(g.doIt){h.dragSelect(a)\n}}else{if(g.action==DwtDropEvent.DRAG_DROP){h.dragDeselect(a);\nvar f=[j];\nvar b=this.getSelection();\nif(b.length){var c=AjxVector.fromArray(b);\nif(c.contains(j)){f=b\n}}this._doTag(f,d,true)\n}else{if(g.action==DwtDropEvent.DRAG_LEAVE){h.dragDeselect(a)\n}else{if(g.action==DwtDropEvent.DRAG_OP_CHANGED){}}}}};\nZmListController.prototype.isDraftsFolder=function(){var a=this._getSearchFolder();\nif(!a){return false\n}return a.nId==ZmFolder.ID_DRAFTS\n};\nZmListController.prototype.isOutboxFolder=function(){var a=this._getSearchFolder();\nif(!a){return false\n}return a.nId==ZmFolder.ID_OUTBOX\n};\nZmListController.prototype.isSyncFailuresFolder=function(){var a=this._getSearchFolder();\nif(!a){return false\n}return a.nId==ZmFolder.ID_SYNC_FAILURES\n};\nZmListController.prototype._getList=function(a){var b=ZmBaseController.prototype._getList.apply(this,arguments);\nif(!b){b=this._list\n}return b\n};\nZmListController.prototype._getAllDoneCallback=function(){return this._checkItemCount.bind(this)\n};\nZmListController.handleProgress=function(b){var a=appCtxt.getCancelMsgDialog();\nif(b.state==ZmListController.PROGRESS_DIALOG_INIT){a.reset();\na.registerCallback(DwtDialog.CANCEL_BUTTON,b.callback);\nZmListController.progressDialogReady=true\n}else{if(b.state==ZmListController.PROGRESS_DIALOG_UPDATE&&ZmListController.progressDialogReady){a.setMessage(b.summary,DwtMessageDialog.INFO_STYLE,AjxMessageFormat.format(ZmMsg.inProgress));\nif(!a.isPoppedUp()){a.popup()\n}}else{if(b.state==ZmListController.PROGRESS_DIALOG_CLOSE){a.unregisterCallback(DwtDialog.CANCEL_BUTTON);\na.popdown();\nZmListController.progressDialogReady=false\n}}}};\nZmListController.prototype._cacheList=function(a,c){if(this._list){var b=a.getResults().getVector();\nc=c?c:parseInt(a.getAttribute(\"offset\"));\nthis._list.cache(c,b)\n}else{this._list=a.getResults(type)\n}};\nZmListController.prototype._search=function(h,e,d,i,a,b,g){var f=this._activeSearch&&this._activeSearch.search;\nvar c={query:this.getSearchString(),queryHint:this.getSearchStringHint(),types:f&&f.types||[],userInitiated:f&&f.userInitiated,sortBy:appCtxt.get(ZmSetting.SORTING_PREF,h),offset:e,limit:d,lastId:b,lastSortVal:g};\nthis._getMoreSearchParams(c);\nvar j=new ZmSearch(c);\nif(a){this._currentSearch=j\n}appCtxt.getSearchController().redoSearch(j,true,null,i)\n};\nZmListController.prototype._paginate=function(j,g,f,d){var c=false;\nvar b=this._view[j];\nif(!b){return\n}var e,k;\nd=d||b.getLimit(e);\nif(b._isPageless){e=this._list.size();\nc=true\n}else{e=b.getNewOffset(g);\nc=(e+d>this._list.size());\nthis.currentPage=this.currentPage+(g?1:-1);\nthis.maxPage=Math.max(this.maxPage,this.currentPage)\n}if(c&&this._list.hasMore()){b.offset=e;\nif(b._isPageless){k=d\n}else{var m=(e+d)-this._list.size();\nk=m<d&&m>0?m:d;\nif(k<d){e=((e+d)-k)+1\n}}if(this._searchPending){return false\n}var i=b.getList();\nvar l=i&&i.getLast();\nvar h=(l&&l.id)?l.sf:null;\nvar a=h?l.id:null;\nthis._setItemCountText(ZmMsg.loading);\nthis._searchPending=true;\nvar n=this._handleResponsePaginate.bind(this,j,false,f,e);\nthis._search(j,e,k,n,true,a,h);\nreturn false\n}else{if(!b._isPageless){b.offset=e;\nthis._resetOperations(this._toolbar[j],0);\nthis._resetNavToolBarButtons(j);\nthis._setViewContents(j);\nthis._resetSelection();\nreturn true\n}}};\nZmListController.prototype._handleResponsePaginate=function(n,d,g,f,p,a){var k=p.getResponse();\nthis._list.setHasMore(k.getAttribute(\"more\"));\nthis._cacheList(k,f);\nvar c=this._view[this._currentViewId];\nvar j=c._isPageless?this.getSelectionCount():0;\nthis._resetOperations(this._toolbar[n],j);\nvar b=d?this.getSelection()[0]:null;\nvar e=b?c.getItemIndex(b):-1;\nvar m=k&&k.getResults().getArray();\nif(c._isPageless&&m&&m.length){c._itemsToAdd=m\n}else{c._itemsToAdd=null\n}var o=(c._isPageless&&(c.size()==0));\nthis._setViewContents(n);\nif(c.allSelected){for(var h=0,l=m.length;\nh<l;\nh++){c.selectItem(m[h],true);\nc.setSelectionCbox(m[h],false)\n}c.setSelectionHdrCbox(true)\n}this._resetNavToolBarButtons(n);\nif(!a&&!c._isPageless){this._resetSelection(e)\n}else{if(o){c._setNextSelection()\n}}this._searchPending=false\n};\nZmListController.prototype._getMoreSearchParams=function(a){};\nZmListController.prototype._checkReplenish=function(e){var a=this.getListView();\nvar d=a.getList();\nvar b=false;\nif(d){var c=a.getLimit()-a.size();\nif(c>a.getReplenishThreshold()){this._replenishList(this._currentViewId,c,e);\nb=true\n}}if(e&&!b){e.run()\n}};\nZmListController.prototype._handleEmptyList=function(a){if(this.currentPage>1){this._paginate(this._currentViewId,false,0)\n}else{a.removeAll(true);\na._setNoResultsHtml();\nthis._resetNavToolBarButtons();\na._checkItemCount()\n}};\nZmListController.prototype._replenishList=function(g,c,h){var b=this._view[g].offset+this._view[g].size();\nvar i=this._list.size();\nif(b<i){var f=(f>i)?i:(b+c);\nvar e=this._list.getVector().getArray();\nvar d=e.slice(b,f);\nvar a=AjxVector.fromArray(d);\nthis._view[g].replenish(a);\nif(h){h.run()\n}}else{this._getMoreToReplenish(g,c,h)\n}};\nZmListController.prototype._resetSelection=function(b){var c=this.getListView().getList();\nif(c){var a=b>=0?b:0;\nvar d=c.get(a);\nthis._view[this._currentViewId].setSelection(d,false)\n}};\nZmListController.prototype._getMoreToReplenish=function(b,e,h){if(this._list.hasMore()){var d=this._view[b].getList();\nvar c=d.getLast();\nvar a=(c&&c.id)?c.sf:null;\nvar f=a?c.id:null;\nvar g=this._handleResponseGetMoreToReplenish.bind(this,b,h);\nthis._search(b,this._list.size(),e,g,false,f,a)\n}else{if(h){h.run()\n}}};\nZmListController.prototype._handleResponseGetMoreToReplenish=function(c,f,b){var a=b.getResponse();\nvar d=a.getAttribute(\"more\");\nthis._list.setHasMore(d);\nthis._cacheList(a);\nvar e=a.getResults().getVector();\nthis._view[c].replenish(e);\nthis._toolbar[c].enable(ZmOperation.PAGE_FORWARD,d);\nif(f){f.run(b)\n}};\nZmListController.prototype._initializeNavToolBar=function(b){var a=new ZmNavToolBar({parent:this._toolbar[b],context:b});\nthis._setNavToolBar(a,b)\n};\nZmListController.prototype._setNavToolBar=function(b,a){this._navToolBar[a]=b;\nif(this._navToolBar[a]){var c=this._navBarListener.bind(this);\nthis._navToolBar[a].addSelectionListener(ZmOperation.PAGE_BACK,c);\nthis._navToolBar[a].addSelectionListener(ZmOperation.PAGE_FORWARD,c)\n}};\nZmListController.prototype._resetNavToolBarButtons=function(a){var b;\nif(a){b=this._view[a]\n}else{b=this.getListView();\na=this._currentViewId\n}if(!b){return\n}if(b._isPageless){this._setItemCountText()\n}if(!this._navToolBar[a]){return\n}this._navToolBar[a].enable(ZmOperation.PAGE_BACK,b.offset>0);\nvar c=false;\nif(this._list){c=this._list.hasMore();\nif(!c&&((b.offset+b.getLimit())<this._list.size())){c=true\n}}this._navToolBar[a].enable(ZmOperation.PAGE_FORWARD,c);\nthis._navToolBar[a].setText(this._getNavText(a))\n};\nZmListController.prototype.enablePagination=function(b,a){if(!this._navToolBar[a]){return\n}if(b){this._resetNavToolBarButtons(a)\n}else{this._navToolBar[a].enable([ZmOperation.PAGE_BACK,ZmOperation.PAGE_FORWARD],false)\n}};\nZmListController.prototype._getNavText=function(b){var e=this._getNavStartEnd(b);\nif(!e){return\"\"\n}var c=e.size;\nvar h=\"\";\nif(c===0){h=AjxMessageFormat.format(ZmMsg.navTextNoItems,ZmMsg[ZmApp.NAME[ZmApp.TASKS]])\n}else{if(c===1){h=AjxMessageFormat.format(ZmMsg.navTextOneItem,ZmMsg[ZmItem.MSG_KEY[ZmItem.TASK]])\n}else{var g=this._view[b];\nvar a=e.limit;\nif(c<a){h=AjxMessageFormat.format(ZmMsg.navTextWithTotal,[e.start,e.end,c])\n}else{var f=this._getUpperLimitSizeText(c);\nvar d=f?ZmMsg.navTextWithTotal:ZmMsg.navTextRange;\nh=AjxMessageFormat.format(d,[e.start,e.end,f])\n}}}return h\n};\nZmListController.prototype._getNavStartEnd=function(c){var e=this._view[c];\nvar b=e.getLimit();\nvar d=this._list?this._list.size():0;\nvar f,a;\nif(d>0){f=e.offset+1;\na=Math.min(e.offset+b,d)\n}return(f&&a)?{start:f,end:a,size:d,limit:b}:null\n};\nZmListController.prototype._getNumTotal=function(){var a=this._getSearchFolderId();\nif(a&&(a!=ZmFolder.ID_TRASH)){var b=appCtxt.getById(a);\nif(b){return b.numTotal\n}}return null\n};\nZmListController.prototype.getActionMenu=function(){if(!this._actionMenu){this._initializeActionMenu();\nthis._resetOperations(this._actionMenu,0)\n}return this._actionMenu\n};\nZmListController.prototype._getMenuContext=function(){return this._app&&this._app._name\n};\nZmListController.prototype._getItemCountText=function(){var i=this._getItemCount();\nif(!i){return\"\"\n}var b=this._view[this._currentViewId],f=b&&b._list,g=b._getItemCountType(),h=this._getNumTotal(),d=h||i,c=\"type\"+AjxStringUtil.capitalizeFirstLetter(ZmItem.MSG_KEY[g]),e=g?AjxMessageFormat.format(ZmMsg[c],d):\"\";\nif(h&&(i!=h)){return AjxMessageFormat.format(ZmMsg.itemCount1,[i,h,e])\n}else{var a=this._getUpperLimitSizeText(i);\nreturn AjxMessageFormat.format(ZmMsg.itemCount,[a,e])\n}};\nZmListController.prototype._getUpperLimitSizeText=function(a){var c=a;\nif(this._list.hasMore()){var b=a<10?1:a<100?10:100;\nc=(Math.floor(a/b))*b+\"+\"\n}return c\n};\nZmListController.prototype._getItemCount=function(){var b=this.getListView();\nvar a=b&&b._list;\nif(!a){return 0\n}return a.size()\n};\nZmListController.prototype._setItemCountText=function(b){b=b||this._getItemCountText();\nvar a=this._itemCountText[this._currentViewId];\nif(a){a.setText(b)\n}};\nZmListController.prototype._getItemSelectionCountText=function(){var f=this._view[this._currentViewId],d=f&&f._list,c=f._getItemCountType(),b=f.getSelectionCount(),a=\"type\"+AjxStringUtil.capitalizeFirstLetter(ZmItem.MSG_KEY[c]),e=c?AjxMessageFormat.format(ZmMsg[a],b):\"\";\nreturn b>0?AjxMessageFormat.format(ZmMsg.itemSelectionCount,[b,e]):\"\"\n};\nZmListController.prototype._setItemSelectionCountText=function(){this._setItemCountText(this._getItemSelectionCountText())\n};\nZmListController.prototype._setupContinuation=function(c,b,e,d,f){var a=new AjxCallback(this,c,b);\ne.finalCallback=this._continueAction.bind(this,{actionCallback:a,allDoneCallback:d,notIdsOnly:f});\ne.count=this._continuation.count;\ne.idsOnly=!f;\nif(!this._continuation.lastItem){this._continuation.lastItem=e.list.getVector().getLast();\nthis._continuation.totalItems=e.list.size()\n}};\nZmListController.prototype._continueAction=function(d,b){var c=this._view[this._currentViewId];\nvar f=b&&b.cancelled;\nvar m=this._continuation.result;\nvar a=m?m.getAttribute(\"more\"):(this._list?this._list.hasMore():false);\nif(c.allSelected&&a&&!f){var g=this._currentSearch;\nvar e=ZmListController.CONTINUATION_SEARCH_ITEMS;\nvar k={query:this.getSearchString(),queryHint:this.getSearchStringHint(),types:g.types,sortBy:g.sortBy,limit:e,idsOnly:!d.notIdsOnly};\nvar h=m?m.getResults():this._list.getArray();\nvar j=this._continuation.lastItem;\nif(!j){j=h&&h[h.length-1]\n}if(j){k.lastId=j.id;\nk.lastSortVal=j.sf\n}else{k.offset=e+(this._continuation.search?this._continuation.search.offset:0)\n}this._continuation.count=b.numItems;\nif(!this._continuation.totalItems){this._continuation.totalItems=h.length\n}this._continuation.search=new ZmSearch(k);\nvar l=this._handleResponseContinueAction.bind(this,d.actionCallback);\nappCtxt.getSearchController().redoSearch(this._continuation.search,true,null,l)\n}else{if(m){if(c.allSelected){if(b.actionTextKey){var i=m.type;\nif(i===ZmId.SEARCH_MAIL){i=this._list.type\n}b.actionSummary=ZmList.getActionSummary({actionTextKey:b.actionTextKey,numItems:this._continuation.totalItems,type:i,actionArg:b.actionArg})\n}c.deselectAll()\n}this._continuation={count:0,totalItems:0}\n}if(d.allDoneCallback){d.allDoneCallback()\n}ZmListController.handleProgress({state:ZmListController.PROGRESS_DIALOG_CLOSE});\nZmBaseController.showSummary(b.actionSummary,b.actionLogItem,b.closeChildWin)\n}};\nZmListController.prototype._handleResponseContinueAction=function(b,a){this._continuation.result=a.getResponse();\nvar c=this._continuation.result.getResults();\nif(c.isZmMailList){c=c.getArray()\n}if(c.length){this._continuation.lastItem=c[c.length-1];\nthis._continuation.totalItems+=c.length;\nb.args=b.args||[];\nb.args.unshift(c);\nb.run()\n}else{}};\nZmListController.prototype._checkItemCount=function(){var a=this._view[this._currentViewId];\na._checkItemCount();\na._handleResponseCheckReplenish(true)\n};\nZmListController.prototype.supportsSorting=function(){return true\n};\nZmListController.prototype.supportsGrouping=function(){return false\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmTreeController\")){ZmTreeController=function(a){if(arguments.length==0){return\n}ZmController.call(this,null);\nthis.type=a;\nthis._opc=appCtxt.getOverviewController();\nthis._listeners={};\nthis._listeners[ZmOperation.DELETE]=this._deleteListener.bind(this);\nthis._listeners[ZmOperation.DELETE_WITHOUT_SHORTCUT]=this._deleteListener.bind(this);\nthis._listeners[ZmOperation.MOVE]=this._moveListener.bind(this);\nthis._listeners[ZmOperation.EXPAND_ALL]=this._expandAllListener.bind(this);\nthis._listeners[ZmOperation.MARK_ALL_READ]=this._markAllReadListener.bind(this);\nthis._listeners[ZmOperation.SYNC]=this._syncListener.bind(this);\nthis._listeners[ZmOperation.SYNC_ALL]=this._syncAllListener.bind(this);\nthis._listeners[ZmOperation.EDIT_PROPS]=this._editPropsListener.bind(this);\nthis._listeners[ZmOperation.EMPTY_FOLDER]=this._emptyListener.bind(this);\nthis._listeners[ZmOperation.FIND_SHARES]=this._findSharesListener.bind(this);\nthis._listeners[ZmOperation.OPEN_IN_TAB]=this._openInTabListener.bind(this);\nthis._dragSrc=new DwtDragSource(Dwt.DND_DROP_MOVE);\nthis._dragSrc.addDragListener(this._dragListener.bind(this));\nthis._dropTgt=new DwtDropTarget(ZmTreeController.DROP_SOURCES[a]);\nthis._dropTgt.addDropListener(this._dropListener.bind(this));\nthis._treeView={};\nthis._hideEmpty={};\nthis._dataTree={};\nthis._treeSelectionShortcutDelay=ZmTreeController.TREE_SELECTION_SHORTCUT_DELAY\n};\nZmTreeController.prototype=new ZmController;\nZmTreeController.prototype.constructor=ZmTreeController;\nZmTreeController.COLOR_CLASS={};\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_ORANGE]=\"OrangeBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_BLUE]=\"BlueBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_CYAN]=\"CyanBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_GREEN]=\"GreenBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_PURPLE]=\"PurpleBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_RED]=\"RedBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_YELLOW]=\"YellowBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_PINK]=\"PinkBg\";\nZmTreeController.COLOR_CLASS[ZmOrganizer.C_GRAY]=\"Gray\";\nZmTreeController.TREE_SELECTION_SHORTCUT_DELAY=750;\nZmTreeController.DROP_SOURCES={};\nZmTreeController.EMPTY_FOLDER_RETRY_INTERVAL=5;\nZmTreeController.EMPTY_FOLDER_MAX_TRIALS=6;\nZmTreeController.prototype.resetOperations=function(){};\nZmTreeController.prototype._getHeaderActionMenuOps=function(){};\nZmTreeController.prototype._getActionMenuOps=function(){};\nZmTreeController.prototype._getNewDialog=function(){};\nZmTreeController.prototype._getRenameDialog=function(){};\nZmTreeController.prototype._itemClicked=function(){};\nZmTreeController.prototype._itemDblClicked=function(){};\nZmTreeController.prototype._dropListener=function(){};\nZmTreeController.prototype._getMoveDialogTitle=function(){};\nZmTreeController.prototype._resetOperation=function(b,g,e,c,a,d){var f=b&&b.getOp(g);\nif(!f){return\n}if(e){f.setText(e)\n}if(c){f.setImage(c)\n}if(a!=null){f.setEnabled(a)\n}if(d!=null){f.setVisible(d)\n}};\nZmTreeController.prototype._resetButtonPerSetting=function(c,d,b){var a=c.getOp(d);\nif(a){if(b){a.setVisible(true);\nif(appCtxt.isOffline&&!appCtxt.getActiveAccount().isZimbraAccount){a.setEnabled(false)\n}}else{a.setVisible(false)\n}}};\nZmTreeController.prototype._enableRecoverDeleted=function(c,b){op=c.getOp(ZmOperation.RECOVER_DELETED_ITEMS);\nif(!op){return\n}var a=appCtxt.get(ZmSetting.DUMPSTER_ENABLED);\nop.setVisible(a&&b);\nop.setEnabled(b)\n};\nZmTreeController.prototype._findSharesListener=function(c){var b=this._getActionedOrganizer(c);\nvar e=b.getAccount();\nif(appCtxt.multiAccounts&&e&&e.isZimbraAccount){appCtxt.accountList.setActiveAccount(e)\n}var a=appCtxt.getShareSearchDialog();\nvar d=this._handleAddShare.bind(this);\na.popup(b.type,d)\n};\nZmTreeController.prototype._handleAddShare=function(){var c=appCtxt.getShareSearchDialog();\nvar b=c.getShares();\nc.popdown();\nif(b.length===0){return\n}AjxDispatcher.require(\"Share\");\nvar f=[];\nfor(var a=0;\na<b.length;\na++){var d=b[a];\nf.push({_jsns:\"urn:zimbraMail\",link:{l:ZmOrganizer.ID_ROOT,name:d.defaultMountpointName,view:d.view,zid:d.ownerId,rid:d.folderId}})\n}var e={jsonObj:{BatchRequest:{_jsns:\"urn:zimbra\",CreateMountpointRequest:f}},asyncMode:true};\nappCtxt.getAppController().sendRequest(e)\n};\nZmTreeController.prototype._openInTabListener=function(a){this._itemClicked(this._getActionedOrganizer(a),true)\n};\nZmTreeController.prototype.toString=function(){return\"ZmTreeController\"\n};\nZmTreeController.prototype.show=function(f){var g=f.overviewId;\nthis._hideEmpty[g]=f.hideEmpty;\nif(!this._treeView[g]||f.forceCreate){this._treeViewCreated=false;\nthis._treeView[g]=null;\nthis._treeView[g]=this.getTreeView(g,true)\n}var a=(appCtxt.multiAccounts&&this.type==ZmOrganizer.ZIMLET);\nvar c=a?appCtxt.accountList.mainAccount:(this.type==ZmOrganizer.VOICE?g:f.account);\nvar d=this.getDataTree(c);\nif(d){f.dataTree=d;\nvar b=ZmOrganizer.OPEN_SETTING[this.type];\nf.collapsed=(!a&&(!(!b||(appCtxt.get(b,null,c)!==false))));\nvar e=this._opc.getOverview(g);\nif(e&&e.showNewButtons&&this.type!=ZmOrganizer.ZIMLET&&this.type!=ZmId.ORG_PREF_PAGE){this._setupOptButton(f)\n}this._treeView[g].set(f);\nthis._checkTreeView(g)\n}if(!this._treeViewCreated){this._treeViewCreated=true;\nthis._postSetup(g,f.account)\n}return this._treeView[g]\n};\nZmTreeController.prototype.getTreeView=function(b,a){if(a&&!this._treeView[b]){this._treeView[b]=this._setup(b)\n}return this._treeView[b]\n};\nZmTreeController.prototype.clearTreeView=function(a){if(this._treeView[a]){this._treeView[a].dispose();\ndelete this._treeView[a]\n}};\nZmTreeController.prototype.getDropTarget=function(){return this._dropTgt\n};\nZmTreeController.prototype.getDataTree=function(a){a=a||appCtxt.getActiveAccount();\nvar b=this._dataTree[a.id];\nif(!b){b=this._dataTree[a.id]=appCtxt.getTree(this.type,a);\nif(b){b.addChangeListener(this._getTreeChangeListener())\n}}return b\n};\nZmTreeController.prototype.dispose=function(){var a=appCtxt.getActiveAccount();\nvar b=this._dataTree[a.id];\nif(!b){return\n}b.removeChangeListener(this._getTreeChangeListener())\n};\nZmTreeController.prototype.setVisibleIfExists=function(b,a,c){var d=b.getOp(a);\nif(!d){return\n}d.setVisible(c)\n};\nZmTreeController.prototype._setupOptButton=function(b){var a=ZmOperation.getProp(ZmOperation.OPTIONS,\"tooltipKey\");\nb.optButton={image:ZmOperation.getProp(ZmOperation.OPTIONS,\"image\"),tooltip:a?ZmMsg[a]:null,callback:new AjxCallback(this,this._dispOpts)}\n};\nZmTreeController.prototype._dispOpts=function(b){var d=b.dwtObj;\nvar a=d&&d.getData(ZmTreeView.KEY_TYPE);\nif(!a){return\n}var c=this._getHeaderActionMenu(b);\nif(c){c.popup(0,b.docX,b.docY)\n}};\nZmTreeController.prototype._getTreeChangeListener=function(){if(!this._dataChangeListener){this._dataChangeListener=appCtxt.isChildWindow?AjxCallback.simpleClosure(this._treeChangeListener,this):new AjxListener(this,this._treeChangeListener)\n}return this._dataChangeListener\n};\nZmTreeController.prototype._setup=function(b){var a=this._initializeTreeView(b);\nif(this._opc.getOverview(b).actionSupported){this._initializeActionMenus()\n}return a\n};\nZmTreeController.prototype._postSetup=function(g,f){var c=this.getTreeView(g);\nif(!c.isCheckedStyle&&!ZmOrganizer.HAS_COLOR[this.type]){return\n}var b=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,f);\nvar a=c.getTreeItemById(b);\nif(!a){return\n}if(c.isCheckedStyle){a.showCheckBox(false)\n}var e=a.getItems();\nfor(var d=0;\nd<e.length;\nd++){this._fixupTreeNode(e[d],null,c,true)\n}};\nZmTreeController.prototype._fixupTreeNode=function(f,a,b,d){if(f._isSeparator){return\n}a=a||f.getData(Dwt.KEY_OBJECT);\nif(a){if(ZmOrganizer.HAS_COLOR[this.type]){this._setTreeItemColor(f,a)\n}if(b.isCheckedStyle){if((a.type==this.type&&b.isCheckedStyle)||a.nId==ZmOrganizer.ID_TRASH||a.nId==ZmOrganizer.ID_DRAFTS){f.setChecked(a.isChecked,true)\n}else{f.showCheckBox(false);\nf.enableSelection(true)\n}}this._expandTreeItem(f,d)\n}var e=f.getItems();\nfor(var c=0;\nc<e.length;\nc++){this._fixupTreeNode(e[c],null,b,d)\n}};\nZmTreeController.prototype._expandTreeItem=function(e,c){var b=appCtxt.get(ZmSetting.FOLDERS_EXPANDED);\nvar a=e.getData(Dwt.KEY_ID);\nvar d=e.parent;\nif(b[a]&&d&&(d instanceof DwtTreeItem)&&d.getExpanded()){e.setExpanded(true,null,c)\n}};\nZmTreeController.prototype._expandTreeItems=function(c){if(c._isSeparator){return\n}this._expandTreeItem(c);\nvar b=c.getItems();\nfor(var a=0;\na<b.length;\na++){this._expandTreeItems(b[a])\n}};\nZmTreeController.prototype._setTreeItemColor=function(b,a){b.setImage(a.getIconWithColor())\n};\nZmTreeController.prototype._getTreeItemColorClassName=function(c,a){if(!c||!a){return null\n}if(a.isInTrash()){return null\n}var b=a.color?a.color:ZmOrganizer.DEFAULT_COLOR[a.type];\nreturn(b&&(b!=ZmOrganizer.C_NONE))?ZmTreeController.COLOR_CLASS[b]:\"\"\n};\nZmTreeController.prototype._initializeTreeView=function(d){var c=this._opc.getOverview(d);\nvar b={parent:c,parentElement:c.getTreeParent(this.type),overviewId:d,type:this.type,headerClass:c.headerClass,dragSrc:(c.dndSupported?this._dragSrc:null),dropTgt:(c.dndSupported?this._dropTgt:null),treeStyle:c.treeStyle,isCheckedByDefault:c.isCheckedByDefault,allowedTypes:this._getAllowedTypes(),allowedSubTypes:this._getAllowedSubTypes()};\nb.id=ZmId.getTreeId(d,b.type);\nif(b.type&&b.type.match(/TASK|ADDRBOOK|FOLDER|BRIEFCASE|CALENDAR|PREF_PAGE/)&&(!b.headerClass||b.headerClass==\"overviewHeader\")){b.headerClass=\"FirstOverviewHeader overviewHeader\"\n}var a=this._createTreeView(b);\na.addSelectionListener(new AjxListener(this,this._treeViewListener));\na.addTreeListener(new AjxListener(this,this._treeListener));\nreturn a\n};\nZmTreeController.prototype._createTreeView=function(a){return new ZmTreeView(a)\n};\nZmTreeController.prototype._initializeActionMenus=function(){var d=this;\nvar c=this._createActionMenu;\nvar b=this._getHeaderActionMenuOps();\nif(!this._headerActionMenu&&b){var a=[this._shell,b];\nthis._headerActionMenu=new AjxCallback(d,c,a)\n}var b=this._getActionMenuOps();\nif(!this._actionMenu&&b){var a=[this._shell,b];\nthis._actionMenu=new AjxCallback(d,c,a)\n}};\nZmTreeController.prototype._getHeaderActionMenu=function(a){if(this._headerActionMenu instanceof AjxCallback){var b=this._headerActionMenu;\nthis._headerActionMenu=b.run()\n}return this._headerActionMenu\n};\nZmTreeController.prototype._getActionMenu=function(c,b){var a=this;\nif(b&&b.type==ZmOrganizer.SEARCH){a=this._opc.getTreeController(ZmOrganizer.SEARCH)\n}if(a._actionMenu instanceof AjxCallback){var d=a._actionMenu;\na._actionMenu=d.run()\n}return a._actionMenu\n};\nZmTreeController.prototype._createActionMenu=function(d,b){if(!b){return\n}var f=appCtxt.getCurrentController()&&appCtxt.getCurrentController().getKeyMapName();\nvar g=f?(\"ZmActionMenu_\"+f):Dwt.getNextId(\"ZmActionMenu_\");\ng=(f&&this.type)?g+\"_\"+this.type:g;\nvar e=new ZmActionMenu({parent:d,menuItems:b,id:g});\nb=e.opList;\nfor(var a=0;\na<b.length;\na++){var c=b[a];\nif(this._listeners[c]){e.addSelectionListener(c,this._listeners[c])\n}}e.addPopdownListener(new AjxListener(this,this._menuPopdownActionListener));\nreturn e\n};\nZmTreeController.prototype._getAllowedTypes=function(){var a={};\na[this.type]=true;\nreturn a\n};\nZmTreeController.prototype._getAllowedSubTypes=function(){var a={};\na[this.type]=true;\nreturn a\n};\nZmTreeController.prototype._doCreate=function(params){params.type=this.type;\nvar funcName=ZmOrganizer.CREATE_FUNC[this.type];\nif(funcName){var func=eval(funcName);\nreturn func(params)\n}};\nZmTreeController.prototype._doDelete=function(a){a._delete()\n};\nZmTreeController.prototype._doEmpty=function(a,g,e){var d=false;\nvar f=ZmTreeController.EMPTY_FOLDER_RETRY_INTERVAL;\nvar c=true;\nif(!g){g=1\n}var b=this._doEmptyErrorHandler.bind(this,a,g);\na.empty(d,null,this._doEmptyHandler.bind(this,a),f,b,c)\n};\nZmTreeController.prototype._doEmptyErrorHandler=function(a,c,b){if(b){if(b.code==ZmCsfeException.SVC_ALREADY_IN_PROGRESS){appCtxt.setStatusMsg(ZmMsg.emptyFolderAlreadyInProgress);\nreturn true\n}else{if(b.code!=AjxException.CANCELED){return false\n}}}if(c>ZmTreeController.EMPTY_FOLDER_MAX_TRIALS-1){appCtxt.setStatusMsg(ZmMsg.emptyFolderNoResponse,ZmStatusView.LEVEL_CRITICAL);\nreturn true\n}c++;\nthis._doEmpty(a,c)\n};\nZmTreeController.prototype._doEmptyHandler=function(b){appCtxt.setStatusMsg({msg:AjxMessageFormat.format(ZmMsg.folderEmptied,b.getName())});\nvar a=appCtxt.getCurrentController();\nif(!a||!a._getSearchFolderId||!a.getListView){return\n}var d=a._getSearchFolderId();\nif(d!==b.id){return\n}var c=a.getListView();\nc._resetList();\nc._setNoResultsHtml()\n};\nZmTreeController.prototype._doRename=function(a,b){a.rename(b)\n};\nZmTreeController.prototype._doMove=function(a,b){a.move(b)\n};\nZmTreeController.prototype._doMarkAllRead=function(a){a.markAllRead()\n};\nZmTreeController.prototype._doSync=function(a){a.sync()\n};\nZmTreeController.prototype._treeViewListener=function(h){if(h.detail!==DwtTree.ITEM_ACTIONED&&h.detail!==DwtTree.ITEM_SELECTED&&h.detail!==DwtTree.ITEM_DBL_CLICKED){return\n}var d=h.item;\nvar f=d.getData(ZmTreeView.KEY_TYPE);\nif(!f){return\n}var j=d.getData(Dwt.KEY_OBJECT);\nif(j){this._actionedOrganizer=j;\nif(j.noSuchFolder){var b=appCtxt.getFolderTree();\nif(b){b.handleDeleteNoSuchFolder(j)\n}return\n}if(j&&j.type===ZmOrganizer.SEARCH){var e=this._opc.getTreeController(ZmOrganizer.SEARCH);\nif(e){e._actionedOrganizer=j;\ne._actionedOverviewId=d.getData(ZmTreeView.KEY_ID)\n}}}var a=d.getData(Dwt.KEY_ID);\nvar c=this._actionedOverviewId=d.getData(ZmTreeView.KEY_ID);\nvar i=this._opc.getOverview(c);\nif(!i){return\n}if(h.detail===DwtTree.ITEM_ACTIONED){if(i.actionSupported){var g=this.getItemActionMenu(h,j);\nif(g){this.resetOperations(g,f,a);\ng.popup(0,h.docX,h.docY)\n}}}else{if((h.detail===DwtTree.ITEM_SELECTED)&&j){if(appCtxt.multiAccounts&&(j instanceof ZmOrganizer)){this._handleMultiAccountItemSelection(h,i,d,j)\n}else{this._handleItemSelection(h,i,d,j)\n}}else{if((h.detail===DwtTree.ITEM_DBL_CLICKED)&&j){this._itemDblClicked(j)\n}}}};\nZmTreeController.prototype.getItemActionMenu=function(b,a){var c=(a.nId==ZmOrganizer.ID_ROOT||a.isDataSource(ZmAccount.TYPE_IMAP))?this._getHeaderActionMenu(b):this._getActionMenu(b,a);\nreturn c\n};\nZmTreeController.prototype._handleItemSelection=function(b,f,e,a){f.itemSelected(e);\nif(b.kbNavEvent){Dwt.scrollIntoView(e._itemDiv,f.getHtmlElement());\nZmController.noFocus=true\n}if(f._treeSelectionShortcutDelayActionId){AjxTimedAction.cancelAction(f._treeSelectionShortcutDelayActionId)\n}if((f.selectionSupported||a._showFoldersCallback)&&!e._isHeader){if(b.kbNavEvent){if(b.enter||this._treeSelectionShortcutDelay){var d=new AjxTimedAction(this,ZmTreeController.prototype._treeSelectionTimedAction,[a,f]);\nf._treeSelectionShortcutDelayActionId=AjxTimedAction.scheduleAction(d,this._treeSelectionShortcutDelay)\n}}else{if((appCtxt.multiAccounts&&(a instanceof ZmOrganizer))||(a.type==ZmOrganizer.VOICE)){appCtxt.getCurrentApp().getOverviewContainer().deselectAll(f);\nvar c=a.account||appCtxt.accountList.mainAccount;\nappCtxt.accountList.setActiveAccount(c)\n}this._itemSelected(a)\n}}};\nZmTreeController.prototype._itemSelected=function(a){if(a&&a._showFoldersCallback){a._showFoldersCallback.run()\n}else{this._itemClicked(a)\n}};\nZmTreeController.prototype._handleMultiAccountItemSelection=function(b,d,c,a){this._handleItemSelection(b,d,c,a)\n};\nZmTreeController.prototype._treeSelectionTimedAction=function(a,b){if(b._treeSelectionShortcutDelayActionId){AjxTimedAction.cancelAction(b._treeSelectionShortcutDelayActionId)\n}this._itemSelected(a)\n};\nZmTreeController.prototype._treeListener=function(g){var e=g&&g.item;\nvar c=e&&e._tree&&e._tree.overviewId;\nvar i=appCtxt.getOverviewController().getOverview(c);\nvar f=i.account;\nif(appCtxt.multiAccounts&&f){appCtxt.accountList.setActiveAccount(f)\n}var d=g.detail==DwtTree.ITEM_EXPANDED;\nvar a=(g.detail==DwtTree.ITEM_COLLAPSED||d)?e.getData(Dwt.KEY_ID):null;\nif(a&&!e._isHeader){var h=appCtxt.get(ZmSetting.FOLDERS_EXPANDED,a)||false;\nif(typeof(h)==\"string\"){h=(h===\"true\")\n}if(!i.skipImplicit&&h!==d){appCtxt.set(ZmSetting.FOLDERS_EXPANDED,d,a)\n}if(d){this._expandTreeItems(e)\n}}if(!(g&&g.detail&&i&&i.isAppOverview&&e._isHeader)){return\n}var b=appCtxt.getSettings(f);\nvar j=b.getSetting(ZmOrganizer.OPEN_SETTING[this.type]);\nif(j){j.setValue(g.detail==DwtTree.ITEM_EXPANDED)\n}};\nZmTreeController.prototype._treeChangeListener=function(a){this._evHandled={};\nfor(var b in this._treeView){this._changeListener(a,this._treeView[b],b)\n}};\nZmTreeController.prototype._changeListener=function(ev,treeView,overviewId){if(this._evHandled[overviewId]){return\n}if(!treeView.allowedTypes[ev.type]&&!treeView.allowedSubTypes[ev.type]){return\n}var organizers=ev.getDetail(\"organizers\");\nif(!organizers&&ev.source){organizers=[ev.source]\n}for(var i=0;\ni<organizers.length;\ni++){var organizer=organizers[i];\nvar node=treeView.getTreeItemById(organizer.id);\nif(!node&&(ev.event!=ZmEvent.E_CREATE)){continue\n}var fields=ev.getDetail(\"fields\");\nif(ev.event==ZmEvent.E_DELETE){if(organizer.nId==ZmFolder.ID_TRASH||organizer.nId==ZmFolder.ID_SPAM){node.setText(organizer.getName(false))\n}else{node.dispose()\n}this._checkTreeView(overviewId);\nthis._evHandled[overviewId]=true\n}else{if(ev.event==ZmEvent.E_CREATE||ev.event==ZmEvent.E_MOVE){if(appCtxt.multiAccounts){var overview=this._opc.getOverview(overviewId);\nif(overview&&overview.account!=organizer.getAccount()){continue\n}}var parentNode=this._getParentNode(organizer,ev,overviewId);\nvar idx=parentNode?ZmTreeView.getSortIndex(parentNode,organizer,eval(ZmTreeView.COMPARE_FUNC[organizer.type])):null;\nif(parentNode&&(ev.event==ZmEvent.E_CREATE)){var type=((organizer.parent.nId==ZmOrganizer.ID_ROOT)||organizer.parent.isRemoteRoot())?ev.type:organizer.parent.type;\nif(type!==this.type||!treeView._isAllowed(organizer.parent,organizer)){continue\n}if(organizer.isOfflineGlobalSearch){appCtxt.getApp(ZmApp.MAIL).getOverviewContainer().addSearchFolder(organizer);\nreturn\n}else{node=this._addNew(treeView,parentNode,organizer,idx)\n}this.createDataSource(organizer)\n}else{if(ev.event==ZmEvent.E_MOVE){var selectedItem=treeView.getSelected();\nif(AjxUtil.isArray1(selectedItem)){selectedItem=null\n}node.dispose();\nif(parentNode){node=this._addNew(treeView,parentNode,organizer,idx)\n}if(!treeView.getSelected()&&selectedItem){treeView.setSelected(selectedItem.id,true,true)\n}}}if(parentNode){parentNode.setExpanded(true);\nthis._fixupTreeNode(node,organizer,treeView)\n}this._checkTreeView(overviewId);\nthis._evHandled[overviewId]=true\n}else{if(ev.event==ZmEvent.E_MODIFY){if(!fields){return\n}if(fields[ZmOrganizer.F_TOTAL]||fields[ZmOrganizer.F_SIZE]||fields[ZmOrganizer.F_UNREAD]||fields[ZmOrganizer.F_NAME]){node.setToolTipContent(organizer.getToolTip(true));\nif(appCtxt.multiAccounts&&organizer.type==ZmOrganizer.FOLDER){appCtxt.getApp(ZmApp.MAIL).getOverviewContainer().updateTooltip(organizer.nId)\n}}if(fields[ZmOrganizer.F_NAME]||fields[ZmOrganizer.F_UNREAD]||fields[ZmOrganizer.F_FLAGS]||fields[ZmOrganizer.F_COLOR]||((organizer.nId==ZmFolder.ID_DRAFTS||organizer.rid==ZmFolder.ID_DRAFTS||organizer.nId==ZmOrganizer.ID_OUTBOX)&&fields[ZmOrganizer.F_TOTAL])){this._updateOverview({organizer:organizer,node:node,fields:fields,treeView:treeView,overviewId:overviewId,ev:ev});\nthis._evHandled[overviewId]=true\n}}}}}};\nZmTreeController.prototype._updateOverview=function(params){var org=params.organizer,node=params.node,parentNode=this._getParentNode(org,params.ev,params.overviewId);\nnode.setText(org.getName(params.treeView._showUnread));\nif(params.fields&&params.fields[ZmOrganizer.F_NAME]){if(parentNode&&(parentNode.getNumChildren()>1)){var nodeSelected=node._selected;\nnode.dispose();\nvar idx=ZmTreeView.getSortIndex(parentNode,org,eval(ZmTreeView.COMPARE_FUNC[org.type]));\nnode=params.treeView._addNew(parentNode,org,idx);\nif(nodeSelected){params.treeView.setSelected(org,true)\n}}else{node.setDndText(org.getName())\n}appCtxt.getAppViewMgr().updateTitle()\n}if(params.fields[ZmOrganizer.F_UNREAD]){var parent=org.parent;\nwhile(parent&&parentNode&&parent.nId!=ZmOrganizer.ID_ROOT){parentNode.setText(parent.getName(params.treeView._showUnread));\nparentNode=this._getParentNode(parent,params.ev,params.overviewId);\nparent=parent.parent\n}}this._fixupTreeNode(node,org,params.treeView)\n};\nZmTreeController.prototype._getParentNode=function(a,c,d){if(a.parent){var b=(a.parent.nId==ZmOrganizer.ID_ROOT)?c.type:null;\nreturn this._opc.getOverview(d).getTreeItemById(a.parent.id,b)\n}};\nZmTreeController.prototype._addNew=function(d,c,b,a){return d._addNew(c,b,a)\n};\nZmTreeController.prototype._newListener=function(c,d){this._pendingActionData=this._getActionedOrganizer(c);\nvar b=this._getNewDialog();\nif(!this._newCb){this._newCb=new AjxCallback(this,this._newCallback)\n}if(this._pendingActionData&&!appCtxt.getById(this._pendingActionData.id)){this._pendingActionData=appCtxt.getFolderTree(d).root\n}if(!d&&appCtxt.multiAccounts){var a=this._opc.getOverview(this._actionedOverviewId);\nd=a&&a.account\n}ZmController.showDialog(b,this._newCb,this._pendingActionData,d);\nb.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,b)\n};\nZmTreeController.prototype.createDataSource=function(a){};\nZmTreeController.prototype._renameListener=function(a){this._pendingActionData=this._getActionedOrganizer(a);\nvar b=this._getRenameDialog();\nif(!this._renameCb){this._renameCb=new AjxCallback(this,this._renameCallback)\n}ZmController.showDialog(b,this._renameCb,this._pendingActionData);\nb.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,b)\n};\nZmTreeController.prototype._deleteListener=function(a){this._doDelete(this._getActionedOrganizer(a))\n};\nZmTreeController.prototype._emptyListener=function(a){this._doEmpty(this._getActionedOrganizer(a))\n};\nZmTreeController.prototype._moveListener=function(a){this._pendingActionData=this._getActionedOrganizer(a);\nvar b=appCtxt.getChooseFolderDialog();\nif(!this._moveCb){this._moveCb=new AjxCallback(this,this._moveCallback)\n}ZmController.showDialog(b,this._moveCb,this._getMoveParams(b));\nb.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,b)\n};\nZmTreeController.prototype._getMoveParams=function(b){var a={};\na[ZmFolder.ID_SPAM]=true;\nreturn{data:this._pendingActionData,treeIds:[this.type],overviewId:b.getOverviewId(appCtxt.getCurrentAppName()+\"_\"+this.type),omit:a,title:AjxStringUtil.htmlEncode(this._getMoveDialogTitle()),description:ZmMsg.targetFolder,appName:ZmOrganizer.APP[this.type]}\n};\nZmTreeController.prototype._expandAllListener=function(d){var a=this._getActionedOrganizer(d);\nvar b=this.getTreeView(this._actionedOverviewId);\nvar c=b.getTreeItemById(a.id);\nwindow.duringExpandAll=true;\nc.setExpanded(true,true);\nwindow.duringExpandAll=false;\nif(window.afterExpandAllCallback){window.afterExpandAllCallback();\nwindow.afterExpandAllCallback=null\n}};\nZmTreeController.prototype._markAllReadListener=function(a){this._doMarkAllRead(this._getActionedOrganizer(a))\n};\nZmTreeController.prototype._syncAllListener=function(g){for(var e in this._treeView){var d=this.getTreeView(e);\nvar h=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,appCtxt.getActiveAccount());\nvar j=d.getTreeItemById(h);\nvar a=j&&j.getItems();\nif(a){for(var f=0;\nf<a.length;\nf++){var b=a[f];\nvar c=b&&b.getData&&b.getData(Dwt.KEY_OBJECT);\nif(c&&(c.isFeed()||c.hasFeeds())){this._syncFeeds(c)\n}}}}};\nZmTreeController.prototype._syncListener=function(a){this._syncFeeds(this._getActionedOrganizer(a))\n};\nZmTreeController.prototype._syncFeeds=function(d){if(d.isFeed()){this._doSync(d)\n}else{if(d.hasFeeds()){var b=d.children.getArray();\nvar e=d.children.size();\nfor(var c=0;\nc<e;\nc++){if(b[c].isFeed()||(b[c].hasFeeds&&b[c].hasFeeds())){this._syncFeeds(b[c])\n}}}}};\nZmTreeController.prototype._editPropsListener=function(b){var a=appCtxt.getFolderPropsDialog();\na.popup(this._getActionedOrganizer(b))\n};\nZmTreeController.prototype._dragListener=function(a){switch(a.action){case DwtDragEvent.SET_DATA:a.srcData={data:a.srcControl.getData(Dwt.KEY_OBJECT),controller:this};\nbreak\n}};\nZmTreeController.prototype._menuPopdownActionListener=function(){if(this._pendingActionData){return\n}var a=this.getTreeView(this._actionedOverviewId);\nif(this._actionedOrganizer&&(a.getSelected()!=this._actionedOrganizer)){var b=a.getTreeItemById(this._actionedOrganizer.id);\nif(b){b._setActioned(false)\n}}};\nZmTreeController.prototype._newCallback=function(a){this._doCreate(a);\nthis._clearDialog(this._getNewDialog())\n};\nZmTreeController.prototype._renameCallback=function(a,b){this._doRename(a,b);\nthis._clearDialog(this._getRenameDialog())\n};\nZmTreeController.prototype._moveCallback=function(a){this._doMove(this._pendingActionData,a);\nthis._clearDialog(appCtxt.getChooseFolderDialog())\n};\nZmTreeController.prototype._deleteShieldYesCallback=function(a){this._doDelete(a);\nthis._clearDialog(this._deleteShield)\n};\nZmTreeController.prototype._emptyShieldYesCallback=function(a){this._doEmpty(a);\nthis._clearDialog(this._emptyShield)\n};\nZmTreeController.prototype._getEmptyShieldWarning=function(b){var a=this._pendingActionData=this._getActionedOrganizer(b);\nvar c=this._emptyShield=appCtxt.getOkCancelMsgDialog();\nc.reset();\nc.registerCallback(DwtDialog.OK_BUTTON,this._emptyShieldYesCallback,this,a);\nc.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,this._emptyShield);\nvar e=(a.nId!=ZmFolder.ID_TRASH)?(AjxMessageFormat.format(ZmMsg.confirmEmptyFolder,a.getName())):ZmMsg.confirmEmptyTrashFolder;\nc.setMessage(e,DwtMessageDialog.WARNING_STYLE);\nvar f=(a.nId==ZmFolder.ID_TRASH||a.nId==ZmFolder.ID_SPAM)?DwtDialog.OK_BUTTON:DwtDialog.CANCEL_BUTTON;\nc.associateEnterWithButton(f);\nc.popup(null,f);\nif(!(a.nId==ZmFolder.ID_SPAM||a.isInTrash())){var d=c.getButton(DwtDialog.CANCEL_BUTTON);\nd.focus()\n}};\nZmTreeController.prototype._getActionedOrganizer=function(a){if(this._actionedOrganizer){return this._actionedOrganizer\n}var c=a.item;\nwhile(c){var b=c.getData(Dwt.KEY_OBJECT);\nif(b instanceof ZmOrganizer){this._actionedOrganizer=b;\nreturn this._actionedOrganizer\n}c=c.parent\n}return null\n};\nZmTreeController.prototype._checkTreeView=function(d){if(!d||!this._treeView[d]){return\n}var b=this._opc.getOverview(d).account;\nvar c=this.getDataTree(b);\nvar a=(ZmOrganizer.HIDE_EMPTY[this.type]&&c&&(c.size()==0));\nthis._treeView[d].setVisible(!a)\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmTagTreeController\")){ZmTagTreeController=function(){ZmTreeController.call(this,ZmOrganizer.TAG);\nthis._listeners[ZmOperation.NEW_TAG]=this._newListener.bind(this);\nthis._listeners[ZmOperation.RENAME_TAG]=this._renameListener.bind(this);\nthis._listeners[ZmOperation.TAG_COLOR_MENU]=this._colorListener.bind(this)\n};\nZmTagTreeController.prototype=new ZmTreeController;\nZmTagTreeController.prototype.constructor=ZmTagTreeController;\nZmTagTreeController.prototype.isZmTagTreeController=true;\nZmTagTreeController.prototype.toString=function(){return\"ZmTagTreeController\"\n};\nZmTagTreeController.prototype._getActionMenu=function(){var b=ZmTreeController.prototype._getActionMenu.call(this);\nif(b&&!b._initialized){var a=b.getMenuItem(ZmOperation.TAG_COLOR_MENU);\nif(a){a.getMenu().addSelectionListener(this._listeners[ZmOperation.TAG_COLOR_MENU])\n}b._initialized=true\n}return b\n};\nZmTagTreeController.prototype.resetOperations=function(c,b,d){var a=appCtxt.getById(d);\nc.enableAll(true);\nif(a.isSystem()){c.enable([ZmOperation.RENAME_TAG,ZmOperation.TAG_COLOR_MENU,ZmOperation.DELETE_WITHOUT_SHORTCUT],false)\n}c.enable(ZmOperation.MARK_ALL_READ,(a&&(a.numUnread>0)))\n};\nZmTagTreeController.prototype._getHeaderActionMenuOps=function(){return[ZmOperation.NEW_TAG]\n};\nZmTagTreeController.prototype._getActionMenuOps=function(){return[ZmOperation.NEW_TAG,ZmOperation.MARK_ALL_READ,ZmOperation.DELETE_WITHOUT_SHORTCUT,ZmOperation.RENAME_TAG,ZmOperation.TAG_COLOR_MENU,ZmOperation.OPEN_IN_TAB]\n};\nZmTagTreeController.prototype._getNewDialog=function(){return appCtxt.getNewTagDialog()\n};\nZmTagTreeController.prototype._getRenameDialog=function(){return appCtxt.getRenameTagDialog()\n};\nZmTagTreeController.prototype._itemClicked=function(b,c){var a;\nswitch(appCtxt.getCurrentAppName()){case ZmApp.CONTACTS:a=ZmItem.CONTACT;\nbreak;\ncase ZmApp.CALENDAR:a=ZmItem.APPT;\nbreak;\ncase ZmApp.BRIEFCASE:a=ZmItem.BRIEFCASE_ITEM;\nbreak;\ncase ZmApp.TASKS:a=ZmItem.TASK;\nbreak;\ndefault:a=ZmId.SEARCH_MAIL;\nbreak\n}var e={query:b.createQuery(),searchFor:a,noGal:true,inclSharedItems:true,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),accountName:appCtxt.multiAccounts?b.getAccount().name:null,userInitiated:c};\nvar d=appCtxt.getSearchController();\nd.searchAllAccounts=false;\nd.search(e)\n};\nZmTagTreeController.prototype._deleteListener=function(b){var a=this._pendingActionData=this._getActionedOrganizer(b);\nvar c=this._deleteShield=appCtxt.getYesNoMsgDialog();\nc.reset();\nc.registerCallback(DwtDialog.NO_BUTTON,this._clearDialog,this,this._deleteShield);\nc.registerCallback(DwtDialog.YES_BUTTON,this._deleteShieldYesCallback,this,a);\nvar d=AjxMessageFormat.format(ZmMsg.askDeleteTag,a.getName(false,ZmOrganizer.MAX_DISPLAY_NAME_LENGTH));\nc.setMessage(d,DwtMessageDialog.WARNING_STYLE);\nc.popup()\n};\nZmTagTreeController.prototype._colorListener=function(c){var a=this._getActionedOrganizer(c);\nif(a){var b=c.item.getData(ZmOperation.MENUITEM_ID);\nif(String(b).match(/^#/)){a.setRGB(b)\n}else{a.setColor(b)\n}}};\nZmTagTreeController.prototype._dropListener=function(e){var f=e.srcData.data;\nif(e.action==DwtDropEvent.DRAG_ENTER){var d=(f instanceof Array)?f[0]:f;\nvar b=e.targetControl.getData(Dwt.KEY_OBJECT);\nif(b.id==ZmOrganizer.ID_ROOT){e.doIt=false\n}else{if(d instanceof ZmItem&&d.isReadOnly()){e.doIt=false\n}else{if(appCtxt.multiAccounts&&b.getAccount()!=d.account){e.doIt=false\n}else{e.doIt=this._dropTgt.isValidTarget(f)\n}}}}else{if(e.action==DwtDropEvent.DRAG_DROP){var a=e.srcData.controller;\nvar c=(f instanceof Array)?f:[f];\na._doTag(c,e.targetControl.getData(Dwt.KEY_OBJECT),true)\n}}};\nZmTagTreeController.prototype._changeListener=function(g,c,h){var b=g.getDetail(\"fields\");\nvar d=g.getDetail(\"organizers\");\nfor(var e=0;\ne<d.length;\ne++){var a=d[e];\nif(g.event==ZmEvent.E_MODIFY&&((b&&b[ZmOrganizer.F_COLOR]))){var f=c.getTreeItemById(a.id);\nif(f){f.setImage(a.getIconWithColor())\n}}else{ZmTreeController.prototype._changeListener.call(this,g,c,h)\n}}};\nZmTagTreeController.prototype._setTreeItemColor=function(b,a){}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmFolderTreeController\")){ZmFolderTreeController=function(b,a){if(!arguments.length){return\n}ZmTreeController.call(this,(b||ZmOrganizer.FOLDER));\nthis._listeners[ZmOperation.NEW_FOLDER]=this._newListener.bind(this);\nthis._listeners[ZmOperation.PRIORITY_FILTER]=this._priorityFilterListener.bind(this);\nthis._listeners[ZmOperation.RENAME_FOLDER]=this._renameListener.bind(this);\nthis._listeners[ZmOperation.SHARE_FOLDER]=this._shareFolderListener.bind(this);\nthis._listeners[ZmOperation.EMPTY_FOLDER]=this._emptyListener.bind(this);\nthis._listeners[ZmOperation.RECOVER_DELETED_ITEMS]=this._recoverListener.bind(this);\nthis._listeners[ZmOperation.SYNC_OFFLINE_FOLDER]=this._syncOfflineFolderListener.bind(this)\n};\nZmFolderTreeController.prototype=new ZmTreeController;\nZmFolderTreeController.prototype.constructor=ZmFolderTreeController;\nZmFolderTreeController.prototype.isZmFolderTreeController=true;\nZmFolderTreeController.prototype.toString=function(){return\"ZmFolderTreeController\"\n};\nZmFolderTreeController.prototype.show=function(a){return ZmTreeController.prototype.show.call(this,a)\n};\nZmFolderTreeController.prototype.resetOperations=function(k,d,r){var n=ZmMsg.emptyFolder;\nvar g=appCtxt.getById(r);\nvar t=((g.numTotal>0)||(g.children&&(g.children.size()>0)));\nvar i=true;\nvar l=g.rid;\nif(l==ZmFolder.ID_ROOT||l==ZmFolder.ID_INBOX||l==ZmFolder.ID_SENT||l==ZmFolder.ID_DRAFTS){i=false\n}var q=ZmOrganizer.normalizeId(r,this.type);\nif(q==ZmOrganizer.ID_ROOT||(!g.isSystem()&&!g.isSystemEquivalent())){var c=(!g.link||g.isAdmin());\nif(appCtxt.isOffline){c=!g.getAccount().isMain&&g.getAccount().isZimbraAccount\n}k.enableAll(true);\nvar m=g.parent&&g.parent.isReadOnly();\nk.enable([ZmOperation.DELETE_WITHOUT_SHORTCUT,ZmOperation.MOVE,ZmOperation.EDIT_PROPS],!m);\nk.enable(ZmOperation.SYNC,g.isFeed());\nk.enable(ZmOperation.SYNC_ALL,g.isFeed()||g.hasFeeds());\nk.enable(ZmOperation.SHARE_FOLDER,c);\nk.enable(ZmOperation.EMPTY_FOLDER,((t||g.link)&&i&&!appCtxt.isExternalAccount()));\nk.enable(ZmOperation.RENAME_FOLDER,!(m||g.isDataSource()||appCtxt.isExternalAccount()));\nk.enable(ZmOperation.NEW_FOLDER,!(g.disallowSubFolder||appCtxt.isExternalAccount()));\nif(g.isRemote()&&g.isReadOnly()){k.enable([ZmOperation.NEW_FOLDER,ZmOperation.MARK_ALL_READ,ZmOperation.EMPTY_FOLDER],false)\n}if(appCtxt.isExternalAccount()){k.enable([ZmOperation.DELETE_WITHOUT_SHORTCUT,ZmOperation.MOVE],false)\n}}else{if(g.isSystemEquivalent()){q=g.getSystemEquivalentFolderId()\n}k.enableAll(false);\nif(!g.disallowSubFolder&&(q==ZmFolder.ID_INBOX||q==ZmFolder.ID_SENT||q==ZmFolder.ID_TRASH)){k.enable(ZmOperation.NEW_FOLDER,true)\n}if(q==ZmFolder.ID_SPAM||q==ZmFolder.ID_TRASH||q==ZmFolder.ID_CHATS){if(q==ZmFolder.ID_SPAM){n=ZmMsg.emptyJunk\n}else{if(q==ZmFolder.ID_TRASH){n=ZmMsg.emptyTrash\n}}k.enable(ZmOperation.EMPTY_FOLDER,t)\n}if(!g.link&&(q==ZmFolder.ID_INBOX||q==ZmFolder.ID_SENT||q==ZmFolder.ID_DRAFTS)){k.enable([ZmOperation.SHARE_FOLDER,ZmOperation.EDIT_PROPS],true)\n}if(appCtxt.multiAccounts){var c=!g.getAccount().isMain&&g.getAccount().isZimbraAccount;\nif(q==ZmFolder.ID_SPAM||q==ZmFolder.ID_TRASH){c=false\n}k.enable([ZmOperation.SHARE_FOLDER,ZmOperation.EDIT_PROPS],c)\n}if(appCtxt.isOffline&&q==ZmOrganizer.ID_SYNC_FAILURES&&t){k.enable(ZmOperation.EMPTY_FOLDER,true)\n}}k.enable(ZmOperation.OPEN_IN_TAB,true);\nk.enable(ZmOperation.EXPAND_ALL,(g.size()>0));\nif(q!=ZmOrganizer.ID_ROOT&&!g.isReadOnly()){k.enable(ZmOperation.MARK_ALL_READ,!g.isRemoteRoot()&&(g.numUnread>0||g.link))\n}var j=k.getOp(ZmOperation.EMPTY_FOLDER);\nif(j){j.setText(n)\n}var e=(q==ZmOrganizer.ID_TRASH);\nvar a=k.getOp(ZmOperation.SYNC);\nif(a){var o=k.getOp(ZmOperation.SYNC_ALL);\nvar v=g.hasFeeds();\nif(g.isFeed()){a.setEnabled(true);\na.setVisible(true);\na.setText(ZmMsg.checkFeed);\nif(o){o.setEnabled(true);\no.setVisible(true);\no.setText(ZmMsg.checkAllFeed)\n}}else{if(v&&!e){if(o){o.setEnabled(true);\no.setVisible(true);\no.setText(ZmMsg.checkAllFeed)\n}}else{var u=appCtxt.get(ZmSetting.POP_ACCOUNTS_ENABLED)||appCtxt.get(ZmSetting.IMAP_ACCOUNTS_ENABLED);\nif(!appCtxt.isOffline&&u){var s=AjxDispatcher.run(\"GetDataSourceCollection\");\nvar f=s.getItemsFor(ZmOrganizer.normalizeId(g.id));\nif(f.length>0){a.setText(ZmMsg.checkExternalMail);\na.setEnabled(true);\na.setVisible(true)\n}else{a.setVisible(false)\n}}else{a.setVisible(false)\n}if((!v||e)&&o){o.setVisible(false)\n}}}}a=k.getOp(ZmOperation.SYNC_OFFLINE_FOLDER);\nif(a){if(!g.isOfflineSyncable){a.setVisible(false)\n}else{a.setVisible(true);\na.setEnabled(true);\nvar p=(g.isOfflineSyncing)?ZmMsg.syncOfflineFolderOff:ZmMsg.syncOfflineFolderOn;\na.setText(p)\n}}var h=appCtxt.get(ZmSetting.PRIORITY_INBOX_ENABLED);\nvar b=k.getOp(ZmOperation.PRIORITY_FILTER);\nif(b){b.setVisible(h);\nb.setEnabled(h)\n}this._enableRecoverDeleted(k,e);\nthis._resetButtonPerSetting(k,ZmOperation.SHARE_FOLDER,appCtxt.get(ZmSetting.SHARING_ENABLED))\n};\nZmFolderTreeController.prototype._getHeaderActionMenuOps=function(){if(appCtxt.isExternalAccount()){return[ZmOperation.EXPAND_ALL]\n}return[ZmOperation.NEW_FOLDER,ZmOperation.SEP,ZmOperation.PRIORITY_FILTER,ZmOperation.EXPAND_ALL,ZmOperation.SYNC,ZmOperation.FIND_SHARES]\n};\nZmFolderTreeController.prototype._getActionMenuOps=function(){return[ZmOperation.NEW_FOLDER,ZmOperation.SYNC,ZmOperation.SYNC_ALL,ZmOperation.MARK_ALL_READ,ZmOperation.EMPTY_FOLDER,ZmOperation.RECOVER_DELETED_ITEMS,ZmOperation.SHARE_FOLDER,ZmOperation.MOVE,ZmOperation.DELETE_WITHOUT_SHORTCUT,ZmOperation.RENAME_FOLDER,ZmOperation.EDIT_PROPS,ZmOperation.SYNC_OFFLINE_FOLDER,ZmOperation.OPEN_IN_TAB,ZmOperation.EXPAND_ALL]\n};\nZmFolderTreeController.prototype._getAllowedSubTypes=function(){var a={};\na[ZmOrganizer.FOLDER]=true;\na[ZmOrganizer.SEARCH]=true;\nreturn a\n};\nZmFolderTreeController.prototype._getNewDialog=function(){return appCtxt.getNewFolderDialog()\n};\nZmFolderTreeController.prototype._getRenameDialog=function(){return appCtxt.getRenameFolderDialog()\n};\nZmFolderTreeController.prototype._itemClicked=function(b,l){if(appCtxt.isOffline){var o=b.getAccount();\nif(o&&o.inNewMailMode){o.inNewMailMode=false;\nvar c=appCtxt.getOverviewController()._overviewContainer;\nfor(var k in c){c[k].updateAccountInfo(o,true,true)\n}}}if(b.type==ZmOrganizer.SEARCH){var g=this._opc.getTreeController(ZmOrganizer.SEARCH);\ng._itemClicked(b,l)\n}else{if(b.id==ZmFolder.ID_ATTACHMENTS){var j=AjxDispatcher.run(\"GetAttachmentsController\");\nj.show()\n}else{var a=ZmId.SEARCH_MAIL;\nif(b.isInTrash()){var e=appCtxt.getCurrentAppName();\nif(e==ZmApp.CONTACTS){a=ZmItem.CONTACT\n}}var n=appCtxt.getSearchController();\nvar o=b.getAccount();\nvar p=appCtxt.get(ZmSetting.SORTING_PREF,b.nId);\nif(!p){p=(n.currentSearch&&b.nId==n.currentSearch.folderId)?null:ZmSearch.DATE_DESC\n}else{var h=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();\nif(h==ZmItem.CONV&&(p==ZmSearch.NAME_ASC||p==ZmSearch.NAME_DESC)){p=appCtxt.get(ZmSetting.SORTING_PREF,appCtxt.getCurrentViewId());\nif(!p){p=ZmSearch.DATE_DESC\n}appCtxt.set(ZmSetting.SORTING_PREF,p,b.nId)\n}}var f={query:b.createQuery(),searchFor:a,getHtml:b.nId==ZmFolder.ID_DRAFTS||appCtxt.get(ZmSetting.VIEW_AS_HTML),types:b.nId==ZmOrganizer.ID_SYNC_FAILURES?[ZmItem.MSG]:null,sortBy:p,accountName:o&&o.name,userInitiated:l,origin:ZmId.SEARCH};\nn.resetSearchAllAccounts();\nif(appCtxt.multiAccounts){if(b.link&&b.perm==null){var d=appCtxt.getFolderTree(o);\nif(d){var q=new AjxCallback(this,this._getPermissionsResponse,[f]);\nd.getPermissions({callback:q,folderIds:[b.id]})\n}return\n}if(appCtxt.isOffline&&o.hasNotSynced()&&!o.__syncAsked){o.__syncAsked=true;\nvar m=appCtxt.getYesNoMsgDialog();\nm.registerCallback(DwtDialog.YES_BUTTON,this._syncAccount,this,[m,o]);\nm.setMessage(ZmMsg.neverSyncedAsk,DwtMessageDialog.INFO_STYLE);\nm.popup()\n}}n.search(f)\n}}};\nZmFolderTreeController.prototype._syncAccount=function(a,b){a.popdown();\nb.sync()\n};\nZmFolderTreeController.prototype._getPermissionsResponse=function(a){appCtxt.getSearchController().search(a)\n};\nZmFolderTreeController.prototype._doSync=function(c){var b=AjxDispatcher.run(\"GetDataSourceCollection\");\nvar a=ZmOrganizer.normalizeId(c.id);\nvar d=b.getItemsFor(a);\nif(d.length>0){b.importMailFor(a)\n}else{ZmTreeController.prototype._doSync.call(this,c)\n}};\nZmFolderTreeController.prototype._syncFeeds=function(b){if(!appCtxt.isOffline&&b&&!b.isFeed()){var c=(appCtxt.get(ZmSetting.POP_ACCOUNTS_ENABLED)||appCtxt.get(ZmSetting.IMAP_ACCOUNTS_ENABLED))?b.getDataSources(null,true):null;\nif(c){var a=AjxDispatcher.run(\"GetDataSourceCollection\");\na.importMail(c);\nreturn\n}}ZmTreeController.prototype._syncFeeds.call(this,b)\n};\nZmFolderTreeController.prototype._addNew=function(d,c,b,a){if(ZmFolder.HIDE_ID[b.id]){return false\n}return d._addNew(c,b,a)\n};\nZmFolderTreeController.prototype._deleteListener=function(c){var a=this._getActionedOrganizer(c);\nvar f=appCtxt.isOffline?this.getDataTree().getById(ZmFolder.ID_TRASH):null;\nif(f&&f.disallowSubFolder&&a.numTotal>0){var h=appCtxt.getMsgDialog();\nh.setMessage(ZmMsg.errorCannotDeleteFolder);\nh.popup();\nreturn\n}if(a.nId==ZmFolder.ID_SPAM||a.isInTrash()||(f&&f.disallowSubFolder)){this._pendingActionData=a;\nvar e=this._deleteShield=appCtxt.getOkCancelMsgDialog();\ne.reset();\ne.registerCallback(DwtDialog.OK_BUTTON,this._deleteShieldYesCallback,this,a);\ne.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,this._deleteShield);\nvar b;\nif(a.type===ZmOrganizer.SEARCH){b=ZmMsg.confirmDeleteSavedSearch\n}else{if(a.nId==ZmFolder.ID_TRASH){b=ZmMsg.confirmEmptyTrashFolder\n}else{if(a.nId==ZmFolder.ID_SPAM){b=ZmMsg.confirmEmptyFolder\n}else{b=ZmMsg.confirmDeleteFolder\n}}}var g=AjxMessageFormat.format(b,a.getName());\ne.setMessage(g,DwtMessageDialog.WARNING_STYLE);\ne.popup()\n}else{this._doMove(a,appCtxt.getById(ZmFolder.ID_TRASH))\n}};\nZmFolderTreeController.prototype._emptyListener=function(a){this._getEmptyShieldWarning(a)\n};\nZmFolderTreeController.prototype._recoverListener=function(a){appCtxt.getDumpsterDialog().popup(this._getSearchFor(),this._getSearchTypes())\n};\nZmFolderTreeController.prototype._getSearchFor=function(a){return ZmId.SEARCH_MAIL\n};\nZmFolderTreeController.prototype._getSearchTypes=function(a){return[ZmItem.MSG]\n};\nZmFolderTreeController.prototype._syncOfflineFolderListener=function(b){var a=this._getActionedOrganizer(b);\nif(a){a.toggleSyncOffline()\n}};\nZmFolderTreeController.prototype._dragListener=function(b){if(b.action==DwtDragEvent.DRAG_START){var a=b.srcControl.getData(Dwt.KEY_OBJECT);\nb.srcData={data:a,controller:this};\nif(!(a instanceof ZmFolder)||a.isSystem()){b.operation=Dwt.DND_DROP_NONE\n}}};\nZmFolderTreeController.prototype._dropListener=function(k){var e=k.targetControl.getData(Dwt.KEY_OBJECT);\nvar b=k.srcData.data;\nvar d=(k.shiftKey||k.uiEvent.shiftKey);\nif(k.action==DwtDropEvent.DRAG_ENTER){if(!b){k.doIt=false;\nreturn\n}var j=k.targetControl.getData(ZmTreeView.KEY_TYPE);\nif(b instanceof ZmFolder){k.doIt=e.mayContain(b,j)&&!e.disallowSubFolder\n}else{if(b instanceof ZmTag){k.doIt=false\n}else{if(this._dropTgt.isValidTarget(b)){k.doIt=e.mayContain(b,j);\nvar a;\nvar n=AjxUtil.toArray(b);\nfor(var c=0;\nc<n.length;\nc++){if(n[c] instanceof ZmItem){a|=n[c].getDefaultDndAction(d)\n}}var l=document.getElementById(DwtId.DND_PLUS_ID);\nif(a&&l){var h=((a&ZmItem.DND_ACTION_COPY)!=0);\nDwt.setVisibility(l,h)\n}}else{k.doIt=false\n}}}}else{if(k.action==DwtDropEvent.DRAG_DROP){if(b instanceof ZmFolder){this._doMove(b,e)\n}else{var m=k.srcData.controller;\nvar g=(b instanceof Array)?b:[b];\nif(appCtxt.multiAccounts&&!d&&!e.getAccount().isMain&&this._isMovingAcrossAccount(g,e)){var f=appCtxt.getYesNoMsgDialog();\nf.registerCallback(DwtDialog.YES_BUTTON,this._continueMovingAcrossAccount,this,[f,m,g,e]);\nf.setMessage(ZmMsg.moveAcrossAccountWarning,DwtMessageDialog.WARNING_STYLE);\nf.popup()\n}else{m._doMove(g,e,null,d)\n}}}}};\nZmFolderTreeController.prototype._isMovingAcrossAccount=function(a,e){for(var c=0;\nc<a.length;\nc++){var d=a[c];\nvar b=d.getAccount();\nif(b&&b!=e.getAccount()){return true\n}}return false\n};\nZmFolderTreeController.prototype._continueMovingAcrossAccount=function(c,a,b,d){c.popdown();\na._doMove(b,d)\n};\nZmTreeController.prototype._priorityFilterListener=function(b){var a=appCtxt.getPriorityMessageFilterDialog();\nZmController.showDialog(a)\n};\nZmFolderTreeController.prototype._shareFolderListener=function(b){this._pendingActionData=this._getActionedOrganizer(b);\nif(this._pendingActionData.id===\"1\"){var a=new AjxException(\"Root folder sharing is not allowed, ignoring action.\",AjxException.INVALID_PARAM);\nappCtxt.getAppController()._handleException(a);\nreturn\n}appCtxt.getSharePropsDialog().popup(ZmSharePropsDialog.NEW,this._pendingActionData)\n};\nZmFolderTreeController.prototype._getMoveDialogTitle=function(){return AjxMessageFormat.format(ZmMsg.moveFolder,this._pendingActionData.name)\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmSearchTreeController\")){ZmSearchTreeController=function(){ZmFolderTreeController.call(this,ZmOrganizer.SEARCH);\nthis._listeners[ZmOperation.RENAME_SEARCH]=this._renameListener.bind(this)\n};\nZmSearchTreeController.prototype=new ZmFolderTreeController;\nZmSearchTreeController.prototype.constructor=ZmSearchTreeController;\nZmSearchTreeController.prototype.isZmSearchTreeController=true;\nZmSearchTreeController.prototype.toString=function(){return\"ZmSearchTreeController\"\n};\nZmSearchTreeController.APP_JOIN_CHAR=\"-\";\nZmSearchTreeController.prototype.show=function(d){var e=d.overviewId;\nif(!this._treeView[e]||d.forceCreate){this._treeView[e]=this._setup(e)\n}var b=this.getDataTree(d.account);\nif(b){d.dataTree=b;\nd.searchTypes={};\nd.omit=d.omit||{};\nd.omit[ZmFolder.ID_TRASH]=true;\nd.omitParents=true;\nvar a=ZmOrganizer.OPEN_SETTING[this.type];\nd.collapsed=!(!a||(appCtxt.get(a,null,d.account)!==false));\nvar c=this._opc.getOverview(e);\nif(c&&c.showNewButtons){this._setupOptButton(d)\n}this._treeView[e].set(d);\nthis._checkTreeView(e)\n}return this._treeView[e]\n};\nZmSearchTreeController.prototype.getTreeStyle=function(){return null\n};\nZmSearchTreeController.prototype.resetOperations=function(c,b,d){c.enableAll(true);\nvar a=appCtxt.getById(d);\nc.enable(ZmOperation.EXPAND_ALL,(a.size()>0))\n};\nZmSearchTreeController.prototype._getHeaderActionMenuOps=function(){return[ZmOperation.EXPAND_ALL]\n};\nZmSearchTreeController.prototype._getActionMenuOps=function(){return[ZmOperation.MOVE,ZmOperation.DELETE_WITHOUT_SHORTCUT,ZmOperation.RENAME_SEARCH,ZmOperation.EDIT_PROPS,ZmOperation.OPEN_IN_TAB,ZmOperation.EXPAND_ALL]\n};\nZmSearchTreeController.prototype._getAllowedSubTypes=function(){return ZmTreeController.prototype._getAllowedSubTypes.call(this)\n};\nZmSearchTreeController.prototype._getNewDialog=function(){return appCtxt.getNewSearchDialog()\n};\nZmSearchTreeController.prototype._itemClicked=function(b,a){if(b._showFoldersCallback){b._showFoldersCallback.run();\nreturn\n}appCtxt.getSearchController().redoSearch(b.search,false,{getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),userInitiated:a,origin:ZmId.SEARCH})\n};\nZmSearchTreeController.prototype._getMoveDialogTitle=function(){return AjxMessageFormat.format(ZmMsg.moveSearch,this._pendingActionData.name)\n};\nZmSearchTreeController.prototype._checkTreeView=function(e){var b=this._treeView[e];\nif(!e||!b){return\n}var d=this._opc.getOverview(e).account;\nvar a=(appCtxt.multiAccounts&&!d.isMain)?(ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,d)):ZmOrganizer.ID_ROOT;\nvar c=ZmOrganizer.HIDE_EMPTY[this.type]&&!b.getTreeItemById(a).getItemCount();\nthis._treeView[e].setVisible(!c)\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmShareTreeController\")){ZmShareTreeController=function(){ZmTreeController.call(this,ZmOrganizer.SHARE)\n};\nZmShareTreeController.prototype=new ZmTreeController;\nZmShareTreeController.prototype.constructor=ZmShareTreeController;\nZmShareTreeController.prototype.toString=function(){return\"ZmShareTreeController\"\n};\nZmShareTreeController.prototype.getDataTree=function(b){var a=new ZmFolderTree(ZmOrganizer.SHARE);\nvar c={id:ZmOrganizer.ID_ROOT,name:ZmMsg.sharedFoldersHeader};\na.root=ZmFolderTree.createFolder(ZmOrganizer.SHARE,null,c,a);\nreturn a\n};\nZmShareTreeController.prototype._createTreeView=function(a){return new ZmShareTreeView(a)\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmOverviewController\")){ZmOverviewController=function(a){ZmController.call(this,a);\nthis._overviewContainer={};\nthis._overview={};\nthis._controller={};\nthis._appOverviewId={}\n};\nZmOverviewController.CONTROLLER={};\nZmOverviewController.DEFAULT_FOLDER_ID=ZmFolder.ID_INBOX;\nZmOverviewController.prototype=new ZmController;\nZmOverviewController.prototype.constructor=ZmOverviewController;\nZmOverviewController.prototype.toString=function(){return\"ZmOverviewController\"\n};\nZmOverviewController.prototype.createOverviewContainer=function(b,c){b.parent=b.parent||this._shell;\nb.controller=this;\nb.id=ZmId.getOverviewContainerId(b.containerId);\nvar a=this._overviewContainer[b.containerId]=new ZmAccountOverviewContainer(b);\nc.containerId=b.id;\na.initialize(c);\nreturn a\n};\nZmOverviewController.prototype.createOverview=function(b){b.parent=b.parent||this._shell;\nvar a=this._overview[b.overviewId]=new ZmOverview(b,this);\nreturn a\n};\nZmOverviewController.prototype.getOverviewContainer=function(a){var a=a||appCtxt.getCurrentAppName();\nreturn this._overviewContainer[a]\n};\nZmOverviewController.prototype.getOverview=function(a){return this._overview[a]\n};\nZmOverviewController.prototype.getTreeController=function(treeId,noCreate){if(!treeId){return null\n}if(!this._controller[treeId]&&!noCreate){var className=ZmOverviewController.CONTROLLER[treeId];\nif(className&&window[className]){var treeControllerCtor=eval(ZmOverviewController.CONTROLLER[treeId]);\nif(treeControllerCtor){this._controller[treeId]=new treeControllerCtor(treeId)\n}}}return this._controller[treeId]\n};\nZmOverviewController.prototype.getTreeData=function(a){return a?appCtxt.getTree(a):null\n};\nZmOverviewController.prototype.getTreeView=function(b,a){if(!b||!a){return null\n}if(!this.getOverview(b)){return null\n}return this.getOverview(b).getTreeView(a)\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmSearchController\")){ZmSearchController=function(a){ZmController.call(this,a);\nthis._inited=false;\nthis._contactSource=ZmItem.CONTACT;\nthis._results=null;\nif(appCtxt.get(ZmSetting.SEARCH_ENABLED)){this._setView()\n}};\nZmSearchController.prototype=new ZmController;\nZmSearchController.prototype.constructor=ZmSearchController;\nZmSearchController.prototype.isZmSearchController=true;\nZmSearchController.prototype.toString=function(){return\"ZmSearchController\"\n};\nZmSearchController.QUERY_ISREMOTE=\"is:remote OR is:local\";\nZmSearchController.prototype.getSearchToolbar=function(){return this._searchToolBar\n};\nZmSearchController.prototype.dateSearch=function(g,a){g=g||new Date();\nvar e=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT);\nvar c=e.format(g);\nvar b=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();\nvar f=\"date:\"+c;\nthis.search({query:f,types:[b],searchFor:a,origin:ZmId.SEARCH,userInitiated:true})\n};\nZmSearchController.prototype.fromSearch=function(a){var b=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();\nvar c=AjxUtil.map(AjxUtil.toArray(a),function(d){return\"from:\"+((d&&d.isAjxEmailAddress)?d.getAddress():d)\n});\nthis.search({query:c.join(\" OR \"),types:[b],origin:ZmId.SEARCH,userInitiated:true})\n};\nZmSearchController.prototype.toSearch=function(a){var b=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();\nvar c=AjxUtil.map(AjxUtil.toArray(a),function(e){return\"tocc:\"+((e&&e.isAjxEmailAddress)?e.getAddress():e)\n});\nvar d={types:[b],origin:ZmId.SEARCH,userInitiated:true,query:c.join(\" OR \")};\nif(this.currentSearch&&this.currentSearch.folderId==ZmFolder.ID_SENT){if(c.length>1){d.query=\"(\"+d.query+\")\"\n}d.query=\"in:sent AND \"+d.query\n}this.search(d)\n};\nZmSearchController.prototype.setSearchField=function(a){if(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)&&this._searchToolBar){this._searchToolBar.setSearchFieldValue(a)\n}else{this._currentQuery=a\n}};\nZmSearchController.prototype.getSearchFieldValue=function(){return this._searchToolBar?this._searchToolBar.getSearchFieldValue():\"\"\n};\nZmSearchController.prototype.setEnabled=function(a){if(this._searchToolBar){this._searchToolBar.setEnabled(a)\n}};\nZmSearchController.prototype.setDefaultSearchType=function(a){if(!this._searchToolBar){return\n}var b=this._searchToolBar.getButton(ZmSearchToolBar.TYPES_BUTTON).getMenu();\nb.checkItem(ZmOperation.MENUITEM_ID,a);\nthis._searchMenuListener(null,a,true)\n};\nZmSearchController.prototype._setView=function(){this.searchPanel=new DwtComposite({parent:this._container,className:\"SearchPanel\",posStyle:Dwt.ABSOLUTE_STYLE});\nthis._searchToolBar=new ZmMainSearchToolBar({parent:this.searchPanel,id:ZmId.SEARCH_TOOLBAR});\nthis._createTabGroup();\nthis._tabGroup.addMember(this._searchToolBar.getChildren());\nthis._searchToolBar.registerEnterCallback(this._toolbarSearch.bind(this));\nthis._searchToolBar.addSelectionListener(ZmSearchToolBar.SEARCH_BUTTON,this._searchButtonListener.bind(this))\n};\nZmSearchController.prototype._addMenuListeners=function(f){var c=this._searchMenuListener.bind(this);\nvar b=f.getItems();\nfor(var d=0;\nd<b.length;\nd++){var e=b[d];\ne.addSelectionListener(c);\nvar a=e.getData(ZmOperation.MENUITEM_ID);\nif(a==ZmId.SEARCH_MAIL){e.setChecked(true,true)\n}}};\nZmSearchController.prototype.search=function(a){if(a.query&&(a.query.indexOf(\"$set:\")==0||a.query.indexOf(\"$cmd:\")==0)){appCtxt.getClientCmdHandler().execute((a.query.substr(5)),this);\nreturn\n}a.searchAllAccounts=this.searchAllAccounts;\nvar b=this._handleResponseSearch.bind(this,a.callback);\nthis._doSearch(a,a.noRender,b,a.errorCallback)\n};\nZmSearchController.prototype._handleResponseSearch=function(b,a){if(b){b.run(a)\n}};\nZmSearchController.prototype.redoSearch=function(d,a,e,g,b){var f={};\nf.query=d.query;\nf.queryHint=d.queryHint;\nf.types=d.types;\nf.forceTypes=d.forceTypes;\nf.sortBy=d.sortBy;\nf.offset=d.offset;\nf.limit=d.limit;\nf.fetch=d.fetch;\nf.searchId=d.searchId;\nf.lastSortVal=d.lastSortVal;\nf.endSortVal=d.endSortVal;\nf.lastId=d.lastId;\nf.soapInfo=d.soapInfo;\nf.accountName=d.accountName;\nf.searchFor=this._searchFor;\nf.idsOnly=d.idsOnly;\nf.inDumpster=d.inDumpster;\nf.userInitiated=d.userInitiated;\nf.sessionId=d.sessionId;\nf.isEmpty=d.isEmpty;\nf.markRead=d.markRead;\nif(e){for(var c in e){f[c]=e[c]\n}}this._doSearch(f,a,g,b)\n};\nZmSearchController.prototype.resetSearchAllAccounts=function(){var a=this.searchAllAccounts&&this._searchToolBar.getButton(ZmSearchToolBar.TYPES_BUTTON);\nvar e=a&&a.getMenu();\nvar d=e&&e.getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_ALL_ACCOUNTS);\nif(d){d.setChecked(false,true);\nvar c=e.getSelectedItem();\nvar b=this._inclSharedItems?this._getSharedImage(c):c.getImage();\na.setImage(b);\nthis.searchAllAccounts=false\n}};\nZmSearchController.prototype.resetSearchToolbar=function(){var a=this._searchToolBar.getButton(ZmSearchToolBar.TYPES_BUTTON);\nvar b=a?a.getMenu().getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_GAL):null;\nif(b){b.setVisible(appCtxt.getActiveAccount().isZimbraAccount)\n}};\nZmSearchController.prototype.getTypeFromSearchFor=function(a,d){var b=a;\nif(a===ZmId.SEARCH_MAIL){var c=window.parentAppCtxt||window.appCtxt,e=c.getApp(d?ZmApp.SEARCH:ZmApp.MAIL);\nb=e?e.getGroupMailBy():ZmItem.MSG\n}return b\n};\nZmSearchController.prototype.getSearchForFromType=function(a){return(a===ZmItem.MSG||a===ZmItem.CONV)?ZmId.SEARCH_MAIL:a\n};\nZmSearchController.prototype.updateOverview=function(a){var b=a||appCtxt.getCurrentSearch();\nif(!b){return\n}var h,c;\nif(b.isSimple()||b.searchId){if(b.searchId){h=this._getNormalizedId(b.searchId);\nc=ZmOrganizer.SEARCH\n}else{if(b.folderId){h=this._getNormalizedId(b.folderId);\nvar e=appCtxt.getFolderTree(),d=e&&e.getById(h);\nc=ZmOrganizer.ITEM_ORGANIZER[b.searchFor]||(d&&d.type)||ZmOrganizer.FOLDER\n}else{if(b.tagId){h=this._getNormalizedId(b.tagId);\nc=ZmOrganizer.TAG\n}}}if(c){var g=appCtxt.getCurrentApp();\nvar f=g&&g.getOverview();\nif(f){f.setSelected(h,c)\n}}}};\nZmSearchController.prototype._getSuitableSortBy=function(b){var d;\nvar a;\nswitch(b){case ZmItem.CONV:a=ZmId.VIEW_CONVLIST;\nbreak;\ncase ZmItem.MSG:a=ZmId.VIEW_TRAD;\nbreak;\ncase ZmItem.CONTACT:a=ZmId.VIEW_CONTACT_SIMPLE;\nbreak;\ncase ZmItem.APPT:a=ZmId.VIEW_CAL;\nbreak;\ncase ZmItem.TASK:a=ZmId.VIEW_TASKLIST;\nbreak;\ncase ZmId.SEARCH_GAL:a=ZmId.VIEW_CONTACT_SIMPLE;\nbreak;\ncase ZmItem.BRIEFCASE_ITEM:a=ZmId.VIEW_BRIEFCASE_DETAIL;\nbreak\n}if(a){d=appCtxt.get(ZmSetting.SORTING_PREF,a)\n}var c=this._searchToolBar.getSearchFieldValue();\nif(c&&c.length>0){if(d===ZmSearch.RCPT_ASC||d===ZmSearch.RCPT_DESC){d=d===ZmSearch.RCPT_ASC?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC\n}else{if(d===ZmSearch.FLAG_ASC||d===ZmSearch.FLAG_DESC){d=d===ZmSearch.FLAG_ASC?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC\n}else{if(d===ZmSearch.ATTACH_ASC||d===ZmSearch.ATTACH_DESC){d=d===ZmSearch.ATTACH_ASC?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC\n}else{if(d===ZmSearch.PRIORITY_ASC||d===ZmSearch.PRIORITY_DESC){d=d===ZmSearch.PRIORITY_ASC?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC\n}}}}}return d\n};\nZmSearchController.prototype._doSearch=function(d,l,m,g){var a=this._searchFor=d.searchFor||this._searchFor||ZmSearchToolBar.MENU_ITEMS[0];\nappCtxt.notifyZimlets(\"onSearch\",[d.query]);\nif(!d.skipUpdateSearchToolbar&&this._searchToolBar){var k=(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)||d.userText)?d.query:null;\nthis._searchToolBar.setSearchFieldValue(k||\"\");\nif(appCtxt.multiAccounts&&d.userText&&this.searchAllAccounts){appCtxt.getCurrentApp().getOverviewContainer().deselectAll()\n}}var h=d.types;\nvar i=!h?a:AjxUtil.toArray(h)[0];\na=this.getSearchForFromType(i);\nif(!d.forceTypes){i=this.getTypeFromSearchFor(a,d.userInitiated)\n}var h=AjxVector.fromArray([i]);\nif(a==ZmId.SEARCH_MAIL){d=appCtxt.getApp(ZmApp.MAIL).getSearchParams(d)\n}if(a==ZmItem.TASK){var c=AjxDispatcher.run(\"GetTaskListController\");\nd.allowableTaskStatus=c&&c.getAllowableTaskStatus()\n}if(d.searchAllAccounts&&!d.queryHint){d.queryHint=appCtxt.accountList.generateQuery(null,h);\nd.accountName=appCtxt.accountList.mainAccount.name\n}else{if(d.inclSharedItems||this._inclSharedItems){d.queryHint=ZmSearchController.generateQueryForShares(i)\n}}d.contactSource=!d.noGal&&(i===ZmItem.CONTACT||i===ZmId.SEARCH_GAL)?this._contactSource:null;\nif(d.contactSource==ZmId.SEARCH_GAL){d.expandDL=true\n}d.sortBy=d.sortBy||this._getSuitableSortBy(i);\nd.types=h;\nvar p=new ZmSearch(d);\nif(a===ZmId.SEARCH_MAIL&&(d.inDumpster||(!d.isViewSwitch&&p.folderId&&p.folderId==ZmFolder.ID_DRAFTS))){p.types=AjxVector.fromArray([ZmItem.MSG]);\np.isDefaultToMessageView=true\n}var n=this._handleResponseDoSearch.bind(this,p,l,m,d.noUpdateOverview);\nvar b=this._handleOfflineDoSearch.bind(this,p,n);\nif(p.folderId==ZmFolder.ID_OUTBOX){var j=true\n}if(!g){g=this._handleErrorDoSearch.bind(this,p);\nif(!d.errorCallback){d.errorCallback=g\n}}p.calController=null;\nif(a==ZmItem.APPT&&!d.forceSearch&&!d.inDumpster){var o,e;\nif(p.userInitiated&&ZmApp.SEARCH_RESULTS_TAB[ZmApp.CALENDAR]){o=appCtxt.getApp(ZmApp.SEARCH).getSearchResultsController(p.sessionId,ZmApp.CALENDAR);\ne=o.getCurrentViewId()\n}var f=AjxDispatcher.run(\"GetCalController\",e,o);\nif(f&&i===ZmItem.APPT){p.calController=f;\nf.handleUserSearch(d,n)\n}else{p.execute({offlineCache:d&&d.offlineCache,callback:n,errorCallback:g,offlineCallback:b,offlineRequest:j})\n}}else{p.execute({offlineCache:d&&d.offlineCache,callback:n,errorCallback:g,offlineCallback:b,offlineRequest:j})\n}};\nZmSearchController.prototype._handleResponseDoSearch=function(d,b,f,e,a){var c=a&&a.getResponse();\nif(!c){return\n}if(!c.type){c.type=d.types.get(0)\n}this.currentSearch=d;\nif(!b){this._showResults(c,d,e)\n}if(f){f.run(a)\n}};\nZmSearchController.prototype._handleOfflineDoSearch=function(a,c){if(a.types&&a.types.replaceObject(ZmItem.CONV,ZmItem.MSG)){a.isDefaultToMessageView=true\n}var b=this._handleOfflineResponseDoSearch.bind(this,a,c);\nZmOfflineDB.search(a,b)\n};\nZmSearchController.prototype._showResults=function(d,i,a){this._results=d=(d&&d.isZmSearchResult)?d:new ZmSearchResult(i);\nvar h=window.parentAppCtxt||window.appCtxt;\nif(h.get(ZmSetting.SAVED_SEARCHES_ENABLED)){var e=this._searchToolBar&&this._searchToolBar.getButton(ZmSearchToolBar.SAVE_BUTTON);\nif(e){e.setEnabled(this._contactSource!=ZmId.SEARCH_GAL)\n}}var b=i.calController?h.getApp(ZmApp.CALENDAR):h.getApp(ZmItem.APP[d.type])||h.getCurrentApp();\nvar f=b.getName();\nif(i.userInitiated&&ZmApp.SEARCH_RESULTS_TAB[f]){var g=(i.calController&&i.calController.searchResultsController)||h.getApp(ZmApp.SEARCH).getSearchResultsController(i.sessionId,f);\ng.show(d,i.calController);\nthis._searchToolBar.setSearchFieldValue(\"\")\n}else{if(b.showSearchResults){var c=this._handleLoadShowResults.bind(this,d,i,a);\nb.currentSearch=i;\nb.currentQuery=i.query;\nb.showSearchResults(d,c)\n}}};\nZmSearchController.prototype.openNewSearchTab=function(){this._toolbarSearch({isEmpty:true,origin:ZmId.SEARCH})\n};\nZmSearchController.prototype._handleLoadShowResults=function(b,a,c){appCtxt.setCurrentList(b.getResults(b.type));\nif(!c){this.updateOverview(a)\n}};\nZmSearchController.prototype._handleErrorDoSearch=function(b,a){if(a.code==ZmCsfeException.MAIL_NO_SUCH_TAG||a.code==ZmCsfeException.MAIL_QUERY_PARSE_ERROR||a.code==ZmCsfeException.MAIL_TOO_MANY_TERMS||(a.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER&&!(a.data.itemId&&a.data.itemId.length))){var c=a.getErrorMsg();\nappCtxt.setStatusMsg(c,ZmStatusView.LEVEL_WARNING);\nreturn true\n}return false\n};\nZmSearchController.generateQueryForShares=function(g,e){var j=window.parentAppCtxt||window.appCtxt;\nvar f=[];\nvar c=j.getApp(ZmItem.APP[g]);\nif(!c){return null\n}var a=c.getRemoteFolderIds(e);\nfor(var d=0;\nd<a.length;\nd++){var b=a[d];\nvar h=AjxUtil.isNumeric(b)?b:['\"',b,'\"'].join(\"\");\nf.push(\"inid:\"+h)\n}if(f.length>0){f.push(\"is:local\");\nreturn f.join(\" OR \")\n}return null\n};\nZmSearchController.prototype._searchButtonListener=function(a){this._toolbarSearch({ev:a,zimletEvent:\"onSearchButtonClick\",origin:ZmId.SEARCH})\n};\nZmSearchController.prototype._toolbarSearch=function(d){var a=d.searchFor||this._searchToolBar.getSearchType();\nif(a&&a.listener){a.listener.run(d.ev)\n}else{var e=!d.isEmpty?d.query||this._searchToolBar.getSearchFieldValue():\"\";\nvar b=(e.length>0);\nif(e){this._currentQuery=null\n}else{e=this._currentQuery||\"\"\n}appCtxt.notifyZimlets(d.zimletEvent,[e]);\nvar c={query:e,userText:b,userInitiated:true,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),searchFor:a,skipUpdateSearchToolbar:d.skipUpdateSearchToolbar,origin:d.origin,sessionId:d.sessionId,errorCallback:d.errorCallback,sortBy:d.sortBy,isEmpty:d.isEmpty||!e};\nthis.search(c)\n}};\nZmSearchController.prototype._searchMenuListener=function(h,a,f){var d=this._searchToolBar.getButton(ZmSearchToolBar.TYPES_BUTTON);\nif(!d){return\n}var b=d.getMenu();\nvar i=h?h.item:(b.getItemById(ZmOperation.MENUITEM_ID,a));\nif(!i||(!!(i._style&DwtMenuItem.SEPARATOR_STYLE))){return\n}a=i.getData(ZmOperation.MENUITEM_ID);\nvar c=b.getSelectedItem();\nvar k=b.getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_SHARED);\nif(a==ZmId.SEARCH_GAL){this._contactSource=ZmId.SEARCH_GAL;\nif(k){k.setChecked(false,true);\nk.setEnabled(false)\n}}else{if(k){if(a==ZmItem.APPT||a==ZmId.SEARCH_CUSTOM){if(this._sharedMenuItemChecked==null){this._sharedMenuItemChecked=k.getChecked()\n}k.setChecked(false,true);\nk.setEnabled(false)\n}else{k.setEnabled(true);\nif(this._sharedMenuItemChecked){k.setChecked(true,true)\n}this._sharedMenuItemChecked=null\n}}this._contactSource=ZmItem.CONTACT\n}this._inclSharedItems=k&&k.getChecked();\nvar e=b.getItemById(ZmOperation.MENUITEM_ID,ZmId.SEARCH_ALL_ACCOUNTS);\nif(e){if(a==ZmItem.APPT){this.resetSearchAllAccounts();\ne.setEnabled(false)\n}else{e.setEnabled(true);\nthis.searchAllAccounts=e&&e.getChecked()\n}}if(a==ZmId.SEARCH_SHARED){var g=this.searchAllAccounts?e.getImage():c.getImage();\nif(this._inclSharedItems){g=this._getSharedImage(c)\n}d.setImage(g)\n}else{if(a==ZmId.SEARCH_ALL_ACCOUNTS){var g=(this.searchAllAccounts&&!this._inclSharedItems)?i.getImage():(this._inclSharedItems)?this._getSharedImage(c):c.getImage();\nd.setImage(g)\n}else{this._searchFor=a;\nvar g=i.getImage();\nif(this._inclSharedItems){g=this._getSharedImage(c)\n}else{if(this.searchAllAccounts){g=e.getImage()\n}}d.setImage(g)\n}}var j=ZmMsg[ZmSearchToolBar.TT_MSG_KEY[a]];\nif(a!=ZmId.SEARCH_SHARED&&a!=ZmId.SEARCH_ALL_ACCOUNTS){d.setToolTipContent(j);\nd.setAttribute(\"aria-label\",j)\n}if(!f){setTimeout(this._searchToolBar.focus.bind(this._searchToolBar),10)\n}};\nZmSearchController.prototype._getSharedImage=function(a){var b=a&&a.getData(ZmOperation.MENUITEM_ID);\nreturn(b&&ZmSearchToolBar.SHARE_ICON[b])?ZmSearchToolBar.SHARE_ICON[b]:ZmSearchToolBar.ICON[b]\n};\nZmSearchController.prototype._getNormalizedId=function(c){var b=c;\nvar a=appCtxt.getActiveAccount();\nif(!a.isMain&&c.indexOf(\":\")==-1){b=a.id+\":\"+c\n}return b\n};\nZmSearchController.prototype._handleOfflineResponseDoSearch=function(c,e,b){if(c.sortBy===ZmSearch.DATE_DESC){b.sort(function(g,f){return f.d-g.d\n})\n}else{if(c.sortBy===ZmSearch.DATE_ASC){b.sort(function(g,f){return g.d-f.d\n})\n}}var a=new ZmSearchResult(c);\nif(c.searchFor===ZmId.SEARCH_MAIL||c.parsedSearchFor===ZmId.SEARCH_MAIL){c.types=new AjxVector([ZmItem.MSG]);\na.set({m:b})\n}else{if(c.searchFor===ZmItem.CONTACT||c.contactSource===ZmItem.CONTACT){a.set({cn:b})\n}}var d=new ZmCsfeResult(a);\ne(d);\nif(c.folderId==ZmFolder.ID_OUTBOX||c.folderId==ZmFolder.ID_DRAFTS){ZmOffline.updateFolderCountCallback(c.folderId,b.length)\n}};\nZmSearchController.prototype._addOfflineDrafts=function(c,a){var d=this._addOfflineDraftsCallback.bind(this,c,a);\nvar b={methodName:\"SaveDraftRequest\"};\nZmOfflineDB.getItemInRequestQueue(b,d,d)\n};\nZmSearchController.prototype._addOfflineDraftsCallback=function(c,a,b){var d=ZmOffline.generateMsgResponse(b);\nthis._handleResponseDoIndexedDBSearch(c,[].concat(a).concat(d))\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmSearchResultsController\")){ZmSearchResultsController=function(a,d,b,c){ZmController.apply(this,arguments);\nthis._initialize()\n};\nZmSearchResultsController.prototype=new ZmController;\nZmSearchResultsController.prototype.constructor=ZmSearchController;\nZmSearchResultsController.prototype.isZmSearchResultsController=true;\nZmSearchResultsController.prototype.toString=function(){return\"ZmSearchResultsController\"\n};\nZmSearchResultsController.DEFAULT_TAB_TEXT=ZmMsg.search;\nZmSearchResultsController.getDefaultViewType=function(){return ZmId.VIEW_SEARCH_RESULTS\n};\nZmSearchResultsController.prototype.getDefaultViewType=ZmSearchResultsController.getDefaultViewType;\nZmSearchResultsController.prototype.show=function(b,c){var a=b.type;\nb.search.sessionId=this.sessionId;\nvar d=this._resultsApp=appCtxt.getApp(ZmItem.APP[a])||appCtxt.getCurrentApp();\nif(!c){d.showSearchResults(b,this._displayResults.bind(this,b.search),this)\n}else{this._displayResults(b.search,c)\n}appCtxt.searchAppName=d.getName();\nthis._curSearch=b.search;\nthis.inactive=true\n};\nZmSearchResultsController.prototype.showOverview=function(a){var d=this._resultsApp.getOverview(),b=appCtxt.getAppViewMgr();\nif(d){var c={};\nc[ZmAppViewMgr.C_TREE]=a?d:this._filterPanel;\nb.setViewComponents(this.viewId,c,true);\nb.displayComponent(ZmAppViewMgr.C_TREE_FOOTER,a,true)\n}};\nZmSearchResultsController.prototype._initialize=function(){this._toolbar=new ZmSearchResultsToolBar({parent:this._container,controller:this,id:DwtId.makeId(ZmId.SEARCHRESULTS_TOOLBAR,this._currentViewId),noMenuButton:true});\nthis._toolbar.getButton(ZmSearchToolBar.SEARCH_BUTTON).addSelectionListener(this._searchListener.bind(this));\nvar a=this._toolbar.getButton(ZmSearchToolBar.SAVE_BUTTON);\nif(a){a.addSelectionListener(this._saveListener.bind(this))\n}this._toolbar.registerEnterCallback(this._searchListener.bind(this));\nthis.isPinned=false\n};\nZmSearchResultsController.prototype._displayResults=function(i,g){var f=g.getApp().getName();\nif(!this._filterPanel||this._filterPanel._resultsApp!==f){this._filterPanel=new ZmSearchResultsFilterPanel({parent:this._container,controller:this,id:DwtId.makeId(ZmId.SEARCHRESULTS_PANEL,this._currentViewId),resultsApp:f})\n}this._resultsController=g;\nvar a={};\na[ZmAppViewMgr.C_TREE]=this._filterPanel;\na[ZmAppViewMgr.C_TOOLBAR_TOP]=g.getCurrentToolbar();\na[ZmAppViewMgr.C_APP_CONTENT]=g.getViewMgr?g.getViewMgr():g.getCurrentView();\nif(appCtxt.getCurrentViewId().indexOf(this._currentViewId)!==-1){appCtxt.getAppViewMgr().setViewComponents(this._currentViewId,a,true)\n}else{var e={};\ne[ZmAppViewMgr.CB_POST_REMOVE]=this._postRemoveCallback.bind(this);\ne[ZmAppViewMgr.CB_POST_SHOW]=this._postShowCallback.bind(this);\na[ZmAppViewMgr.C_SEARCH_RESULTS_TOOLBAR]=this._toolbar;\nthis._app.createView({viewId:this._currentViewId,viewType:this._currentViewType,elements:a,callbacks:e,controller:this,hide:[ZmAppViewMgr.C_TREE_FOOTER],tabParams:this._getTabParams()});\nthis._app.pushView(this._currentViewId);\nthis._filterPanel.reset();\nif(!this._button){this._button=appCtxt.getAppChooser().getButton(this.tabId);\nDwt.addClass(this._button.getHtmlElement(),\"SearchTabButton\");\nthis._button.addSelectionListener(this._pinnedListener.bind(this))\n}}if(i&&i.query){this._filterPanel.resetBasicFiltersToQuery(i.query)\n}if(i&&i.origin==ZmId.SEARCH){this._toolbar.setSearch(i)\n}var c=g.getCurrentSearchResults&&g.getCurrentSearchResults();\nvar b=(c&&c.getResults())||g.getList();\nvar j=b&&b.size&&b.size();\nvar d=(b&&b.hasMore&&b.hasMore())?\"+\":\"\";\nvar h=j?AjxMessageFormat.format(ZmMsg.searchResultsLabel,[j,d]):i.isEmpty?ZmMsg.searchResultsEnterSearch:ZmMsg.searchResultsLabelNone;\nthis._toolbar.setLabel(h,false);\nif(g&&g.updateTimeIndicator){g.updateTimeIndicator()\n}setTimeout(this._toolbar.focus.bind(this._toolbar),100)\n};\nZmSearchResultsController.prototype._postHideCallback=function(){};\nZmSearchResultsController.prototype._postRemoveCallback=function(){this._app.deleteSessionController({appName:this._resultsApp.getName(),controllerClass:\"ZmSearchResultsController\",sessionId:this.sessionId})\n};\nZmSearchResultsController.prototype._postShowCallback=function(){if(appCtxt.isWebClientOfflineSupported){this.getApp().resetWebClientOfflineOperations(this)\n}};\nZmSearchResultsController.prototype._getTabParams=function(){return{id:this.tabId,leftImage:\"Pin\",rightImage:\"CloseGray\",rightHoverImage:\"Close\",text:ZmSearchResultsController.DEFAULT_TAB_TEXT,textPrecedence:90,tooltip:ZmSearchResultsController.DEFAULT_TAB_TEXT,style:DwtLabel.IMAGE_BOTH}\n};\nZmSearchResultsController.prototype._searchListener=function(d,h){var c=this._toolbar,b=c&&c._searchField.getInputElement();\nif(b&&c._acList){c._settingSearch=true;\nc._acList._complete(b);\nc._settingSearch=false\n}var a=appCtxt.getCurrentViewId();\nvar g=a?appCtxt.get(ZmSetting.SORTING_PREF,a):null;\nvar e=this._toolbar.getSearchFieldValue();\nvar f={ev:d,zimletEvent:h||\"onSearchButtonClick\",query:e,isEmpty:!e,sessionId:this.sessionId,skipUpdateSearchToolbar:true,origin:ZmId.SEARCHRESULTS,searchFor:this._curSearch&&this._curSearch.searchFor,sortBy:g,errorCallback:this._errorCallback.bind(this)};\nc.setLabel(ZmMsg.searching);\nappCtxt.getSearchController()._toolbarSearch(f)\n};\nZmSearchResultsController.prototype._errorCallback=function(a){var b=ZmCsfeException.getErrorMsg(a.code);\nb=b||ZmMsg.unknownError;\nthis._toolbar.setLabel(b,true);\nreturn true\n};\nZmSearchResultsController.prototype._saveListener=function(b){var a=appCtxt.getOverviewController().getTreeController(ZmOrganizer.SEARCH);\nif(!a._newCb){a._newCb=a._newCallback.bind(a)\n}var c={search:this._curSearch,appName:this._resultsApp.getName()};\nZmController.showDialog(a._getNewDialog(),a._newCb,c)\n};\nZmSearchResultsController.prototype._pinnedListener=function(b){if(!Dwt.hasClass(b.target,\"ImgPin\")&&!Dwt.hasClass(b.target,\"ImgUnpin\")){return\n}this.isPinned=!this.isPinned;\nvar a=appCtxt.getAppChooser().getButton(this.tabId);\na.setImage(this.isPinned?\"Unpin\":\"Pin\",DwtLabel.LEFT)\n};\nZmSearchResultsController.prototype._closeListener=function(a){appCtxt.getAppViewMgr().popView(false,this.getCurrentViewId())\n};\nZmSearchResultsController.prototype.addSearchTerm=function(c,b,a){return this._toolbar.addSearchTerm(c,b,a)\n};\nZmSearchResultsController.prototype.removeSearchTerm=function(b,a){this._toolbar.removeSearchTerm(b,a)\n};\nZmSearchResultsController.prototype.getSearchTerms=function(c,b){var a=this._toolbar._searchField.getAddresses();\nvar d=AjxUtil.map(a,function(f,e){return new ZmSearchToken(f)\n});\nreturn d\n}\n}if(AjxPackage.define(\"zimbraMail.share.controller.ZmActionController\")){ZmActionController=function(){this._actionStack=new ZmActionStack(1);\nthis._statusTransitions=ZmActionController._substituteTransitions(appCtxt.getSkinHint(\"toast\",\"transitions\")||ZmToast.DEFAULT_TRANSITIONS);\nthis._outsideListener=new AjxListener(this,ZmActionController.prototype._outsideMouseDownListener);\nappCtxt.getKeyboardMgr().addListener(DwtEvent.ONKEYDOWN,this._outsideListener)\n};\nZmActionController.prototype.toString=function(){return\"ZmActionController\"\n};\nZmActionController.prototype.actionPerformed=function(b){var a=this._actionStack.logAction(b);\nif(a){this.dismiss();\na.onComplete(new AjxCallback(this,this._handleActionComplete))\n}return a\n};\nZmActionController.prototype._handleActionComplete=function(a){this._active=true\n};\nZmActionController.prototype.getUndoLink=function(b,c){if(b instanceof ZmAction){var a=ZmActionController._registerCallback(new AjxCallback(this,this.undoCurrent));\nreturn[\"<a onclick='ZmActionController.callRegisteredCallback(\",a,\")' href='javascript:;' class='undo'>\",c||ZmMsg.undo,\"</a>\"].join(\"\")\n}else{return\"\"\n}};\nZmActionController.prototype.getStatusTransitions=function(){return this._statusTransitions\n};\nZmActionController.prototype.undo=function(a){if(this._active){this.dismiss();\na.undo()\n}};\nZmActionController.prototype.undoCurrent=function(){if(this._actionStack.canUndo()){if(this._actionStack.actionIsComplete()){if(this._active){this.dismiss()\n}this._actionStack.undo()\n}else{this._actionStack.onComplete(new AjxCallback(this,function(a){setTimeout(AjxCallback.simpleClosure(this.undo,this,a),0)\n}))\n}}};\nZmActionController.prototype.onPopup=function(){var a=appCtxt.getOutsideMouseEventMgr();\nvar b={id:\"ZmActionController\",obj:this,elementId:ZmId.TOAST,outsideListener:this._outsideListener};\na.startListening(b)\n};\nZmActionController.prototype.dismiss=function(){appCtxt.dismissStatusMsg(true);\nvar a=appCtxt.getOutsideMouseEventMgr();\na.stopListening(\"ZmActionController\");\nthis._active=false\n};\nZmActionController._substituteTransitions=function(d){var c=[];\nvar b=false;\nfor(var a=0;\na<d.length;\na++){var e=d[a];\nif(e){if(e.type==ZmToast.PAUSE.type){if(!b){b=true;\nc.push(ZmToast.HOLD)\n}}else{c.push(e)\n}}}return c\n};\nZmActionController._registeredCallbacks=[];\nZmActionController._registerCallback=function(b){var a=ZmActionController._registeredCallbacks.length;\nZmActionController._registeredCallbacks[a]=b;\nreturn a\n};\nZmActionController.callRegisteredCallback=function(b){var a=ZmActionController._registeredCallbacks[b];\nif(a){if(a instanceof AjxCallback){a.run()\n}else{if(AjxUtil.isFunction(a)){a()\n}}}};\nZmActionController.prototype._outsideMouseDownListener=function(a){this.dismiss()\n}\n}if(AjxPackage.define(\"zimbraMail.core.ZmAppViewMgr\")){ZmAppViewMgr=function(d,b,a,c){ZmAppViewMgr._setContainerIds();\nthis._shell=d;\nthis._controller=b;\nthis._isNewWindow=a;\nthis._hasSkin=c;\nthis._shellSz=this._shell.getSize();\nthis._shell.addControlListener(this._shellControlListener.bind(this));\nthis._sashSupported=(window.skin&&typeof window.skin.setTreeWidth==\"function\");\nif(appCtxt.get(ZmSetting.HISTORY_SUPPORT_ENABLED)&&!a&&!AjxEnv.isPrism){this._historyMgr=appCtxt.getHistoryMgr();\nthis._historyMgr.addListener(this._historyChangeListener.bind(this))\n}this._hashViewId={};\nthis._nextHashIndex=0;\nthis._curHashIndex=0;\nthis._noHistory=false;\nthis._ignoreHistoryChange=false;\nthis._lastViewId=null;\nthis._currentViewId=null;\nthis._hidden=[];\nthis._toRemove=[];\nthis._view={};\nthis._component={};\nthis._app={};\nthis._emptyView={component:{},callback:{},hide:{}};\nthis._viewByTabId={};\nthis._pushCallback=this.pushView.bind(this);\nthis._popCallback=this.popView.bind(this);\nthis._createLoadingView()\n};\nZmAppViewMgr.prototype.isZmAppViewMgr=true;\nZmAppViewMgr.prototype.toString=function(){return\"ZmAppViewMgr\"\n};\nZmAppViewMgr.C_BANNER=\"banner\";\nZmAppViewMgr.C_USER_INFO=\"userInfo\";\nZmAppViewMgr.C_QUOTA_INFO=\"quota\";\nZmAppViewMgr.C_SEARCH=\"search\";\nZmAppViewMgr.C_APP_CHOOSER=\"appChooser\";\nZmAppViewMgr.C_TREE=\"tree\";\nZmAppViewMgr.C_TOOLBAR_TOP=\"topToolbar\";\nZmAppViewMgr.C_NEW_BUTTON=\"newButton\";\nZmAppViewMgr.C_APP_CONTENT=\"main\";\nZmAppViewMgr.C_SASH=\"sash\";\nZmAppViewMgr.C_TREE_FOOTER=\"treeFooter\";\nZmAppViewMgr.C_SEARCH_RESULTS_TOOLBAR=\"searchResultsToolbar\";\nZmAppViewMgr.LEFT_NAV=[ZmAppViewMgr.C_NEW_BUTTON,ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_SASH];\nZmAppViewMgr.GLOBAL=\"Global\";\nZmAppViewMgr.APP=\"App\";\nZmAppViewMgr.CONT_ID_KEY={};\nZmAppViewMgr.CB_PRE_HIDE=\"PRE_HIDE\";\nZmAppViewMgr.CB_POST_HIDE=\"POST_HIDE\";\nZmAppViewMgr.CB_PRE_SHOW=\"PRE_SHOW\";\nZmAppViewMgr.CB_POST_SHOW=\"POST_SHOW\";\nZmAppViewMgr.CB_PRE_UNLOAD=\"PRE_UNLOAD\";\nZmAppViewMgr.CB_POST_REMOVE=\"POST_REMOVE\";\nZmAppViewMgr.PENDING_VIEW=\"ZmAppViewMgr.PENDING_VIEW\";\nZmAppViewMgr.BROWSER_BACK=\"BACK\";\nZmAppViewMgr.BROWSER_FORWARD=\"FORWARD\";\nZmAppViewMgr.TAB_BUTTON_MAX_TEXT=15;\nZmAppViewMgr._setContainerIds=function(){ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_BANNER]=ZmId.SKIN_LOGO;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_USER_INFO]=ZmId.SKIN_USER_INFO;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_QUOTA_INFO]=ZmId.SKIN_QUOTA_INFO;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SEARCH]=ZmId.SKIN_SEARCH;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SEARCH_RESULTS_TOOLBAR]=ZmId.SKIN_SEARCH_RESULTS_TOOLBAR;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CHOOSER]=ZmId.SKIN_APP_CHOOSER;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TREE]=ZmId.SKIN_TREE;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TREE_FOOTER]=ZmId.SKIN_TREE_FOOTER;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TOOLBAR_TOP]=ZmId.SKIN_APP_TOP_TOOLBAR;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_NEW_BUTTON]=ZmId.SKIN_APP_NEW_BUTTON;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CONTENT]=ZmId.SKIN_APP_MAIN;\nZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SASH]=ZmId.SKIN_SASH;\nZmAppViewMgr.ALL_COMPONENTS=AjxUtil.keys(ZmAppViewMgr.CONT_ID_KEY)\n};\nZmAppViewMgr.prototype.getViewComponent=function(f,a){var b=this._view[a||this._currentViewId]||this._emptyView;\nvar e=b.app||appCtxt.getCurrentAppName();\nvar d=this._view[e];\nvar c=this._view[ZmAppViewMgr.GLOBAL];\nreturn((b&&b.component[f])||(d&&d.component[f])||(c&&c.component[f]))\n};\nZmAppViewMgr.prototype.getCurrentViewComponent=ZmAppViewMgr.prototype.getViewComponent;\nZmAppViewMgr.prototype._getView=function(a,c){var b;\nif(a==ZmAppViewMgr.GLOBAL){b=this._view[a]||this.createView({viewId:a})\n}else{if(a==ZmAppViewMgr.APP){a=c||appCtxt.getCurrentAppName();\nb=this._view[a]||this.createView({viewId:a})\n}else{b=this._view[a||this._currentViewId]||this.createView({viewId:a})\n}}return b\n};\nZmAppViewMgr.prototype.setViewComponents=function(n,h,m,c){var l=this._getView(n,c);\nif(!l){return\n}var f=0;\nvar a=AjxUtil.arraySize(h);\nfor(var k in h){var g=h[k];\nif(!g){continue\n}if(this.isHidden(k,n)){continue\n}var b=m&&!this.isHidden(k,this._currentViewId);\nif(b){var j=this._component[k]&&this._component[k].control;\nif(j&&(j!=g)){this.showComponent(k,false,j)\n}}l.component[k]=g;\nif(this._hasSkin){this.getContainer(k,g)\n}this.displayComponent(k,b,false,null,true);\nif(k==ZmAppViewMgr.C_SASH){if(this._sashSupported){g.registerCallback(this._appTreeSashCallback,this);\nif(appCtxt.get(ZmSetting.FOLDER_TREE_SASH_WIDTH)){var e=appCtxt.get(ZmSetting.FOLDER_TREE_SASH_WIDTH);\nvar d=skin.getTreeWidth();\nthis._appTreeSashCallback(e-d)\n}}g.setCursor(\"default\")\n}f++\n}if(m){this.fitAll()\n}};\nZmAppViewMgr.prototype.addComponents=ZmAppViewMgr.prototype.setViewComponents;\nZmAppViewMgr.prototype.isHidden=function(f,a){var b=this._view[a||this._currentViewId]||this._emptyView;\nvar e=b.app||appCtxt.getCurrentAppName();\nvar d=this._view[e];\nvar c=this._view[ZmAppViewMgr.GLOBAL];\nif(b&&b.component[f]){return false\n}else{if(b&&b.hide[f]){return true\n}else{if(d&&d.component[f]){return false\n}else{if(d&&d.hide[f]){return true\n}else{if(c&&c.component[f]){return false\n}else{return c&&c.hide[f]\n}}}}}};\nZmAppViewMgr.prototype.setHiddenComponents=function(b,a,e,f){a=AjxUtil.toArray(a);\nvar c=this._getView(b,f);\nif(!c){return\n}for(var d=0;\nd<a.length;\nd++){c.hide[a[d]]=e\n}};\nZmAppViewMgr.prototype.showSkinElement=function(c,a,b){if(this._hasSkin){skin.show(c,a,b)\n}};\nZmAppViewMgr.prototype.showComponent=function(c,a,b){b=b||this.getViewComponent(c);\nif(b){if(a){b.zShow(true);\nb.noTab=false\n}else{if(b.getPosition()==Dwt.ABSOLUTE_STYLE){b.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)\n}b.zShow(false);\nb.noTab=true\n}}};\nZmAppViewMgr.prototype.displayComponent=function(e,a,c,b,d){this.showSkinElement(e,a,d);\nthis.showComponent(e,a,b);\nif(c){this._fitToContainer(e)\n}};\nZmAppViewMgr.prototype.getContainer=function(g,b){var c=this._component[g]=this._component[g]||{};\nif(!c.container){var f=ZmAppViewMgr.CONT_ID_KEY[g];\nvar a=document.getElementById(f);\nif(!a){return null\n}c.container=a;\nif(b){a.innerHTML=\"\";\nvar e=this._getContainerBounds(g);\nvar d=Boolean(this.getViewComponent(ZmAppViewMgr.C_TOOLBAR_TOP));\nif(e){b.setBounds(e.x,e.y,e.width,e.height,d)\n}}}return c.container\n};\nZmAppViewMgr.prototype.getCurrentViewId=function(){return this._currentViewId\n};\nZmAppViewMgr.prototype.getCurrentViewType=function(){var a=this._view[this._currentViewId];\nreturn a?a.type:\"\"\n};\nZmAppViewMgr.prototype.getLastViewId=function(){return this._lastViewId\n};\nZmAppViewMgr.prototype.getCurrentView=function(a){return this.getViewComponent(ZmAppViewMgr.C_APP_CONTENT,a||this._currentViewId)\n};\nZmAppViewMgr.prototype.getAppView=function(a){return this._app[a]&&this._app[a].viewId\n};\nZmAppViewMgr.prototype.setAppView=function(b,a){if(!b||!a){return\n}var b=this._app[b];\nif(!b){b=this._app[b]={}\n}b.viewId=a\n};\nZmAppViewMgr.prototype.getViewsByType=function(c,e){var d=[];\nfor(var a in this._view){var b=this._view[a];\nif(b.type==c&&(!e||b.visible)){d.push(b)\n}}return d\n};\nZmAppViewMgr.prototype.isVisible=function(a){var b=this._view[a];\nreturn b&&b.visible\n};\nZmAppViewMgr.prototype.createView=function(e){e=e||{};\nvar a=e.viewId;\nif(!a){return null\n}var b=this._view[a]={id:a,type:e.viewType||a,component:e.elements||{},controller:e.controller,callback:e.callbacks||{},app:e.appName,isAppView:e.isAppView,isTransient:e.isTransient,isFullScreen:e.isFullScreen,hide:AjxUtil.arrayAsHash(e.hide||[])};\nif(e.appName&&!this._app[e.appName]){this._app[e.appName]={}\n}if(!this._isNewWindow&&e.tabParams){b.tabParams=e.tabParams;\nb.isTabView=true;\nthis._viewByTabId[e.tabParams.id]=a\n}var d=e.isAppView&&e.elements&&e.elements[ZmAppViewMgr.C_APP_CONTENT],c=d&&d.getHtmlElement();\nif(c){c.setAttribute(\"role\",\"main\")\n}return b\n};\nZmAppViewMgr.prototype.pushView=function(m,b){if(!m){return false\n}m=this._viewByTabId[m]||m;\nvar j=this._view[m]||this._emptyView;\nvar c=(m==ZmAppViewMgr.PENDING_VIEW);\nif(!c&&!j){return false\n}if(c){m=this._pendingView\n}var a=j.controller;\nif(m==this._currentViewId){if(a){a._restoreFocus()\n}return true\n}if(j.isTabView){var l=j.tabParams;\nvar g=l&&l.tabCallback&&l.tabCallback.run(this._currentViewId,m);\nif(l&&!g){var o=appCtxt.getAppChooser();\nvar f=o.getButton(l.id);\nif(!f){f=o.addButton(l.id,l);\nf.setHoverImage(\"Close\",\"right\")\n}}}if(c){b=true\n}var k=this._view[this._currentViewId]||this._emptyView;\nif(!this._hideView(this._currentViewId,b||k.isTabView,false,m)){this._pendingAction=this._pushCallback;\nthis._pendingView=m;\nreturn false\n}this.setViewComponents(m,j.component);\nvar h=k.controller;\nvar d=k.isTransient||(h&&h.isTransient(this._currentViewId,m));\nif(this._currentViewId&&(this._currentViewId!=m)&&!d){this._hidden.push(this._currentViewId)\n}this._removeFromHidden(m);\nvar n=this._lastViewId;\nthis._lastViewId=this._currentViewId;\nthis._currentViewId=m;\nif(!this._showView(m,b,(m!=this._currentViewId))){this._currentViewId=this._lastViewId;\nthis._lastViewId=n;\nthis._pendingAction=this._pushCallback;\nthis._pendingView=m;\nreturn false\n}if(this._noHistory){this._noHistory=false\n}else{if(m!=ZmId.VIEW_LOADING){this._nextHashIndex++;\nthis._curHashIndex=this._nextHashIndex;\nthis._hashViewId[this._curHashIndex]=m;\nif(this._historyMgr){this._historyMgr.add(this._curHashIndex)\n}}}this._layout(this._currentViewId);\nif(a&&a.setCurrentViewId){a.setCurrentViewId(m)\n}if(j.isAppView){this.setAppView(j.app,m)\n}if(this._toRemove.length){for(var e=0;\ne<this._toRemove.length;\ne++){this._removeFromHidden(this._toRemove[e])\n}this._toRemove=[]\n}return true\n};\nZmAppViewMgr.prototype.popView=function(b,h,e){h=this._viewByTabId[h]||h;\nvar f=this._view[h]||this._emptyView;\nif(!this._currentViewId){return false\n}var c=(b==ZmAppViewMgr.PENDING_VIEW);\nif(c){h=b;\nb=true\n}if(h&&!c&&(this._currentViewId!=h)){if(f.isTabView&&(this._currentViewId!=h)){this.pushView(h)\n}else{return false\n}}var j=false,d=false;\nvar a=null;\nvar g=this._view[this._currentViewId]||this._emptyView;\nif(!this._hidden.length&&!this._isNewWindow){j=!g.isTabView;\nd=true;\na=appCtxt.getCurrentAppName()||appCtxt.startApp\n}if(!this._hideView(this._currentViewId,b,j)){this._pendingAction=this._popCallback;\nthis._pendingView=null;\nreturn false\n}this._deactivateView(this._currentViewId);\nif(g.isTabView){appCtxt.getAppChooser().removeButton(g.tabParams.id);\nvar i=g.callback[ZmAppViewMgr.CB_POST_REMOVE];\nif(i){i.run()\n}}if(d){if(a){this._controller.activateApp(ZmApp.MAIL)\n}return !j\n}this._lastViewId=this._currentViewId;\nthis._currentViewId=this._hidden.pop();\nif(!this._currentViewId&&this._isNewWindow){window.close();\nreturn false\n}if(!this._showView(this._currentViewId,this._popCallback,null,b,true)){return false\n}this._removeFromHidden(this._currentViewId);\nif(this._historyMgr&&!e){if(this._noHistory){this._noHistory=false\n}else{this._ignoreHistoryChange=true;\nhistory.back()\n}}this._layout(this._currentViewId);\nreturn true\n};\nZmAppViewMgr.prototype.setView=function(b,d){var a=this.pushView(b,d);\nif(a){for(var c=0;\nc<this._hidden.length;\nc++){this._deactivateView(this._hidden[c])\n}this._hidden=[]\n}return a\n};\nZmAppViewMgr.prototype.stageView=function(a){this._removeFromHidden(a);\nthis._hidden.push(a)\n};\nZmAppViewMgr.prototype.isAppView=function(a){var b=this._view[a||this._currentViewId]||this._emptyView;\nreturn b.isAppView\n};\nZmAppViewMgr.prototype.isFullScreen=function(a){var b=this._view[a||this._currentViewId]||this._emptyView;\nreturn b.isFullScreen\n};\nZmAppViewMgr.prototype.showPendingView=function(a){if(a&&this._pendingAction){this._pendingAction.run(ZmAppViewMgr.PENDING_VIEW)\n}if(!a){if(this._browserAction==ZmAppViewMgr.BROWSER_BACK){this._ignoreHistoryChange=true;\nhistory.forward()\n}else{if(this._browserAction==ZmAppViewMgr.BROWSER_FORWARD){this._ignoreHistoryChange=true;\nhistory.back()\n}}this._browserAction=null\n}this._pendingAction=this._pendingView=null\n};\nZmAppViewMgr.prototype.fitAll=function(){this._shell.relayout();\nthis._fitToContainer(ZmAppViewMgr.ALL_COMPONENTS)\n};\nZmAppViewMgr.prototype.getPendingViewId=function(){return this._pendingView\n};\nZmAppViewMgr.prototype.updateTitle=function(){this._setTitle(this._currentViewId)\n};\nZmAppViewMgr.prototype.setTabTitle=function(a,e){var b=this._view[a||this._currentViewId]||this._emptyView;\nvar d=b.tabParams;\nvar c=!appCtxt.isChildWindow&&d&&appCtxt.getAppChooser().getButton(d.id);\nif(c){c.setText(AjxStringUtil.htmlEncode(e))\n}};\nZmAppViewMgr.prototype.isOkToUnload=function(){for(var a in this._view){var b=this._view[a];\nvar d=b&&b.callback&&b.callback[ZmAppViewMgr.CB_PRE_UNLOAD];\nif(d){var c=d.run(a);\nif(!c){return false\n}}}return true\n};\nZmAppViewMgr.prototype._createLoadingView=function(){this.loadingView=new DwtControl({parent:this._shell,className:\"DwtListView\",posStyle:Dwt.ABSOLUTE_STYLE,id:ZmId.LOADING_VIEW});\nvar a=this.loadingView.getHtmlElement();\na.innerHTML=AjxTemplate.expand(\"share.App#Loading\",this._htmlElId);\nvar b={};\nb[ZmAppViewMgr.C_APP_CONTENT]=this.loadingView;\nthis.createView({viewId:ZmId.VIEW_LOADING,elements:b})\n};\nZmAppViewMgr.prototype._fitToContainer=function(a,h){var a=AjxUtil.toArray(a);\nfor(var c=0;\nc<a.length;\nc++){var g=a[c];\nvar n=this.getContainer(g);\nif(n){var f=this.getViewComponent(g);\nif(f&&!this.isHidden(g,this._currentViewId)){var d=this._getComponentPosition(g);\nvar l=(d==Dwt.STATIC_STYLE);\nvar m=f.getHtmlElement();\nif(d){m.style.position=d\n}var k=this._component[g];\nif(l){if(m.parentNode!=n){n.appendChild(m)\n}if(f.adjustSize){f.adjustSize()\n}}else{var e=Dwt.getBounds(n);\nvar b=Dwt.getInsets(n);\nDwt.insetBounds(e,b);\nk.bounds=e;\nvar j=Boolean(this._component[ZmAppViewMgr.C_TOOLBAR_TOP].control);\nf.setBounds(e.x,e.y,e.width,e.height,j)\n}k.control=f\n}}}if(window.DBG&&DBG.getDebugLevel()>=AjxDebug.DBG2){this._debugShowMetrics(a)\n}};\nZmAppViewMgr.prototype._getComponentPosition=function(a){return appCtxt.getSkinHint(a,\"position\")\n};\nZmAppViewMgr.prototype._getContainerBounds=function(e){var a=this._getComponentPosition(e);\nif(a==Dwt.STATIC_STYLE){return null\n}var c=this.getContainer(e);\nif(c){var d=Dwt.getBounds(c);\nvar b=Dwt.getInsets(c);\nDwt.insetBounds(d,b);\nreturn d\n}return null\n};\nZmAppViewMgr.prototype._layout=function(b){if(this._hasSkin){return\n}var c=this.getViewComponent(ZmAppViewMgr.C_TOOLBAR_TOP);\nif(c){var e=c.getSize();\nvar a=e.y?e.y:c.getHtmlElement().clientHeight;\nc.setBounds(0,0,this._shellSz.x,a)\n}var d=this.getCurrentView();\nif(d){d.setBounds(0,a,this._shellSz.x,this._shellSz.y-a,Boolean(c))\n}};\nZmAppViewMgr.prototype._hideView=function(a,e,f,c){if(!a){return true\n}var b=this._view[a]||this._emptyView;\nvar d=true;\nvar g=b.callback[ZmAppViewMgr.CB_PRE_HIDE];\nif(g){d=g.run(a,e,c)\n}if(d){if(!f){this._setViewVisible(a,false)\n}if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){appCtxt.getKeyboardMgr().clearKeySeq()\n}g=b.callback[ZmAppViewMgr.CB_POST_HIDE];\nif(g){g.run(a,c)\n}}return d\n};\nZmAppViewMgr.prototype._showView=function(a,e,d){if(!a){return true\n}var b=this._view[a]||this._emptyView;\nvar c=true;\nvar f=b.callback[ZmAppViewMgr.CB_PRE_SHOW];\nif(f){c=f.run(a,d,e)\n}if(c){this._setViewVisible(a,true);\nf=b.callback[ZmAppViewMgr.CB_POST_SHOW];\nif(f){f.run(a,d)\n}}appCtxt.notifyZimlets(\"onShowView\",[a,d]);\nreturn c\n};\nZmAppViewMgr.prototype._setViewVisible=function(j,h){var g=this._view[j]||this._emptyView;\ng.visible=h;\nif(h){for(var c=0;\nc<ZmAppViewMgr.ALL_COMPONENTS.length;\nc++){var f=ZmAppViewMgr.ALL_COMPONENTS[c];\nvar e=this.getViewComponent(f,this._lastViewId);\nif(e){this.displayComponent(f,false,null,e,true)\n}var d=this.getViewComponent(f,j);\nif(d){this.displayComponent(f,!this.isHidden(f,j),null,d,true)\n}}if(this._hasSkin){this.fitAll()\n}this._setTitle(j);\nif(g.isTabView){var a=g.tabParams.id;\nthis._controller.setActiveTabId(a)\n}if(g.app){this._controller.setActiveApp(g)\n}}else{for(var f in g.component){this.showComponent(f,false)\n}var b=this._view[g.app];\nif(b){for(var f in b.component){this.showComponent(f,false)\n}}}};\nZmAppViewMgr.prototype._removeFromHidden=function(a){AjxUtil.arrayRemove(this._hidden,a)\n};\nZmAppViewMgr.prototype._deactivateView=function(a){a=a||this._currentViewId;\nvar b=this._view[a]||this._emptyView;\nfor(var d in b.component){var c=this.getViewComponent(d,a);\nif(c&&c.deactivate){c.deactivate()\n}}};\nZmAppViewMgr.prototype._setTitle=function(a){var b=this.getCurrentView();\nif(b&&b.getTitle){var c=b.getTitle();\nDwt.setTitle(c?c:ZmMsg.zimbraTitle)\n}};\nZmAppViewMgr.prototype._shellControlListener=function(d){if(d.oldWidth!=d.newWidth||d.oldHeight!=d.newHeight){this._shellSz.x=d.newWidth;\nthis._shellSz.y=d.newHeight;\nvar c=d.newWidth-d.oldWidth;\nvar f=d.newHeight-d.oldHeight;\nif(this._isNewWindow){var a=this._view[this._currentViewId]||this._emptyView;\nif(a.component){var b=a.component[ZmAppViewMgr.C_TOOLBAR_TOP];\nif(b){b.setSize(d.newWidth,Dwt.DEFAULT)\n}var e=this.getCurrentView();\nif(e){e.setSize(d.newWidth,d.newHeight-b.getH())\n}}}else{this.fitAll()\n}}};\nZmAppViewMgr.prototype._debugShowMetrics=function(d){for(var b=0;\nb<d.length;\nb++){var e=d[b];\nvar a=this.getContainer(e);\nif(a){var c=Dwt.getBounds(a)\n}}};\nZmAppViewMgr.prototype._historyChangeListener=function(c){if(appCtxt.inStartup){return\n}if(!(c&&c.data)){return\n}if(this._ignoreHistoryChange){this._ignoreHistoryChange=false;\nreturn\n}var d;\nwhile(d=DwtBaseDialog.getActiveDialog()){if(d&&d.isPoppedUp()){d.popdown()\n}}var b=parseInt(c.data);\nthis._noHistory=true;\nvar a=this._hashViewId[b];\nif(b==(this._curHashIndex-1)){this._browserAction=ZmAppViewMgr.BROWSER_BACK;\nthis.popView()\n}else{if(b==(this._curHashIndex+1)){this._browserAction=ZmAppViewMgr.BROWSER_FORWARD;\nthis.pushView(a)\n}else{this._browserAction=null;\nthis.pushView(a)\n}}this._curHashIndex=b\n};\nZmAppViewMgr.prototype._appTreeSashCallback=function(d){if(!window.skin){return\n}var a=skin.getTreeWidth();\nif(a===null){return 0\n}if(!this.treeMinSize){this.treeMinSize=DwtCssStyle.asPixelCount(window.skin.hints.tree.minWidth||150);\nthis.treeMaxSize=DwtCssStyle.asPixelCount(window.skin.hints.tree.maxWidth||1000)\n}if(a+d>this.treeMaxSize){d=Math.max(0,this.treeMaxSize-a)\n}if(a+d<this.treeMinSize){d=Math.min(0,this.treeMinSize-a)\n}var b=a+d;\nskin.setTreeWidth(b);\nvar c=this;\nsetTimeout(function(){c.fitAll()\n},0);\nreturn d\n}\n}if(AjxPackage.define(\"zimbraMail.core.ZmRequestMgr\")){ZmRequestMgr=function(a){this._controller=a;\nappCtxt.setRequestMgr(this);\nZmCsfeCommand.setServerUri(appCtxt.get(ZmSetting.CSFE_SERVER_URI));\nvar b=appCtxt.get(ZmSetting.CLIENT_VERSION);\nZmCsfeCommand.clientVersion=(!b||b.indexOf(\"@\")==0)?\"dev build\":b;\nthis._shell=appCtxt.getShell();\nthis._highestNotifySeen=0;\nthis._cancelActionId={};\nthis._pendingRequests={};\nthis._useXml=appCtxt.get(ZmSetting.USE_XML);\nthis._logRequest=appCtxt.get(ZmSetting.LOG_REQUEST);\nthis._stdTimeout=appCtxt.get(ZmSetting.TIMEOUT);\nthis._unreadListener=new AjxListener(this,this._unreadChangeListener)\n};\nZmRequestMgr.prototype.isZmRequestMgr=true;\nZmRequestMgr.prototype.toString=function(){return\"ZmRequestMgr\"\n};\nZmRequestMgr._SENT=1;\nZmRequestMgr._RESPONSE=2;\nZmRequestMgr._CANCEL=3;\nZmRequestMgr.RETRY_MAX=2;\nZmRequestMgr.RETRY_DELAY=5;\nZmRequestMgr.RETRY_ON_EXCEPTION={};\nZmRequestMgr.RETRY_ON_EXCEPTION[ZmCsfeException.EMPTY_RESPONSE]=true;\nZmRequestMgr._nextReqId=1;\nZmRequestMgr.OFFLINE_HEAP_DUMP=\"heapdump_upload\";\nZmRequestMgr.OFFLINE_MUST_RESYNC=\"resync\";\nZmRequestMgr.OFFLINE_MUST_GAL_RESYNC=\"gal_resync\";\nZmRequestMgr.OFFLINE_FOLDER_MOVE_FAILED=\"foldermove_failed\";\nZmRequestMgr.FOCUS_CHECK_DELAY=500;\nZmRequestMgr.prototype.sendRequest=function(q){var b=q.response;\nif(b){if(q.reqId){q=this._pendingRequests[q.reqId]||q;\nq.response=b\n}q.asyncMode=true;\nreturn this._handleResponseSendRequest(q,new ZmCsfeResult(b))\n}if(q.offlineRequest||appCtxt.isWebClientOffline()){if(q.offlineCallback){q.offlineCallback.run(q)\n}return\n}var l=q.reqId=(\"Req_\"+ZmRequestMgr._nextReqId++);\nvar g=q.timeout=(q.timeout!=null)?q.timeout:this._stdTimeout;\nif(g){g=g*1000\n}var r=q.asyncMode?new AjxCallback(this,this._handleResponseSendRequest,[q]):null;\nif(q.sensitive){var o=document.location.protocol==ZmSetting.PROTO_HTTP;\nvar d=appCtxt.get(ZmSetting.PROTOCOL_MODE)==ZmSetting.PROTO_MIXED;\nif(o&&d){return this._sensitiveRequest(q,l)\n}}var c=new ZmCsfeCommand();\nvar a=q.accountName;\nif(!a){var i=appCtxt.getActiveAccount();\na=(i&&i.id!=ZmAccountList.DEFAULT_ID)?i.name:null\n}var j=null;\nif(q.useChangeToken&&(!a||(a===appCtxt.accountList.mainAccount.name))){j=this._changeToken\n}var f,h;\nif(q.restUri){f={restUri:q.restUri,asyncMode:q.asyncMode,callback:r}\n}else{f={jsonObj:q.jsonObj,soapDoc:q.soapDoc,accountName:a,useXml:this._useXml,changeToken:j,asyncMode:q.asyncMode,callback:r,logRequest:this._logRequest,highestNotifySeen:this._highestNotifySeen,noAuthToken:true,skipAuthCheck:q.skipAuthCheck,resend:q.resend,noSession:q.noSession,useStringify1:(AjxEnv.isIE||AjxEnv.isModernIE)&&q.fromChildWindow,emptyResponseOkay:q.emptyResponseOkay};\nh=q.methodName=ZmCsfeCommand.getMethodName(f.jsonObj||f.soapDoc)\n}appCtxt.currentRequestParams=q;\nvar m=g?[l,q.errorCallback,q.noBusyOverlay]:null;\nif(!q.noBusyOverlay){var e=null;\nvar k=false;\nif(g){e=new AjxCallback(this,this.cancelRequest,m);\nthis._shell.setBusyDialogText(ZmMsg.askCancel);\nk=true\n}this._shell.setBusy(true,l,k,g,e)\n}else{if(g){var n=new AjxTimedAction(this,this.cancelRequest,m);\nthis._cancelActionId[l]=AjxTimedAction.scheduleAction(n,g)\n}}this._pendingRequests[l]=c;\ntry{var b=q.restUri?c.invokeRest(f):c.invoke(f);\nc.state=ZmRequestMgr._SENT\n}catch(p){this._handleResponseSendRequest(q,new ZmCsfeResult(p,true));\nreturn\n}return(q.asyncMode)?l:(this._handleResponseSendRequest(q,b))\n};\nZmRequestMgr.prototype._handleResponseSendRequest=function(b,l){var k=(b.response!=null);\nif(!k&&!appCtxt.isWebClientOffline()){if(!this._pendingRequests[b.reqId]){return\n}if(this._pendingRequests[b.reqId].state==ZmRequestMgr._CANCEL){return\n}this._pendingRequests[b.reqId].state=ZmRequestMgr._RESPONSE;\nif(!b.noBusyOverlay){this._shell.setBusy(false,b.reqId)\n}}var c,j;\ntry{if(b.asyncMode&&!b.restUri){c=l.getResponse()\n}else{if(l._isException){throw l._data\n}else{c=l\n}}if(c.Header){j=this._handleHeader(c.Header)\n}}catch(f){var a=b.errorCallback;\nif(a){var d=a.run(f,b);\nif(!d){this._handleException(f,b)\n}}else{var e=function(m,n){if(m&&(m.length>0)){for(var o in m){if(m[o]==n){return true\n}}}return false\n}(b.ignoreErrs,f.code);\nif(f.code===ZmCsfeException.EMPTY_RESPONSE&&b.offlineCallback){b.offlineCallback(b);\nif(appCtxt.isWebClientOffline()&&!b.noBusyOverlay){this._shell.setBusy(false,b.reqId)\n}e=true\n}if(!e){this._handleException(f,b)\n}}var i=l.getHeader();\nif(i){this._handleHeader(i);\nthis._handleNotifications(i)\n}this._clearPendingRequest(b.reqId);\nreturn\n}if(b.asyncMode&&!b.restUri){l.set(c.Body)\n}if(!appCtxt.isOffline&&!k){this._controller._kickPolling(true)\n}var g=ZmCsfeCommand.getMethodName(b.jsonObj||b.soapDoc);\nif(b.asyncMode&&b.callback){b.callback.run(l)\n}this._handleNotifications(c.Header,g);\nthis._clearPendingRequest(b.reqId);\nif(j&&(!appCtxt.isOffline||!appCtxt.multiAccounts)&&!b.more){this._refreshHandler(j)\n}if(!b.asyncMode){return c.Body\n}var h=this._controller;\nif(h._evtMgr&&h._evtMgr.isListenerRegistered(ZmAppEvent.RESPONSE)){h._evt.request=g;\nh.notify(ZmAppEvent.RESPONSE)\n}};\nZmRequestMgr.prototype.cancelRequest=function(d,a,b){if(!this._pendingRequests[d]){return\n}if(this._pendingRequests[d].state==ZmRequestMgr._RESPONSE){return\n}this._pendingRequests[d].state=ZmRequestMgr._CANCEL;\nif(!b){this._shell.setBusy(false,d)\n}this._pendingRequests[d].cancel();\nif(a){var c=new AjxException(\"Request canceled\",AjxException.CANCELED,\"ZmRequestMgr.prototype.cancelRequest\");\na.isAjxCallback?a.run(c):a(c)\n}this._clearPendingRequest(d)\n};\nZmRequestMgr.prototype._clearPendingRequest=function(c){var b=this._pendingRequests[c];\nif(b){if(b.iframeId){var a=document.getElementById(b.iframeId);\nif(a){a.parentNode.removeChild(a)\n}}delete this._pendingRequests[c]\n}var d=this._cancelActionId[c];\nif(d&&d!=-1){AjxTimedAction.cancelAction(d);\nthis._cancelActionId[c]=-1\n}};\nZmRequestMgr.prototype._handleHeader=function(f){var b=f&&f.context;\nif(!b){return\n}if(b.change){this._changeToken=b.change.token\n}if(b.zdsync&&b.zdsync.account){var a=b.zdsync.account;\nfor(var d=0;\nd<a.length;\nd++){var e=appCtxt.accountList.getAccount(a[d].id);\nif(e){var c=a[d].dialog;\nif(c){this._handleOfflineInfoDialog(c[0],e)\n}e.updateState(a[d])\n}}}if(b.refresh){this._controller.runAppFunction(\"_clearDeferredFolders\");\nthis._loadTrees(b.refresh);\nthis._controller.runAppFunction(\"_createVirtualFolders\");\nthis._highestNotifySeen=0\n}return b.refresh\n};\nZmRequestMgr.prototype._handleOfflineInfoDialog=function(c,d){if(!c.type){return\n}var a;\nswitch(c.type){case ZmRequestMgr.OFFLINE_HEAP_DUMP:a=ZmMsg.offlineHeapDump;\nbreak;\ncase ZmRequestMgr.OFFLINE_MUST_RESYNC:a=AjxMessageFormat.format(ZmMsg.offlineMustReSync,d.name);\nbreak;\ncase ZmRequestMgr.OFFLINE_MUST_GAL_RESYNC:a=AjxMessageFormat.format(ZmMsg.offlineMustGalReSync,d.name);\nbreak;\ncase ZmRequestMgr.OFFLINE_FOLDER_MOVE_FAILED:appCtxt.setStatusMsg(ZmMsg.offlineMoveFolderError);\nbreak;\ndefault:}if(!a){return\n}var b=appCtxt.getOkCancelMsgDialog();\nb.setMessage(a);\nb.registerCallback(DwtDialog.OK_BUTTON,this._handleOfflineDialogAction,this,[b,c.type,d.id,true]);\nb.registerCallback(DwtDialog.CANCEL_BUTTON,this._handleOfflineDialogAction,this,[b,c.type,d.id,false]);\nb.popup()\n};\nZmRequestMgr.prototype._handleOfflineDialogAction=function(e,c,b,d){var a={jsonObj:{DialogActionRequest:{_jsns:\"urn:zimbraOffline\",type:c,id:b,action:d?\"yes\":\"no\"}},callback:new AjxCallback(this,this._handleOfflineDialogActionResp,e),errorCallback:new AjxCallback(this,this._handleOfflineDialogActionResp,e),asyncMode:true};\nthis.sendRequest(a)\n};\nZmRequestMgr.prototype._handleOfflineDialogActionResp=function(b,a){if(b.isPoppedUp()){b.popdown()\n}};\nZmRequestMgr.prototype._handleException=function(a,c){var b=false;\nif(ZmRequestMgr.RETRY_ON_EXCEPTION[a.code]){c.retryCount=c.retryCount||0;\nif(c.retryCount<ZmRequestMgr.RETRY_MAX){c.resend=ZmCsfeCommand.RETRY;\nc.retryCount++;\nAjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){this.sendRequest(c)\n}),ZmRequestMgr.RETRY_DELAY*1000);\nb=true\n}}if(!b){this._controller._handleException(a,c)\n}};\nZmRequestMgr.prototype._handleNotifications=function(f,c){if(f&&f.context&&f.context.notify){for(var e=0;\ne<f.context.notify.length;\ne++){var d=f.context.notify[e];\nvar b=d.seq;\nvar a=f.context&&ZmCsfeCommand.extractSessionId(f.context.session);\nif(d.seq>this._highestNotifySeen&&!(a&&ZmCsfeCommand._staleSession[a])){this._highestNotifySeen=b;\nthis._notifyHandler(d,c)\n}else{}}}};\nZmRequestMgr.prototype._refreshHandler=function(a){AjxDebug.println(AjxDebug.NOTIFY,\"REFRESH block received\");\nif(!appCtxt.inStartup){this._controller._execPoll()\n}if(a.version){if(!this._canceledReload){var d=appCtxt.get(ZmSetting.SERVER_VERSION);\nif(d!=a.version){appCtxt.set(ZmSetting.SERVER_VERSION,a.version);\nif(d){var c=appCtxt.getYesNoMsgDialog();\nc.reset();\nc.registerCallback(DwtDialog.YES_BUTTON,this._reloadYesCallback,this,[c,d,a.version]);\nc.registerCallback(DwtDialog.NO_BUTTON,this._reloadNoCallback,this,[c,a]);\nvar b=AjxMessageFormat.format(ZmMsg.versionChangeRestart,[d,a.version]);\nc.setMessage(b,DwtMessageDialog.WARNING_STYLE);\nc.popup();\nappCtxt.reloadAppCache(true);\nreturn\n}}}}if(!this._recentlyRefreshed){this._controller.runAppFunction(\"refresh\",false,a);\nthis._recentlyRefreshed=true;\nthis._lastSkippedRefresh=null\n}else{this._lastSkippedRefresh=a\n}if(!this._refreshTimer){this._refreshTimer=new AjxTimedAction(this,this._refreshTimeout)\n}AjxTimedAction.scheduleAction(this._refreshTimer,5000)\n};\nZmRequestMgr.prototype._refreshTimeout=function(){if(this._lastSkippedRefresh){this._controller.runAppFunction(\"refresh\",false,this._lastSkippedRefresh);\nthis._lastSkippedRefresh=null\n}this._recentlyRefreshed=false\n};\nZmRequestMgr.prototype._loadTrees=function(c){var b={};\nvar a=appCtxt.multiAccounts?appCtxt.accountList.mainAccount:null;\nthis._loadTree(ZmOrganizer.TAG,b,c.tags,null,a);\nthis._loadTree(ZmOrganizer.FOLDER,b,c.folder[0],\"folder\",a);\nthis._loadHabTree()\n};\nZmRequestMgr.prototype._loadHabTree=function(){var b=appCtxt.get(ZmSetting.HAB_ROOT);\nif(!b&&b.length===0){return\n}var c=b[0];\nif(c){var a=c._content;\nvar d={_jsns:\"urn:zimbraAccount\",ownerOf:1,habRootGroupId:a};\nvar f={GetHABRequest:d};\nvar e=this._handleHABResponse.bind(this,a);\nappCtxt.getAppController().sendRequest({jsonObj:f,asyncMode:true,callback:e})\n}};\nZmRequestMgr.prototype._handleHABResponse=function(c,a){var d=a._data.GetHABResponse.ou[0];\nvar b=d.habGroup[0];\nb.id=c;\nthis._loadTree(\"HAB\",{},b,\"hab\",null)\n};\nZmRequestMgr.prototype._reloadYesCallback=function(b){b.popdown();\nwindow.onbeforeunload=null;\nvar a=AjxUtil.formatUrl();\nZmZimbraMail.sendRedirect(a)\n};\nZmRequestMgr.prototype._reloadNoCallback=function(a,b){a.popdown();\nthis._canceledReload=true;\nthis._refreshHandler(b)\n};\nZmRequestMgr.prototype._loadTree=function(c,b,f,g,e){var d=(c==ZmOrganizer.TAG);\nvar a=appCtxt.getTree(c,e);\nif(a){a.reset()\n}else{a=d?new ZmTagTree(e):new ZmFolderTree()\n}appCtxt.setTree(c,a,e);\na.addChangeListener(this._unreadListener);\na.getUnreadHash(b);\na.loadFromJs(f,g,e)\n};\nZmRequestMgr.prototype._notifyHandler=function(b,a){AjxDebug.println(AjxDebug.NOTIFY,\"Notification block:\");\nAjxDebug.dumpObj(AjxDebug.NOTIFY,b);\nthis._controller.runAppFunction(\"preNotify\",false,b);\nif(b.deleted&&b.deleted.id){this._handleDeletes(b.deleted)\n}if(b.created){this._handleCreates(b.created)\n}if(b.modified){this._handleModifies(b.modified)\n}if(ZmOffline.isOnlineMode()&&(b.deleted||b.created||b.modified)){appCtxt.webClientOfflineHandler.scheduleSyncRequest(b,a)\n}this._controller.runAppFunction(\"postNotify\",false,b)\n};\nZmRequestMgr.prototype._handleDeletes=function(d){var b=d.id.split(\",\");\nthis._controller.runAppFunction(\"deleteNotify\",false,b);\nfor(var a=0;\na<b.length;\na++){var e=b[a];\nif(!e){continue\n}var c=appCtxt.cacheGet(e);\nif(c&&c.notifyDelete){c.notifyDelete();\nappCtxt.cacheRemove(e);\nc=null\n}}};\nZmRequestMgr.prototype._handleCreates=function(h){this._controller.runAppFunction(\"createNotify\",false,h);\nfor(var a in h){if(h.hasOwnProperty(a)){var g=h[a];\nfor(var c=0;\nc<g.length;\nc++){var e=g[c];\nif(e._handled){continue\n}if(appCtxt.cacheGet(e.id)&&a!=\"tag\"){continue\n}if(a==\"tag\"){var f=appCtxt.multiAccounts&&ZmOrganizer.parseId(e.id).account;\nvar b=appCtxt.getTagTree(f);\nif(b){b.root.notifyCreate(e)\n}}else{if(a==\"folder\"||a==\"search\"||a==\"link\"){var d=e.l;\nvar j=appCtxt.getById(d);\nif(j&&j.notifyCreate&&j.type!=ZmOrganizer.TAG){j.notifyCreate(e,a)\n}}}}}}};\nZmRequestMgr.prototype._handleModifies=function(c){this._controller.runAppFunction(\"modifyNotify\",false,c);\nfor(var b in c){if(b==\"mbx\"){var k=c[b];\nfor(var e=0;\ne<k.length;\ne++){var a=k[e];\nvar j=a.acct;\nvar f=j&&appCtxt.accountList.getAccount(j);\nvar m=appCtxt.getSettings(f).getSetting(ZmSetting.QUOTA_USED);\nm.notifyModify({_name:b,s:a.s,account:f})\n}continue\n}var g=c[b];\nfor(var e=0;\ne<g.length;\ne++){var h=g[e];\nif(h._handled){continue\n}var l=appCtxt.cacheGet(h.id);\nif(!l&&b==\"cn\"&&AjxDispatcher.loaded(\"ContactsCore\")){var d=appCtxt.getApp(ZmApp.CONTACTS);\nif(d.isContactListLoaded()){l=d.getContactList().getById(h.id)\n}}if(l&&l.notifyModify){h._isRemote=(b==\"folder\"&&l.link);\nl.notifyModify(h)\n}}}};\nZmRequestMgr.prototype._unreadChangeListener=function(f){if(f.event==ZmEvent.E_MODIFY){var e=f.getDetail(\"fields\");\nif(e&&e[ZmOrganizer.F_UNREAD]){var c=f.getDetail(\"organizers\");\nvar g=c?c[0]:null;\nvar a=g?(g.isSystem()?g.nId:g.id):null;\nvar i=appCtxt.getCurrentSearch();\nif(i){var d=appCtxt.multiAccounts&&appCtxt.getById(i.folderId);\nvar b=(d&&d.getAccount()==appCtxt.getActiveAccount())?d.nId:i.folderId;\nif(a&&(a==b||a==i.tagId)){Dwt.setTitle(i.getTitle())\n}}var h=appCtxt.getApp(ZmApp.MAIL);\nif(h){h.setNewMailNotice(g)\n}}}};\nZmRequestMgr.prototype._sensitiveRequest=function(h,e){h.noSession=true;\nh.noAuthToken=true;\nvar a=ZmCsfeCommand.getRequestStr(h);\nvar g=document.location;\nvar b=appCtxt.get(ZmSetting.HTTPS_PORT);\nif(b&&b!=ZmSetting.DEFAULT_HTTPS_PORT){b=\":\"+b\n}var c=document.createElement(\"IFRAME\");\nc.style.display=\"none\";\nc.id=Dwt.getNextId();\ndocument.body.appendChild(c);\nvar f=Dwt.getIframeDoc(c);\nf.write(\"<form \",\"id=\",c.id,\"-form \",\"target=\",c.id,\"-iframe \",\"method=POST \",\"action='https://\",g.hostname,b,appContextPath,\"/public/secureRequest.jsp'\",\">\",\"<input type=hidden name=reqId value='\",e,\"'>\",\"<textarea name=data>\",AjxStringUtil.htmlEncode(a),\"</textarea>\",\"</form>\",\"<iframe name=\",c.id,\"-iframe></iframe>\");\nf.close();\nh.iframeId=c.id;\nthis._pendingRequests[e]=h;\nvar d=f.getElementById(c.id+\"-form\");\nd.submit()\n}\n}if(AjxPackage.define(\"zimbraMail.core.ZmZimbraMail\")){ZmZimbraMail=function(e){if(arguments.length==0){return\n}ZmController.call(this,null);\nappCtxt.setZimbraMail(this);\nappCtxt.setAppController(this);\nwindow._zimbraMail=this;\nthis._evt=new ZmAppEvent();\nthis._evtMgr=new AjxEventMgr();\nfor(var b in ZmZimbraMail._listeners){var d=ZmZimbraMail._listeners[b];\nif(d&&d.length){for(var a=0;\na<d.length;\na++){this._evtMgr.addListener(b,d[a])\n}}}ZmZimbraMail.addListener=AjxCallback.simpleClosure(this.addListener,this);\nZmZimbraMail.addAppListener=AjxCallback.simpleClosure(this.addAppListener,this);\nZmOperation.initialize();\nthis._createSettings(e);\nthis._createEnabledApps();\nthis._initializeSettings(e);\nthis._postInitializeSettings();\ndocument.body.className=\"user_font_\"+appCtxt.get(ZmSetting.FONT_NAME);\nDwt.delClass(document.documentElement,\"user_font_size_normal\",\"user_font_size_\"+appCtxt.get(ZmSetting.FONT_SIZE));\nthis._shell=appCtxt.getShell();\nthis._userShell=e.userShell;\nthis._requestMgr=new ZmRequestMgr(this);\nthis._appIframeView={};\nthis._activeApp=null;\nthis._sessionTimer=new AjxTimedAction(null,ZmZimbraMail.executeSessionTimer);\nthis._sessionTimerId=-1;\nthis._pollActionId=null;\nthis._pollRequest=null;\nthis._pollInstantNotifications=false;\nthis.statusView=null;\nZmZimbraMail._exitTimer=new AjxTimedAction(null,ZmZimbraMail.exitSession);\nZmZimbraMail._exitTimerId=-1;\nZmZimbraMail.stayOnPagePrompt=false;\nZmZimbraMail.STAYONPAGE_INTERVAL=2;\nif(appCtxt.get(ZmSetting.HISTORY_SUPPORT_ENABLED)&&!AjxEnv.isSafari){window.historyMgr=appCtxt.getHistoryMgr()\n}this._appViewMgr=new ZmAppViewMgr(this._shell,this,false,true);\nvar c=[ZmAppViewMgr.C_SEARCH_RESULTS_TOOLBAR,ZmAppViewMgr.C_TASKBAR];\nif(!appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL)){c.push(ZmAppViewMgr.C_TREE_FOOTER)\n}this._appViewMgr.setHiddenComponents(ZmAppViewMgr.GLOBAL,c,true);\nAjxDispatcher.setPackageLoadFunction(\"Zimlet\",new AjxCallback(this,this._postLoadZimlet));\nAjxDispatcher.setPreLoadFunction(new AjxCallback(this,function(){this._appViewMgr.pushView(ZmId.VIEW_LOADING)\n}));\nAjxDispatcher.setPostLoadFunction(new AjxCallback(this,function(){if(!AjxUtil.arrayContains(this._appViewMgr._toRemove,ZmId.VIEW_LOADING)){this._appViewMgr._toRemove.push(ZmId.VIEW_LOADING)\n}}));\nfor(var a in ZmApp.QS_ARG){ZmApp.QS_ARG_R[ZmApp.QS_ARG[a]]=a\n}this._shell.addGlobalSelectionListener(new AjxListener(this,this._globalSelectionListener));\nappCtxt.initWebOffline();\nthis.startup(e)\n};\nZmZimbraMail.prototype=new ZmController;\nZmZimbraMail.prototype.constructor=ZmZimbraMail;\nZmZimbraMail.prototype.isZmZimbraMail=true;\nZmZimbraMail.prototype.toString=function(){return\"ZmZimbraMail\"\n};\nZmMsg.BETA_documents=[ZmMsg.documents,ZmMsg.beta].join(\" \");\nZmApp.MAIN=\"ZmZimbraMail\";\nZmApp.DROP_TARGETS[ZmApp.MAIN]={};\nZmZimbraMail._listeners={};\nZmZimbraMail.UI_LOAD_BEGIN=\"ui_load_begin\";\nZmZimbraMail.UI_LOAD_END=\"ui_load_end\";\nZmZimbraMail.UI_NETWORK_UP=\"network_up\";\nZmZimbraMail.UI_NETWORK_DOWN=\"network_down\";\nZmZimbraMail.run=function(c){if(c.noSplashScreen){ZmZimbraMail.killSplash()\n}window.appCtxt=new ZmAppCtxt();\nappCtxt.rememberMe=false;\nif(c.offlineMode){appCtxt.isOffline=true\n}var b=c.userShell=window.document.getElementById(ZmId.SKIN_SHELL);\nif(!b){alert(\"Could not get user shell - skin file did not load properly\")\n}var a=new DwtShell({userShell:b,docBodyScrollable:false,id:ZmId.SHELL});\nappCtxt.setShell(a);\nnew ZmZimbraMail(c)\n};\nZmZimbraMail.unload=function(){if(!ZmZimbraMail._endSessionDone){ZmZimbraMail._endSession()\n}if(ZmZimbraMail._isLogOff){ZmZimbraMail._isLogOff=false;\nif(window._zimbraMail){window._zimbraMail.setSessionTimer(false)\n}ZmCsfeCommand.noAuth=true\n}ZmZimbraMail.closeChildWindows();\nZmZimbraMail.stayOnPagePrompt=false;\nZmZimbraMail.setExitTimer(false);\nZmZimbraMail.sessionTimerInvoked=false;\nwindow._zimbraMail=window.onload=window.onunload=window.onresize=window.document.onkeypress=null\n};\nZmZimbraMail.closeChildWindows=function(){var b=window._zimbraMail&&window._zimbraMail._childWinList;\nif(b){for(var a=0;\na<b.size();\na++){var c=b.get(a);\nif(c.win){c.win.onbeforeunload=null;\nc.win.parentController=null;\nc.win.close()\n}}}};\nZmZimbraMail.hashSortCompare=function(g,e,c){var f=e?Number(g[e]):0;\nvar d=c?Number(g[c]):0;\nif(f>d){return 1\n}if(f<d){return -1\n}return 0\n};\nZmZimbraMail.killSplash=function(){Dwt.hide(\"skin_container_splash_screen\")\n};\nZmZimbraMail.hasSessionEnded=function(){return ZmZimbraMail._endSessionDone\n};\nZmZimbraMail.prototype.startup=function(d){if(appCtxt.isOffline){this.sendClientEventNotify(ZmZimbraMail.UI_LOAD_BEGIN)\n}appCtxt.inStartup=true;\nif(typeof(skin)==\"undefined\"){}skin.show(\"skin\",true);\nappCtxt.getShell().relayout();\nif(!this._components){this._components={};\nthis._components[ZmAppViewMgr.C_SASH]=new DwtSash({parent:this._shell,style:DwtSash.HORIZONTAL_STYLE,className:\"console_inset_app_l\",threshold:20,id:ZmId.MAIN_SASH});\nthis._components[ZmAppViewMgr.C_SASH].addListener(DwtEvent.ONMOUSEUP,ZmZimbraMail._folderTreeSashRelease);\nthis._components[ZmAppViewMgr.C_BANNER]=this._createBanner();\nthis._components[ZmAppViewMgr.C_USER_INFO]=this._userNameField=this._createUserInfo(\"BannerTextUser\",ZmAppViewMgr.C_USER_INFO,ZmId.USER_NAME);\nthis._components[ZmAppViewMgr.C_QUOTA_INFO]=this._usedQuotaField=this._createUserInfo(\"BannerTextQuota\",ZmAppViewMgr.C_QUOTA_INFO,ZmId.USER_QUOTA);\nif(appCtxt.isOffline){this._initOfflineUserInfo()\n}}if(!this.statusView){this.statusView=new ZmStatusView(this._shell,\"ZmStatus\",Dwt.ABSOLUTE_STYLE,ZmId.STATUS_VIEW)\n}this._registerOrganizers();\nfor(var a in ZmSearch.TYPE){ZmSearch.TYPE_MAP[ZmSearch.TYPE[a]]=a\n}ZmZimbraMail.registerViewsToTypeMap();\nthis._getStartApp(d);\nappCtxt.startApp=d.startApp;\nthis._postRenderCallbacks=[];\nthis._postRenderLast=0;\nif(d.startApp==ZmApp.MAIL){this._doingPostRenderStartup=true;\nvar f=new AjxCallback(this,function(){AjxDispatcher.require(\"Startup2\");\nvar g=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nif(appCtxt.get(ZmSetting.CALENDAR_ENABLED,null,g)){this.handleCalendarComponents()\n}if(appCtxt.get(ZmSetting.TASKS_ENABLED,null,g)){this.handleTaskComponents()\n}this._appViewMgr.loadingView.setVisible(false)\n});\nthis.addPostRenderCallback(f,0,0,true);\nvar f=new AjxCallback(this,function(){AjxDispatcher.require(\"Startup2\");\nvar g=new DwtIdleTimer(30*1000,function(){AjxDispatcher.require(\"TinyMCE\",true);\ng.kill()\n})\n});\nthis.addPostRenderCallback(f,0,0,true)\n}var c=AjxUtil.get(d,\"getInfoResponse\");\nif(c){this._requestMgr.sendRequest({response:c})\n}var e=new AjxCallback(this,this._handleResponseGetMetaData,d);\nappCtxt.accountList.mainAccount.loadMetaData(e);\nthis._initDelegatedSenderAddrs();\nif(appCtxt.isOffline){var b=appCtxt.get(ZmSetting.OFFLINE_UPDATE_NOTIFY);\nthis._offlineUpdateChannelPref(b)\n}};\nZmZimbraMail.prototype._initDelegatedSenderAddrs=function(){var b=AjxSoapDoc.create(\"DiscoverRightsRequest\",\"urn:zimbraAccount\");\nb.set(\"right\",\"sendAs\");\nb.set(\"right\",\"sendOnBehalfOf\");\nb.set(\"right\",\"sendAsDistList\");\nb.set(\"right\",\"sendOnBehalfOfDistList\");\nvar a=new ZmBatchCommand(null,appCtxt.accountList.mainAccount.name);\nvar d=this._initDelegatedSenderEmails.bind(this);\na.addNewRequestParams(b,d,d);\nvar c=this._handleOfflineDelegatedSenderEmails.bind(this,d);\na.run(null,null,c)\n};\nZmZimbraMail.prototype._getDelegatedSenderEmails=function(p,n){var f=[];\nif(!p||!p.length){return f\n}for(var d=0;\nd<p.length;\nd++){var g=p[d].target;\nvar o=p[d].right;\nvar e=n+\"DistList\";\nif(o!==n&&o!==e){continue\n}var l=o===e;\nfor(var c=0;\nc<g.length;\nc++){var h=g[c];\nvar b=h.email;\nfor(var a=0;\na<b.length;\na++){var m=b[a].addr;\nf.push({addr:m,isDL:l,displayName:h.d})\n}}}return f\n};\nZmZimbraMail.prototype._initDelegatedSenderEmails=function(a){var b=a.getResponse();\nif(ZmOffline.isOnlineMode()){localStorage.setItem(\"DiscoverRightsResponse\",JSON.stringify(b))\n}var d=b&&b.DiscoverRightsResponse;\nvar c=d&&d.targets;\nappCtxt.sendAsEmails=this._getDelegatedSenderEmails(c,\"sendAs\");\nappCtxt.sendOboEmails=this._getDelegatedSenderEmails(c,\"sendOnBehalfOf\")\n};\nZmZimbraMail.prototype._handleOfflineDelegatedSenderEmails=function(c){var a=localStorage.getItem(\"DiscoverRightsResponse\");\nif(a){var b=new ZmCsfeResult({BatchResponse:JSON.parse(a)});\nc.run(b)\n}};\nZmZimbraMail.registerViewsToTypeMap=function(){for(var b in ZmOrganizer.VIEWS){var c=ZmOrganizer.VIEWS[b];\nfor(var a=0;\na<c.length;\na++){ZmOrganizer.TYPE[c[a]]=b\n}}};\nZmZimbraMail.prototype._createSettings=function(e){if(e.batchInfoResponse){var b=e.batchInfoResponse.Body.BatchResponse;\nvar c=b.GetInfoResponse[0];\nif(!c){c={}\n}c.domainSettings=e.settings;\ne.getInfoResponse={Header:e.batchInfoResponse.Header,Body:{GetInfoResponse:c}};\nvar d=AjxUtil.get(e.getInfoResponse,\"Header\",\"context\",\"session\");\nif(d){ZmCsfeCommand.setSessionId(d)\n}if(b.SearchResponse){e.searchResponse={Body:{SearchResponse:b.SearchResponse[0]}}\n}}var a=new ZmSettings();\nappCtxt.setSettings(a);\na.setUserSettings({info:e.getInfoResponse.Body.GetInfoResponse,preInit:true})\n};\nZmZimbraMail.prototype._initializeSettings=function(f){var e=f.getInfoResponse.Body.GetInfoResponse;\nvar c=appCtxt.getSettings();\nc.setUserSettings(e,null,true,true,true);\nc.userSettingsLoaded=true;\nvar b=appCtxt.get(ZmSetting.BRANCH);\nif(window.DBG&&!DBG.isDisabled()){}if(f.settings){for(var a in f.settings){var g=c.getSettingByName(a);\nif(g){c.getSetting(g).setValue(f.settings[a])\n}}}if(appCtxt.isOffline){appCtxt.set(ZmSetting.POLLING_INTERVAL,60,null,null,true)\n}if(f.devMode==\"1\"){appCtxt.set(ZmSetting.DEV,true)\n}if(f.protocolMode){var d=(f.protocolMode.indexOf(\":\")==-1)?f.protocolMode+\":\":f.protocolMode;\nappCtxt.set(ZmSetting.PROTOCOL_MODE,d)\n}if(f.httpPort){appCtxt.set(ZmSetting.HTTP_PORT,f.httpPort)\n}if(f.httpsPort){appCtxt.set(ZmSetting.HTTPS_PORT,f.httpsPort)\n}if(!appCtxt.get(ZmSetting.SPAM_ENABLED)){ZmFolder.HIDE_ID[ZmFolder.ID_SPAM]=true\n}if(appCtxt.get(ZmSetting.SHOW_CHATS_FOLDER)){delete ZmFolder.HIDE_ID[ZmOrganizer.ID_CHATS]\n}};\nZmZimbraMail.prototype._postInitializeSettings=function(){this._setCustomInvalidEmailPats()\n};\nZmZimbraMail.prototype._setCustomInvalidEmailPats=function(){var d=appCtxt.getSettings().getSetting(ZmSetting.EMAIL_VALIDATION_REGEX);\nvar a=[];\nif(d){a=d.value\n}for(var c=0;\nc<a.length;\nc++){var b=a[c];\nif(b&&b!=\"\"){AjxEmailAddress.customInvalidEmailPats.push(new RegExp(b))\n}}};\nZmZimbraMail.prototype._handleResponseGetMetaData=function(a){if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){var b=appCtxt.multiAccounts?\"GetContactsForAllAccounts\":\"GetContacts\";\nAjxDispatcher.run({method:b,callback:this._handleResponseLoadUserSettings.bind(this,a)})\n}else{this._handleResponseLoadUserSettings(a)\n}};\nZmZimbraMail.prototype.showMiniCalendar=function(){var a=appCtxt.getCalManager();\na.getMiniCalendar();\nappCtxt.getAppViewMgr().displayComponent(ZmAppViewMgr.C_TREE_FOOTER,true);\na.highlightMiniCal();\na.startDayRollTimer()\n};\nZmZimbraMail.prototype.showReminder=function(){var a=appCtxt.getApp(ZmApp.CALENDAR).getReminderController();\na.refresh()\n};\nZmZimbraMail.prototype.showTaskReminder=function(){var b=appCtxt.getTaskManager();\nvar a=b.getReminderController();\na.refresh()\n};\nZmZimbraMail.prototype._isProtocolHandlerAccessed=function(){if(AjxEnv.isFirefox){if(!localStorage||localStorage.zimbra_mailto_init){return true\n}localStorage.zimbra_mailto_init=true\n}return false\n};\nZmZimbraMail.prototype._handleResponseLoadUserSettings=function(b,a){if(appCtxt.multiAccounts){var c=new AjxCallback(this,this._handleResponseStartup,[b,a]);\nappCtxt.accountList.loadAccounts(c)\n}else{this._handleResponseStartup(b,a)\n}};\nZmZimbraMail.prototype._handleResponseStartup=function(d,q){d=d||{};\nif(d.settingOverrides){this._needOverviewLayout=true;\nfor(var a in d.settingOverrides){var p=appCtxt.getSetting(a);\nif(p){p.setValue(d.settingOverrides[a])\n}}}if(d.preset){var g=d.preset.split(\",\");\nfor(var f=0;\nf<g.length;\nf++){var j=g[f].split(\":\");\nvar p=appCtxt.getSettings().getSetting(j[0]);\nif(p&&p.canPreset){p.setValue(j[1])\n}}}if(!appCtxt.isOffline){if(appCtxt.get(ZmSetting.INSTANT_NOTIFY)&&appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL)==appCtxt.get(ZmSetting.POLLING_INTERVAL)){AjxTimedAction.scheduleAction(new AjxTimedAction(this,this.setInstantNotify,[true]),4000)\n}else{this.setPollInterval(true)\n}}else{if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&window.platform&&window.platform.isRegisteredProtocolHandler(\"mailto\")){this.registerMailtoHandler(!AjxEnv.isWindows,true)\n}}window.onbeforeunload=ZmZimbraMail._confirmExitMethod;\nif(!this._components[ZmAppViewMgr.C_APP_CHOOSER]){this._components[ZmAppViewMgr.C_APP_CHOOSER]=this._appChooser=this._createAppChooser()\n}ZmApp.initialize();\nif(appCtxt.get(ZmSetting.DEFAULT_TIMEZONE)){AjxTimezone.DEFAULT_RULE=AjxTimezone._guessMachineTimezone(appCtxt.get(ZmSetting.DEFAULT_TIMEZONE));\nAjxTimezone.DEFAULT=AjxTimezone.getClientId(AjxTimezone.DEFAULT_RULE.serverId)\n}this.notify(ZmAppEvent.PRE_STARTUP);\nd.result=q;\nvar o=new AjxCallback(this,this._handleResponseStartup1,d);\nif(this._doingPostRenderStartup){this.addAppListener(d.startApp,ZmAppEvent.POST_RENDER,new AjxListener(this,this._postRenderStartup));\nif(!appCtxt.isWebClientOffline()){this._searchResponse=d.searchResponse\n}}else{AjxDispatcher.require(\"Startup2\")\n}var n=new AjxCallback(this,function(){this.runAppFunction(\"startup\",false,d.result)\n});\nthis.addPostRenderCallback(n,2,0,true);\nn=new AjxCallback(this,function(){this._setupTabGroups();\nthis.focusContentPane()\n});\nthis.addPostRenderCallback(n,3,100);\nn=new AjxCallback(this,function(){AjxDispatcher.enableLoadFunctions(true);\nappCtxt.inStartup=false;\nthis.notify(ZmAppEvent.POST_STARTUP);\nvar i=appCtxt.getSearchController();\ni.getSearchToolbar().initAutocomplete();\nif(appCtxt.isOffline){i.resetSearchToolbar()\n}if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&appCtxt.isOffline){this.handleOfflineMailTo(location.search)\n}});\nthis.addPostRenderCallback(n,5,100);\nif(appCtxt.get(ZmSetting.MAIL_ENABLED)&&!appCtxt.isExternalAccount()&&navigator.registerProtocolHandler&&!this._isProtocolHandlerAccessed()){n=new AjxCallback(this,function(){try{navigator.registerProtocolHandler(\"mailto\",AjxUtil.formatUrl({qsArgs:{view:\"compose\",to:\"%s\"},qsReset:true}),ZmMsg.zimbraTitle)\n}catch(i){}});\nthis.addPostRenderCallback(n,6,100)\n}this.activateApp(d.startApp,false,o,this._errorCallback,d);\nvar k=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nif(appCtxt.get(ZmSetting.CALENDAR_ENABLED,null,k)&&!this._doingPostRenderStartup&&(d.startApp!=ZmApp.CALENDAR)){this.handleCalendarComponents()\n}if(appCtxt.get(ZmSetting.TASKS_ENABLED,null,k)&&!this._doingPostRenderStartup&&(d.startApp!=ZmApp.TASKS)){this.handleTaskComponents()\n}if(appCtxt.get(ZmSetting.IMPORT_ON_LOGIN_ENABLED)){var b=new ZmDataSourceCollection();\nvar l=appCtxt.getDataSourceCollection();\nvar m=l&&l.getPopAccounts();\nvar e=l&&l.getImapAccounts();\nvar h={};\nif(m){for(var f=0;\nf<m.length;\nf++){h[m[f].id]=m[f]\n}}if(e){for(var f=0;\nf<e.length;\nf++){h[e[f].id]=e[f]\n}}if(m||e){var c=new AjxTimedAction(b,b.checkStatus,[h,2000]);\nAjxTimedAction.scheduleAction(c,10000)\n}}};\nZmZimbraMail.prototype.handleTaskComponents=function(){var b=new AjxTimedAction(this,this.showTaskReminder);\nvar a=appCtxt.isOffline?0:ZmTasksApp.REMINDER_START_DELAY;\nAjxTimedAction.scheduleAction(b,a)\n};\nZmZimbraMail.prototype.handleCalendarComponents=function(){if(appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL)){var c=new AjxTimedAction(this,this.showMiniCalendar);\nvar a=appCtxt.isOffline?0:ZmCalendarApp.MINICAL_DELAY;\nAjxTimedAction.scheduleAction(c,a)\n}AjxDispatcher.require([\"ContactsCore\",\"MailCore\",\"CalendarCore\",\"Calendar\"]);\nvar b=new AjxTimedAction(this,this.showReminder);\nvar a=appCtxt.isOffline?0:ZmCalendarApp.REMINDER_START_DELAY;\nAjxTimedAction.scheduleAction(b,a)\n};\nZmZimbraMail.prototype._handleResponseStartup1=function(e){this._setExternalLinks();\nthis.setUserInfo();\nthis._setRefresh();\nif(appCtxt.get(ZmSetting.SEARCH_ENABLED)){this._components[ZmAppViewMgr.C_SEARCH]=appCtxt.getSearchController().getSearchToolbar()\n}else{Dwt.hide(ZmId.SKIN_SEARCH)\n}var b=this.getNewButton();\nvar d={parent:this._shell,context:ZmOperation.NEW_MENU,buttons:ZmOperation.NONE,controller:this,refElementId:ZmId.SKIN_APP_NEW_BUTTON};\nvar a=this._newToolbar=new ZmButtonToolBar(d);\nb.reparent(a);\nthis._components[ZmAppViewMgr.C_NEW_BUTTON]=a;\nif(e.unitTest){var c=window.unitTestManager;\nappCtxt.addZimletsLoadedListener(c.runTests.bind(c),0)\n}this.getKeyMapMgr();\nthis.setSessionTimer(true);\nZmZimbraMail.killSplash();\nthis.runAppFunction(\"addComponents\",false,this._components);\nthis._appViewMgr.setViewComponents(ZmAppViewMgr.GLOBAL,this._components,true);\nthis._checkLicense();\nif(!this._doingPostRenderStartup){this._postRenderStartup()\n}};\nZmZimbraMail.prototype._setRefresh=function(){var b=document.getElementById(ZmId.SKIN_REFRESH);\nif(!b){return\n}var a=appCtxt.refreshButton=new DwtToolBarButton({parent:DwtShell.getShell(window),id:ZmId.OP_CHECK_MAIL});\na.setImage(\"RefreshAll\");\na.setToolTipContent(ZmMsg.checkMailPrefUpdate,true);\na.reparentHtmlElement(ZmId.SKIN_REFRESH);\nvar c=this._refreshListener.bind(this);\na.addSelectionListener(c)\n};\nZmZimbraMail.prototype._refreshListener=function(){if(!appCtxt.isWebClientOffline()){this.runAppFunction(\"runRefresh\")\n}};\nZmZimbraMail.prototype._checkLicense=function(b){var a=appCtxt.get(ZmSetting.LICENSE_STATUS);\nvar d=ZmSetting.LICENSE_MSG[a];\nif(d){AjxDispatcher.require(\"Startup2\");\nvar c=appCtxt.getMsgDialog();\nc.reset();\nc.setMessage(d,DwtMessageDialog.WARNING_STYLE);\nc.popup()\n}};\nZmZimbraMail.prototype._postRenderStartup=function(a){this._postRenderCallbacks.sort(function(d,c){return d.order-c.order\n});\nthis._runNextPostRenderCallback()\n};\nZmZimbraMail.prototype._runNextPostRenderCallback=function(){if(this._postRenderCallbacks&&this._postRenderCallbacks.length){var a=this._postRenderCallbacks.shift();\nif(!a){return\n}AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){a.callback.run();\nthis._runNextPostRenderCallback()\n}),a.delay)\n}else{if(appCtxt.isOffline){this.sendClientEventNotify(ZmZimbraMail.UI_LOAD_END);\nif(AjxEnv.isPrism){this._firstTimeNetworkChange=true;\nvar b=new ZimbraNetworkChecker();\nb.addEventListener(\"offline\",function(c){window.appCtxt.getAppController().handleNetworkChange(false)\n},false);\nb.addEventListener(\"online\",function(c){window.appCtxt.getAppController().handleNetworkChange(true)\n},false)\n}}}};\nZmZimbraMail.prototype.handleNetworkChange=function(a){this._isPrismOnline=a;\nif(this._isUserOnline||this._firstTimeNetworkChange){this._updateNetworkStatus(a)\n}};\nZmZimbraMail.prototype._updateNetworkStatus=function(a){if((a&&this._currentNetworkStatus==ZmZimbraMail.UI_NETWORK_UP)||(!a&&this._currentNetworkStatus==ZmZimbraMail.UI_NETWORK_DOWN)){return\n}if(a){if(!this._firstTimeNetworkChange){this.setStatusMsg(ZmMsg.networkChangeOnline)\n}else{this._firstTimeNetworkChange=false;\nthis._isUserOnline=a\n}this._currentNetworkStatus=ZmZimbraMail.UI_NETWORK_UP;\nthis.sendClientEventNotify(this._currentNetworkStatus,true)\n}else{this.setStatusMsg(ZmMsg.networkChangeOffline,ZmStatusView.LEVEL_WARNING);\nthis._currentNetworkStatus=ZmZimbraMail.UI_NETWORK_DOWN;\nthis.sendClientEventNotify(this._currentNetworkStatus)\n}this._networkStatusIcon.setToolTipContent(a?ZmMsg.networkStatusOffline:ZmMsg.networkStatusOnline,true);\nthis._networkStatusIcon.getHtmlElement().innerHTML=AjxImg.getImageHtml(a?\"Connect\":\"Disconnect\");\nvar b=a?ZmMsg.netStatusOnline:ZmMsg.netStatusOffline;\nthis._networkStatusText.getHtmlElement().innerHTML=b.substr(0,1).toUpperCase()+b.substr(1)\n};\nZmZimbraMail.prototype.addPostRenderCallback=function(d,a,b,c){if(!this._doingPostRenderStartup&&c){d.run()\n}else{a=a||this._postRenderLast++;\nthis._postRenderCallbacks.push({callback:d,order:a,delay:b||0})\n}};\nZmZimbraMail.prototype._isInternalApp=function(a){return !ZmApp.SETTING[a]||(appCtxt.get(ZmApp.SETTING[a],null,appCtxt.multiAccounts&&appCtxt.accountList.mainAccount))\n};\nZmZimbraMail.prototype._isIframeApp=function(a){return !this._isInternalApp(a)&&appCtxt.get(ZmApp.UPSELL_SETTING[a])\n};\nZmZimbraMail.prototype._getStartApp=function(g){var b;\nvar e=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nif(g&&g.app){b=ZmApp.QS_ARG_R[g.app.toLowerCase()];\nif(!this._isInternalApp(b)&&!this._isIframeApp(b)){b=null\n}}if(!b){for(var f in ZmApp.DEFAULT_SORT){ZmApp.DEFAULT_APPS.push(f)\n}ZmApp.DEFAULT_APPS.sort(function(i,h){return ZmZimbraMail.hashSortCompare(ZmApp.DEFAULT_SORT,i,h)\n});\nvar a=null;\nfor(var d=0;\nd<ZmApp.DEFAULT_APPS.length;\nd++){var f=ZmApp.DEFAULT_APPS[d];\nif(this._isInternalApp(f)){a=f;\nbreak\n}}b=this._getDefaultStartAppName(e)\n}var c=AjxStringUtil.parseQueryString();\nif(c&&c.view&&!c.app){b=ZmApp.QS_VIEWS[c.view]\n}g.startApp=b;\ng.qsParams=c\n};\nZmZimbraMail.prototype._getDefaultStartAppName=function(d){d=d||(appCtxt.multiAccounts&&appCtxt.accountList.mainAccount)||null;\nfor(var e in ZmApp.DEFAULT_SORT){ZmApp.DEFAULT_APPS.push(e)\n}ZmApp.DEFAULT_APPS.sort(function(g,f){return ZmZimbraMail.hashSortCompare(ZmApp.DEFAULT_SORT,g,f)\n});\nvar a=null;\nfor(var b=0;\nb<ZmApp.DEFAULT_APPS.length;\nb++){var e=ZmApp.DEFAULT_APPS[b];\nvar c=ZmApp.SETTING[e];\nif(!c||appCtxt.get(c,null,d)){return e\n}}};\nZmZimbraMail.prototype.cancelRequest=function(c,a,b){this._requestMgr.cancelRequest(c,a,b)\n};\nZmZimbraMail.prototype.sendRequest=function(a){return this._requestMgr.sendRequest(a)\n};\nZmZimbraMail.prototype.runAppFunction=function(h,a){var f=[];\nfor(var d=2;\nd<arguments.length;\nd++){f.push(arguments[d])\n}for(var d=0;\nd<ZmApp.APPS.length;\nd++){var g=ZmApp.APPS[d];\nvar j=this._isIframeApp(g)?ZmApp.UPSELL_SETTING[g]:ZmApp.SETTING[g];\nvar e=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nif(!j||appCtxt.get(j,null,e)||a){var c=appCtxt.getApp(g,null,e);\nvar b=c&&c[h];\nif(b&&(typeof(b)==\"function\")){b.apply(c,f)\n}}}appCtxt.notifyZimlets(\"runAppFunction\",[h])\n};\nZmZimbraMail.prototype._createEnabledApps=function(c){this._apps={};\nfor(var e in ZmApp.CLASS){if(!c||c[e]){ZmApp.APPS.push(e)\n}}ZmApp.APPS.sort(function(g,f){return ZmZimbraMail.hashSortCompare(ZmApp.LOAD_SORT,g,f)\n});\nfor(var b=0;\nb<ZmApp.APPS.length;\nb++){var e=ZmApp.APPS[b];\nvar d=this._isInternalApp(e);\nvar a=this._isIframeApp(e);\nif(d||a||e===ZmApp.BRIEFCASE){ZmApp.ENABLED_APPS[e]=d||a;\nthis._createApp(e);\nthis._apps[e].isIframe=a\n}}};\nZmZimbraMail.addListener=function(a,b){if(!ZmZimbraMail._listeners[a]){ZmZimbraMail._listeners[a]=[]\n}ZmZimbraMail._listeners[a].push(b)\n};\nZmZimbraMail.addAppListener=function(a,b,c){b=[a,b].join(\"_\");\nZmZimbraMail.addListener(b,c)\n};\nZmZimbraMail.prototype.addListener=function(a,b){return this._evtMgr.addListener(a,b)\n};\nZmZimbraMail.prototype.removeListener=function(a,b){return this._evtMgr.removeListener(a,b)\n};\nZmZimbraMail.prototype.addAppListener=function(c,a,b){a=[c,a].join(\"_\");\nreturn this.addListener(a,b)\n};\nZmZimbraMail.prototype.removeAppListener=function(c,a,b){a=[c,a].join(\"_\");\nreturn this.removeListener(a,b)\n};\nZmZimbraMail.prototype.sendNoOp=function(){var b={NoOpRequest:{_jsns:\"urn:zimbraMail\"}};\nvar a=appCtxt.isOffline&&appCtxt.accountList.mainAccount.name;\nthis.sendRequest({jsonObj:b,asyncMode:true,noBusyOverlay:true,accountName:a})\n};\nZmZimbraMail.prototype.sendClientEventNotify=function(b,a){var c={jsonObj:{ClientEventNotifyRequest:{_jsns:\"urn:zimbraOffline\",e:b}},asyncMode:true};\nif(a){c.callback=new AjxCallback(this,this.handleClientEventNotifyResponse,b);\nc.noBusyOverlay=true;\nif(this.clientEventNotifyReqId){appCtxt.getRequestMgr().cancelRequest(this.clientEventNotifyReqId)\n}this.clientEventNotifyTimerId=AjxTimedAction.scheduleAction(new AjxTimedAction(this,this.sendClientEventNotify,[b,true]),3000)\n}else{c.callback=new AjxCallback(this,this.setInstantNotify,true)\n}this.clientEventNotifyReqId=this.sendRequest(c)\n};\nZmZimbraMail.prototype.handleClientEventNotifyResponse=function(b,a){if(!a.isException()&&a.getResponse()){if(this.clientEventNotifyTimerId){AjxTimedAction.cancelAction(this.clientEventNotifyTimerId);\nthis.clientEventNotityTimerId=null\n}this.setInstantNotify(true)\n}};\nZmZimbraMail.prototype.setInstantNotify=function(a){if(a){this._pollInstantNotifications=true;\nthis._pollInterval=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);\nif(this._pollActionId){AjxTimedAction.cancelAction(this._pollActionId);\nthis._pollActionId=null\n}this._kickPolling(true)\n}else{this._pollInstantNotifications=false;\nthis._cancelInstantNotify();\nthis.setPollInterval(true)\n}};\nZmZimbraMail.prototype.getInstantNotify=function(){return this._pollInstantNotifications\n};\nZmZimbraMail.prototype.registerMailtoHandler=function(f,d){if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&window.platform){try{if(d){if(f){var a=appCtxt.get(ZmSetting.OFFLINE_WEBAPP_URI,null,appCtxt.accountList.mainAccount);\nwindow.platform.registerProtocolHandler(\"mailto\",a+\"&mailto=%s\");\nif(AjxEnv.isWindows){var c=new ZimbraDesktopShell;\nc.defaultClient=true\n}}var e=AjxCallback.simpleClosure(this.handleOfflineMailTo,this);\nwindow.platform.registerProtocolCallback(\"mailto\",e)\n}else{window.platform.unregisterProtocolHandler(\"mailto\");\nif(AjxEnv.isWindows){var c=new ZimbraDesktopShell;\nc.defaultClient=false\n}}}catch(b){}}};\nZmZimbraMail.prototype.handleOfflineMailTo=function(c,f){if(window.platform&&!window.platform.isRegisteredProtocolHandler(\"mailto\")){return false\n}var e=this.getApp(ZmApp.MAIL);\nvar a=(c.indexOf(\"mailto\"));\nif(a>=0){var d=\"to=\"+decodeURIComponent(c.substring(a+7));\nd=d.replace(/\\?/g,\"&\");\nvar b=e._showComposeView(f,d);\nthis._checkOfflineMailToAttachments(b,d);\nreturn true\n}return false\n};\nZmZimbraMail.prototype._checkOfflineMailToAttachments=function(d,g){var c=g||location.search;\nvar e=c.match(/\\bto=([^&]+)/);\nvar h=e?AjxStringUtil.urlComponentDecode(e[1]):null;\ne=c.match(/\\battachments=([^&]+)/);\nvar b=e?(AjxStringUtil.urlComponentDecode(e[1]).replace(/\\+/g,\" \")):null;\nif(h&&h.indexOf(\"mailto\")==0){h=h.replace(/mailto:/,\"\");\nvar a=h.split(\"?\");\nif(a.length>1){a=a[1];\ne=a.match(/\\battachments=([^&]+)/);\nif(!b){b=e?(AjxStringUtil.urlComponentDecode(e[1]).replace(/\\+/g,\" \")):null\n}}}if(b){b=b.replace(/;$/,\"\");\nb=b.split(\";\");\nthis._mailtoAttachmentsLength=b.length;\nthis._attachmentsProcessed=0;\nthis.attachment_ids=[];\nfor(var f=0;\nf<b.length;\nf++){this._handleMailToAttachment(b[f],d)\n}}};\nZmZimbraMail.prototype._handleMailToAttachment=function(h,i){var f=h;\nvar a=f.replace(/^.*\\\\/,\"\");\ntry{netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\")\n}catch(j){return\n}try{var d=Components.classes[\"@mozilla.org/file/local;1\"].createInstance(Components.interfaces.nsILocalFile);\nd.initWithPath(f);\nvar m=this._getAttachmentContentType(d);\nvar b=Components.classes[\"@mozilla.org/network/file-input-stream;1\"].createInstance(Components.interfaces.nsIFileInputStream);\nb.init(d,-1,-1,false);\nvar g=Components.classes[\"@mozilla.org/binaryinputstream;1\"].createInstance(Components.interfaces.nsIBinaryInputStream);\ng.setInputStream(b);\nvar l=new XMLHttpRequest();\nl.open(\"POST\",appCtxt.get(ZmSetting.CSFE_UPLOAD_URI)+\"&fmt=extended,raw\",true);\nl.setRequestHeader(\"Cache-Control\",\"no-cache\");\nl.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");\nl.setRequestHeader(\"Content-Type\",(m||\"application/octet-stream\"));\nl.setRequestHeader(\"Content-Disposition\",'attachment; filename=\"'+AjxUtil.convertToEntities(a)+'\"');\nvar c=l;\nl.onreadystatechange=AjxCallback.simpleClosure(this._handleUploadResponse,this,c,i);\nl.sendAsBinary(g.readBytes(g.available()));\ndelete l\n}catch(k){this._attachmentsProcessed++\n}};\nZmZimbraMail.prototype._getAttachmentContentType=function(b){var c;\ntry{c=Components.classes[\"@mozilla.org/mime;1\"].getService(Components.interfaces.nsIMIMEService).getTypeFromFile(b)\n}catch(a){c=\"application/octet-stream\"\n}return c\n};\nZmZimbraMail.prototype._handleUploadResponse=function(req,controller){if(req){if(req.readyState==4&&req.status==200){var resp=eval(\"[\"+req.responseText+\"]\");\nthis._attachmentsProcessed++;\nthis.popupUploadErrorDialog(ZmItem.MSG,resp[0]);\nif(resp.length>2){var respObj=resp[2];\nfor(var i=0;\ni<respObj.length;\ni++){if(respObj[i].aid!=\"undefined\"){this.attachment_ids.push(respObj[i].aid)\n}}if(this.attachment_ids.length>0&&this._attachmentsProcessed==this._mailtoAttachmentsLength){var attachment_list=this.attachment_ids.join(\",\");\nif(!controller){var msg=new ZmMailMsg();\ncontroller=AjxDispatcher.run(\"GetComposeController\");\ncontroller._setView({action:ZmOperation.NEW_MESSAGE,msg:msg,inNewWindow:false})\n}var callback=new AjxCallback(controller,controller._handleResponseSaveDraftListener);\ncontroller.sendMsg(attachment_list,ZmComposeController.DRAFT_TYPE_MANUAL,callback);\nthis.getAppViewMgr().pushView(controller.getCurrentViewId())\n}}}}};\nZmZimbraMail.prototype.setPollInterval=function(a){if(!this._pollInstantNotifications){this._pollInterval=appCtxt.get(ZmSetting.POLLING_INTERVAL)*1000;\nif(this._pollInterval){if(a){this._kickPolling(true)\n}}else{if(this._pollActionId){AjxTimedAction.cancelAction(this._pollActionId);\nthis._pollActionId=null\n}}return true\n}else{this._pollInterval=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);\nreturn false\n}};\nZmZimbraMail.prototype._cancelInstantNotify=function(){if(this._pollRequest){this._requestMgr.cancelRequest(this._pollRequest);\nthis._pollRequest=null\n}if(this._pollActionId){AjxTimedAction.cancelAction(this._pollActionId);\nthis._pollActionId=null\n}};\nZmZimbraMail.prototype._kickPolling=function(c){DBG.println(AjxDebug.DBG2,[\"ZmZimbraMail._kickPolling \",this._pollInterval,\", \",this._pollActionId,\", \",this._pollRequest?\"request_pending\":\"no_request_pending\"].join(\"\"));\nif(this._pollActionId){AjxTimedAction.cancelAction(this._pollActionId);\nthis._pollActionId=null\n}if(c&&this._pollInstantNotifications){var a=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);\nif(this._pollInterval>a){this._pollInterval=a\n}}if(this._pollInterval&&!this._pollRequest){try{this._pollActionId=AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._execPoll),this._pollInterval)\n}catch(b){this._pollActionId=null\n}}};\nZmZimbraMail.prototype._execPoll=function(){this._cancelInstantNotify();\nvar f={NoOpRequest:{_jsns:\"urn:zimbraMail\"}},e=f.NoOpRequest;\ntry{if(this._pollInstantNotifications){var d=ZmCsfeCommand.getSessionId();\nif(d){e.wait=1;\ne.limitToOneBlocked=1\n}}var c={jsonObj:f,asyncMode:true,callback:this._handleResponseDoPoll.bind(this),errorCallback:this._handleErrorDoPoll.bind(this),noBusyOverlay:true,timeout:appCtxt.get(ZmSetting.INSTANT_NOTIFY_TIMEOUT),accountName:appCtxt.isOffline&&appCtxt.accountList.mainAccount.name};\nthis._pollRequest=this.sendRequest(c);\nvar b=appCtxt.accountList;\nif(appCtxt.isOffline&&!b.isInitialSyncing()&&b.isSyncStatus(ZmZimbraAccount.STATUS_RUNNING)){this.sendNoOp()\n}}catch(a){this._handleErrorDoPoll(a)\n}};\nZmZimbraMail.prototype._handleErrorDoPoll=function(b){if(this._pollRequest){if(this._pollActionId){AjxTimedAction.cancelAction(this._pollActionId);\nthis._pollActionId=null\n}this._requestMgr.cancelRequest(this._pollRequest);\nthis._pollRequest=null\n}if(this._pollInstantNotifications){this._pollInterval*=2;\nif(this._pollInterval>(1000*60*2)){this._pollInterval=1000*60*2\n}}var a=(b.code==ZmCsfeException.SVC_AUTH_EXPIRED||b.code==ZmCsfeException.SVC_AUTH_REQUIRED||b.code==ZmCsfeException.NO_AUTH_TOKEN);\nif(!a){this._kickPolling(false)\n}return !a\n};\nZmZimbraMail.prototype._handleResponseDoPoll=function(a){this._pollRequest=null;\nvar b=a.getResponse().NoOpResponse;\nif(b.waitDisallowed){this._waitDisallowed=true;\nthis.setInstantNotify(false)\n}else{this._kickPolling(true)\n}};\nZmZimbraMail.prototype.getKeyMapMgr=function(){var a=appCtxt.getKeyboardMgr();\nif(!a.__keyMapMgr){this._initKeyboardHandling()\n}return a.__keyMapMgr\n};\nZmZimbraMail.prototype._initKeyboardHandling=function(){var a=appCtxt.getKeyboardMgr();\nif(a.__keyMapMgr){return\n}if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){a.enable(true);\na.registerKeyMap(new ZmKeyMap());\na.pushDefaultHandler(this)\n}else{a.enable(false)\n}};\nZmZimbraMail.prototype._setupTabGroups=function(){var b=appCtxt.getRootTabGroup();\nif(appCtxt.get(ZmSetting.SEARCH_ENABLED)){b.addMember(appCtxt.getSearchController().getSearchToolbar().getTabGroupMember())\n}b.addMember(this._userNameField);\nb.addMember(this._usedQuotaField);\nif(this._helpButton){b.addMember(this._helpButton)\n}b.addMember(appCtxt.getAppChooser().getTabGroupMember());\nb.addMember(appCtxt.refreshButton);\nb.addMember(this._newToolbar);\nvar a=appCtxt.getCurrentApp();\nvar c=a&&a.getOverview();\nif(c){b.addMember(c.getTabGroupMember());\nZmController._currentOverview=c\n}appCtxt.getKeyboardMgr().setTabGroup(b)\n};\nZmZimbraMail.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.FOLDER,{app:ZmApp.MAIL,nameKey:\"folder\",defaultFolder:ZmOrganizer.ID_INBOX,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmFolder\",orgPackage:\"MailCore\",treeController:\"ZmMailFolderTreeController\",labelKey:\"mailFolders\",itemsKey:\"messages\",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER],views:[\"message\",\"conversation\"],folderKey:\"mailFolder\",mountKey:\"mountFolder\",createFunc:\"ZmOrganizer.create\",compareFunc:\"ZmFolder.sortCompare\",newOp:ZmOperation.NEW_FOLDER,displayOrder:100,childWindow:true,openSetting:ZmSetting.FOLDER_TREE_OPEN});\nZmOrganizer.registerOrg(ZmOrganizer.SEARCH,{app:ZmApp.MAIN,nameKey:\"savedSearch\",precondition:ZmSetting.SAVED_SEARCHES_ENABLED,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmSearchFolder\",treeController:\"ZmSearchTreeController\",labelKey:\"searches\",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,folderKey:\"savedSearch\",disableShare:true,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.SEARCH],createFunc:\"ZmSearchFolder.create\",compareFunc:\"ZmFolder.sortCompare\",openSetting:ZmSetting.SEARCH_TREE_OPEN,displayOrder:300});\nZmOrganizer.registerOrg(ZmOrganizer.SHARE,{orgClass:\"ZmShareProxy\",treeController:\"ZmShareTreeController\",labelKey:\"sharedFoldersHeader\",compareFunc:\"ZmFolder.sortCompare\",displayOrder:101,hideEmpty:false});\nZmOrganizer.registerOrg(ZmOrganizer.TAG,{app:ZmApp.MAIN,nameKey:\"tag\",precondition:ZmSetting.TAGGING_ENABLED,soapCmd:\"TagAction\",firstUserId:64,orgClass:\"ZmTag\",treeController:\"ZmTagTreeController\",hasColor:true,defaultColor:ZmOrganizer.C_ORANGE,labelKey:\"tags\",treeType:ZmOrganizer.TAG,createFunc:\"ZmTag.create\",compareFunc:\"ZmTag.sortCompare\",newOp:ZmOperation.NEW_TAG,openSetting:ZmSetting.TAG_TREE_OPEN,displayOrder:400});\nZmOrganizer.registerOrg(ZmOrganizer.ZIMLET,{orgClass:\"ZmZimlet\",treeController:\"ZmZimletTreeController\",labelKey:\"zimlets\",compareFunc:\"ZmZimlet.sortCompare\",openSetting:ZmSetting.ZIMLET_TREE_OPEN,hideEmpty:true});\nZmOrganizer.registerOrg(ZmOrganizer.HAB,{treeController:\"ZmHabTreeController\",labelKey:\"hab\",childWindow:true});\nthis._name=ZmApp.MAIN;\nZmApp.prototype._setupDropTargets.call(this)\n};\nZmZimbraMail.prototype.getApp=function(a){if(!ZmApp.ENABLED_APPS[a]){return null\n}if(!this._apps[a]){this._createApp(a)\n}return this._apps[a]\n};\nZmZimbraMail.prototype.getAppViewMgr=function(){return this._appViewMgr\n};\nZmZimbraMail.prototype.getActiveApp=function(){return this._activeApp\n};\nZmZimbraMail.prototype.getPreviousApp=function(){return this._previousApp\n};\nZmZimbraMail.prototype.activateApp=function(f,b,i,d,c){var e=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nvar k=this._isIframeApp(f);\nvar g=this._appViewMgr.getAppView(f);\nif(g&&!b){if(this._appViewMgr.pushView(g)){this._appViewMgr.setAppView(f,g);\nif(k){var h=[ZmMsg.zimbraTitle,f].join(\": \");\nDwt.setTitle(h)\n}}if(i){i.run()\n}}else{if(!this._apps[f]){this._createApp(f)\n}if(k){this._createAppIframeView(f);\nif(i){i.run()\n}}else{var j=new AjxCallback(this,this._handleResponseActivateApp,[i,f]);\nvar a=[f,ZmAppEvent.PRE_LAUNCH].join(\"_\");\nthis._evt.item=this._apps[f];\nthis.notify(a);\nc=c||{};\nc.searchResponse=this._searchResponse;\nthis._apps[f].launch(c,j);\ndelete this._searchResponse\n}}};\nZmZimbraMail.prototype._handleResponseActivateApp=function(c,a){if(c){c.run()\n}if(ZmApp.DEFAULT_SEARCH[a]){appCtxt.getSearchController().setDefaultSearchType(ZmApp.DEFAULT_SEARCH[a])\n}var b=[a,ZmAppEvent.POST_LAUNCH].join(\"_\");\nthis._evt.item=this._apps[a];\nthis.notify(b)\n};\nZmZimbraMail.prototype.setActiveApp=function(i){var g=i.app;\nif(!i.isTabView){this._components[ZmAppViewMgr.C_APP_CHOOSER].setSelected(g)\n}var d=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nvar b=!ZmApp.SETTING[g]||appCtxt.get(ZmApp.SETTING[g],null,d);\nthis._activeTabId=null;\nif(g===ZmApp.SEARCH){this._setSearchTabNewButtonProps(i.controller._resultsController)\n}if(this._activeApp!=g){if(this._activeApp){var a=this._apps[this._activeApp];\nif(a){a.activate(false,i.id)\n}this._previousApp=this._activeApp\n}this._activeApp=g;\nif(b){var a=this._apps[this._activeApp];\nif(appCtxt.get(ZmSetting.SEARCH_ENABLED)){var h;\nvar e;\nif(g===ZmApp.SEARCH){e=i.controller._resultsController._currentSearch;\nvar f=e&&e.types;\nh=f&&f.size()>0&&f.get(0)\n}else{e=a.currentSearch;\nh=a.getInitialSearchType();\nif(!h){h=ZmApp.DEFAULT_SEARCH[g]\n}}if(h){appCtxt.getSearchController().setDefaultSearchType(h)\n}var c=appCtxt.getSearchController().getSearchToolbar();\nif(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)&&c){var j=e?e.query:a.currentQuery;\nj=g===ZmApp.SEARCH?\"\":j;\nc.setSearchFieldValue(j?j+\" \":\"\")\n}}if(a){if(appCtxt.inStartup&&this._doingPostRenderStartup){var k=new AjxCallback(this,function(){a.activate(true)\n});\nthis.addPostRenderCallback(k,1,0,true)\n}else{a.activate(true)\n}}}this._evt.item=this._apps[g];\nthis.notify(ZmAppEvent.ACTIVATE)\n}else{if(this._activeApp&&this._apps[this._activeApp]){this._apps[this._activeApp].stopAlert()\n}}};\nZmZimbraMail.prototype._setSearchTabNewButtonProps=function(e){var a;\nif(e.isZmCalViewController){a=appCtxt.getApp(ZmApp.CALENDAR)\n}else{var d=e._currentSearch;\nvar c=d&&d.types;\nvar b=c&&c.size()>0&&c.get(0);\na=b&&appCtxt.getApp(ZmItem.APP[b])\n}if(a){appCtxt.getAppController().setNewButtonProps(a.getNewButtonProps())\n}};\nZmZimbraMail.prototype.getAppChooserButton=function(b){var a=this._components[ZmAppViewMgr.C_APP_CHOOSER];\nreturn a&&a.getButton(b)\n};\nZmZimbraMail.prototype.appRendered=function(a){var b=[a,ZmAppEvent.POST_RENDER].join(\"_\");\nthis.notify(b);\nif(window._facadeCleanup){window._facadeCleanup();\nwindow._facadeCleanup=null\n}};\nZmZimbraMail.prototype.addApp=function(b){var a=b.getName();\nthis._apps[a]=b;\nZmApp.ENABLED_APPS[a]=true\n};\nZmZimbraMail.prototype._createApp=function(appName){if(!appName||this._apps[appName]){return\n}var appClass=eval(ZmApp.CLASS[appName]);\nthis.addApp(new appClass(this._shell))\n};\nZmZimbraMail.prototype._setExternalLinks=function(){var c;\nif(!appCtxt.isOffline&&(appCtxt.get(ZmSetting.IS_ADMIN)||appCtxt.get(ZmSetting.IS_DELEGATED_ADMIN))){c=appCtxt.get(ZmSetting.ADMIN_URL);\nif(!c){c=[\"https://\",location.hostname,\":7071\"].join(\"\")\n}}var a=document.getElementById(\"skin_container_links\");\nif(a){var b={showOfflineLink:(!appCtxt.isOffline&&appCtxt.get(ZmSetting.SHOW_OFFLINE_LINK)),helpIcon:(appCtxt.getSkinHint(\"helpButton\",\"hideIcon\")?null:\"Help\"),logoutIcon:(appCtxt.getSkinHint(\"logoutButton\",\"hideIcon\")?null:\"Logoff\"),logoutText:(appCtxt.isOffline?ZmMsg.setup:ZmMsg.logOff),adminUrl:c};\na.innerHTML=AjxTemplate.expand(\"share.App#UserInfo\",b)\n}a=document.getElementById(\"skin_container_help_button\");\nif(a){this._helpButton=this.getHelpButton(DwtShell.getShell(window));\nthis._helpButton.reparentHtmlElement(\"skin_container_help_button\")\n}a=document.getElementById(\"skin_dropMenu\");\nif(a){this._helpButton=this.getDropMenuOptions(DwtShell.getShell(window),a,c)\n}};\nZmZimbraMail.ONLINE_HELP_URL=\"https://help.zimbra.com/?\";\nZmZimbraMail.NEW_FEATURES_URL=\"https://www.zimbra.com/products/whats_new.html?\";\nZmZimbraMail.DEFAULT_CONTACT_ICON=appContextPath+\"/img/large/ImgPerson_48.png?v=\"+window.cacheKillerVersion;\nZmZimbraMail.DEFAULT_CONTACT_ICON_SMALL=appContextPath+\"/img/large/ImgPerson_32.png?v=\"+window.cacheKillerVersion;\nZmZimbraMail.prototype.getDropMenuOptions=function(f,b,h){var e=new DwtLinkButton({parent:f,className:DwtButton.LINK_BUTTON_CLASS,parentElement:b,elementTag:\"DIV\"});\ne.whatToShow={};\ne.setSize(Dwt.DEFAULT);\ne.setAlign(DwtLabel.ALIGN_LEFT);\ne.setText(ZmMsg.help);\ne.setAttribute(\"aria-label\",ZmMsg.userActions);\nvar g=new ZmPopupMenu(e);\nvar a=appCtxt.get(ZmSetting.SUPPORTED_HELPS);\nvar d=new AjxListener(this,this._helpListener);\ne.addSelectionListener(d);\nvar c;\nif(h){c=g.createMenuItem(\"adminLink\",{text:ZmMsg.adminLinkLabel});\nc.addSelectionListener(new AjxListener(null,ZmZimbraMail.adminLinkCallback,h))\n}c=g.createMenuItem(\"standardHtmlLink\",{text:ZmMsg.htmlClient});\nc.addSelectionListener(ZmZimbraMail.standardHtmlLinkCallback);\ng.createSeparator();\nif(a.indexOf(\"productHelp\")!==-1){c=g.createMenuItem(\"documentation\",{text:ZmMsg.productHelp});\nc.addSelectionListener(d)\n}if(a.indexOf(\"onlineHelp\")!==-1){c=g.createMenuItem(\"onlinehelp\",{text:ZmMsg.onlineHelp});\nc.addSelectionListener(new AjxListener(this,this._onlineHelpListener))\n}if(a.indexOf(\"newFeatures\")!==-1){c=g.createMenuItem(\"newFeatures\",{text:ZmMsg.newFeatures});\nc.addSelectionListener(new AjxListener(this,this._newFeaturesListener))\n}c=g.createMenuItem(\"showCurrentShortcuts\",{text:ZmMsg.shortcuts});\nc.addSelectionListener(this._showCurrentShortcuts.bind(this));\ng.createSeparator();\nc=g.createMenuItem(ZmZimbraMail.HELP_MENU_ABOUT,{text:ZmMsg.about});\nc.addSelectionListener(new AjxListener(this,this._aboutListener));\ng.createSeparator();\nif(!appCtxt.isExternalAccount()&&appCtxt.get(ZmSetting.WEBCLIENT_OFFLINE_ENABLED)){c=g.createMenuItem(\"offlineSettings\",{text:ZmMsg.offlineSettings});\nc.addSelectionListener(new AjxListener(this,this._offlineSettingsListener))\n}if(appCtxt.get(ZmSetting.CHANGE_PASSWORD_ENABLED)){c=g.createMenuItem(\"changePassword\",{text:ZmMsg.changePassword});\nc.addSelectionListener(new AjxListener(this,this._changePasswordListener))\n}c=g.createMenuItem(ZmZimbraMail.HELP_MENU_LOGOFF,{text:ZmMsg.logOff});\nc.addSelectionListener(new AjxListener(null,ZmZimbraMail.logOff));\ne.setMenu(g);\nthis.setupHelpMenu(e);\nreturn e\n};\nZmZimbraMail.HELP_MENU_ABOUT=\"about\";\nZmZimbraMail.HELP_MENU_LOGOFF=\"logOff\";\nZmZimbraMail.prototype.setupHelpMenu=function(b){b=b||this._helpButton;\nif(!b){return\n}var c=b.getMenu();\nif(!c){return\n}var d=!appCtxt.isWebClientOffline();\nif(d){c.enableAll(true)\n}else{c.enableAll(false);\nvar a=[ZmZimbraMail.HELP_MENU_ABOUT];\nc.enable(a,true)\n}};\nZmZimbraMail.prototype.getNewButton=function(){var b=this._newButton;\nif(!b){var a=ZmId.getButtonId(null,ZmOperation.NEW_MENU);\nvar e={parent:appCtxt.getShell(),id:a,posStyle:DwtControl.ABSOLUTE_STYLE,className:\"ZToolbarButton ZNewButton\"};\nb=this._newButton=new DwtToolBarButton(e);\nb.setText(ZmMsg._new);\nZmOperation.addNewMenu(b);\nvar d=this._newButtonListener.bind(this);\nvar c=this._newDropDownListener.bind(this,d);\nthis._newDropDownListener=c;\nb.addSelectionListener(d);\nb.addDropDownSelectionListener(c)\n}return b\n};\nZmZimbraMail.prototype._newDropDownListener=function(f,d){var c=this.getNewButton();\nvar g=c.getMenu();\nvar a=g.getItems();\nfor(var b=0;\nb<g.getItemCount();\nb++){a[b].addSelectionListener(f)\n}var e=this._newDropDownListener;\nc.removeDropDownSelectionListener(e);\nc.popup();\ndelete this._newDropDownListener\n};\nZmZimbraMail.prototype._newButtonListener=function(b,e,d){if(!b&&!e){return\n}e=e||b.item.getData(ZmOperation.KEY_ID);\nif(!e||e==ZmOperation.NEW_MENU){e=ZmController._defaultNewId\n}var c=ZmApp.OPS_R[e];\nif(c){d=d||{};\nd.ev=b;\nappCtxt.getApp(c).handleOp(e,d)\n}else{var a=appCtxt.getCurrentController();\nif(a){a._newListener(b,e)\n}}};\nZmZimbraMail.prototype.setNewButtonProps=function(b){var a=this.getNewButton();\nif(a){a.setText(b.text);\na.setToolTipContent(b.tooltip);\na.setImage(b.icon);\na.setEnabled(!b.disabled);\nZmController._defaultNewId=b.defaultId;\nb.hidden?a.setVisibility(false):a.setVisibility(true)\n}};\nZmZimbraMail.prototype.getHelpButton=function(d){var c=new DwtLinkButton({parent:d,className:DwtButton.LINK_BUTTON_CLASS});\nc.dontStealFocus();\nc.setSize(Dwt.DEFAULT);\nc.setAlign(DwtLabel.ALIGN_LEFT);\nc.setText(ZmMsg.help);\nvar e=new ZmPopupMenu(c);\nvar b=new AjxListener(this,this._helpListener);\nc.addSelectionListener(b);\nvar a=e.createMenuItem(\"documentation\",{text:ZmMsg.productHelp});\na.addSelectionListener(b);\nvar a=e.createMenuItem(\"onlinehelp\",{text:ZmMsg.onlineHelp});\na.addSelectionListener(new AjxListener(this,this._onlineHelpListener));\na=e.createMenuItem(\"newFeatures\",{text:ZmMsg.newFeatures});\na.addSelectionListener(new AjxListener(this,this._newFeaturesListener));\na=e.createMenuItem(\"showCurrentShortcuts\",{text:ZmMsg.shortcuts});\na.addSelectionListener(this._showCurrentShortcuts.bind(this));\ne.createSeparator();\na=e.createMenuItem(\"about\",{text:ZmMsg.about});\na.addSelectionListener(new AjxListener(this,this._aboutListener));\nc.setMenu(e);\nreturn c\n};\nZmZimbraMail.prototype._helpListener=function(a){ZmZimbraMail.helpLinkCallback()\n};\nZmZimbraMail.prototype._getVersion=function(){return appCtxt.get(ZmSetting.CLIENT_VERSION)\n};\nZmZimbraMail.prototype._getQueryParams=function(){var b=appCtxt.getCurrentAppName().toLowerCase();\nvar a=appCtxt.isOffline?\"zd\":\"zcs\";\nreturn[\"utm_source=\",b,\"&utm_medium=\",a,\"&utm_content=\",this._getVersion(),\"&utm_campaign=help\"].join(\"\")\n};\nZmZimbraMail.prototype._onlineHelpListener=function(b){ZmZimbraMail.unloadHackCallback();\nvar a=[ZmZimbraMail.ONLINE_HELP_URL,this._getQueryParams()].join(\"\");\nwindow.open(a)\n};\nZmZimbraMail.prototype._newFeaturesListener=function(b){ZmZimbraMail.unloadHackCallback();\nvar a=[ZmZimbraMail.NEW_FEATURES_URL,this._getQueryParams()].join(\"\");\nwindow.open(a)\n};\nZmZimbraMail.prototype._changePasswordListener=function(a){appCtxt.getChangePasswordWindow(a)\n};\nZmZimbraMail.prototype._aboutListener=function(e){var c=appCtxt.getMsgDialog();\nc.reset();\nvar b=this._getVersion();\nvar a=appCtxt.get(ZmSetting.CLIENT_RELEASE);\nvar d=appCtxt.isOffline?ZmMsg.aboutMessageZD:ZmMsg.aboutMessage;\nc.setMessage(AjxMessageFormat.format(d,[b,a,AjxDateUtil.getYearStr()]),DwtMessageDialog.INFO_STYLE,ZmMsg.about);\nc.popup()\n};\nZmZimbraMail.prototype._offlineSettingsListener=function(b){var a;\nif(AjxEnv.isOfflineSupported){a=appCtxt.getOfflineSettingsDialog()\n}else{a=appCtxt.getMsgDialog();\na.setMessage(ZmMsg.offlineSupportedBrowser,\"\",ZmMsg.offlineSettings)\n}a.popup()\n};\nZmZimbraMail.prototype._initOfflineUserInfo=function(){var a=this._userNameField.getHTMLElId();\nthis._userNameField.getHtmlElement().innerHTML=AjxTemplate.expand(\"share.App#NetworkStatus\",{id:a});\nthis._userNameField.addClassName(\"BannerTextUserOffline\");\nvar d={parent:this._userNameField,parentElement:(a+\"_networkStatusIcon\")};\nthis._networkStatusIcon=new DwtComposite(d);\nvar b={parent:this._userNameField,parentElement:(a+\"_networkStatusText\")};\nthis._networkStatusText=new DwtComposite(b);\nvar c=document.getElementById(\"skin_container_tree_top\");\nif(c){Dwt.setSize(c,Dwt.DEFAULT,\"20\")\n}};\nZmZimbraMail.prototype._offlineUpdateChannelPref=function(c){try{netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\");\nvar a=Components.classes[\"@mozilla.org/preferences-service;1\"].getService(Components.interfaces.nsIPrefBranch);\nif(a){a.setCharPref(\"app.update.channel\",c)\n}}catch(b){}};\nZmZimbraMail.prototype.setUserInfo=function(){if(appCtxt.isOffline){return\n}var a=appCtxt.getLoggedInUsername();\nvar c=(appCtxt.get(ZmSetting.DISPLAY_NAME))||a;\nif(c){var b=this._userNameField.getHtmlElement();\nb.innerHTML=AjxStringUtil.htmlEncode(AjxStringUtil.clipByLength(c,24));\nb.setAttribute(\"aria-label\",c);\nif(AjxEnv.isLinux){b.style.lineHeight=\"13px\"\n}}this.setQuotaInfo(a,c)\n};\nZmZimbraMail.prototype.setQuotaInfo=function(a,h){var d=appCtxt.get(ZmSetting.QUOTA);\nvar g=(appCtxt.get(ZmSetting.QUOTA_USED))||0;\nvar f={id:this._usedQuotaField._htmlElId,login:a,username:h,quota:d,usedQuota:g,size:(AjxUtil.formatSize(g,false,1))};\nvar e;\nif(f.quota){e=\"UsedLimited\";\nf.limit=AjxUtil.formatSize(f.quota,false,1);\nf.percent=Math.min(Math.round((f.usedQuota/f.quota)*100),100);\nf.desc=AjxMessageFormat.format(ZmMsg.usingDescLimited,[f.size,\"(\"+f.percent+\"%)\",f.limit])\n}else{f.desc=AjxMessageFormat.format(ZmMsg.usingDescUnlimited,[f.size]);\ne=\"UsedUnlimited\"\n}var c=this._usedQuotaField.getHtmlElement();\nc.innerHTML=AjxTemplate.expand(\"share.Quota#\"+e,f);\nc.setAttribute(\"aria-label\",f.desc);\nvar b=AjxTemplate.expand(\"share.Quota#Tooltip\",f);\nthis._components[ZmAppViewMgr.C_USER_INFO].setToolTipContent(b);\nthis._components[ZmAppViewMgr.C_QUOTA_INFO].setToolTipContent(b)\n};\nZmZimbraMail.setExitTimer=function(b){if(b&&ZmZimbraMail.stayOnPagePrompt){if(ZmZimbraMail._exitTimerId==-1){ZmZimbraMail._exitTimerId=AjxTimedAction.scheduleAction(ZmZimbraMail._exitTimer,ZmZimbraMail.STAYONPAGE_INTERVAL*60*1000);\nif(AjxEnv.isFirefox){var c=AjxMessageFormat.format(ZmMsg.appExitPrompt,[ZmZimbraMail.STAYONPAGE_INTERVAL]);\nvar a=appCtxt.getMsgDialog();\na.setMessage(c,DwtMessageDialog.CRITICAL_STYLE);\nsetTimeout(function(){a.popup()\n},1000*2)\n}}}else{if(!b&&ZmZimbraMail._exitTimerId){AjxTimedAction.cancelAction(ZmZimbraMail._exitTimerId);\nZmZimbraMail._exitTimerId=-1\n}}};\nZmZimbraMail.logOff=function(e,d){if(appCtxt.isChildWindow){window.close();\nreturn\n}if(appCtxt.isWebClientOfflineSupported&&(e||d)){return ZmOffline.handleLogOff(e,d)\n}if(localStorage.hasOwnProperty(\"csrfToken\")==true){localStorage.removeItem(\"csrfToken\")\n}ZmZimbraMail._isLogOff=true;\nif(appCtxt.isOffline&&AjxEnv.isWindows&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE)){window.platform.icon().imageSpec=\"resource://webapp/icons/default/launcher.ico\";\nwindow.platform.icon().title=null\n}var a={path:appContextPath,qsArgs:{loginOp:d?\"relogin\":\"logout\"}};\nif(d){a.qsArgs.username=appCtxt.getLoggedInUsername()\n}if(appCtxt.isExternalAccount()){var c=appCtxt.getUserDomain();\na.qsArgs.virtualacctdomain=c?c:\"\"\n}var b=AjxUtil.formatUrl(a);\nZmZimbraMail.sendRedirect(b);\nif(AjxEnv.isFirefox){ZmZimbraMail.setExitTimer(true)\n}};\nZmZimbraMail.exitSession=function(){ZmZimbraMail.logOff()\n};\nZmZimbraMail.executeSessionTimer=function(){ZmZimbraMail.sessionTimerInvoked=true;\nZmZimbraMail.logOff()\n};\nZmZimbraMail.getConfirmExitMethod=function(){return this._confirmExitMethod\n};\nZmZimbraMail._onClickLogOff=function(){if(AjxEnv.isIE){var a=DwtUiEvent.getEvent();\na.returnValue=false\n}ZmZimbraMail.logOff()\n};\nZmZimbraMail.adminLinkCallback=function(a){ZmZimbraMail.unloadHackCallback();\nvar b=window.parentAppCtxt||window.appCtxt;\nwindow.open(a)\n};\nZmZimbraMail.standardHtmlLinkCallback=function(){var a={path:appContextPath,qsArgs:{client:\"standard\"}};\nvar b=AjxUtil.formatUrl(a);\nZmZimbraMail.sendRedirect(b)\n};\nZmZimbraMail.helpLinkCallback=function(c){ZmZimbraMail.unloadHackCallback();\nvar d=window.parentAppCtxt||window.appCtxt;\nvar b;\nif(!d.isOffline){try{b=c||skin.hints.helpButton.url\n}catch(f){}b=b||d.get(ZmSetting.HELP_URI);\nvar a=b.match(/\\?/)?\"&\":\"?\";\nb=[b,a,\"locid=\",AjxEnv.DEFAULT_LOCALE].join(\"\")\n}else{b=d.get(ZmSetting.HELP_URI).replace(/\\/$/,\"\");\nb=[b,\"help\",\"en_US\",\"Zimbra_Mail_Help.htm\"].join(\"/\")\n}window.open(b)\n};\nZmZimbraMail.sendRedirect=function(b){if(AjxEnv.isIE){var a=new AjxTimedAction(null,ZmZimbraMail.redir,[b]);\nAjxTimedAction.scheduleAction(a,1)\n}else{ZmZimbraMail.redir(b)\n}};\nZmZimbraMail.redir=function(b){try{window.location=b\n}catch(a){}};\nZmZimbraMail.prototype.setSessionTimer=function(b){var a=appCtxt.get(ZmSetting.IDLE_SESSION_TIMEOUT)*1000;\nif(a<=0){return\n}if(b){this._sessionTimerId=AjxTimedAction.scheduleAction(this._sessionTimer,a);\nDwtEventManager.addListener(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);\nthis._shell.setHandler(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);\nif(document.attachEvent){document.attachEvent(\"onkeydown\",ZmZimbraMail._userEventHdlr)\n}window.onkeydown=ZmZimbraMail._userEventHdlr\n}else{AjxTimedAction.cancelAction(this._sessionTimerId);\nthis._sessionTimerId=-1;\nDwtEventManager.removeListener(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);\nthis._shell.clearHandler(DwtEvent.ONMOUSEUP);\nif(document.detachEvent){document.detachEvent(\"onkeydown\",ZmZimbraMail._userEventHdlr)\n}window.onkeydown=null\n}};\nZmZimbraMail.prototype.addChildWindow=function(c,b){if(this._childWinList==null){this._childWinList=new AjxVector()\n}var a={win:c,childId:b};\nthis._childWinList.add(a);\nreturn a\n};\nZmZimbraMail.prototype.getChildWindow=function(d){var c=this._childWinList;\nif(c&&d){for(var b=0;\nb<c.size();\nb++){var a=c.get(b);\nif(d===a.win||d.childId===a.childId){return a\n}}}return null\n};\nZmZimbraMail.prototype.removeChildWindow=function(d){var c=this._childWinList;\nif(c){for(var b=0;\nb<c.size();\nb++){var a=c.get(b);\nif(d==a.win){a.win=null;\nbreak\n}}}};\nZmZimbraMail.prototype._handleException=function(g,b){var d=false;\nif(g.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER){var a=[ZmOrganizer.CALENDAR,ZmOrganizer.ADDRBOOK];\nif(g.data.itemId&&g.data.itemId.length){var i=g.data.itemId[0];\nvar e=i.lastIndexOf(\":\");\nvar f=i.substring(0,e);\nvar j=i.substring(e+1,i.length);\nvar c=appCtxt.getFolderTree();\nfor(var h=0;\nh<a.length;\nh++){d|=c.handleNoSuchFolderError(a[h],f,j,true)\n}}}else{if(appCtxt.isWebClientOffline()&&g.code===ZmCsfeException.EMPTY_RESPONSE){d=true\n}}if(!d){ZmController.prototype._handleException.apply(this,arguments)\n}};\nZmZimbraMail._confirmExitMethod=function(){if(!ZmCsfeCommand.noAuth){appCtxt.accountList.saveImplicitPrefs();\nif(appCtxt.get(ZmSetting.WARN_ON_EXIT)&&!ZmZimbraMail._isOkToExit()){if(ZmZimbraMail.stayOnPagePrompt){return\n}ZmZimbraMail._isLogOff=false;\nvar a=(appCtxt.isOffline)?ZmMsg.appExitWarningZD:ZmMsg.appExitWarning;\nif(ZmZimbraMail.sessionTimerInvoked){ZmZimbraMail.stayOnPagePrompt=true;\na=AjxMessageFormat.format(a+ZmMsg.appExitTimeWarning,[ZmZimbraMail.STAYONPAGE_INTERVAL])\n}if(!AjxEnv.isFirefox){ZmZimbraMail.setExitTimer(true)\n}return a\n}ZmZimbraMail._endSession()\n}if(window.ZmDesktopAlert){ZmDesktopAlert.closeNotification()\n}ZmZimbraMail._endSessionDone=true\n};\nZmZimbraMail._isOkToExit=function(){var b=window._zimbraMail;\nif(!b){return true\n}var a=b._appViewMgr.isOkToUnload()&&ZmZimbraMail._childWindowsOkToUnload();\nif(a&&!AjxEnv.isPrism&&b._pollRequest){b._requestMgr.cancelRequest(b._pollRequest)\n}return a\n};\nZmZimbraMail._childWindowsOkToUnload=function(){var b=window._zimbraMail?window._zimbraMail._childWinList:null;\nif(b){for(var a=0;\na<b.size();\na++){var c=b.get(a);\nif(c.win&&c.win.ZmNewWindow&&c.win.ZmNewWindow._confirmExitMethod()){return false\n}}}return true\n};\nZmZimbraMail.handleNetworkStatusClick=function(){var a=window.appCtxt.getAppController();\nif(!a._isPrismOnline){return\n}a._isUserOnline=!a._isUserOnline;\na._updateNetworkStatus(a._isUserOnline)\n};\nZmZimbraMail.unloadHackCallback=function(){window.onbeforeunload=null;\nvar a=function(){window.onbeforeunload=ZmZimbraMail._confirmExitMethod\n};\nAjxTimedAction.scheduleAction((new AjxTimedAction(null,a)),3000)\n};\nZmZimbraMail._userEventHdlr=function(b){var a=window._zimbraMail;\nif(a){AjxTimedAction.cancelAction(a._sessionTimerId);\nvar c=appCtxt.get(ZmSetting.IDLE_SESSION_TIMEOUT)*1000;\nif(c<=0){return\n}a._sessionTimerId=AjxTimedAction.scheduleAction(a._sessionTimer,c)\n}};\nZmZimbraMail.prototype._createBanner=function(){var a=new DwtComposite({parent:this._shell,posStyle:Dwt.ABSOLUTE_STYLE,id:ZmId.BANNER});\nvar c=appCtxt.getSkinHint(\"banner\",\"url\")||appCtxt.get(ZmSetting.LOGO_URI);\nvar b={url:c,isOffline:appCtxt.isOffline};\na.getHtmlElement().innerHTML=AjxTemplate.expand(\"share.App#Banner\",b);\na.getHtmlElement().style.height=\"100%\";\nreturn a\n};\nZmZimbraMail.prototype._createUserInfo=function(c,f,e){var a=appCtxt.getSkinHint(f,\"position\");\nvar b=a||Dwt.ABSOLUTE_STYLE;\nvar d=new DwtComposite({parent:this._shell,className:c,posStyle:b,id:e,isFocusable:true});\nd._setMouseEventHdlrs();\nreturn d\n};\nZmZimbraMail.prototype._createAppChooser=function(){var b=[];\nfor(var d in ZmApp.CHOOSER_SORT){if(d==ZmAppChooser.SPACER||d==ZmAppChooser.B_HELP||d==ZmAppChooser.B_LOGOUT){continue\n}if(this._isInternalApp(d)||this._isIframeApp(d)){b.push(d)\n}}b.sort(function(f,e){return ZmZimbraMail.hashSortCompare(ZmApp.CHOOSER_SORT,f,e)\n});\nvar c=new ZmAppChooser({parent:this._shell,buttons:b,id:ZmId.APP_CHOOSER,refElementId:ZmId.SKIN_APP_CHOOSER});\nvar a=new AjxListener(this,this._appButtonListener);\nc.addSelectionListener(a);\nreturn c\n};\nZmZimbraMail.prototype._appButtonListener=function(b){try{var d=b.item.getData(Dwt.KEY_ID);\nif(d==ZmAppChooser.B_HELP){window.open(appCtxt.get(ZmSetting.HELP_URI))\n}else{if(d==ZmAppChooser.B_LOGOUT){ZmZimbraMail.logOff()\n}else{if(d&&ZmApp.ENABLED_APPS[d]&&(d!=this._activeTabId)){this.activateApp(d);\nif(appCtxt.zimletsPresent()){appCtxt.getZimletMgr().notifyZimlets(\"onSelectApp\",d)\n}}else{var c=(DwtUiEvent.getTargetWithProp(b,\"id\")==b.item._getIconEl(DwtLabel.RIGHT));\nif(c){this._appViewMgr.popView(false,d)\n}else{if(d!=this._activeTabId){this._appViewMgr.pushView(d)\n}}}}}}catch(a){this._handleException(a)\n}};\nZmZimbraMail.prototype.getAppChooser=function(){return this._appChooser\n};\nZmZimbraMail.prototype.setActiveTabId=function(a){this._activeTabId=a;\nthis._appChooser.setSelected(a)\n};\nZmZimbraMail.prototype.setStatusMsg=function(a){a=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);\nthis.statusView.setStatusMsg(a)\n};\nZmZimbraMail.prototype.dismissStatusMsg=function(a){this.statusView.dismissStatusMsg(a)\n};\nZmZimbraMail.prototype.getKeyMapName=function(){var a=appCtxt.getCurrentController();\nif(a&&a.getKeyMapName){return a.getKeyMapName()\n}return ZmKeyMap.MAP_GLOBAL\n};\nZmZimbraMail.prototype.handleKeyAction=function(g,i){DwtMenu.closeActiveMenu();\nvar a=ZmApp.GOTO_ACTION_CODE_R[g];\nif(a){if(a==this.getActiveApp()){return false\n}if(appCtxt.isWebClientOffline()&&!AjxUtil.arrayContains(ZmOffline.SUPPORTED_APPS,a)){return false\n}this.activateApp(a);\nreturn true\n}switch(g){case ZmKeyMap.QUICK_REMINDER:var f=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount;\nif(appCtxt.get(ZmSetting.CALENDAR_ENABLED,null,f)&&!appCtxt.isWebClientOffline()){var h=appCtxt.getCalManager();\nh.showQuickReminder()\n}break;\ncase ZmKeyMap.FOCUS_SEARCH_BOX:var b=appCtxt.getSearchController().getSearchToolbar();\nif(b){var k=b.getSearchField();\nappCtxt.getKeyboardMgr().grabFocus(k);\nif(ZmSearchAutocomplete){ZmSearchAutocomplete._ignoreNextKey=true\n}}break;\ncase ZmKeyMap.FOCUS_CONTENT_PANE:this.focusContentPane();\nbreak;\ncase ZmKeyMap.FOCUS_TOOLBAR:this.focusToolbar();\nbreak;\ncase ZmKeyMap.SHORTCUTS:this._showCurrentShortcuts();\nbreak;\ncase ZmKeyMap.CANCEL:var e=false;\nvar d=(DwtMouseEventCapture.getId()==\"DwtControl\")?DwtMouseEventCapture.getCaptureObj():null;\nvar c=d&&d.targetObj;\nif(c&&(c._dragging==DwtControl._DRAGGING)){d.release();\nc.__lastDestDwtObj=null;\nc._setDragProxyState(false);\nDwtControl.__badDrop(c,DwtShell.mouseEvent);\ne=true\n}if(e){break\n}default:var j=appCtxt.getCurrentController();\nreturn j&&j.handleKeyAction?j.handleKeyAction(g,i):false\n}return true\n};\nZmZimbraMail.prototype.focusContentPane=function(){var a=appCtxt.getCurrentController();\nvar b=a&&a._getDefaultFocusItem();\nif(b){appCtxt.getKeyboardMgr().grabFocus(b)\n}};\nZmZimbraMail.prototype.focusToolbar=function(){var a=appCtxt.getCurrentController();\nvar b=a&&a.getCurrentToolbar&&a.getCurrentToolbar();\nif(b){appCtxt.getKeyboardMgr().grabFocus(b)\n}};\nZmZimbraMail.prototype._createAppIframeView=function(a){var h=[a,\"iframe\"].join(\"_\"),e=(a===ZmApp.SOCIAL),g={appName:a},c=this._appIframeView[a];\nif(!c){c=this._appIframeView[a]=e?new ZmCommunityView(g):new ZmAppIframeView(g);\nvar f={},d={};\nf[ZmAppViewMgr.C_APP_CONTENT]=c;\nd[ZmAppViewMgr.CB_POST_SHOW]=this._displayAppIframeView.bind(this);\nvar b=[ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_TOOLBAR_TOP,ZmAppViewMgr.C_NEW_BUTTON,ZmAppViewMgr.C_SASH];\nthis._appViewMgr.createView({viewId:h,appName:a,controller:this,elements:f,hide:b,isTransient:true,isFullScreen:true,callbacks:d})\n}this._appViewMgr.pushView(h);\nc.activate(true)\n};\nZmZimbraMail.prototype._displayAppIframeView=function(a){appCtxt.getApp(this._getDefaultStartAppName()).setOverviewPanelContent(false)\n};\nZmZimbraMail.prototype._postLoadZimlet=function(){appCtxt.setZimletsPresent(true)\n};\nZmZimbraMail.prototype._globalSelectionListener=function(e){if(this._waitDisallowed){this._waitDisallowed=false;\nthis.setInstantNotify(true)\n}if(!appCtxt.areZimletsLoaded()){return\n}var d=e.item;\nvar h=(d&&d.getText)?(d.getText()||d._toggleText):null;\nif(d&&!h){h=d.getData(ZmOperation.KEY_ID)||d.getData(Dwt.KEY_ID)\n}if(h){var c;\nif(d instanceof ZmAppButton){c=\"app\"\n}else{if(d instanceof DwtMenuItem){c=\"menuitem\"\n}else{if(d instanceof DwtButton){c=\"button\"\n}else{if(d instanceof DwtTreeItem){if(!d.getSelected()){return\n}c=\"treeitem\"\n}else{c=d.toString()\n}}}}var b=appCtxt.getAppViewMgr();\nvar a=b.getCurrentViewId();\nvar g=b.getLastViewId();\nvar f=(AjxStringUtil.split((\"\"+h),\" \")).join(\"\");\nappCtxt.notifyZimlets(\"onAction\",[c,f,a,g])\n}};\nZmZimbraMail._folderTreeSashRelease=function(b){var a=skin.getTreeWidth();\nif(a){appCtxt.set(ZmSetting.FOLDER_TREE_SASH_WIDTH,a)\n}};\nZmZimbraMail._endSession=function(){if(!AjxEnv.isPrism&&navigator.onLine){var b={jsonObj:{EndSessionRequest:{_jsns:\"urn:zimbraAccount\"}},asyncMode:!appCtxt.get(\"FORCE_CLEAR_COOKIES\"),emptyResponseOkay:true};\nvar a=appCtxt.getAppController();\na&&a.sendRequest(b)\n}};\nZmZimbraMail.prototype.notify=function(a){this._evtMgr.notifyListeners(a,this._evt)\n};\nZmZimbraMail.prototype._showCurrentShortcuts=function(){var b=appCtxt.getShortcutsPanel();\nvar k=this.getKeyMapName();\nvar a=appCtxt.getAppController().getKeyMapMgr();\nvar l=a.getAncestors(k);\nvar m=(l&&l.length>0);\nl.unshift(k);\nvar e=[];\nif(m){if(l.length>1&&l[l.length-1]==ZmKeyMap.MAP_GLOBAL){l.pop();\ne.push(ZmKeyMap.MAP_GLOBAL)\n}}var j={},h={};\nj.type=ZmShortcutList.TYPE_APP;\nj.maps=l;\nvar d=[j];\nif(e.length){h.type=ZmShortcutList.TYPE_APP;\nh.maps=e;\nd.push(h)\n}var g={};\ng.type=ZmShortcutList.TYPE_SYS;\ng.maps=[];\nvar n=appCtxt.getCurrentController();\nvar c=[\"list\",\"editor\",\"tabView\"];\nfor(var f=0;\nf<c.length;\nf++){if(n&&n.mapSupported(c[f])){g.maps.push(c[f])\n}}g.maps.push(\"button\",\"menu\",\"tree\",\"dialog\",\"toolbarHorizontal\");\nd.push(g);\nb.popup(d)\n};\nZmOrganizer.ZIMLET=\"ZIMLET\"\n}if(AjxPackage.define(\"zimbraMail.prefs.model.ZmPref\")){ZmPref=function(c,b,a){ZmSetting.call(this,c,b,ZmSetting.T_PREF,a);\nthis.origValue=null;\nthis.isDirty=false\n};\nZmPref.prototype=new ZmSetting;\nZmPref.prototype.constructor=ZmPref;\nZmPref.prototype.isZmPref=true;\nZmPref.prototype.toString=function(){return\"ZmPref\"\n};\nZmPref.KEY_ID=\"prefId_\";\nZmPref.TYPE_STATIC=\"STATIC\";\nZmPref.TYPE_INPUT=\"INPUT\";\nZmPref.TYPE_CHECKBOX=\"CHECKBOX\";\nZmPref.TYPE_COLOR=\"COLOR\";\nZmPref.TYPE_RADIO_GROUP=\"RADIO_GROUP\";\nZmPref.TYPE_SELECT=\"SELECT\";\nZmPref.TYPE_COMBOBOX=\"COMBOBOX\";\nZmPref.TYPE_TEXTAREA=\"TEXTAREA\";\nZmPref.TYPE_PASSWORD=\"PASSWORD\";\nZmPref.TYPE_IMPORT=\"IMPORT\";\nZmPref.TYPE_EXPORT=\"EXPORT\";\nZmPref.TYPE_SHORTCUTS=\"SHORTCUTS\";\nZmPref.TYPE_CUSTOM=\"CUSTOM\";\nZmPref.TYPE_LOCALES=\"LOCALES\";\nZmPref.TYPE_FONT=\"FONT\";\nZmPref.TYPE_FONT_SIZE=\"FONT_SIZE\";\nZmPref.ORIENT_VERTICAL=\"vertical\";\nZmPref.ORIENT_HORIZONTAL=\"horizontal\";\nZmPref.MAX_ROWS=7;\nZmPref.loadSkins=function(a){var e=appCtxt.get(ZmSetting.AVAILABLE_SKINS);\na.options=[];\nfor(var b=0;\nb<e.length;\nb++){var c=e[b];\na.options.push(c);\nvar d=ZmMsg[\"theme-\"+c]||c.substr(0,1).toUpperCase()+c.substr(1);\na.displayOptions.push(d)\n}};\nZmPref.loadCsvFormats=function(b){var a=appCtxt.get(ZmSetting.AVAILABLE_CSVFORMATS);\nif(!a._options){var c=a._options=[];\nvar e=a._displayOptions=[];\nfor(var d=0;\nd<a.length;\nd++){c.push(a[d])\n}c.sort(ZmPref.__BY_CSVFORMAT);\nfor(var d=0;\nd<c.length;\nd++){e.push((ZmMsg[c[d]]||c[d]))\n}}b.options=a._options;\nb.displayOptions=a._displayOptions\n};\nZmPref.__BY_CSVFORMAT=function(d,c){if(d.match(/^zimbra/)){return -1\n}if(c.match(/^zimbra/)){return 1\n}if(d.match(/^yahoo/)){return -1\n}if(c.match(/^yahoo/)){return 1\n}return d.localeCompare(c)\n};\nZmPref.loadPageSizes=function(b){var a=(b.maxSetting&&appCtxt.get(b.maxSetting))||100;\nvar e=[];\nfor(var d=0;\nd<ZmPref.PAGE_SIZES.length;\nd++){var c=parseInt(ZmPref.PAGE_SIZES[d]);\nif(c<=a){e.push(ZmPref.PAGE_SIZES[d])\n}}if(a>ZmPref.PAGE_SIZES[ZmPref.PAGE_SIZES.length-1]){e.push(String(a))\n}b.displayOptions=b.options=e\n};\nZmPref.PAGE_SIZES=[\"10\",\"25\",\"50\",\"100\",\"250\",\"500\",\"1000\"];\nZmPref.validateEmail=function(a){if(a){return a.match(/\\@localhost$/i)||AjxEmailAddress.parse(a)!=null\n}return true\n};\nZmPref.validateEmailList=function(a){for(var b in a){if(!ZmPref.validateEmail(a[b])){return false\n}}return true\n};\nZmPref.downloadSinceDisplay=function(a){if(!a){return ZmMailApp.POP_DOWNLOAD_SINCE_ALL\n}if(a===appCtxt.get(ZmSetting.POP_DOWNLOAD_SINCE)){return ZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE\n}return ZmMailApp.POP_DOWNLOAD_SINCE_FROM_NOW\n};\nZmPref.downloadSinceValue=function(b){if(b==ZmMailApp.POP_DOWNLOAD_SINCE_ALL){return\"\"\n}if(b==ZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE){return appCtxt.get(ZmSetting.POP_DOWNLOAD_SINCE)\n}var a=new Date();\na.setMinutes(a.getMinutes()+a.getTimezoneOffset());\nreturn AjxDateFormat.format(\"yyyyMMddHHmmss'Z'\",a)\n};\nZmPref.validatePollingInterval=function(a){var c=appCtxt.get(ZmSetting.MIN_POLLING_INTERVAL);\nif(a&&(!c||a>=c)){return true\n}else{var b=c/60;\nZmPref.SETUP[ZmSetting.POLLING_INTERVAL].errorMessage=AjxMessageFormat.format(ZmMsg.invalidPollingInterval,b);\nreturn false\n}};\nZmPref.pollingIntervalDisplay=function(a){if(appCtxt.get(ZmSetting.INSTANT_NOTIFY)&&a==appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL)){return a\n}else{return a/60\n}};\nZmPref.pollingIntervalValue=function(a){if(appCtxt.get(ZmSetting.INSTANT_NOTIFY)&&a==appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL)){return a\n}else{return a*60\n}};\nZmPref.int2DurationDay=function(a){return a!=null&&a!=0?a+\"d\":a\n};\nZmPref.string2EmailList=function(d){var e=[];\nvar f,c=AjxEmailAddress.split(d);\nif(c&&c.length){for(var b=0;\nb<c.length;\nb++){f=c[b];\nvar a=AjxEmailAddress.parse(f);\nif(a){f=a.getAddress()\n}if(f){e.push(AjxStringUtil.htmlEncode(f))\n}}}return e\n};\nZmPref.durationDay2Int=function(a){return parseInt(a,10)\n};\nZmPref.approximateInterval=function(b){var a=[].concat(ZmPref.SETUP.POLLING_INTERVAL.options);\na.sort(ZmPref.__BY_NUMBER);\nreturn ZmPref.approximateValue(a,b)\n};\nZmPref.approximateValue=function(f,j){for(var h=0;\nh<f.length+1;\nh++){var d=f[h];\nvar c=f[h+1];\nif(j<c){var g=j-d;\nvar e=c-j;\nreturn g<e?d:c\n}}return f[f.length-1]\n};\nZmPref.validateLifetime=function(b){var a=appCtxt.get(ZmSetting.MAIL_LIFETIME_GLOBAL);\nif(a==\"0\"){return true\n}return ZmPref.__BY_DURATION(b,a)<=0\n};\nZmPref.validateLifetimeJunk=function(b){var a=appCtxt.get(ZmSetting.MAIL_LIFETIME_JUNK_GLOBAL);\nif(a==\"0\"){return true\n}return ZmPref.__BY_DURATION(b,a)<=0&&ZmPref.validateLifetime(b)\n};\nZmPref.validateLifetimeTrash=function(b){var a=appCtxt.get(ZmSetting.MAIL_LIFETIME_TRASH_GLOBAL);\nif(a==\"0\"){return true\n}return ZmPref.__BY_DURATION(b,a)<=0&&ZmPref.validateLifetime(b)\n};\nZmPref.approximateLifetimeInboxRead=function(a){return ZmPref.approximateLifetime(\"MAIL_LIFETIME_INBOX_READ\",a,ZmPref.validateLifetime)\n};\nZmPref.approximateLifetimeInboxUnread=function(a){return ZmPref.approximateLifetime(\"MAIL_LIFETIME_INBOX_UNREAD\",a,ZmPref.validateLifetime)\n};\nZmPref.approximateLifetimeJunk=function(a){return ZmPref.approximateLifetime(\"MAIL_LIFETIME_JUNK\",a,ZmPref.validateLifetimeJunk,ZmPref.validateLifetime)\n};\nZmPref.approximateLifetimeSent=function(a){return ZmPref.approximateLifetime(\"MAIL_LIFETIME_SENT\",a,ZmPref.validateLifetime)\n};\nZmPref.approximateLifetimeTrash=function(a){return ZmPref.approximateLifetime(\"MAIL_LIFETIME_TRASH\",a,ZmPref.validateLifetimeTrash,ZmPref.validateLifetime)\n};\nZmPref.approximateLifetime=function(e,a,c){var h=[].concat(ZmPref.SETUP[e].options);\nfor(var d=0;\nd<h.length;\nd++){var g=h[d];\nh[d]=ZmPref.__DUR2SECS(g!=\"0\"?g+\"d\":g)\n}h.sort(ZmPref.__BY_NUMBER);\nvaluesLoop:for(var d=h.length-1;\nd>=0;\nd--){for(var b=2;\nb<arguments.length;\nb++){var k=arguments[b];\nvar g=ZmPref.__SECS2DUR(h[d]);\nif(!k(g)){h.pop();\ncontinue valuesLoop\n}}break\n}var f;\nif(a==\"0\"){f=h[h.length-1]\n}else{f=ZmPref.approximateValue(h,ZmPref.__DUR2SECS(a+\"d\"))\n}a=ZmPref.__SECS2DUR(f);\nreturn a!=\"0\"?parseInt(a,10):0\n};\nZmPref.markMsgReadDisplay=function(a){return(a>0)?1:a\n};\nZmPref.markMsgReadValue=function(c){if(c==ZmSetting.MARK_READ_TIME){var b=DwtId.makeId(ZmId.WIDGET_INPUT,ZmId.OP_MARK_READ);\nvar a=DwtControl.fromElementId(b);\nif(a){return a.getValue()||ZmSetting.MARK_READ_NOW\n}}return c\n};\nZmPref.setFormValue=function(a,c){var e=appCtxt.getApp(ZmApp.PREFERENCES);\nvar d=ZmPref.getPrefSectionWithPref(a);\nif(e&&d){var b=e.getPreferencesPage(d.id);\nif(b){b.setFormValue(a,c)\n}}};\nZmPref.getFormValue=function(a){var d=appCtxt.getApp(ZmApp.PREFERENCES);\nvar c=ZmPref.getPrefSectionWithPref(a);\nif(d&&c){var b=d.getPreferencesPage(c.id);\nif(b){return b.getFormValue(a)\n}}};\nZmPref.setIncludeOrig=function(j,f,d){j.setValue(f);\nj.origValue=j.copyValue();\nvar b=[ZmSetting.REPLY_INCLUDE_WHAT,ZmSetting.REPLY_USE_PREFIX,ZmSetting.REPLY_INCLUDE_HEADERS];\nvar c=AjxUtil.arrayAsHash(b);\nvar e=ZmSetting.REPLY_INCLUDE_ORIG;\nif(!c[j.id]){b=[ZmSetting.FORWARD_INCLUDE_WHAT,ZmSetting.FORWARD_USE_PREFIX,ZmSetting.FORWARD_INCLUDE_HEADERS];\ne=ZmSetting.FORWARD_INCLUDE_ORIG\n}var h=AjxUtil.map(b,function(k){return appCtxt.get(k)\n});\nvar g=(h[0]==ZmSetting.INC_NONE||h[0]==ZmSetting.INC_ATTACH)?h[0]:h.join(\"|\");\nvar a=ZmMailApp.INC_MAP_REV[g];\nvar i=appCtxt.getSettings().getSetting(e);\ni.setValue(a);\nd.push(i)\n};\nZmPref.addOOOVacationExternalPrefToList=function(c,b,a){var d=appCtxt.get(b);\nif(d!==a){prefToAdd=appCtxt.getSettings().getSetting(b);\nprefToAdd.setValue(a);\nc.push(prefToAdd)\n}};\nZmPref.addOOOVacationExternalPrefOnSave=function(a,d,c,b){var f,e;\nZmPref.addOOOVacationExternalPrefToList(c,ZmSetting.VACATION_EXTERNAL_SUPPRESS,d);\nf=b.getFormObject(ZmSetting.VACATION_EXTERNAL_SUPPRESS);\ne=f.getText();\nif(e.indexOf(ZmMsg.vacationExternalReplySuppress)===-1){if(e===ZmMsg.vacationExternalAllStandard){ZmPref.addOOOVacationExternalPrefToList(c,ZmSetting.VACATION_EXTERNAL_MSG_ENABLED,false);\nreturn\n}if(e===ZmMsg.vacationExternalAllCustom){ZmPref.addOOOVacationExternalPrefToList(c,ZmSetting.VACATION_EXTERNAL_TYPE,\"ALL\")\n}if(e===ZmMsg.vacationExternalAllExceptABCustom){ZmPref.addOOOVacationExternalPrefToList(c,ZmSetting.VACATION_EXTERNAL_TYPE,\"ALLNOTINAB\")\n}ZmPref.addOOOVacationExternalPrefToList(c,ZmSetting.VACATION_EXTERNAL_MSG_ENABLED,true)\n}};\nZmPref.initOOOVacationExternalSuppress=function(){var d=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_EXTERNAL_MSG);\nvar a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView().getView(d.id);\nvar c=a.getFormObject(ZmSetting.VACATION_EXTERNAL_MSG);\nvar e=a.getFormObject(ZmSetting.VACATION_EXTERNAL_SUPPRESS);\nif(appCtxt.get(ZmSetting.VACATION_EXTERNAL_SUPPRESS)){c.setVisible(false);\nreturn\n}if(!appCtxt.get(ZmSetting.VACATION_EXTERNAL_MSG_ENABLED)){e.setSelected(0);\nc.setVisible(false);\nreturn\n}var b={ALL:1,ALLNOTINAB:2};\ne.setSelected(b[appCtxt.get(ZmSetting.VACATION_EXTERNAL_TYPE)])\n};\nZmPref.initIncludeWhat=function(a,b){AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){ZmPref._showIncludeOptions(a,(b==ZmSetting.INC_BODY||b==ZmSetting.INC_SMART))\n}),100)\n};\nZmPref.onChangeIncludeWhat=function(d){var a=d._args.newValue;\nvar c=d._args.oldValue;\nvar e=(a==ZmSetting.INC_BODY||a==ZmSetting.INC_SMART);\nvar b=(c==ZmSetting.INC_BODY||c==ZmSetting.INC_SMART);\nif(e!=b){ZmPref._showIncludeOptions(d._args.selectObj,e)\n}};\nZmPref._showIncludeOptions=function(a,b){var c=(a._name==ZmSetting.REPLY_INCLUDE_WHAT)?[ZmSetting.REPLY_USE_PREFIX,ZmSetting.REPLY_INCLUDE_HEADERS]:[ZmSetting.FORWARD_USE_PREFIX,ZmSetting.FORWARD_INCLUDE_HEADERS];\nfor(var d=0;\nd<c.length;\nd++){var e=a.parent._dwtObjects[c[d]];\nif(e){e.setVisible(b)\n}}};\nZmPref.getSendToFiltersActive=function(a,b){if(a.target.checked){if(b){b.run(false)\n}return false\n}AjxDispatcher.run(\"GetFilterController\").hasOutgoingFiltersActive(b)\n};\nZmPref.onChangeConfirm=function(c,b,e,g,d){var a=false;\nvar f=e?new AjxCallback(this,ZmPref._showOnChangeConfirm,[c,g]):null;\nif(AjxUtil.isFunction(b)){a=b(d,f)\n}else{if(AjxUtil.isInstance(b,AjxCallback)){a=b.run(d,f)\n}else{a=b\n}}ZmPref._showOnChangeConfirm(c,g,a)\n};\nZmPref._showOnChangeConfirm=function(c,d,a){if(a){if(a){var b=appCtxt.getYesNoMsgDialog();\nb.reset();\nb.setMessage(c);\nb.setButtonListener(DwtDialog.NO_BUTTON,new AjxListener(null,ZmPref._handleOnChangeConfirmNo,[d]));\nb.popup()\n}}};\nZmPref._handleOnChangeConfirmNo=function(a){if(a){a.run()\n}appCtxt.getYesNoMsgDialog().popdown()\n};\nZmPref.__BY_NUMBER=function(d,c){if(d==c){return 0\n}if(d==Math.POSITIVE_INFINITY||c==Math.NEGATIVE_INFINITY){return 1\n}if(c==Math.POSITIVE_INFINITY||d==Math.NEGATIVE_INFINITY){return -1\n}return Number(d)-Number(c)\n};\nZmPref.__BY_DURATION=function(d,c){if(d==c){return 0\n}if(d==\"0\"){return 1\n}if(c==\"0\"){return -1\n}var e=ZmPref.__DUR2SECS(d);\nvar f=ZmPref.__DUR2SECS(c);\nreturn e-f\n};\nZmPref.__DURMULT={s:1,m:60,h:3600,d:86400};\nZmPref.__DURDIV={86400:\"d\",3600:\"h\",60:\"m\",1:\"s\"};\nZmPref.__DUR2SECS=function(b){if(b==\"0\"){return Number.POSITIVE_INFINITY\n}var a=b.substring(b.length-1).toLowerCase();\nreturn parseInt(b,10)*ZmPref.__DURMULT[a]\n};\nZmPref.__SECS2DUR=function(d,b){if(d==Number.POSITIVE_INFINITY){return\"0\"\n}var c=ZmPref.__DURDIV;\nif(b){b={};\nb[ZmPref.__DURMULT[b]]=b\n}for(var e in c){var a=Math.floor(d/e);\nif(a>0){return[a,c[e]].join(\"\")\n}}return\"0\"+b\n};\nZmPref.MAX_LENGTH={};\nZmPref.MAX_LENGTH[ZmSetting.INITIAL_SEARCH]=512;\nZmPref.MAX_LENGTH[ZmSetting.SIGNATURE]=1024;\nZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE]=8192;\nZmPref.setPrefList=function(a,b){ZmPref[a]=b\n};\nZmPref.SETUP={};\nZmPref.registerPref=function(b,a){ZmPref.SETUP[b]=a\n};\nZmPref.clearPrefSections=function(){ZmPref._prefSectionMap={};\nZmPref._prefSectionArray=null\n};\nZmPref.registerPrefSection=function(c,b){if(!c||!b){return\n}var a=b.templateId||c;\nif(!a.match(/#/)){a=[\"prefs.Pages\",a].join(\"#\")\n}b.templateId=a;\nb.id=c;\nappCtxt.set(ZmSetting.PREF_SECTIONS,b,c);\nZmPref._prefSectionArray=null\n};\nZmPref.unregisterPrefSection=function(a){appCtxt.set(ZmSetting.PREF_SECTIONS,null,a);\nZmPref._prefSectionArray=null\n};\nZmPref.getPrefSectionMap=function(){return appCtxt.get(ZmSetting.PREF_SECTIONS)\n};\nZmPref.getPrefSectionArray=function(){if(!ZmPref._prefSectionArray){ZmPref._prefSectionArray=[];\nvar a=appCtxt.get(ZmSetting.PREF_SECTIONS);\nfor(var b in a){ZmPref._prefSectionArray.push(a[b])\n}ZmPref._prefSectionArray.sort(ZmPref.__BY_PRIORITY)\n}return ZmPref._prefSectionArray\n};\nZmPref.getPrefSectionWithPref=function(d){var b=appCtxt.get(ZmSetting.PREF_SECTIONS);\nfor(var c in b){var e=b[c];\nif(e.prefs==null){continue\n}for(var a=0;\na<e.prefs.length;\na++){if(e.prefs[a]==d){return e\n}}}return null\n};\nZmPref.clearPrefSections();\nZmPref.__BY_PRIORITY=function(d,c){return Number(d.priority)-Number(c.priority)\n};\nZmPref.regenerateSignatureEditor=function(d){var a=d.parent;\nvar b=document.getElementById(a._htmlElId+\"_SIG_EDITOR\");\nvar c=new ZmHtmlEditor({parent:a,parentElement:b.parentNode,textAreaId:\"TEXTAREA_SIGNATURE\",autoFocus:true,attachmentCallback:a._insertImagesListener.bind(a)});\nb.parentNode.removeChild(b);\na._sigEditor=c;\na._populateSignatures()\n};\nZmPref._normalizeFontId=function(h,g){var d=h;\nh=h.replace(/,\\s/g,\",\").replace(/'/g,\"\").toLowerCase();\nif(!g){var e=ZmPref.FONT_FAMILY;\nif(e&&!e[h]){var c=AjxUtil.keys(e);\nif(c.length){var f=h.split(\",\");\nfor(var b=0;\nb<f.length;\nb++){for(var a=0;\na<c.length;\na++){if(c[a].indexOf(f[b])!=-1){return c[a]\n}}}return c[0]\n}}}return h\n};\nZmPref._normalizeFontName=function(a){return ZmPref.FONT_FAMILY[ZmPref._normalizeFontId(a)].name\n};\nZmPref._normalizeFontValue=function(a){return ZmPref.FONT_FAMILY[ZmPref._normalizeFontId(a)].value\n};\nZmPref.handleOOOVacationExternalOptionChange=function(d){var e=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_EXTERNAL_MSG);\nvar b=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView().getView(e.id);\nvar c=b.getFormObject(ZmSetting.VACATION_EXTERNAL_MSG);\nvar f=b.getFormObject(ZmSetting.VACATION_EXTERNAL_SUPPRESS);\nvar a=f.getSelectedOption().getItem()._optionIndex;\nif(a===0||a===3){c.setVisible(false)\n}else{c.setVisible(true)\n}};\nZmPref.setMailNotificationAddressValue=function(a,f,e,c){a.setValue(f);\ne.push(a);\nvar b=appCtxt.getSettings().getSetting(ZmSetting.NOTIF_ENABLED),d=!!f;\nif(b.getValue()!==d){b.setValue(d);\ne.push(b)\n}};\nZmPref.FONT_FAMILY={};\n(function(){var a=[\"fontFamilyIntl\",\"fontFamilyBase\"];\nvar e,c,d,f,b;\nfor(c=0;\nc<a.length;\nc++){for(e=1;\nf=AjxMsg[a[c]+e+\".css\"];\ne++){if(f.match(/^#+$/)){break\n}f=ZmPref._normalizeFontId(f,true);\nb=AjxMsg[a[c]+e+\".display\"];\nZmPref.FONT_FAMILY[f]={name:b,value:f}\n}}})()\n}if(AjxPackage.define(\"zimbraMail.calendar.model.ZmCalBaseItem\")){ZmCalBaseItem=function(b,c,d,a){if(arguments.length==0){return\n}ZmItem.call(this,b,d,c);\nthis.id=d||-1;\nthis.uid=-1;\nthis.folderId=a||this._getDefaultFolderId();\nthis.fragment=\"\";\nthis.name=\"\";\nthis.allDayEvent=\"0\";\nthis.startDate=null;\nthis.endDate=null;\nthis.timezone=AjxTimezone.getServerId(AjxTimezone.DEFAULT);\nthis.alarm=false;\nthis.alarmData=null;\nthis.isException=false;\nthis.recurring=false;\nthis.priority=null;\nthis.ptst=null;\nthis.status=ZmCalendarApp.STATUS_CONF;\nthis._reminderMinutes=0;\nthis.otherAttendees=false\n};\nZmCalBaseItem.prototype=new ZmItem;\nZmCalBaseItem.prototype.constructor=ZmCalBaseItem;\nZmCalBaseItem.prototype.toString=function(){return\"ZmCalBaseItem\"\n};\nZmCalBaseItem.PERSON=\"PERSON\";\nZmCalBaseItem.OPTIONAL_PERSON=\"OPT_PERSON\";\nZmCalBaseItem.GROUP=\"GROUP\";\nZmCalBaseItem.LOCATION=\"LOCATION\";\nZmCalBaseItem.EQUIPMENT=\"EQUIPMENT\";\nZmCalBaseItem.FORWARD=\"FORWARD\";\nZmCalBaseItem.PSTATUS_ACCEPT=\"AC\";\nZmCalBaseItem.PSTATUS_DECLINED=\"DE\";\nZmCalBaseItem.PSTATUS_DEFERRED=\"DF\";\nZmCalBaseItem.PSTATUS_DELEGATED=\"DG\";\nZmCalBaseItem.PSTATUS_NEEDS_ACTION=\"NE\";\nZmCalBaseItem.PSTATUS_COMPLETED=\"CO\";\nZmCalBaseItem.PSTATUS_TENTATIVE=\"TE\";\nZmCalBaseItem.PSTATUS_WAITING=\"WA\";\nZmCalBaseItem.FBA_TO_PTST={B:ZmCalBaseItem.PSTATUS_ACCEPT,F:ZmCalBaseItem.PSTATUS_DECLINED,T:ZmCalBaseItem.PSTATUS_TENTATIVE};\nZmCalBaseItem._pstatusString={NE:ZmMsg._new,TE:ZmMsg.tentative,AC:ZmMsg.accepted,DE:ZmMsg.declined,DG:ZmMsg.delegated};\nZmCalBaseItem.compareByTimeAndDuration=function(d,c){if(d.getStartTime()>c.getStartTime()){return 1\n}if(d.getStartTime()<c.getStartTime()){return -1\n}if(d.getDuration()<c.getDuration()){return 1\n}if(d.getDuration()>c.getDuration()){return -1\n}return 0\n};\nZmCalBaseItem.createFromDom=function(b,c,a){var d=new ZmCalBaseItem(ZmItem.APPT,c.list);\nd._loadFromDom(b,(a||{}));\nreturn d\n};\nZmCalBaseItem.prototype.getName=function(){return this.name||\"\"\n};\nZmCalBaseItem.prototype.getEndTime=function(){return this.endDate.getTime()\n};\nZmCalBaseItem.prototype.getStartTime=function(){return this.startDate.getTime()\n};\nZmCalBaseItem.prototype.getAlarmInstStart=function(){return this._alarmInstStart\n};\nZmCalBaseItem.prototype.getDuration=function(){return this.getEndTime()-this.getStartTime()\n};\nZmCalBaseItem.prototype.getLocation=function(){return this.location||\"\"\n};\nZmCalBaseItem.prototype.isAllDayEvent=function(){return this.allDayEvent==\"1\"\n};\nZmCalBaseItem.prototype.getParticipantStatusStr=function(){return ZmCalBaseItem._pstatusString[this.ptst]\n};\nZmCalBaseItem.prototype.getUniqueId=function(a){if(a){if(!this._startTimeUniqId){this._startTimeUniqId=this.id+\"_\"+this.getStartTime()\n}return this._startTimeUniqId\n}else{if(this._uniqId==null){this._uniqId=Dwt.getNextId()\n}return(this.id+\"_\"+this._uniqId)\n}};\nZmCalBaseItem.prototype.isMultiDay=function(){var b=this.startDate;\nvar a=this.endDate;\nif(!b&&!a){return false\n}if(!b){return false\n}if(a.getHours()==0&&a.getMinutes()==0&&a.getSeconds()==0){a=new Date(a.getTime()-2*AjxDateUtil.MSEC_PER_HOUR)\n}return(b.getDate()!=a.getDate())||(b.getMonth()!=a.getMonth())||(b.getFullYear()!=a.getFullYear())\n};\nZmCalBaseItem.prototype.getDurationText=function(c,a,f){var d=this.isAllDayEvent();\nvar g=this.isMultiDay();\nvar e;\nif(d){if(c){return\"\"\n}var h=this.startDate;\nvar b=new Date(this.endDate.getTime()-(g?2*AjxDateUtil.MSEC_PER_HOUR:0));\nif(f){if(g){e=ZmMsg.apptTimeAllDayMultiCondensed\n}else{return ZmMsg.allDay\n}}else{e=g?ZmMsg.apptTimeAllDayMulti:ZmMsg.apptTimeAllDay\n}return AjxMessageFormat.format(e,[h,b])\n}if(a){return ZmCalBaseItem._getTTHour(this.startDate)\n}if(f){e=g?ZmMsg.apptTimeInstanceMultiCondensed:ZmMsg.apptTimeInstanceCondensed\n}else{e=g?ZmMsg.apptTimeInstanceMulti:ZmMsg.apptTimeInstance\n}return AjxMessageFormat.format(e,[this.getDateInLocalTimezone(this.startDate),this.getDateInLocalTimezone(this.endDate),\"\"])\n};\nZmCalBaseItem.prototype.isAlarmInRange=function(){if(!this.alarmData){return false\n}var b=this.alarmData[0];\nif(!b){return false\n}this._nextAlarmTime=this.adjustMS(b.nextAlarm,this.tzo);\nthis._alarmInstStart=this.adjustMS(b.alarmInstStart,this.tzo);\nvar a=(new Date()).getTime();\nreturn(a>=this._nextAlarmTime)\n};\nZmCalBaseItem.prototype.adjustMS=function(a,c){var b=this.isAllDayEvent()?(c+new Date(a).getTimezoneOffset()*60*1000):0;\nreturn parseInt(a,10)+b\n};\nZmCalBaseItem.prototype.isAlarmInstance=function(){var a=this.alarmData?this.alarmData[0]:null;\nif(!a||!a.alarmInstStart||!this.startDate){return false\n}this._alarmInstStart=this.adjustMS(a.alarmInstStart,this.tzo);\nreturn(this._alarmInstStart==this.startDate.getTime())\n};\nZmCalBaseItem.prototype.hasAlarmData=function(){return(this.alarmData!=null)\n};\nZmCalBaseItem.prototype._loadFromDom=function(c,a){this.uid=c.uid;\nthis.folderId=c.l||this._getDefaultFolderId();\nthis.invId=c.invId;\nthis.isException=a.ex;\nthis.id=c.id;\nthis.name=this._getAttr(c,a,\"name\");\nthis.fragment=this._getAttr(c,a,\"fr\");\nthis.status=this._getAttr(c,a,\"status\");\nthis.ptst=this._getAttr(c,a,\"ptst\");\nthis.allDayEvent=(a.allDay||c.allDay)?\"1\":\"0\";\nthis.organizer=c.or&&c.or.a;\nthis.isOrg=this._getAttr(c,a,\"isOrg\");\nthis.transparency=this._getAttr(c,a,\"transp\");\nif(a.allDay==false){this.allDayEvent=\"0\"\n}this.alarm=this._getAttr(c,a,\"alarm\");\nthis.alarmData=this._getAttr(c,a,\"alarmData\");\nif(!this.alarmData&&this.isException){this.alarmData=c.alarmData\n}this.priority=parseInt(this._getAttr(c,a,\"priority\"));\nthis.recurring=a.recur!=null?a.recur:c.recur;\nthis.ridZ=this.recurring&&a&&a.ridZ;\nthis.fba=this._getAttr(c,a,\"fba\");\nvar g=a.s!=null?a.s:c.inst&&c.inst.length>0&&c.inst[0].s;\nif(g){var h=this.tzo=a.tzo!=null?a.tzo:c.tzo;\nvar f=this.isAllDayEvent()?(h+new Date(g).getTimezoneOffset()*60*1000):0;\nvar e=parseInt(g,10)+f;\nthis.startDate=new Date(e);\nthis.uniqStartTime=this.startDate.getTime()\n}var d=this._getAttr(c,a,\"dur\");\nif(d){var b=e+(parseInt(d));\nthis.endDate=new Date(b)\n}this.otherAttendees=this._getAttr(c,a,\"otherAtt\");\nthis.location=this._getAttr(c,a,\"loc\")\n};\nZmCalBaseItem.prototype._getDefaultFolderId=function(){return appCtxt.get(ZmSetting.CAL_DEFAULT_ID)\n};\nZmCalBaseItem.prototype._getAttr=function(a,c,b){return c[b]!=null?c[b]:c.ex?null:a[b]\n};\nZmCalBaseItem.prototype._addLocationToRequest=function(a){a.loc=this.getLocation()\n};\nZmCalBaseItem._getTTHour=function(b){var a=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);\nreturn a.format(b)\n};\nZmCalBaseItem.prototype.getReminderLocation=function(){return(this.alarmData[0].loc||\"\")\n};\nZmCalBaseItem.prototype.getReminderName=function(){return(this.alarmData[0].name||\"\")\n};\nZmCalBaseItem.prototype.getAlarmData=function(){return this.alarmData\n};\nZmCalBaseItem.prototype.isAlarmOld=function(){if(!this.alarmData){return false\n}var c=this.alarmData[0];\nthis._nextAlarmTime=c.nextAlarm;\nthis._alarmInstStart=c.alarmInstStart;\nvar a=(new Date()).getTime();\nvar b=(a-this._nextAlarmTime);\nif(b>2*60*1000){return true\n}return false\n};\nZmCalBaseItem.prototype.getRestUrl=function(){if(this.restUrl){return this.restUrl\n}var a=appCtxt.getById(this.folderId);\nvar b=a?([a.getRestUrl(),\"/?id=\",AjxStringUtil.urlComponentEncode(this.id||this.invId)].join(\"\")):null;\nreturn b\n};\nZmCalBaseItem.prototype.getDateInLocalTimezone=function(b){var e=this.getTimezone();\nvar a=AjxTimezone.getServerId(AjxTimezone.DEFAULT);\nif(e!=a){var d=AjxTimezone.getOffset(AjxTimezone.DEFAULT,b);\nvar c=AjxTimezone.getOffset(AjxTimezone.getClientId(e),b);\nreturn new Date(b.getTime()+(d-c)*60*1000)\n}return b\n}\n}if(AjxPackage.define(\"zimbraMail.calendar.model.ZmCalItem\")){ZmCalItem=function(b,c,d,a){if(arguments.length==0){return\n}ZmCalBaseItem.call(this,b,c,d,a);\nthis.notesTopPart=null;\nthis.attachments=null;\nthis.viewMode=ZmCalItem.MODE_NEW;\nthis._recurrence=new ZmRecurrence(this);\nthis._noBusyOverlay=null;\nthis._sendNotificationMail=true;\nthis.identity=null;\nthis.isProposeTimeMode=false;\nthis.isForwardMode=false;\nthis.alarmActions=new AjxVector();\nthis.alarmActions.add(ZmCalItem.ALARM_DISPLAY);\nthis._useAbsoluteReminder=false;\nthis._ignoreVersion=false\n};\nZmCalItem.prototype=new ZmCalBaseItem;\nZmCalItem.prototype.constructor=ZmCalItem;\nZmCalItem.prototype.toString=function(){return\"ZmCalItem\"\n};\nZmCalItem.MODE_NEW=\"NEW\";\nZmCalItem.MODE_EDIT=\"EDIT\";\nZmCalItem.MODE_COPY_SINGLE_INSTANCE=\"COPY_INST\";\nZmCalItem.MODE_EDIT_SINGLE_INSTANCE=\"EDIT_INST\";\nZmCalItem.MODE_EDIT_SERIES=\"EDIT_SER\";\nZmCalItem.MODE_DELETE=\"DELETE\";\nZmCalItem.MODE_DELETE_INSTANCE=\"DELETE_INST\";\nZmCalItem.MODE_DELETE_SERIES=\"DELETE_SER\";\nZmCalItem.MODE_NEW_FROM_QUICKADD=\"NEW_FROM_QUICK\";\nZmCalItem.MODE_GET=\"GET\";\nZmCalItem.MODE_FORWARD=\"FORWARD\";\nZmCalItem.MODE_FORWARD_SINGLE_INSTANCE=\"FORWARD_INST\";\nZmCalItem.MODE_FORWARD_SERIES=\"FORWARD_SER\";\nZmCalItem.MODE_FORWARD_INVITE=\"FORWARD_INV\";\nZmCalItem.MODE_PROPOSE_TIME=\"PROPOSE_TIME\";\nZmCalItem.MODE_PURGE=15;\nZmCalItem.MODE_LAST=15;\nZmCalItem.FORWARD_MAPPING={};\nZmCalItem.FORWARD_MAPPING[ZmCalItem.MODE_FORWARD]=ZmCalItem.MODE_EDIT;\nZmCalItem.FORWARD_MAPPING[ZmCalItem.MODE_FORWARD_SINGLE_INSTANCE]=ZmCalItem.MODE_EDIT_SINGLE_INSTANCE;\nZmCalItem.FORWARD_MAPPING[ZmCalItem.MODE_FORWARD_SERIES]=ZmCalItem.MODE_EDIT_SERIES;\nZmCalItem.FORWARD_MAPPING[ZmCalItem.MODE_FORWARD_INVITE]=ZmCalItem.MODE_EDIT;\nZmCalItem.PRIORITY_LOW=9;\nZmCalItem.PRIORITY_LOW_RANGE=[6,7,8,9];\nZmCalItem.PRIORITY_NORMAL=5;\nZmCalItem.PRIORITY_NORMAL_RANGE=[0,5];\nZmCalItem.PRIORITY_HIGH=1;\nZmCalItem.PRIORITY_HIGH_RANGE=[1,2,3,4];\nZmCalItem.ROLE_CHAIR=\"CHA\";\nZmCalItem.ROLE_REQUIRED=\"REQ\";\nZmCalItem.ROLE_OPTIONAL=\"OPT\";\nZmCalItem.ROLE_NON_PARTICIPANT=\"NON\";\nZmCalItem.SERVER_WEEK_DAYS=[\"SU\",\"MO\",\"TU\",\"WE\",\"TH\",\"FR\",\"SA\"];\nZmCalItem.ATTACHMENT_CHECKBOX_NAME=\"__calAttCbox__\";\nZmCalItem.ATT_LINK_IMAGE=\"mainImage\";\nZmCalItem.ATT_LINK_MAIN=\"main\";\nZmCalItem.ATT_LINK_DOWNLOAD=\"download\";\nZmCalItem.REMINDER_UNIT_MINUTES=\"minutes\";\nZmCalItem.REMINDER_UNIT_HOURS=\"hours\";\nZmCalItem.REMINDER_UNIT_DAYS=\"days\";\nZmCalItem.REMINDER_UNIT_WEEKS=\"weeks\";\nZmCalItem.REMINDER_NONE=\"none\";\nZmCalItem.ALARM_DISPLAY=\"DISPLAY\";\nZmCalItem.ALARM_EMAIL=\"EMAIL\";\nZmCalItem.ALARM_DEVICE_EMAIL=\"DEVICE_EMAIL\";\nZmCalItem.MSEC_LIMIT_PER_WEEK=AjxDateUtil.MSEC_PER_DAY*7;\nZmCalItem.MSEC_LIMIT_PER_MONTH=AjxDateUtil.MSEC_PER_DAY*7*5;\nZmCalItem.MSEC_LIMIT_PER_YEAR=AjxDateUtil.MSEC_PER_DAY*366;\nZmCalItem.prototype.getCompNum=function(){return this.compNum||\"0\"\n};\nZmCalItem.prototype.getFolder=function(){};\nZmCalItem.prototype.getOrganizer=function(){return this.organizer||\"\"\n};\nZmCalItem.prototype.getOrganizerName=function(){return this.organizerName\n};\nZmCalItem.prototype.getSentBy=function(){return this.sentBy||\"\"\n};\nZmCalItem.prototype.getOrigStartDate=function(){return this._origStartDate||this.startDate\n};\nZmCalItem.prototype.getOrigStartTime=function(){return this.getOrigStartDate().getTime()\n};\nZmCalItem.prototype.getOrigEndDate=function(){return this._origEndDate||this.endDate\n};\nZmCalItem.prototype.getOrigEndTime=function(){return this.getOrigEndDate().getTime()\n};\nZmCalItem.prototype.getOrig=function(){return this._orig\n};\nZmCalItem.prototype.getOrigTimezone=function(){return this._origTimezone||this.timezone\n};\nZmCalItem.prototype.getRecurBlurb=function(){return this._recurrence.getBlurb()\n};\nZmCalItem.prototype.getRecurrence=function(){return this._recurrence\n};\nZmCalItem.prototype.getRecurType=function(){return this._recurrence.repeatType\n};\nZmCalItem.prototype.getTimezone=function(){return this.timezone\n};\nZmCalItem.prototype.getSummary=function(a){};\nZmCalItem.prototype.getToolTip=function(a){};\nZmCalItem.prototype.isCustomRecurrence=function(){return this._recurrence.repeatCustom==\"1\"||this._recurrence.repeatEndType!=\"N\"\n};\nZmCalItem.prototype.isOrganizer=function(){return(typeof(this.isOrg)===\"undefined\")||(this.isOrg==true)\n};\nZmCalItem.prototype.isRecurring=function(){return(this.recurring||(this._rawRecurrences!=null))\n};\nZmCalItem.prototype.hasAttachments=function(){return this.getAttachments()!=null\n};\nZmCalItem.prototype.hasAttendeeForType=function(a){return false\n};\nZmCalItem.prototype.hasAttendees=function(){return false\n};\nZmCalItem.prototype.hasPersonAttendees=function(){return false\n};\nZmCalItem.prototype.setAllDayEvent=function(a){this.allDayEvent=a?\"1\":\"0\"\n};\nZmCalItem.prototype.setName=function(a){this.name=a\n};\nZmCalItem.prototype.setOrganizer=function(a){this.organizer=a!=\"\"?a:null\n};\nZmCalItem.prototype.setRecurType=function(a){this._recurrence.repeatType=a\n};\nZmCalItem.prototype.setType=function(a){this.type=a\n};\nZmCalItem.prototype.setOrigTimezone=function(a){this._origTimezone=a\n};\nZmCalItem.prototype.setFolderId=function(a){this.folderId=a||ZmOrganizer.ID_CALENDAR\n};\nZmCalItem.prototype.getLocalFolderId=function(){var b=this.folderId;\nif(this.isShared()){var a=appCtxt.getById(this.folderId);\nif(a){b=a.id\n}}return b\n};\nZmCalItem.prototype.setEndDate=function(b,a){if(this._origEndDate==null&&this.endDate!=null&&this.endDate!=\"\"){this._origEndDate=new Date(this.endDate.getTime())\n}this.endDate=new Date(b instanceof Date?b.getTime():b);\nif(!a){this._resetCached()\n}};\nZmCalItem.prototype.setStartDate=function(a,b){if(this._origStartDate==null&&this.startDate!=null&&this.startDate!=\"\"){this._origStartDate=new Date(this.startDate.getTime())\n}this.startDate=new Date(a instanceof Date?a.getTime():a);\nif(!b){this._resetCached()\n}if(this.recurring&&this._recurrence){this._recurrence.setRecurrenceStartTime(this.startDate.getTime())\n}};\nZmCalItem.prototype.setTimezone=function(a,b){if(this._origTimezone==null){this._origTimezone=a\n}this.timezone=a;\nif(!b){this._resetCached()\n}};\nZmCalItem.prototype.setEndTimezone=function(a){if(this._origEndTimezone==null){this._origEndTimezone=a\n}this.endTimezone=a\n};\nZmCalItem.prototype.setViewMode=function(a){this.viewMode=a||ZmCalItem.MODE_NEW;\nif(this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE){this._recurrence.repeatType=\"NON\"\n}};\nZmCalItem.prototype.getViewMode=function(a){return this.viewMode\n};\nZmCalItem.prototype.getNotesPart=function(e){if(this.notesTopPart){var a=e||ZmMimeTable.TEXT_PLAIN;\nvar b=this.notesTopPart.getContentForType(a);\nif(!b){if(a==ZmMimeTable.TEXT_PLAIN){var d=document.createElement(\"div\");\nb=this.notesTopPart.getContentForType(ZmMimeTable.TEXT_HTML);\nd.innerHTML=b||\"\";\nvar c=AjxStringUtil.convertHtml2Text(d);\nreturn c.substring(1)\n}else{if(a==ZmMimeTable.TEXT_HTML){b=AjxStringUtil.convertToHtml(this.notesTopPart.getContentForType(ZmMimeTable.TEXT_PLAIN))\n}}}return b\n}else{return this.fragment\n}};\nZmCalItem.prototype.getRemoteFolderOwner=function(){var b=AjxDispatcher.run(\"GetCalController\");\nif(b.isMovingBetwAccounts(this,this.folderId)){return null\n}var c=this.getFolder();\nvar a=c&&c.link&&c.owner;\nvar d=(!a&&appCtxt.multiAccounts&&c.getAccount());\nif(d){a=d.name\n}return a\n};\nZmCalItem.prototype.isReadOnly=function(){var c=this.getFolder();\nif(appCtxt.multiAccounts){var a=appCtxt.accountList.getAccountByEmail(this.organizer);\nvar b=appCtxt.accountList.getAccountByEmail(c.getAccount().getEmail());\nif(a==b){return false\n}}return(!this.isOrganizer()||(c.link&&c.isReadOnly()))\n};\nZmCalItem.prototype.isFolderReadOnly=function(){var a=this.getFolder();\nreturn(a&&a.isReadOnly())\n};\nZmCalItem.prototype.isVersionIgnored=function(){return this._ignoreVersion\n};\nZmCalItem.prototype.setIgnoreVersion=function(a){this._ignoreVersion=a\n};\nZmCalItem.prototype.resetRepeatWeeklyDays=function(){if(this.startDate){this._recurrence.repeatWeeklyDays=[ZmCalItem.SERVER_WEEK_DAYS[this.startDate.getDay()]]\n}};\nZmCalItem.prototype.resetRepeatMonthlyDayList=function(){if(this.startDate){this._recurrence.repeatMonthlyDayList=[this.startDate.getDate()]\n}};\nZmCalItem.prototype.resetRepeatYearlyMonthsList=function(a){this._recurrence.repeatYearlyMonthsList=a\n};\nZmCalItem.prototype.resetRepeatCustomDayOfWeek=function(){if(this.startDate){this._recurrence.repeatCustomDayOfWeek=ZmCalItem.SERVER_WEEK_DAYS[this.startDate.getDay()]\n}};\nZmCalItem.prototype.isOverlapping=function(a,f){if(f&&this.folderId!=a.folderId){return false\n}var b=this.getStartTime();\nvar d=this.getEndTime();\nvar e=a.getStartTime();\nvar c=a.getEndTime();\nreturn(b<c)&&(d>e)\n};\nZmCalItem.prototype.isInRange=function(c,b){var a=this.getStartTime();\nvar d=this.getEndTime();\nreturn(a<b&&d>c)\n};\nZmCalItem.prototype.isValidDuration=function(){var d=this.getStartTime();\nvar b=this.getEndTime();\nif(this.endTimezone&&this.endTimezone!=this.timezone){var a=AjxTimezone.getRule(this.timezone).standard.offset;\nvar c=AjxTimezone.getRule(this.endTimezone).standard.offset;\nd=d-(a*60000);\nb=b-(c*60000)\n}return(d<=b)\n};\nZmCalItem.prototype.isValidDurationRecurrence=function(){var a=true;\nvar c=this.getRecurType();\nvar b=this.getDuration();\nswitch(c){case ZmRecurrence.DAILY:a=b<=AjxDateUtil.MSEC_PER_DAY;\nbreak;\ncase ZmRecurrence.WEEKLY:a=b<=ZmCalItem.MSEC_LIMIT_PER_WEEK;\nbreak;\ncase ZmRecurrence.MONTHLY:a=b<=ZmCalItem.MSEC_LIMIT_PER_MONTH;\nbreak;\ncase ZmRecurrence.YEARLY:a=b<=ZmCalItem.MSEC_LIMIT_PER_YEAR;\nbreak;\ndefault:break\n}return a\n};\nZmCalItem.prototype.parseAlarmData=function(){if(!this.alarmData){return\n}for(var b=0;\nb<this.alarmData.length;\nb++){var c=this.alarmData[b].alarm;\nif(c){for(var a=0;\na<c.length;\na++){this.parseAlarm(c[a])\n}}}};\nZmCalItem.prototype.parseAlarm=function(f){if(!f){return\n}var i,b,g,j,c;\nvar e=f.trigger;\nvar a=(e&&(e.length>0))?e[0].rel:null;\ni=(a&&(a.length>0))?a[0].s:null;\nb=(a&&(a.length>0))?a[0].m:null;\nj=(a&&(a.length>0))?a[0].d:null;\ng=(a&&(a.length>0))?a[0].h:null;\nc=(a&&(a.length>0))?a[0].w:null;\nthis._reminderMinutes=-1;\nif(f.action==ZmCalItem.ALARM_DISPLAY){if(i==0){this._reminderMinutes=0\n}if(b!=null){this._reminderMinutes=b;\nthis._origReminderUnits=ZmCalItem.REMINDER_UNIT_MINUTES\n}if(g!=null){g=parseInt(g);\nthis._reminderMinutes=g*60;\nthis._origReminderUnits=ZmCalItem.REMINDER_UNIT_HOURS\n}if(j!=null){j=parseInt(j);\nthis._reminderMinutes=j*24*60;\nthis._origReminderUnits=ZmCalItem.REMINDER_UNIT_DAYS\n}if(c!=null){c=parseInt(c);\nthis._reminderMinutes=c*7*24*60;\nthis._origReminderUnits=ZmCalItem.REMINDER_UNIT_WEEKS\n}}};\nZmCalItem.prototype.isStartInRange=function(c,b){var a=this.getStartTime();\nreturn(a<b&&a>=c)\n};\nZmCalItem.prototype.isEndInRange=function(b,a){var c=this.getEndTime();\nreturn(c<=a&&c>b)\n};\nZmCalItem.prototype.setDateRange=function(c,a,f,b){var d=c.startDate;\nvar g=c.endDate;\nthis.endDate.setTime(c.endDate.getTime());\nthis.startDate.setTime(c.startDate.getTime())\n};\nZmCalItem.prototype.getDateRange=function(a,c,b){return{startDate:this.startDate,endDate:this.endDate}\n};\nZmCalItem.prototype.setAttachments=function(c){this.attachments=[];\nif(c&&c.length>0){var b=c.split(\",\");\nfor(var a=0;\na<b.length;\na++){this.attachments[a]={id:b[a]}\n}}};\nZmCalItem.prototype.getAttachments=function(){var b=this.message?this.message.attachments:null;\nif(b){if(this._validAttachments==null){this._validAttachments=[];\nfor(var a=0;\na<b.length;\n++a){if(this.message.isRealAttachment(b[a])||b[a].contentType==ZmMimeTable.TEXT_CAL){this._validAttachments.push(b[a])\n}}}return this._validAttachments.length>0?this._validAttachments:null\n}return null\n};\nZmCalItem.prototype.removeAttachment=function(a){if(this._validAttachments&&this._validAttachments.length>0){for(var b=0;\nb<this._validAttachments.length;\nb++){if(this._validAttachments[b].part==a){this._validAttachments.splice(b,1);\nbreak\n}}}};\nZmCalItem.prototype.getShortStartHour=function(){var a=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);\nreturn a.format(this.startDate)\n};\nZmCalItem.prototype.getUniqueStartDate=function(){if(this._uniqueStartDate==null&&this.uniqStartTime){this._uniqueStartDate=new Date(this.uniqStartTime)\n}return this._uniqueStartDate\n};\nZmCalItem.prototype.getUniqueEndDate=function(){if(this._uniqueEndDate==null&&this.uniqStartTime){this._uniqueEndDate=new Date(this.uniqStartTime+this.getDuration())\n}return this._uniqueEndDate\n};\nZmCalItem.prototype.getDetails=function(d,l,h,f,k,e){var i=d||this.viewMode;\nvar c=i==ZmCalItem.MODE_EDIT_SERIES;\nvar a=(c&&this.message&&!this.message.seriesMode);\nif(this.message==null||a){var b=c?(this.seriesInvId||this.invId||this.id):this.invId;\nthis.message=new ZmMailMsg(b);\nif(this._orig){this._orig.message=this.message\n}var n=new AjxCallback(this,this._handleResponseGetDetails,[i,this.message,l]);\nvar m=(!f)?(new AjxCallback(this,this._handleErrorGetDetails,[i,l,h])):h;\nvar j=appCtxt.isOffline&&this.getFolder().getAccount();\nvar g={callback:n,errorCallback:m,noBusyOverlay:k,ridZ:(c?null:this.ridZ),batchCmd:e,accountName:(j&&j.name)};\nthis.message.load(g)\n}else{this.setFromMessage(this.message,i);\nif(l){l.run()\n}}};\nZmCalItem.prototype.convertToLocalTimezone=function(){var f=this.getTimezone();\nvar b=AjxTimezone.getServerId(AjxTimezone.DEFAULT);\nvar e=this.startDate;\nvar a=this.endDate;\nif(f!=b){var d=AjxTimezone.getOffset(AjxTimezone.DEFAULT,e);\nvar c=AjxTimezone.getOffset(AjxTimezone.getClientId(f),e);\ne.setTime(e.getTime()+(d-c)*60*1000);\na.setTime(a.getTime()+(d-c)*60*1000);\nthis.setTimezone(b);\nthis.setEndTimezone(b)\n}};\nZmCalItem.prototype._handleResponseGetDetails=function(e,d,h,a){this.setFromMessage(d,e);\nd.seriesMode=(e==ZmCalItem.MODE_EDIT_SERIES);\nif(this._orig&&this._orig.proposedInvite){var c=this._orig.proposedInvite;\nvar g=c.getServerStartTime();\nvar b=c.getServerEndTime();\nif(g){this.setStartDate(AjxDateUtil.parseServerDateTime(g,true))\n}if(b){this.setEndDate(AjxDateUtil.parseServerDateTime(b,true))\n}var f=c.getServerStartTimeTz();\nthis.setTimezone(f||AjxTimezone.getServerId(AjxTimezone.DEFAULT));\nthis.startsInUTC=g?g.charAt(g.length-1)==\"Z\":null;\nthis.endsInUTC=b&&g?b.charAt(g.length-1)==\"Z\":null;\nthis.status=c.components[0].status;\nthis.convertToLocalTimezone();\nthis.isAcceptingProposal=true\n}if(h){h.run(a)\n}};\nZmCalItem.prototype._handleErrorGetDetails=function(g,i,f,h){if(h.code==\"mail.INVITE_OUT_OF_DATE\"){var j={},k=this._getRequestNameForMode(ZmCalItem.MODE_GET),e=j[k]={_jsns:\"urn:zimbraMail\"},l=new AjxCallback(this,this._handleErrorGetDetails2,[g,i,f]),d;\ne.id=this.id;\nd={jsonObj:j,asyncMode:true,callback:l,errorCallback:f};\nappCtxt.getAppController().sendRequest(d);\nreturn true\n}if(h.code==\"account.ACCOUNT_INACTIVE\"){var b=h.msg?h.msg.split(\":\"):null,a=b?b[1]:\"\",c=appCtxt.getMsgDialog();\nc.setMessage(AjxMessageFormat.format(ZmMsg.accountInactiveError,a),DwtMessageDialog.CRITICAL_STYLE);\nc.popup();\nreturn true\n}if(f){return f.run(h)\n}return false\n};\nZmCalItem.prototype._handleErrorGetDetails2=function(e,f,c,a){var b=this._getInviteFromError(a);\nthis.invId=[this.id,b.id].join(\"-\");\nthis.message=null;\nvar d=true;\nthis.getDetails(e,f,c,d)\n};\nZmCalItem.prototype.setFromMessage=function(b,a){if(b==this._currentlyLoaded){return\n}if(b.invite){this.isOrg=b.invite.isOrganizer();\nthis.organizer=b.invite.getOrganizerEmail();\nthis.organizerName=b.invite.getOrganizerName();\nthis.sentBy=b.invite.getSentBy();\nthis.name=b.invite.getName()||b.subject;\nthis.isException=b.invite.isException();\nthis.recurring=b.invite.isRecurring();\nthis.location=b.invite.getLocation();\nthis.seq=b.invite.getSequenceNo();\nthis.allDayEvent=b.invite.isAllDayEvent();\nif(b.invite.id){this.invId=this.id+\"-\"+b.invite.id\n}this._setTimeFromMessage(b,a);\nthis._setExtrasFromMessage(b);\nthis._setRecurrence(b)\n}this._setNotes(b);\nthis.getAttachments();\nthis._currentlyLoaded=b\n};\nZmCalItem.prototype.setFromSavedResponse=function(a){this.invId=a.invId;\nif(this.message){this.message.rev=a.rev;\nthis.message.ms=a.ms\n}if(this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE&&!this.isException){this.isException=true\n}};\nZmCalItem.prototype.setFromMailMessage=function(b,a){this.name=a;\nthis._setNotes(b);\nthis.message=b;\nthis.invId=b.id\n};\nZmCalItem.prototype.setTextNotes=function(a){this.notesTopPart=new ZmMimePart();\nthis.notesTopPart.setContentType(ZmMimeTable.TEXT_PLAIN);\nthis.notesTopPart.setContent(a)\n};\nZmCalItem.prototype._setTimeFromMessage=function(j,d){var b=j.invite.getServerStartTime();\nvar e=j.invite.getServerEndTime();\nif(d===ZmCalItem.MODE_EDIT_SINGLE_INSTANCE||d===ZmCalItem.MODE_FORWARD_SINGLE_INSTANCE||d===ZmCalItem.MODE_COPY_SINGLE_INSTANCE){var a=this.getUniqueStartDate();\nif(a){this.setStartDate(a)\n}var i=this.getUniqueEndDate();\nif(i){if(this.isAllDayEvent()&&d===ZmCalItem.MODE_COPY_SINGLE_INSTANCE){i.setDate(i.getDate()-1)\n}this.setEndDate(i)\n}if(d===ZmCalItem.MODE_COPY_SINGLE_INSTANCE){d=ZmCalItem.MODE_EDIT_SINGLE_INSTANCE\n}}else{if(b){this.setStartDate(AjxDateUtil.parseServerDateTime(b))\n}if(e){this.setEndDate(AjxDateUtil.parseServerDateTime(e))\n}}this.startsInUTC=b?b.charAt(b.length-1)==\"Z\":null;\nthis.endsInUTC=e&&b?e.charAt(b.length-1)==\"Z\":null;\nvar g;\nif(d==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE||d==ZmCalItem.MODE_DELETE_INSTANCE||d==ZmCalItem.MODE_FORWARD_SINGLE_INSTANCE){g=AjxTimezone.getServerId(AjxTimezone.DEFAULT);\nthis.setTimezone(g);\nthis.setEndTimezone(g)\n}else{var f=!this.startsInUTC&&j.invite.getServerStartTimeTz();\ng=f||AjxTimezone.getServerId(AjxTimezone.DEFAULT);\nthis.setTimezone(g);\nvar c=!this.endsInUTC&&j.invite.getServerEndTimeTz();\nthis.setEndTimezone(c||AjxTimezone.getServerId(AjxTimezone.DEFAULT));\nif(!this.startsInUTC&&j.invite.getServerEndTimeTz()){this.setEndTimezone(j.invite.getServerEndTimeTz())\n}}var h=AjxTimezone.getRule(AjxTimezone.getClientId(this.getTimezone()));\nif(h){if(h.aliasId){h=AjxTimezone.getRule(h.aliasId)||h\n}this.setTimezone(h.serverId)\n}h=AjxTimezone.getRule(AjxTimezone.getClientId(this.endTimezone));\nif(h){if(h.aliasId){h=AjxTimezone.getRule(h.aliasId)||h\n}this.setEndTimezone(h.serverId)\n}};\nZmCalItem.prototype._setExtrasFromMessage=function(a){this._setAlarmFromMessage(a)\n};\nZmCalItem.prototype._setAlarmFromMessage=function(d){this._reminderMinutes=-1;\nvar h=d.invite.getAlarm();\nif(h){for(var c=0;\nc<h.length;\nc++){var f=h[c];\nif(!f){continue\n}var e=f.action;\nif(e==ZmCalItem.ALARM_DISPLAY){this.parseAlarm(f);\ncontinue\n}if(e==ZmCalItem.ALARM_EMAIL){var g=f.at;\nif(!g){continue\n}for(var b=0;\nb<g.length;\nb++){var a=g[b].a;\nif(a==appCtxt.get(ZmSetting.CAL_DEVICE_EMAIL_REMINDERS_ADDRESS)){e=ZmCalItem.ALARM_DEVICE_EMAIL\n}this.addReminderAction(e)\n}}}}};\nZmCalItem.prototype._setRecurrence=function(b){var a=b.invite.getRecurrenceRules();\nif(a){this._recurrence.parse(a)\n}if(this._recurrence.repeatWeeklyDays==null){this.resetRepeatWeeklyDays()\n}if(this._recurrence.repeatMonthlyDayList==null){this.resetRepeatMonthlyDayList()\n}};\nZmCalItem.prototype._getCleanHtml2Text=function(g){var d;\nvar b=g?g.getDocument():null;\nvar a=b?b.body:null;\nif(a){var c=a.innerHTML.replace(/\\n/ig,\"\");\na.innerHTML=c.replace(/<!--.*-->/ig,\"\");\nvar f=a.firstChild;\nvar e=(f&&f.tagName&&f.tagName.toLocaleLowerCase()==\"p\");\nd=AjxStringUtil.convertHtml2Text(a);\nif(e){d=d.replace(/\\n\\n/i,\"\")\n}}return d\n};\nZmCalItem.prototype._setNotes=function(i){if(!(i.isZmMailMsg)){return\n}this.notesTopPart=new ZmMimePart();\nvar e=i.getBodyContent(ZmMimeTable.TEXT_HTML);\nif(e){e=e.replace(/<title\\s*>.*\\/title>/ig,\"\");\nif(!this._includeEditReply){e=this._trimNotesSummary(e,true)\n}}if(e){var b={parent:appCtxt.getShell(),hidden:true,html:e};\nvar f=i.getInviteDescriptionContentValue(ZmMimeTable.TEXT_PLAIN);\nif(!f){var c=new DwtIframe(b);\nf=this._getCleanHtml2Text(c);\nvar d=c.getIframe();\nif(d&&d.parentNode){d.parentNode.removeChild(d)\n}delete c\n}var a=new ZmMimePart();\na.setContentType(ZmMimeTable.TEXT_PLAIN);\na.setContent(f);\nvar h=new ZmMimePart();\nh.setContentType(ZmMimeTable.TEXT_HTML);\nh.setContent(e);\nthis.notesTopPart.setContentType(ZmMimeTable.MULTI_ALT);\nthis.notesTopPart.children.add(a);\nthis.notesTopPart.children.add(h)\n}else{var f=i.getBodyContent(ZmMimeTable.TEXT_PLAIN);\nif(!this._includeEditReply){f=this._trimNotesSummary(f)\n}var g=this.isTextPartPresent(i)?ZmMimeTable.TEXT_PLAIN:i._lastContentType;\nthis.notesTopPart.setContentType(g);\nthis.notesTopPart.setContent(f)\n}};\nZmCalItem.prototype.getMailNotificationOption=function(){return this._sendNotificationMail\n};\nZmCalItem.prototype.setMailNotificationOption=function(a){this._sendNotificationMail=a\n};\nZmCalItem.prototype.addExceptionDetails=function(a){var e=a.exceptId={},c=this._orig?this._orig.allDayEvent:this.allDayEvent,b,d;\nif(c!=\"1\"){d=AjxDateUtil.getServerDateTime(this.getOrigStartDate(),this.startsInUTC);\nb=this.getOrigTimezone();\nif(!this.startsInUTC&&b){e.tz=b\n}e.d=d\n}else{d=AjxDateUtil.getServerDate(this.getOrigStartDate());\ne.d=d\n}};\nZmCalItem.prototype.save=function(c,h,e,a){var k=false,i={},j=this._getRequestNameForMode(this.viewMode,this.isException),d=i[j]={_jsns:\"urn:zimbraMail\"},g,b,f;\nif(this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE&&!this.isException){this._addInviteAndCompNum(d);\nk=true\n}else{if(this.viewMode==ZmCalItem.MODE_EDIT||this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE||this.viewMode==ZmCalItem.MODE_EDIT_SERIES){this._addInviteAndCompNum(d);\nk=this.isException\n}}g=this.getRemoteFolderOwner();\nb=this._setRequestAttributes(d,c,a,g);\nf=b.inv.comp[0];\nif(k){this.addExceptionDetails(f)\n}else{this._recurrence.setJson(f)\n}this._setAlarmData(f);\nthis._sendRequest(null,g,h,e,i,j)\n};\nZmCalItem.prototype._setAlarmData=function(f){var g=this._useAbsoluteReminder,c=g?this._reminderAbs:this._reminderMinutes;\nif(c==null||c===-1){return\n}for(var e=0,h=this.alarmActions.size();\ne<h;\ne++){var j=null;\nvar d=this.alarmActions.get(e);\nif(d==ZmCalItem.ALARM_EMAIL){j=appCtxt.get(ZmSetting.CAL_EMAIL_REMINDERS_ADDRESS);\nif(!j){continue\n}}if(d==ZmCalItem.ALARM_DEVICE_EMAIL){j=appCtxt.get(ZmSetting.CAL_DEVICE_EMAIL_REMINDERS_ADDRESS);\nif(!j){continue\n}d=ZmCalItem.ALARM_EMAIL\n}var k=f.alarm=f.alarm||[];\nvar a={action:d};\nk.push(a);\nvar b=a.trigger={};\nthis._setReminderUnits(b,c);\nthis._addXPropsToAlarm(a);\nif(j){a.at={a:j}\n}}};\nZmCalItem.prototype._setReminderUnits=function(b,d){d=d||0;\nvar c=this._useAbsoluteReminder,a=b[c?\"abs\":\"rel\"]={};\nif(c){a.d=d\n}else{a.m=d;\na.related=\"START\";\na.neg=\"1\"\n}};\nZmCalItem.prototype._addXPropsToAlarm=function(a){if(!this.alarmData){return\n}var c=(this.alarmData&&this.alarmData.length>0)?this.alarmData[0]:null,d=c?c.alarm:null,b=(d&&d.length>0)?d[0]:null;\nthis._setAlarmXProps(b,a)\n};\nZmCalItem.prototype._setAlarmXProps=function(f,e){var d=(f&&f.xprop)?f.xprop:null,c,a,b;\nif(!d){return\n}d=(d instanceof Array)?d:[d];\nfor(c=0;\nc<d.length;\nc++){b=d[c];\nif(b&&b.name){a=e.xprop={};\na.name=b.name;\nif(b.value!=null){a.value=b.value\n}this._addXParamToRequest(a,b.xparam)\n}}};\nZmCalItem.prototype.setReminderMinutes=function(a){this._reminderMinutes=a\n};\nZmCalItem.prototype.setReminderUnits=function(a,b,c){if(!a){this._reminderMinutes=0;\nreturn\n}a=parseInt(a+\"\");\nthis._reminderMinutes=ZmCalendarApp.convertReminderUnits(a,b);\nthis._reminderSendEmail=c\n};\nZmCalItem.prototype.addReminderAction=function(a){this.alarmActions.add(a,null,true)\n};\nZmCalItem.prototype.removeReminderAction=function(a){this.alarmActions.remove(a)\n};\nZmCalItem.prototype.cancel=function(f,a,g,e,c){this.setViewMode(f);\nif(a){var k=[];\nvar b=(a._topPart.contentType==ZmMimeTable.MULTI_ALT)?a._topPart.children.getArray():[a._topPart];\nfor(var d=0;\nd<b.length;\nd++){k.push(b[d])\n}a.setBodyParts(k);\nthis._setNotes(a);\nthis._doCancel(f,g,a,c)\n}else{var h=new AjxCallback(this,this._doCancel,[f,g,null,c]);\nvar j=new AjxCallback(this,this._handleCancelError,[f,g,e]);\nif(this._blobInfoMissing&&f!=ZmCalItem.MODE_DELETE_SERIES){this.showBlobMissingDlg()\n}else{this.getDetails(null,h,j)\n}}};\nZmCalItem.prototype.showBlobMissingDlg=function(){var a=appCtxt.getMsgDialog();\na.setMessage(ZmMsg.apptBlobMissing,DwtMessageDialog.INFO_STYLE);\na.popup()\n};\nZmCalItem.prototype._handleCancelError=function(c,d,a,b){if(b.code==\"mail.NO_SUCH_BLOB\"){if(this.isRecurring()&&c!=ZmCalItem.MODE_DELETE_SERIES){this._blobInfoMissing=true;\nthis.showBlobMissingDlg();\nreturn true\n}else{this._doCancel(c,d,this.message)\n}return true\n}if(a){return a.run(b)\n}return false\n};\nZmCalItem.prototype.setCancelFutureInstances=function(a){this._cancelFutureInstances=a\n};\nZmCalItem.prototype._sendCancelMsg=function(a){this.save(null,a)\n};\nZmCalItem.prototype._doCancel=function(u,k,l,v,t){var b=this.getFolder().nId,F={},D,g,y,a=this.getRemoteFolderOwner(),s,q,d,w,B,E,x,C,A,z,f,c,p,r,n,h,o;\nif(b==ZmOrganizer.ID_TRASH){u=ZmCalItem.MODE_PURGE;\nD=this._getRequestNameForMode(u);\ng=F[D]={_jsns:\"urn:zimbraMail\"};\ny=g.action={};\ny.op=\"delete\";\ny.id=this.id;\nif(v){v.addRequestParams(F,k)\n}else{this._sendRequest(null,a,k,null,F,D)\n}}else{if(u==ZmCalItem.MODE_DELETE_SERIES&&this._cancelFutureInstances&&this.getOrigStartDate().getTime()!=this.getStartTime()){s=this._recurrence;\nq=new Date(this.getOrigStartDate().getTime());\nq.setTime(q.getTime()-AjxDateUtil.MSEC_PER_DAY);\ns.repeatEndDate=q;\ns.repeatEndType=\"D\";\nthis.viewMode=ZmCalItem.MODE_EDIT_SERIES;\nthis._sendCancelMsg(k);\nreturn\n}if(u==ZmCalItem.MODE_DELETE||u==ZmCalItem.MODE_DELETE_SERIES||u==ZmCalItem.MODE_DELETE_INSTANCE){D=this._getRequestNameForMode(u);\ng=F[D]={_jsns:\"urn:zimbraMail\"};\nthis._addInviteAndCompNum(g);\nif(u==ZmCalItem.MODE_DELETE_INSTANCE||this.isException){g.s=this.getOrigStartTime();\nd=g.inst={};\nw=this.isAllDayEvent();\nB=w?AjxDateUtil.getServerDate:AjxDateUtil.getServerDateTime;\nd.d=B(this.getOrigStartDate());\nif(!w&&this.timezone){d.tz=this.timezone;\nE=AjxTimezone.getClientId(this.timezone);\nZmTimezone.set(g,E,null,true)\n}}x=g.m={};\nC=x.e=[];\no=this.isOrganizer();\nif(o){if(!this.inviteNeverSent){if(l){for(A=0;\nA<ZmMailMsg.ADDRS.length;\nA++){f=ZmMailMsg.ADDRS[A];\nif((a&&f==AjxEmailAddress.FROM)||(f==AjxEmailAddress.RESENT_FROM)){continue\n}c=l.getAddresses(f);\np=c.size();\nfor(z=0;\nz<p;\nz++){r=c.get(z);\nC.push({a:r.getAddress(),t:AjxEmailAddress.toSoapType[f]})\n}}if(a){C.push({a:a,t:AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]})\n}}else{this._addAttendeesToRequest(null,x,null,a)\n}}h=this.getMailFromAddress();\nif(h){C.push({a:h,t:AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]})\n}}n=(l&&l.subject)?l.subject:([ZmMsg.cancelled,\": \",this.name].join(\"\"));\nx.su=n;\nthis._addNotesToRequest(x,true);\nif(v){v.addRequestParams(F,k)\n}else{this._sendRequest(null,a,k,null,F,D)\n}}else{if(k){k.run()\n}}}};\nZmCalItem.prototype.getMailFromAddress=function(){var a=appCtxt.get(ZmSetting.MAIL_FROM_ADDRESS);\nif(a){return(a instanceof Array)?a[0]:a\n}};\nZmCalItem.prototype.getTextSummary=function(){return this.getSummary(false)\n};\nZmCalItem.prototype.getHtmlSummary=function(){return this.getSummary(true)\n};\nZmCalItem.prototype._getTextSummaryTime=function(e,h,b,a,d,j){var k=appCtxt.get(ZmSetting.CAL_SHOW_TIMEZONE);\nvar c=[];\nvar f=0;\nif(b){c[f++]=AjxDateUtil.longComputeDateStr(b);\nc[f++]=\", \"\n}if(this.isAllDayEvent()){c[f++]=ZmMsg.allDay\n}else{var g=AjxDateFormat.getTimeInstance();\nif(a){c[f++]=g.format(a)\n}if(a&&d){c[f++]=\" - \"\n}if(d){c[f++]=g.format(d)\n}if(k){c[f++]=\" \";\nc[f++]=AjxTimezone.getLongName(AjxTimezone.getClientId(this.timezone))\n}}if(e&&((this._orig&&this._orig.isAllDayEvent()!=this.isAllDayEvent())||j)){c[f++]=\" \";\nc[f++]=ZmMsg.apptModifiedStamp\n}c[f++]=\"\\n\";\nreturn c.join(\"\")\n};\nZmCalItem.prototype._trimNotesSummary=function(b,c){if(b){var a=b.indexOf(ZmItem.NOTES_SEPARATOR);\nif(a!=-1){b=b.substr(a+ZmItem.NOTES_SEPARATOR.length);\nif(c){b=b.replace(/^<br><br>/i,\"\");\nb=b.replace(/^<\\/div><br>/i,\"\");\nb=b.replace(/^<\\/body><\\/html>/i,\"\")\n}else{b=b.replace(/^\\n\\n/i,\"\")\n}}}return AjxStringUtil.trim(b)\n};\nZmCalItem.prototype._resetCached=function(){delete this._startTimeUniqId;\nthis._startTimeUniqId=null;\ndelete this._validAttachments;\nthis._validAttachments=null;\ndelete this.tooltip;\nthis.tooltip=null\n};\nZmCalItem.prototype._getTTDay=function(a){return DwtCalendar.getDayFormatter().format(a)\n};\nZmCalItem.prototype._addInviteAndCompNum=function(a){var b;\nif(this.message&&!this.isVersionIgnored()){a.ms=this.message.ms;\na.rev=this.message.rev\n}if(this.viewMode==ZmCalItem.MODE_EDIT_SERIES||this.viewMode==ZmCalItem.MODE_DELETE_SERIES){if(this.recurring&&this.seriesInvId!=null){a.id=this.seriesInvId;\na.comp=this.getCompNum()\n}}else{if(this.invId!=null&&this.invId!=-1){b=this.invId;\nif(appCtxt.multiAccounts&&this._orig&&this._orig.getFolder().getAccount()!=this.getFolder().getAccount()){b=ZmOrganizer.getSystemId(this.invId,this._orig.getFolder().getAccount(),true)\n}a.id=b;\na.comp=this.getCompNum()\n}}};\nZmCalItem.prototype._getDefaultBlurb=function(e,d){var a=[];\nvar b=0;\nvar c=this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE||this.viewMode==ZmCalItem.MODE_DELETE_INSTANCE;\nif(d){a[b++]=\"<h3>\"\n}if(this.isProposeTimeMode){a[b++]=ZmMsg.subjectNewTime\n}else{if(e){a[b++]=c?ZmMsg.apptInstanceCanceled:ZmMsg.apptCanceled\n}else{if(!this.isForwardMode||this.isOrganizer()){if(!this.inviteNeverSent&&(this.viewMode==ZmCalItem.MODE_EDIT||this.viewMode==ZmCalItem.MODE_EDIT_SINGLE_INSTANCE||this.viewMode==ZmCalItem.MODE_EDIT_SERIES)){a[b++]=c?ZmMsg.apptInstanceModified:ZmMsg.apptModified\n}else{a[b++]=ZmMsg.apptNew\n}}else{a[b++]=ZmMsg.apptForwarded\n}}}if(d){a[b++]=\"</h3>\"\n}a[b++]=\"\\n\\n\";\na[b++]=this.getSummary(d);\nreturn a.join(\"\")\n};\nZmCalItem.prototype._getRequestNameForMode=function(b,a){};\nZmCalItem.prototype._getInviteFromError=function(a){};\nZmCalItem.prototype._setRequestAttributes=function(d,f,j,c){var w=d.m={},s=this.getFolder(),p=s.getAccount(),q=c&&p&&p.name!=c,g,l,h,C,k,D,v,r,G,y,o,u,t,A,F,n,b,a,B,E,z,x;\nw.l=(q?this.getFolder().rid:this.folderId);\nb=w.inv={};\nz=w.e=[];\nif(this.uid!=null&&this.uid!=-1&&!this.isSharedCopy){b.uid=this.uid\n}t=b.comp=[];\nA=t[0]={};\nA.at=[];\nthis._addAttendeesToRequest(A,w,j,c);\nG=this.identity;\nv=G==null||G.isDefault;\ny=s.isRemote();\ng=this.getMailFromAddress();\nif(this.isOrganizer()&&!c&&(g||y||!v)){if(g){n=g\n}else{if(y){n=this.organizer\n}else{if(G){n=G.sendFromAddress;\nh=G.sendFromDisplay\n}}}o={a:n,t:AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]};\nif(!h&&n==appCtxt.get(ZmSetting.USERNAME)){h=appCtxt.get(ZmSetting.DISPLAY_NAME)\n}if(h){o.p=h\n}z.push(o);\nif(G&&G.isFromDataSource&&!y){this._addIdentityFrom(G,z,w)\n}}if(y){if(!G){r=appCtxt.getIdentityCollection();\nG=r&&r.defaultIdentity\n}if(G){n=G.sendFromAddress;\nh=G.sendFromDisplay\n}else{n=appCtxt.get(ZmSetting.USERNAME);\nh=appCtxt.get(ZmSetting.DISPLAY_NAME)\n}o={a:n,t:AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER]};\nif(h){o.p=h\n}z.push(o)\n}this._addExtrasToRequest(d,A);\nthis._addDateTimeToRequest(d,A);\nthis._addXPropsToRequest(A);\nw.su=this.name;\nA.name=this.name;\nthis._addLocationToRequest(A);\nthis._addNotesToRequest(w);\nif(!(appCtxt.isOffline&&p.isMain)){E=(appCtxt.multiAccounts)?p.getEmail():appCtxt.get(ZmSetting.USERNAME);\nif(!G){r=appCtxt.getIdentityCollection(p);\nG=r&&r.defaultIdentity\n}if(G){l=G.sendFromAddress;\nh=G.sendFromDisplay\n}F=g||l||E;\nD=this.organizer||F;\na=A.or={};\na.a=D;\nif(y){a.sentBy=F\n}u=(D==l)?h:(ZmApptViewHelper.getAddressEmail(D)).getName();\nif(u){a.d=u\n}}this.flagLocal(ZmItem.FLAG_ATTACH,false);\nthis.getAttachments();\nif(f!=null||(this._validAttachments!=null&&this._validAttachments.length)){k=d.m.attach={};\nif(f){k.aid=f;\nthis.flagLocal(ZmItem.FLAG_ATTACH,true)\n}if(this._validAttachments){C=this._validAttachments.length;\nk.mp=[];\nfor(x=0;\nx<C;\nx++){B=(this.invId||this.message.id);\nif((B.indexOf(\":\")<0)&&s.isRemote()){B=(appCtxt.getActiveAccount().id+\":\"+B)\n}k.mp.push({mid:B,part:this._validAttachments[x].part})\n}if(C>0){this.flagLocal(ZmItem.FLAG_ATTACH,true)\n}}}return{inv:b,m:w}\n};\nZmCalItem.prototype._addIdentityFrom=function(c,f,a){var i=appCtxt.getDataSourceCollection().getById(c.id),h,d,g,b;\nif(i){h=ZmDataSource.getProviderForAccount(i);\nd=h&&h._nosender;\nif(!d){f.push({t:AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER],p:appCtxt.get(ZmSetting.DISPLAY_NAME)||\"\"})\n}g={t:AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER],a:i.getEmail()};\nif(appCtxt.get(ZmSetting.DEFAULT_DISPLAY_NAME)){b=i.identity&&i.identity.sendFromDisplay;\nb=b||i.userName||i.getName();\nif(b){g.p=b\n}}f.push(g)\n}};\nZmCalItem.prototype._addExtrasToRequest=function(b,a){if(this.priority){a.priority=this.priority\n}a.status=this.status\n};\nZmCalItem.prototype._addXPropsToRequest=function(c){var f=this.message?this.message:null,b=(f&&f.invite)?f.invite:null,g=b?b.getXProp():null,e,a,d;\nif(!g){return\n}c.xprop=[];\ng=(g instanceof Array)?g:[g];\nfor(d=0;\nd<g.length;\nd++){e=g[d],a={};\nif(e&&e.name){a.name=e.name;\nif(e.value!=null){a.value=e.value\n}this._addXParamToRequest(a,e.xparam);\nc.xprop.push(a)\n}}};\nZmCalItem.prototype._addXParamToRequest=function(d,f){if(!f){return\n}f=(f instanceof Array)?f:[f];\nvar b=d.xparam=[],e={},c,a;\nfor(c=0;\nc<f.length;\nc++){a=f[c];\ne={};\nif(a&&a.name){e.name=a.name;\nif(a.value!=null){e.value=a.value\n}b.push(e)\n}}};\nZmCalItem.prototype._addDateTimeToRequest=function(c,f,i){f.allDay=this.allDayEvent+\"\";\nvar b,a,j,h,g,d;\nif(this.timezone){a=AjxTimezone.getClientId(this.timezone);\nZmTimezone.set(c,a,null,true);\nb=this.timezone\n}if(this.startDate){j=f.s={};\nif(!this.isAllDayEvent()||i){h=AjxDateUtil.getServerDateTime(this.startDate,this.startsInUTC);\nif(!this.startsInUTC&&b&&b.length){j.tz=b\n}j.d=h\n}else{j.d=AjxDateUtil.getServerDate(this.startDate)\n}}if(this.endTimezone){b=this.endTimezone\n}if(this.endDate){g=f.e={};\nif(!this.isAllDayEvent()){d=AjxDateUtil.getServerDateTime(this.endDate,this.endsInUTC);\nif(!this.endsInUTC&&b&&b.length){g.tz=b\n}g.d=d\n}else{if(i){var d=new Date(this.endDate.getTime()+AjxDateUtil.MSEC_PER_DAY);\ng.d=AjxDateUtil.getServerDateTime(d,this.endsInUTC);\nif(!this.endsInUTC&&b&&b.length){g.tz=b\n}}else{g.d=AjxDateUtil.getServerDate(this.endDate)\n}}}};\nZmCalItem.prototype._addAttendeesToRequest=function(b,a,d,c){if(this.isOrganizer()&&c){a.e.push({a:c,t:AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]})\n}};\nZmCalItem.prototype._addNotesToRequest=function(d,q){var e=this.hasAttendees(),j=e?this._getDefaultBlurb(q):\"\",r=e?this._getDefaultBlurb(q,true):\"\",c=d.mp={mp:[]},b,a,p,k,l,n,o,h,g;\nc.ct=ZmMimeTable.MULTI_ALT;\nb=this.notesTopPart?this.notesTopPart.children.size():0;\nif(b>0){for(g=0;\ng<b;\ng++){a=this.notesTopPart.children.get(g);\np=a.getContentType();\nif(p==ZmMimeTable.TEXT_HTML){var f=a.getContent();\nf=AjxStringUtil.defangHtmlContent(f);\nk=\"<html><body id='htmlmode'>\"+(this._includeEditReply?f:AjxBuffer.concat(r,f))+\"</body></html>\"\n}else{k=this._includeEditReply?a.getContent():AjxBuffer.concat(j,a.getContent())\n}c.mp.push({ct:p,content:k})\n}}else{l=this.notesTopPart;\nn=l?l.getContent():\"\";\np=l?l.getContentType():ZmMimeTable.TEXT_PLAIN;\nc.mp.push({ct:p});\nif(p==ZmMimeTable.TEXT_HTML){o=AjxStringUtil.nl2br(AjxStringUtil.htmlEncode(n));\nh=\"<html><body>\"+(this._includeEditReply?o:AjxBuffer.concat(r,o))+\"</body></html>\";\nc.mp[0].content=h\n}else{c.mp[0].content=(this._includeEditReply?n:AjxBuffer.concat(j,n))\n}}};\nZmCalItem.prototype.getInviteDescription=function(e){var d=this.hasAttendees();\nvar c=d?this.getSummary(false):\"\";\nvar b=d?this.getSummary(true):\"\";\nvar a=this.getNotesPart(e?ZmMimeTable.TEXT_HTML:ZmMimeTable.TEXT_PLAIN);\nreturn AjxBuffer.concat(e?b:c,a)\n};\nZmCalItem.prototype.setIncludeEditReply=function(a){this._includeEditReply=a\n};\nZmCalItem.prototype._sendRequest=function(d,c,h,b,g,f){var a=d?d.getMethod().nodeName.replace(\"Request\",\"Response\"):f.replace(\"Request\",\"Response\");\nvar e=new AjxCallback(this,this._handleResponseSend,[a,h]);\nif(!g){appCtxt.getAppController().sendRequest({soapDoc:d,asyncMode:true,accountName:c,callback:e,errorCallback:b})\n}else{appCtxt.getAppController().sendRequest({jsonObj:g,asyncMode:true,accountName:c,callback:e,errorCallback:b})\n}};\nZmCalItem.prototype._loadFromDom=function(b,a){ZmCalBaseItem.prototype._loadFromDom.call(this,b,a);\nthis.isOrg=this._getAttr(b,a,\"isOrg\");\nvar c=b.or;\nthis.organizer=c&&c.a;\nthis.sentBy=c&&c.sentBy;\nthis.invId=this._getAttr(b,a,\"invId\");\nthis.compNum=this._getAttr(b,a,\"compNum\")||\"0\";\nthis.parseAlarmData(this.alarmData);\nthis.seriesInvId=this.recurring?b.invId:null;\nthis.ridZ=a&&a.ridZ;\nif(b.tn){this._parseTagNames(b.tn)\n}if(b.f){this._parseFlags(b.f)\n}};\nZmCalItem.prototype._handleResponseSend=function(f,g,a){var e=a.getResponse();\nvar d=e[f];\nif(d.uid!=null){this.uid=d.uid\n}var c;\nif(d.echo){c=d.echo;\nif(c.length>0){c=c[0]\n}}c=c?c.m:d.m;\nif(c!=null){if(c.length>0){c=c[0]\n}var b=this.invId;\nthis.invId=c.id;\nif(AjxUtil.isSpecified(b)&&b!=this.invId){this.message=null\n}else{if(c){this.message=new ZmMailMsg(c.id);\nthis.message._loadFromDom(c);\ndelete this._validAttachments;\nthis._validAttachments=null;\nthis.getAttachments()\n}}}this._messageNode=null;\nif(g){g.run(d)\n}};\nZmCalItem.prototype.processErrorSave=function(b){var a={continueSave:false,errorMessage:\"\"};\nif(b.code==ZmCsfeException.MAIL_SEND_ABORTED_ADDRESS_FAILURE){var c=b.getData(ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_INVALID);\nvar d=(c&&c.length)?AjxMessageFormat.format(ZmMsg.apptSendErrorInvalidAddresses,AjxStringUtil.htmlEncode(c.join(\", \"))):null;\na.errorMessage=ZmMsg.apptSendErrorAbort+\"<br/>\"+d\n}else{if(b.code==ZmCsfeException.MAIL_SEND_PARTIAL_ADDRESS_FAILURE){var c=b.getData(ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_INVALID);\na.errorMessage=(c&&c.length)?AjxMessageFormat.format(ZmMsg.apptSendErrorPartial,AjxStringUtil.htmlEncode(c.join(\", \"))):ZmMsg.apptSendErrorAbort\n}else{if(b.code==ZmCsfeException.MAIL_MESSAGE_TOO_BIG){a.errorMessage=(this.type==ZmItem.TASK)?ZmMsg.taskSaveErrorToobig:ZmMsg.apptSaveErrorToobig\n}else{if(b.code==ZmCsfeException.MAIL_INVITE_OUT_OF_DATE){if(!this.isVersionIgnored()){this.setIgnoreVersion(true);\na.continueSave=true\n}else{a.errorMessage=ZmMsg.inviteOutOfDate;\nthis.setIgnoreVersion(false)\n}}else{if(b.code==ZmCsfeException.MAIL_NO_SUCH_CALITEM){a.errorMessage=b.getErrorMsg([b.getData(\"itemId\")])\n}else{if(b.code==ZmCsfeException.MAIL_QUOTA_EXCEEDED){if(this.type==ZmItem.APPT){a.errorMessage=ZmMsg.errorQuotaExceededAppt\n}else{if(this.type==ZmItem.TASK){a.errorMessage=ZmMsg.errorQuotaExceededTask\n}}}else{if(b.code===ZmCsfeException.MUST_BE_ORGANIZER){a.errorMessage=ZmMsg.mustBeOrganizer\n}}}}}}}return a\n};\nZmCalItem.prototype.setProposedTimeCallback=function(a){this._proposedTimeCallback=a\n};\nZmCalItem.prototype.handlePostSaveCallbacks=function(){if(this._proposedTimeCallback){this._proposedTimeCallback.run(this)\n}this.setIgnoreVersion(false)\n};\nZmCalItem.isPriorityHigh=function(a){return AjxUtil.arrayContains(ZmCalItem.PRIORITY_HIGH_RANGE,a)\n};\nZmCalItem.isPriorityLow=function(a){return AjxUtil.arrayContains(ZmCalItem.PRIORITY_LOW_RANGE,a)\n};\nZmCalItem.isPriorityNormal=function(a){return AjxUtil.arrayContains(ZmCalItem.PRIORITY_NORMAL_RANGE,a)\n};\nZmCalItem.getLabelForPriority=function(a){if(ZmCalItem.isPriorityLow(a)){return ZmMsg.low\n}if(ZmCalItem.isPriorityNormal(a)){return ZmMsg.normal\n}if(ZmCalItem.isPriorityHigh(a)){return ZmMsg.high\n}return\"\"\n};\nZmCalItem.getImageForPriority=function(a,b){if(ZmCalItem.isPriorityLow(a.priority)){return b?AjxImg.getImageHtml(\"PriorityLow_list\",null,[\"id='\",b,\"'\"].join(\"\")):AjxImg.getImageHtml(\"PriorityLow_list\")\n}else{if(ZmCalItem.isPriorityHigh(a.priority)){return b?AjxImg.getImageHtml(\"PriorityHigh_list\",null,[\"id='\",b,\"'\"].join(\"\")):AjxImg.getImageHtml(\"PriorityHigh_list\")\n}}return\"\"\n};\nZmCalItem.getLabelForStatus=function(a){switch(a){case ZmCalendarApp.STATUS_CANC:return ZmMsg.cancelled;\ncase ZmCalendarApp.STATUS_COMP:return ZmMsg.completed;\ncase ZmCalendarApp.STATUS_DEFR:return ZmMsg.deferred;\ncase ZmCalendarApp.STATUS_INPR:return ZmMsg.inProgress;\ncase ZmCalendarApp.STATUS_NEED:return ZmMsg.notStarted;\ncase ZmCalendarApp.STATUS_WAIT:return ZmMsg.waitingOn\n}return\"\"\n};\nZmCalItem.getLabelForParticipationStatus=function(a){switch(a){case ZmCalBaseItem.PSTATUS_ACCEPT:return ZmMsg.ptstAccept;\ncase ZmCalBaseItem.PSTATUS_DECLINED:return ZmMsg.ptstDeclined;\ncase ZmCalBaseItem.PSTATUS_DEFERRED:return ZmMsg.ptstDeferred;\ncase ZmCalBaseItem.PSTATUS_DELEGATED:return ZmMsg.ptstDelegated;\ncase ZmCalBaseItem.PSTATUS_NEEDS_ACTION:return ZmMsg.ptstNeedsAction;\ncase ZmCalBaseItem.PSTATUS_COMPLETED:return ZmMsg.completed;\ncase ZmCalBaseItem.PSTATUS_TENTATIVE:return ZmMsg.ptstTentative;\ncase ZmCalBaseItem.PSTATUS_WAITING:return ZmMsg.ptstWaiting\n}return\"\"\n};\nZmCalItem.getParticipationStatusIcon=function(a){switch(a){case ZmCalBaseItem.PSTATUS_ACCEPT:return\"Check\";\ncase ZmCalBaseItem.PSTATUS_DECLINED:return\"Cancel\";\ncase ZmCalBaseItem.PSTATUS_DEFERRED:return\"QuestionMark\";\ncase ZmCalBaseItem.PSTATUS_DELEGATED:return\"Plus\";\ncase ZmCalBaseItem.PSTATUS_NEEDS_ACTION:return\"NeedsAction\";\ncase ZmCalBaseItem.PSTATUS_COMPLETED:return\"Completed\";\ncase ZmCalBaseItem.PSTATUS_TENTATIVE:return\"QuestionMark\";\ncase ZmCalBaseItem.PSTATUS_WAITING:return\"Minus\"\n}return\"\"\n};\nZmCalItem._getTTDay=function(c,b){b=b||AjxDateFormat.SHORT;\nvar a=AjxDateFormat.getDateInstance();\nreturn a.format(c)\n};\nZmCalItem.prototype.isTextPartPresent=function(c){var a=c._topPart&&c._topPart.children.getArray().filter(function(d){return d.contentType===ZmMimeTable.TEXT_PLAIN\n});\nvar b=a&&a.length&&a[0].getContent();\nif(b&&b.length){return true\n}else{return false\n}}\n}if(AjxPackage.define(\"zimbraMail.tasks.model.ZmTask\")){ZmTask=function(b,c,a){ZmCalItem.call(this,ZmItem.TASK,b,c,a);\nthis.priority=ZmCalItem.PRIORITY_NORMAL;\nthis.pComplete=0;\nthis.status=ZmCalendarApp.STATUS_NEED;\nthis.startDate=null;\nthis.endDate=null;\nthis.remindDate=new Date();\nthis.alarm=false;\nthis._useAbsoluteReminder=true\n};\nZmTask.prototype=new ZmCalItem;\nZmTask.prototype.constructor=ZmTask;\nZmTask.PCOMPLETE_INT=10;\nZmTaskClone=function(){};\nZmTask.quickClone=function(b){ZmTaskClone.prototype=b;\nvar a=new ZmTaskClone();\na.startDate=b.startDate?(new Date(b.startDate.getTime())):null;\na.endDate=b.endDate?(new Date(b.endDate.getTime())):null;\na._uniqId=Dwt.getNextId();\na._validAttachments=AjxUtil.createProxy(b._validAttachments);\nif(!a._orig){a._orig=b\n}a.type=ZmItem.TASK;\nreturn a\n};\nZmTask.createFromDom=function(d,c,a){var b=new ZmTask(c.list,d.id);\nb._loadFromDom(d,a);\nreturn b\n};\nZmTask.prototype.toString=function(){return\"ZmTask\"\n};\nZmTask.prototype.getIcon=function(){return\"Task\"\n};\nZmTask.prototype.getFolder=function(){return appCtxt.getById(this.folderId)\n};\nZmTask.prototype.getId=function(){return this.id\n};\nZmTask.prototype.getSummary=function(a){};\nZmTask.prototype.getToolTip=function(a){};\nZmTask.prototype.notifyModify=function(a){ZmItem.prototype.notifyModify.call(this,a);\nthis.uid=a.uid;\nif(a.l){this.folderId=a.l\n}this._loadFromDom(a);\nthis._notify(ZmEvent.E_MODIFY,a)\n};\nZmTask.prototype.isPastDue=function(){return(this.endDate&&((new Date()).getTime()>this.endDate.getTime()))\n};\nZmTask.prototype.getEndTime=function(){return this.endDate?this.endDate.getTime():null\n};\nZmTask.prototype.getStartTime=function(){return this.startDate?this.startDate.getTime():null\n};\nZmTask.prototype.isComplete=function(){return(this.pComplete==100)||(this.status==ZmCalendarApp.STATUS_COMP)\n};\nZmTask.prototype.getPercentComplete=function(){return this.pComplete\n};\nZmTask.prototype.getStatus=function(){return this.status\n};\nZmTask.prototype.getPriority=function(){return this.priority\n};\nZmTask.prototype.cancel=function(c,a){this.setViewMode(c);\nvar e={},d=this._getRequestNameForMode(c),b=e[d]={_jsns:\"urn:zimbraMail\"};\nthis._addInviteAndCompNum(b);\na.addRequestParams(e)\n};\nZmTask.prototype.getRemoteFolderOwner=function(){var a=AjxDispatcher.run(\"GetTaskController\");\nif(a.isMovingBetwAccounts(this,this.folderId)){return null\n}var b=this.getFolder();\nreturn(b&&b.link)?b.owner:null\n};\nZmTask.prototype._getDefaultFolderId=function(){return ZmOrganizer.ID_TASKS\n};\nZmTask.prototype._loadFromDom=function(d,m){var h=d.inv?d.inv[0]:null;\nvar j=h?h.comp[0]:null;\nif(!d.id){this.id=d.id\n}if(d.invId){this.invId=d.invId\n}else{if(h){var e=h.id;\ne=e.toString().indexOf(\":\");\nif(e!=-1){this.invId=this.id+\"-\"+h.id.substring(e+1)\n}else{this.invId=[d.id,h.id].join(\"-\")\n}}}this.uid=d.uid;\nif(d.l){this.folderId=d.l\n}if(d.s){this.size=d.s\n}if(d.sf){this.sf=d.sf\n}this.allDayEvent=(m?m.allDay:null||d.allDay)?\"1\":\"0\";\nvar c=d.inst&&d.inst.length>0?d.inst[0]:null;\nvar p=this.tzo=c&&c.tzo!=null?parseInt(c.tzo):0;\nvar l=this.tzoDue=c&&c.tzoDue!=null?parseInt(c.tzoDue):0;\nif(c&&c.s){var k=this.isAllDayEvent()?(p+new Date(parseInt(c.s,10)).getTimezoneOffset()*60*1000):0;\nvar b=parseInt(c.s,10)+k;\nthis.startDate=new Date(b);\nthis.uniqStartTime=this.startDate.getTime()\n}else{if(j){this.startDate=null;\nif(j.s&&j.s[0].d){var a=j.s[0].d;\nvar g=parseInt(a.substr(0,4),10);\nvar o=parseInt(a.substr(4,2),10);\nvar n=parseInt(a.substr(6,2),10);\nthis.startDate=new Date(g,o-1,n)\n}}}if(c&&c.dueDate){var k=this.isAllDayEvent()?(l+new Date(parseInt(c.dueDate,10)).getTimezoneOffset()*60*1000):0;\nvar i=parseInt(c.dueDate,10)+k;\nthis.endDate=new Date(i)\n}else{if(j){this.endDate=null;\nif(j.e&&j.e[0].d){var f=j.e[0].d;\nvar g=parseInt(f.substr(0,4),10);\nvar o=parseInt(f.substr(4,2),10);\nvar n=parseInt(f.substr(6,2),10);\nthis.endDate=new Date(g,o-1,n)\n}}}if(d.alarm){if(d.alarm){this.alarm=d.alarm\n}if(d.alarmData){this.alarmData=this._getAttr(d,j,\"alarmData\")\n}}else{if(j&&j.alarm&&(j.alarm.length>0)){this.alarm=d.alarm=true;\nthis.alarmData=d.alarmData=j.alarm\n}}if(d.name||j){this.name=this._getAttr(d,j,\"name\")\n}if(d.loc||j){this.location=this._getAttr(d,j,\"loc\")\n}if(d.allDay||j){this.setAllDayEvent(this._getAttr(d,j,\"allDay\"))\n}if(d.priority||j){this.priority=parseInt(this._getAttr(d,j,\"priority\"))\n}if(d.percentComplete||j){this.pComplete=parseInt(this._getAttr(d,j,\"percentComplete\"))\n}if(d.status||j){this.status=this._getAttr(d,j,\"status\")\n}if(d.isOrg||j){this.isOrg=new Boolean(this._getAttr(d,j,\"isOrg\"))\n}if(d.or||j){this.organizer=d.or?d.or.a:(j.or?j.or.a:null)\n}if(d.ptst||j){this.ptst=this._getAttr(d,j,\"ptst\")\n}if(d.compNum!=null){this.compNum=(this._getAttr(d,j,\"compNum\")||\"0\")\n}if(d.f){this._parseFlags(d.f)\n}if(d.tn){this._parseTagNames(d.tn)\n}this.type=ZmItem.TASK\n};\nZmTask.prototype.isAlarmInRange=function(){if(!this.alarmData){return false\n}var b=this.alarmData[0];\nif(!b){return false\n}this._nextAlarmTime=new Date(b.nextAlarm);\nthis._alarmInstStart=this.adjustMS(b.alarmInstStart,this.tzo);\nvar a=(new Date()).getTime();\nreturn this._nextAlarmTime<=a\n};\nZmTask.prototype._getAttr=function(c,a,b){if(c[b]!=null){return c[b]\n}if(a){return a[b]\n}return null\n};\nZmTask.prototype.isAlarmModified=function(){if(this._orig.alarm==true&&this.alarm==false){return true\n}return false\n};\nZmTask.prototype.isMultiDay=function(){var b=this.startDate;\nvar a=this.endDate;\nif(!b&&!a){return false\n}if(!b){return false\n}return(b.getDate()!=a.getDate())||(b.getMonth()!=a.getMonth())||(b.getFullYear()!=a.getFullYear())\n};\nZmTask.prototype._setExtrasFromMessage=function(a){ZmCalItem.prototype._setExtrasFromMessage.apply(this,arguments);\nthis.location=a.invite.getLocation()\n};\nZmTask.prototype._setTimeFromMessage=function(b,a){ZmCalItem.prototype._setTimeFromMessage.apply(this,arguments);\nif(b.invite.components[0].s==null){this.startDate=null\n}};\nZmTask.prototype.parseAlarm=function(c){if(!c){return\n}var e;\nvar b=(c)?c.trigger:null;\nvar a=(b&&(b.length>0))?b[0].abs:null;\ne=(a&&(a.length>0))?a[0].d:null;\nthis._reminderMinutes=0;\nif(c&&(c.action==\"DISPLAY\")){if(e!=null){this._reminderAbs=e;\nthis.remindDate=e?AjxDateUtil.parseServerDateTime(e):null\n}}};\nZmTask.prototype._getRequestNameForMode=function(b,a){switch(b){case ZmCalItem.MODE_NEW:return\"CreateTaskRequest\";\ncase ZmCalItem.MODE_EDIT_SINGLE_INSTANCE:return !a?\"CreateTaskExceptionRequest\":\"ModifyTaskRequest\";\ncase ZmCalItem.MODE_EDIT:case ZmCalItem.MODE_EDIT_SERIES:return\"ModifyTaskRequest\";\ncase ZmCalItem.MODE_DELETE:case ZmCalItem.MODE_DELETE_SERIES:case ZmCalItem.MODE_DELETE_INSTANCE:return\"CancelTaskRequest\";\ncase ZmCalItem.MODE_GET:return\"GetTaskRequest\"\n}return null\n};\nZmTask.prototype._addExtrasToRequest=function(b,a){ZmCalItem.prototype._addExtrasToRequest.call(this,b,a);\na.percentComplete=this.pComplete\n};\nZmTask.prototype._getInviteFromError=function(a){return(a._data.GetTaskResponse.task[0].inv[0])\n};\nZmTask.prototype.setTaskReminder=function(a){this._reminderAbs=a\n};\nZmTask.isInTrash=function(b){var a=(b instanceof ZmTask)?b.folderId:b.l;\nvar c=appCtxt.getById(a);\nreturn(c&&c.isInTrash())\n}\n}if(AjxPackage.define(\"zimbraMail.prefs.ZmPreferencesApp\")){ZmPreferencesApp=function(b,a){ZmApp.call(this,ZmApp.PREFERENCES,b,a);\nthis._filterRules={};\nthis._outgoingFilterRules={}\n};\nZmPreferencesApp.prototype=new ZmApp;\nZmPreferencesApp.prototype.constructor=ZmPreferencesApp;\nZmPreferencesApp.prototype.isZmPreferencesApp=true;\nZmPreferencesApp.prototype.toString=function(){return\"ZmPreferencesApp\"\n};\nZmEvent.S_FILTER=\"FILTER\";\nZmEvent.S_PREF_ZIMLET=\"PREF_ZIMLET\";\nZmEvent.S_PREF_ACCOUNT=\"PREF_ACCOUNT\";\nZmEvent.S_PREF_BACKUP=\"PREF_BACKUP\";\nZmApp.PREFERENCES=ZmId.APP_PREFERENCES;\nZmApp.CLASS[ZmApp.PREFERENCES]=\"ZmPreferencesApp\";\nZmApp.SETTING[ZmApp.PREFERENCES]=ZmSetting.OPTIONS_ENABLED;\nZmApp.LOAD_SORT[ZmApp.PREFERENCES]=10;\nZmApp.QS_ARG[ZmApp.PREFERENCES]=\"options\";\nZmOrganizer.PREF_PAGE=\"PREF_PAGE\";\nZmPreferencesApp.QS_ARG_SECTION=\"section\";\nZmPreferencesApp._registerAllPrefs=function(){AjxDispatcher.require(\"PreferencesCore\");\nappCtxt.getAppController().runAppFunction(\"_registerPrefs\")\n};\nZmZimbraMail.addAppListener(ZmApp.PREFERENCES,ZmAppEvent.PRE_LAUNCH,new AjxListener(ZmPreferencesApp._registerAllPrefs));\nZmPreferencesApp.prototype.launch=function(b,d){if(appCtxt.multiAccounts){appCtxt.accountList.setActiveAccount(appCtxt.accountList.mainAccount)\n}var c=(b.qsParams&&b.qsParams[ZmPreferencesApp.QS_ARG_SECTION])||\"GENERAL\";\nd=new AjxCallback(this,this.gotoSection,[c,d]);\nvar a=new AjxCallback(this,this._handleLoadLaunch,[d]);\nAjxDispatcher.require([\"PreferencesCore\",\"Preferences\"],true,a,null,true)\n};\nZmPreferencesApp.prototype.getPrefController=function(){if(!this._prefController){AjxDispatcher.require([\"PreferencesCore\",\"Preferences\"]);\nthis._prefController=new ZmPrefController(this._container,this)\n}return this._prefController\n};\nZmPreferencesApp.prototype.getFilterController=function(){if(!this._filterController){this._filterController=this.getPrefController().getFilterController()\n}return this._filterController\n};\nZmPreferencesApp.prototype.getFilterRules=function(a){var b=window.parentAppCtxt||window.appCtxt;\nvar c=a||b.getActiveAccount().name;\nif(!this._filterRules[c]){this._filterRules[c]=new ZmFilterRules(c)\n}return this._filterRules[c]\n};\nZmPreferencesApp.prototype.getOutgoingFilterRules=function(a){var b=window.parentAppCtxt||window.appCtxt;\nvar c=a||b.getActiveAccount().name;\nif(!this._outgoingFilterRules[c]){this._outgoingFilterRules[c]=new ZmFilterRules(c,true)\n}return this._outgoingFilterRules[c]\n};\nZmPreferencesApp.prototype.modifyNotify=function(c,a){var b=this._getSharingView();\nif(b){b.notifyModify(c)\n}};\nZmPreferencesApp.prototype.refresh=function(b,d){var a=this.getPreferencesPage(\"TRUSTED_ADDR\");\nif(a&&d){a.addItem(d)\n}if(!appCtxt.inStartup){var c=this._getSharingView();\nif(c){c.refresh(b)\n}}};\nZmPreferencesApp.prototype.gotoSection=function(b,e){if(b){var d=this.getPrefController();\nvar a=d&&d.getPrefsView();\nif(a){b=b.toUpperCase();\nvar c=this.getOverview();\nif(c){c.setSelected([ZmOrganizer.PREF_PAGE,b].join(\"_\"))\n}a.selectSection(b)\n}}if(e&&e.run){e.run()\n}};\nZmPreferencesApp.prototype._defineAPI=function(){AjxDispatcher.registerMethod(\"GetFilterRules\",[\"PreferencesCore\",\"Preferences\"],new AjxCallback(this,this.getFilterRules));\nAjxDispatcher.registerMethod(\"GetOutgoingFilterRules\",[\"PreferencesCore\",\"Preferences\"],new AjxCallback(this,this.getOutgoingFilterRules));\nAjxDispatcher.registerMethod(\"GetPrefController\",[\"PreferencesCore\",\"Preferences\"],new AjxCallback(this,this.getPrefController));\nAjxDispatcher.registerMethod(\"GetFilterController\",[\"PreferencesCore\",\"Preferences\"],new AjxCallback(this,this.getFilterController))\n};\nZmPreferencesApp.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.PREF_PAGE,{app:ZmApp.PREFERENCES,orgClass:\"ZmPrefPage\",orgPackage:\"PreferencesCore\",treeController:\"ZmPrefPageTreeController\",labelKey:\"preferences\",treeType:ZmOrganizer.PREF_PAGE,displayOrder:100})\n};\nZmPreferencesApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_MOBILE_REMOVE,{textKey:\"mobileRemoveFromList\",image:\"Delete\"});\nZmOperation.registerOp(ZmId.OP_MOBILE_RESUME_SYNC,{textKey:\"mobileResumeSync\",image:\"ImAvailable\"});\nZmOperation.registerOp(ZmId.OP_MOBILE_SUSPEND_SYNC,{textKey:\"mobileSuspendSync\",image:\"Offline\"});\nZmOperation.registerOp(ZmId.OP_MOBILE_WIPE,{textKey:\"mobileWipe\",image:\"MobileWipe\"},ZmSetting.MOBILE_POLICY_ENABLED);\nZmOperation.registerOp(ZmId.OP_MOBILE_CANCEL_WIPE,{textKey:\"mobileWipeCancel\",image:\"MobileWipeCancel\"},ZmSetting.MOBILE_POLICY_ENABLED);\nZmOperation.registerOp(ZmId.OP_REVERT_PAGE,{textKey:\"restorePage\"})\n};\nZmPreferencesApp.prototype._registerSettings=function(a){a=a||appCtxt.getSettings();\na.registerSetting(\"IMPORT_FOLDER\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE});\na.registerSetting(\"IMPORT_BUTTON\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE});\na.registerSetting(\"EXPORT_FOLDER\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE});\na.registerSetting(\"EXPORT_BUTTON\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE});\na.registerSetting(\"PREF_SECTIONS\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_HASH,isGlobal:true});\na.registerSetting(\"SIGNATURE_MAX_LENGTH\",{name:\"zimbraMailSignatureMaxLength\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:1024});\na.registerSetting(\"DISCARD_IN_FILTER_ENABLED\",{name:\"zimbraFeatureDiscardInFiltersEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"FROM_DISPLAY_ENABLED\",{name:\"zimbraFeatureFromDisplayEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true})\n};\nZmPreferencesApp.prototype._registerApp=function(){ZmApp.registerApp(ZmApp.PREFERENCES,{mainPkg:\"Preferences\",nameKey:\"preferences\",icon:\"Preferences\",textPrecedence:50,chooserTooltipKey:\"goToOptions\",button:appCtxt.isChildWindow?null:ZmAppChooser.B_OPTIONS,overviewTrees:[ZmOrganizer.PREF_PAGE],hideZimlets:true,gotoActionCode:ZmKeyMap.GOTO_OPTIONS,chooserSort:180})\n};\nZmPreferencesApp.prototype._registerPrefs=function(){var r={GENERAL:{title:ZmMsg.general,templateId:\"prefs.Pages#General\",priority:0,prefs:[ZmSetting.LOCALE_NAME,ZmSetting.COMPOSE_INIT_DIRECTION,ZmSetting.SHOW_COMPOSE_DIRECTION_BUTTONS,ZmSetting.FONT_NAME,ZmSetting.FONT_SIZE,ZmSetting.PASSWORD,ZmSetting.SEARCH_INCLUDES_SHARED,ZmSetting.SEARCH_INCLUDES_SPAM,ZmSetting.SEARCH_INCLUDES_TRASH,ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES,ZmSetting.SHOW_SEARCH_STRING,ZmSetting.SHOW_SELECTION_CHECKBOX,ZmSetting.SKIN_NAME,ZmSetting.CLIENT_TYPE,ZmSetting.DEFAULT_TIMEZONE,ZmSetting.DEFAULT_PRINTFONTSIZE,ZmSetting.OFFLINE_IS_MAILTO_HANDLER,ZmSetting.SHORT_ADDRESS,ZmSetting.OFFLINE_UPDATE_NOTIFY]},ACCOUNTS:{icon:\"Accounts\",title:appCtxt.isOffline?ZmMsg.personas:ZmMsg.accounts,templateId:\"prefs.Pages#Accounts\",priority:9,precondition:ZmSetting.MAIL_PREFERENCES_ENABLED,prefs:[ZmSetting.ACCOUNTS,ZmSetting.SAVE_TO_SENT_DELEGATED_TARGET],manageDirty:true,createView:function(w,x,p){return new ZmAccountsPage(w,x,p)\n}},FILTERS:{icon:\"MailRule\",title:ZmMsg.filterRules,templateId:\"prefs.Pages#MailFilters\",priority:50,precondition:[ZmSetting.MAIL_PREFERENCES_ENABLED,ZmSetting.FILTERS_ENABLED],prefs:[ZmSetting.FILTERS],manageChanges:true,createView:function(w,x,p){return p.getFilterController(x).getFilterView()\n}},SIGNATURES:{icon:\"AddSignature\",title:ZmMsg.signatures,templateId:\"prefs.Pages#Signatures\",priority:51,precondition:[ZmSetting.MAIL_PREFERENCES_ENABLED,ZmSetting.SIGNATURES_ENABLED],prefs:[ZmSetting.SIGNATURES,ZmSetting.SIGNATURE_STYLE,ZmSetting.SIGNATURE_ENABLED],manageDirty:true,createView:function(w,x,p){return new ZmSignaturesPage(w,x,p)\n}},OUTOFOFFICE:{icon:\"OutOfOffice\",title:ZmMsg.outOfOffice,priority:55,templateId:\"prefs.Pages#OutOfOffice\",precondition:[ZmSetting.MAIL_PREFERENCES_ENABLED,ZmSetting.VACATION_MSG_FEATURE_ENABLED],prefs:[ZmSetting.START_DATE_ENABLED,ZmSetting.END_DATE_ENABLED,ZmSetting.VACATION_DURATION_ENABLED,ZmSetting.VACATION_DURATION_ALL_DAY,ZmSetting.VACATION_CALENDAR_ENABLED,ZmSetting.VACATION_FROM,ZmSetting.VACATION_FROM_TIME,ZmSetting.VACATION_MSG_ENABLED,ZmSetting.VACATION_MSG,ZmSetting.VACATION_EXTERNAL_MSG_ENABLED,ZmSetting.VACATION_EXTERNAL_MSG,ZmSetting.VACATION_EXTERNAL_TYPE,ZmSetting.VACATION_EXTERNAL_SUPPRESS,ZmSetting.VACATION_CALENDAR_TYPE,ZmSetting.VACATION_UNTIL,ZmSetting.VACATION_UNTIL_TIME],manageDirty:true,createView:function(w,x,p){AjxDispatcher.require(\"Alert\");\nreturn new ZmMailPrefsPage(w,x,p)\n}},TRUSTED_ADDR:{title:ZmMsg.trustedAddrs,icon:\"TrustedAddresses\",templateId:\"prefs.Pages#Trusted\",priority:60,precondition:ZmSetting.MAIL_PREFERENCES_ENABLED,createView:function(w,x,p){return new ZmTrustedPage(w,x,p,\"Prefs_Pages_TrustedAddresses\")\n},manageDirty:true,prefs:[ZmSetting.TRUSTED_ADDR_LIST]},SHARING:{title:ZmMsg.sharing,icon:\"SharedContact\",templateId:\"prefs.Pages#SharingPrefPage\",priority:85,precondition:ZmSetting.SHARING_ENABLED,manageChanges:true,createView:function(w,x,p){AjxDispatcher.require(\"Share\");\nreturn new ZmSharingPage(w,x,p,\"Prefs_Pages_Sharing\")\n}},NOTIFICATIONS:{title:ZmMsg.notifications,icon:\"ApptReminder\",templateId:\"prefs.Pages#Notifications\",priority:88,precondition:[ZmSetting.CALENDAR_ENABLED,ZmSetting.TASKS_ENABLED],preconditionAny:true,prefs:[ZmSetting.CAL_EMAIL_REMINDERS_ADDRESS,ZmSetting.CAL_DEVICE_EMAIL_REMINDERS_ADDRESS],createView:function(w,x,p){return new ZmNotificationsPage(w,x,p)\n}},MOBILE:{title:ZmMsg.connectedDevicesAndApps,icon:\"Mobile\",templateId:\"prefs.Pages#MobileDevices\",priority:90,precondition:ZmSetting.MOBILE_SYNC_ENABLED,manageChanges:true,createView:function(w,x,p){return new ZmMobileDevicesPage(w,x,p)\n}},IMPORT_EXPORT:{title:ZmMsg.importExport,icon:\"SendReceive\",templateId:\"data.ImportExport#ImportExportPrefPage\",priority:100,precondition:[ZmSetting.IMPORT_ENABLED,ZmSetting.EXPORT_ENABLED],preconditionAny:true,prefs:[ZmSetting.IMPORT_FOLDER,ZmSetting.IMPORT_BUTTON,ZmSetting.EXPORT_FOLDER,ZmSetting.EXPORT_BUTTON],manageChanges:true,createView:function(w,x,p){AjxDispatcher.require(\"ImportExport\");\nreturn new ZmImportExportPage(w,x,p)\n}},SHORTCUTS:{title:ZmMsg.shortcuts,icon:\"Shortcut\",templateId:\"prefs.Pages#Shortcuts\",priority:120,precondition:ZmSetting.USE_KEYBOARD_SHORTCUTS,createView:function(w,x,p){return new ZmShortcutsPage(w,x,p)\n}},PREF_ZIMLETS:{title:ZmMsg.zimlets,icon:\"Zimlet\",templateId:\"prefs.Pages#Zimlets\",manageDirty:true,priority:140,precondition:ZmSetting.CHECKED_ZIMLETS_ENABLED,prefs:[ZmSetting.CHECKED_ZIMLETS,ZmSetting.OFFLINE_ZIMLET_SYNC_ACCOUNT_ID],createView:function(w,x,p){return new ZmZimletsPage(w,x,p)\n}}};\nif(appCtxt.isOffline){r.BACKUP={title:ZmMsg.offlineBackups,icon:\"backup\",manageDirty:true,templateId:\"prefs.Pages#BackUp\",priority:130,prefs:[ZmSetting.OFFLINE_BACKUP_NOW_BUTTON,ZmSetting.OFFLINE_BACKUP_INTERVAL,ZmSetting.OFFLINE_BACKUP_PATH,ZmSetting.OFFLINE_BACKUP_KEEP,ZmSetting.OFFLINE_BACKUP_ACCOUNT_ID,ZmSetting.OFFLINE_BACKUP_RESTORE],createView:function(w,x,p){return new ZmBackupPage(w,x,p)\n}}\n}if(appCtxt.get(ZmSetting.CHAT_FEATURE_ENABLED)){ZmPref.registerPref(\"CHAT_ENABLED\",{displayName:ZmMsg.chatFeatureStatus,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.chatFeatureEnabled,ZmMsg.chatFeatureDisabled],options:[true,false]});\nZmPref.registerPref(\"CHAT_PLAY_SOUND\",{displayName:ZmMsg.chatPlaySound,displayContainer:ZmPref.TYPE_CHECKBOX});\nr.CHAT={title:ZmMsg.chat,icon:\"Conversation\",templateId:\"prefs.Pages#Chat\",priority:65,prefs:[ZmSetting.CHAT_ENABLED,ZmSetting.CHAT_PLAY_SOUND]}\n}for(var s in r){ZmPref.registerPrefSection(s,r[s])\n}ZmPref.registerPref(\"CLIENT_TYPE\",{displayName:ZmMsg.clientType,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:window.zimbraxSupported?[ZmMsg.clientAdvanced,ZmMsg.clientStandard,ZmMsg.clientZimbrax]:[ZmMsg.clientAdvanced,ZmMsg.clientStandard],options:window.zimbraxSupported?[ZmSetting.CLIENT_ADVANCED,ZmSetting.CLIENT_STANDARD,ZmSetting.CLIENT_ZIMBRAX]:[ZmSetting.CLIENT_ADVANCED,ZmSetting.CLIENT_STANDARD]});\nZmPref.registerPref(\"COMPOSE_AS_FORMAT\",{displayName:ZmMsg.composeUsing,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.composeAsHTML,ZmMsg.composeAsText],options:[ZmSetting.COMPOSE_HTML,ZmSetting.COMPOSE_TEXT],precondition:ZmSetting.HTML_COMPOSE_ENABLED,inputId:[\"COMPOSE_AS_HTML\",\"COMPOSE_AS_TEXT\"]});\nZmPref.registerPref(\"COMPOSE_INIT_FONT_COLOR\",{displayOptions:[\"rgb(0, 0, 0)\"],displayContainer:ZmPref.TYPE_COLOR,precondition:ZmSetting.HTML_COMPOSE_ENABLED});\nvar g=[],n=[];\nfor(var v in ZmPref.FONT_FAMILY){var l=ZmPref.FONT_FAMILY[v];\ng.push(l.value);\nn.push(l.name)\n}ZmPref.registerPref(\"COMPOSE_INIT_FONT_FAMILY\",{displayName:ZmMsg.defaultFontSettings,displayContainer:ZmPref.TYPE_SELECT,displayOptions:n,options:g,precondition:[ZmSetting.HTML_COMPOSE_ENABLED,ZmSetting.NOTEBOOK_ENABLED],preconditionAny:true,approximateFunction:function(p){if(AjxUtil.indexOf(g,p)!=-1){return p\n}return ZmPref._normalizeFontId(p)\n}});\nvar h=[8,9,10,11,12,13,14,16,18,24,36,48],c=AjxUtil.map(h,function(p){return AjxMessageFormat.format(ZmMsg.pt,p)\n}),e=AjxUtil.map(h,function(p){return p+\"pt\"\n});\nvar t=function(){var x=appCtxt.accountList.visibleAccounts;\nvar w=[];\nw.push(ZmMsg.zimletPrefDontSync);\nfor(var p=0;\np<x.length;\np++){if(x[p].isZimbraAccount&&!x[p].isMain){w.push([ZmMsg.zimletPrefSyncWith,\" \",x[p].name].join(\"\"))\n}}return w\n};\nvar i=function(){var x=appCtxt.accountList.visibleAccounts;\nvar w=[];\nw.push(\"\");\nfor(var p=0;\np<x.length;\np++){if(x[p].isZimbraAccount&&!x[p].isMain){w.push(x[p].id)\n}}return w\n};\nZmPref.registerPref(\"COMPOSE_INIT_FONT_SIZE\",{displayName:null,displayContainer:ZmPref.TYPE_SELECT,displayOptions:c,options:e,precondition:ZmSetting.HTML_COMPOSE_ENABLED});\nZmPref.registerPref(\"COMPOSE_SAME_FORMAT\",{displayName:ZmMsg.replyForwardInSameFormat,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CHECKED_ZIMLETS\",{displayName:ZmMsg.zimlets,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"OFFLINE_ZIMLET_SYNC_ACCOUNT_ID\",{displayName:ZmMsg.zimletSyncPref,displayContainer:ZmPref.TYPE_SELECT,displayOptions:t(),options:i()});\nZmPref.registerPref(\"DEFAULT_TIMEZONE\",{displayName:ZmMsg.selectTimezone,displayContainer:ZmPref.TYPE_SELECT,displayParams:{layout:DwtMenu.LAYOUT_SCROLL,maxRows:ZmPref.MAX_ROWS},displayOptions:AjxTimezone.getZonePreferences(),options:AjxTimezone.getZonePreferencesOptions()});\nZmPref.registerPref(\"DEFAULT_PRINTFONTSIZE\",{displayName:ZmMsg.printFontSizePref,displayContainer:ZmPref.TYPE_SELECT,displayOptions:c,options:e});\nZmPref.registerPref(\"EXPORT_FOLDER\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"EXPORT_BUTTON\",{displayName:ZmMsg._export,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"FORWARD_INCLUDE_WHAT\",{displayName:ZmMsg.forwardInclude,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.includeInBody,ZmMsg.includeOriginalAsAttach],options:[ZmSetting.INC_BODY,ZmSetting.INC_ATTACH],setFunction:ZmPref.setIncludeOrig,initFunction:ZmPref.initIncludeWhat,changeFunction:ZmPref.onChangeIncludeWhat});\nZmPref.registerPref(\"FORWARD_USE_PREFIX\",{displayName:ZmMsg.usePrefix,displayContainer:ZmPref.TYPE_CHECKBOX,setFunction:ZmPref.setIncludeOrig});\nZmPref.registerPref(\"FORWARD_INCLUDE_HEADERS\",{displayName:ZmMsg.includeHeaders,displayContainer:ZmPref.TYPE_CHECKBOX,setFunction:ZmPref.setIncludeOrig});\nZmPref.registerPref(\"IMPORT_FOLDER\",{loadFunction:ZmPref.loadCsvFormats,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"IMPORT_BUTTON\",{displayName:ZmMsg._import,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"LOCALE_NAME\",{displayName:ZmMsg.selectLanguage,displayContainer:ZmPref.TYPE_LOCALES,precondition:ZmSetting.LOCALE_CHANGE_ENABLED});\nZmPref.registerPref(\"COMPOSE_INIT_DIRECTION\",{displayName:ZmMsg.composeDirectionLabel,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.directionLTR,ZmMsg.directionRTL],options:[ZmSetting.LTR,ZmSetting.RTL]});\nZmPref.registerPref(\"SHOW_COMPOSE_DIRECTION_BUTTONS\",{displayName:ZmMsg.showDirectionButtons,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"FONT_NAME\",{displayName:ZmMsg.selectFong,displayContainer:ZmPref.TYPE_FONT});\nZmPref.registerPref(\"FONT_SIZE\",{displayName:ZmMsg.selectFontSize,displayContainer:ZmPref.TYPE_FONT_SIZE});\nvar b=AjxMessageFormat.format(ZmMsg.messageReadTime,DwtId.makeId(ZmId.WIDGET_INPUT,ZmId.OP_MARK_READ));\nZmPref.registerPref(\"MARK_MSG_READ\",{displayName:ZmMsg.messageReadLabel,displayContainer:ZmPref.TYPE_RADIO_GROUP,displayFunction:ZmPref.markMsgReadDisplay,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.messageReadNow,b,ZmMsg.messageReadNone],options:[ZmSetting.MARK_READ_NOW,ZmSetting.MARK_READ_TIME,ZmSetting.MARK_READ_NONE],valueFunction:ZmPref.markMsgReadValue});\nZmPref.registerPref(\"NEW_WINDOW_COMPOSE\",{displayName:ZmMsg.composeInNewWin,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:[ZmSetting.MAIL_ENABLED,ZmSetting.DETACH_COMPOSE_ENABLED]});\nZmPref.registerPref(\"MAIL_MANDATORY_SPELLCHECK\",{displayName:ZmMsg.mandatorySpellcheck,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"PAGE_SIZE\",{displayContainer:ZmPref.TYPE_SELECT,displayOptions:[\"25\",\"50\",\"100\",\"200\"]});\nZmPref.registerPref(\"PASSWORD\",{displayName:ZmMsg.changePassword,displayContainer:ZmPref.TYPE_PASSWORD,precondition:ZmSetting.CHANGE_PASSWORD_ENABLED});\nZmPref.registerPref(\"SHARING\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"SHORT_ADDRESS\",{displayName:ZmMsg.shortAddress,displayContainer:ZmPref.TYPE_CHECKBOX});\nif(appCtxt.isOffline){ZmPref.registerPref(\"OFFLINE_IS_MAILTO_HANDLER\",{displayName:ZmMsg.offlineAllowMailTo,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"OFFLINE_BACKUP_ACCOUNT_ID\",{displayName:ZmMsg.offlineBackUpAccounts,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"OFFLINE_BACKUP_RESTORE\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"OFFLINE_BACKUP_NOW_BUTTON\",{displayName:ZmMsg.offlineBackUpButton,displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"OFFLINE_BACKUP_INTERVAL\",{displayName:ZmMsg.offlineBackUpInterval,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.pollNever,ZmMsg.everyDay,ZmMsg.everyWeek,ZmMsg.everyMonth],options:[0,86400000,604800000,2628000000]});\nZmPref.registerPref(\"OFFLINE_BACKUP_PATH\",{displayName:ZmMsg.offlineBackUpPath,displayContainer:ZmPref.TYPE_INPUT});\nZmPref.registerPref(\"OFFLINE_BACKUP_KEEP\",{displayName:ZmMsg.offlineBackUpKeep,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[\"1\",\"2\",\"3\",\"4\",\"5\"]});\nZmPref.registerPref(\"OFFLINE_UPDATE_NOTIFY\",{displayName:ZmMsg.offlineUpdateNotify,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.offlineUpdateRelease,ZmMsg.offlineUpdateBeta],options:[\"release\",\"beta\"]})\n}var j=525600;\nvar k=10;\nvar d=[j];\nvar m=[ZmMsg.pollManually];\nvar u=appCtxt.get(ZmSetting.INSTANT_NOTIFY)?true:false;\nif(u){d.push(appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL));\nm.push(ZmMsg.pollInstant)\n}var o=ZmPref.pollingIntervalDisplay(appCtxt.get(ZmSetting.MIN_POLLING_INTERVAL));\no=(o<1)?1:Math.round(o);\nvar a=ZmPref.pollingIntervalDisplay(appCtxt.get(ZmSetting.POLLING_INTERVAL));\na=Math.round(a);\nwhile(o<=k){d.push(o);\no++\n}o=o-1;\nvar f=d.length;\nwhile(f<k){o=o+5;\nd.push(o);\nf++\n}if(a>o&&a!=j&&(u&&a!=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL))){var q=a%5;\nq=(q==0)?a:((a/5+1)*5);\nd.push(q)\n}else{o=o+5;\nd.push(o)\n}while(m.length<=f){m.push(ZmMsg.pollEveryNMinutes)\n}ZmPref.registerPref(\"POLLING_INTERVAL\",{displayName:ZmMsg.pollingInterval,displayContainer:ZmPref.TYPE_SELECT,displayOptions:m,options:d,approximateFunction:ZmPref.approximateInterval,displayFunction:ZmPref.pollingIntervalDisplay,valueFunction:ZmPref.pollingIntervalValue,validationFunction:ZmPref.validatePollingInterval});\nZmPref.registerPref(\"REPLY_INCLUDE_WHAT\",{displayName:ZmMsg.replyInclude,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.dontInclude,ZmMsg.includeInBody,ZmMsg.smartInclude,ZmMsg.includeOriginalAsAttach],options:[ZmSetting.INC_NONE,ZmSetting.INC_BODY,ZmSetting.INC_SMART,ZmSetting.INC_ATTACH],setFunction:ZmPref.setIncludeOrig,initFunction:ZmPref.initIncludeWhat,changeFunction:ZmPref.onChangeIncludeWhat});\nZmPref.registerPref(\"REPLY_USE_PREFIX\",{displayName:ZmMsg.usePrefix,displayContainer:ZmPref.TYPE_CHECKBOX,setFunction:ZmPref.setIncludeOrig});\nZmPref.registerPref(\"REPLY_INCLUDE_HEADERS\",{displayName:ZmMsg.includeHeaders,displayContainer:ZmPref.TYPE_CHECKBOX,setFunction:ZmPref.setIncludeOrig});\nZmPref.registerPref(\"REPLY_PREFIX\",{displayName:ZmMsg.prefix,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[\">\",\"|\"]});\nZmPref.registerPref(\"SAVE_TO_SENT\",{displayName:ZmMsg.saveToSent,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.MAIL_ENABLED,changeFunction:AjxCallback.simpleClosure(ZmPref.onChangeConfirm,null,ZmMsg.saveToSentWarning,ZmPref.getSendToFiltersActive,true,new AjxCallback(null,ZmPref.setFormValue,[\"SAVE_TO_SENT\",true]))});\nZmPref.registerPref(\"SAVE_TO_SENT_DELEGATED_TARGET\",{displayName:ZmMsg.saveToSentDelegatedTarget,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.saveToSentDelegatedOwner,ZmMsg.saveToSentDelegatedSender,ZmMsg.saveToSentDelegatedBoth,ZmMsg.saveToSentDelegatedNone],options:[\"owner\",\"sender\",\"both\",\"none\"],precondition:ZmSetting.MAIL_ENABLED});\nZmPref.registerPref(\"SEARCH_INCLUDES_SHARED\",{displayName:ZmMsg.includeSharedItems,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.SHARING_ENABLED});\nZmPref.registerPref(\"SEARCH_INCLUDES_SPAM\",{displayName:ZmMsg.includeJunkFolder,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:[ZmSetting.MAIL_ENABLED,ZmSetting.SPAM_ENABLED]});\nZmPref.registerPref(\"SEARCH_INCLUDES_TRASH\",{displayName:ZmMsg.includeTrashFolder,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:[ZmSetting.MAIL_ENABLED,ZmSetting.CONTACTS_ENABLED],preconditionAny:true});\nZmPref.registerPref(\"SHOW_FRAGMENTS\",{displayName:ZmMsg.showFragments,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"COLOR_MESSAGES\",{displayName:ZmMsg.colorMessages,displayContainer:ZmPref.TYPE_CHECKBOX});\nif(appCtxt.isOffline){ZmPref.registerPref(\"OFFLINE_SHOW_ALL_MAILBOXES\",{displayName:ZmMsg.showAllMailboxes,displayContainer:ZmPref.TYPE_CHECKBOX})\n}ZmPref.registerPref(\"SHOW_SEARCH_STRING\",{displayName:ZmMsg.showSearchString,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"SHOW_SELECTION_CHECKBOX\",{displayName:ZmMsg.showSelectionString,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"SKIN_NAME\",{displayName:ZmMsg.selectSkin,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[],options:[],loadFunction:ZmPref.loadSkins,precondition:ZmSetting.SKIN_CHANGE_ENABLED});\nZmPref.registerPref(\"VIEW_AS_HTML\",{displayName:ZmMsg.displayMail,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.displayAsHTML,ZmMsg.displayAsText],options:[true,false]})\n};\nZmPreferencesApp.prototype._handleLoadLaunch=function(b){var a=new AjxCallback(this,this._handleResponseLaunch,[b]);\nappCtxt.getSettings().loadPreferenceData(a)\n};\nZmPreferencesApp.prototype._handleResponseLaunch=function(a){AjxDispatcher.run(\"GetPrefController\").show();\nif(a){a.run()\n}};\nZmPreferencesApp.prototype._getSharingView=function(){var a=this.getPreferencesPage(\"SHARING\");\nreturn(a&&a.view)\n};\nZmPreferencesApp.prototype.getPreferencesPage=function(c){if(!this._prefController){return null\n}var b=this.getPrefController();\nvar a=b&&b.getPrefsView();\nreturn a&&a.getView(c)\n};\nZmPreferencesApp.prototype._getOverviewParams=function(){var a=ZmApp.prototype._getOverviewParams.call(this);\na.omit={};\na.omit[ZmOrganizer.ID_ZIMLET]=true;\na.actionSupported=false;\nreturn a\n};\nZmPreferencesApp.getFilterRulesController=function(a){var c=AjxDispatcher.run(\"GetPrefController\");\nif(c&&c.getPrefsView()){var b=c.getFilterController();\nreturn a?b.getOutgoingFilterRulesController():b.getIncomingFilterRulesController()\n}return null\n};\nZmPreferencesApp.prototype.getNewButtonProps=function(){return{hidden:true}\n}\n}if(AjxPackage.define(\"zimbraMail.portal.ZmPortalApp\")){ZmPortalApp=function(b,a){ZmApp.call(this,ZmApp.PORTAL,b,a)\n};\nZmPortalApp.prototype=new ZmApp;\nZmPortalApp.prototype.constructor=ZmPortalApp;\nZmPortalApp.prototype.toString=function(){return\"ZmPortalApp\"\n};\nZmPortalApp.prototype._registerApp=function(){ZmApp.registerApp(ZmApp.PORTAL,{nameKey:\"portal\",icon:\"Globe\",chooserTooltipKey:\"goToPortal\",button:ZmAppChooser.B_PORTAL,chooserSort:1,defaultSort:1})\n};\nZmApp.PORTAL=ZmId.APP_PORTAL;\nZmApp.CLASS[ZmApp.PORTAL]=\"ZmPortalApp\";\nZmApp.SETTING[ZmApp.PORTAL]=ZmSetting.PORTAL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.PORTAL]=1;\nZmApp.QS_ARG[ZmApp.PORTAL]=\"home\";\nZmEvent.S_PORTLET=\"PORTLET\";\nZmItem.PORTLET=ZmEvent.S_PORTLET;\nZmPortalApp.__PORTLET_ID=0;\nZmPortalApp.prototype.refreshPortlets=function(){var b=this.getPortletMgr();\nvar a=b.getPortlets();\nfor(var c in a){a[c].refresh()\n}};\nZmPortalApp.prototype.launch=function(b,c){var a=new AjxCallback(this,this._handleLoadLaunch,[b,c]);\nAjxDispatcher.require(\"Portal\",true,a,null,true)\n};\nZmPortalApp.prototype._handleLoadLaunch=function(b,c){var a=this.getPortalController();\na.show();\nZmApp.prototype.launch.call(this,b,c)\n};\nZmPortalApp.prototype.activate=function(b){var a=this.getPortalController();\na.setPaused(!b);\nZmApp.prototype.activate.call(this,b)\n};\nZmPortalApp.prototype.getManifest=function(e){if(!this._manifest){var c=appCtxt.get(ZmSetting.PORTAL_NAME);\nif(c){var b=new Date().getTime();\nvar d={url:[window.appContextPath,\"/portals/\",c,\"/manifest.xml?v=\",b].join(\"\"),callback:e?new AjxCallback(this,this._handleLoadManifest,[e]):null};\nvar a=AjxLoader.load(d);\nif(!e){this._handleLoadManifest(e,a)\n}}}else{if(e){e.run(this._manifest)\n}}return this._manifest\n};\nZmPortalApp.prototype._handleLoadManifest=function(j,g){var d;\nif(g.status==200&&g.responseXML){try{var k=new AjxJsonSerializer(true).serialize(g.responseXML);\nthis._manifest=JSON.parse(k);\nvar c=this._manifest.portal;\nvar b=c&&c.portlets;\nif(b&&!(b.portlet instanceof Array)){b.portlet=[b.portlet]\n}c.portlets=b.portlet;\nif(c.portlets){for(var a=0;\na<c.portlets.length;\na++){var h=c.portlets[a];\nvar f=h.property;\nif(f&&!(f instanceof Array)){f=[f]\n}h.properties=f;\ndelete h.property\n}}}catch(d){}}else{d=\"\"\n}if(!this._manifest){this._manifest={error:d}\n}if(j){j.run(this._manifest)\n}};\nZmPortalApp.prototype.getPortalController=function(){AjxDispatcher.require(\"Portal\");\nif(!this._portalController){this._portalController=new ZmPortalController(this._container,this)\n}return this._portalController\n};\nZmPortalApp.prototype.getPortletMgr=function(){AjxDispatcher.require(\"Portal\");\nif(!this._portletMgr){this._portletMgr=new ZmPortletMgr()\n}return this._portletMgr\n};\nZmPortalApp.prototype._getOverviewTrees=function(){return this._getOverviewApp()._getOverviewTrees()\n};\nZmPortalApp.prototype._getOverviewApp=function(){if(!this._overviewApp){var d=[];\nfor(var b in ZmApp.CHOOSER_SORT){d.push({name:b,sort:ZmApp.CHOOSER_SORT[b]})\n}d.sort(ZmPortalApp.__BY_SORT);\nvar a=null;\nfor(var c=0;\nc<d.length;\nc++){var e=d[c];\nif(e.name==this._name){continue\n}if(appCtxt.getApp(e.name).isIframe){continue\n}a=e.name;\nbreak\n}this._overviewApp=appCtxt.getApp(a)\n}return this._overviewApp\n};\nZmPortalApp.__BY_SORT=function(d,c){return d.sort-c.sort\n}\n}if(AjxPackage.define(\"zimbraMail.mail.ZmMailApp\")){ZmMailApp=function(b,a){ZmApp.call(this,ZmApp.MAIL,b,a);\nthis._dataSourceCollection={};\nthis._identityCollection={};\nthis._signatureCollection={};\nthis.numEntries=0;\nthis.globalMailCount=0;\nthis._throttleStats=[];\nthis._addSettingsChangeListeners();\nAjxCore.addOnloadListener(this._checkVacationReplyEnabled.bind(this))\n};\nZmMailApp.prototype=new ZmApp;\nZmMailApp.prototype.constructor=ZmMailApp;\nZmMailApp.prototype.isZmMailApp=true;\nZmMailApp.prototype.toString=function(){return\"ZmMailApp\"\n};\nZmEvent.S_CONV=ZmId.ITEM_CONV;\nZmEvent.S_MSG=ZmId.ITEM_MSG;\nZmEvent.S_ATT=ZmId.ITEM_ATT;\nZmEvent.S_FOLDER=ZmId.ORG_FOLDER;\nZmEvent.S_DATA_SOURCE=ZmId.ITEM_DATA_SOURCE;\nZmEvent.S_IDENTITY=\"IDENTITY\";\nZmEvent.S_SIGNATURE=\"SIGNATURE\";\nZmItem.CONV=ZmEvent.S_CONV;\nZmItem.MSG=ZmEvent.S_MSG;\nZmItem.ATT=ZmEvent.S_ATT;\nZmItem.DATA_SOURCE=ZmEvent.S_DATA_SOURCE;\nZmOrganizer.FOLDER=ZmEvent.S_FOLDER;\nZmApp.MAIL=ZmId.APP_MAIL;\nZmApp.CLASS[ZmApp.MAIL]=\"ZmMailApp\";\nZmApp.SETTING[ZmApp.MAIL]=ZmSetting.MAIL_ENABLED;\nZmApp.UPSELL_SETTING[ZmApp.MAIL]=ZmSetting.MAIL_UPSELL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.MAIL]=20;\nZmApp.QS_ARG[ZmApp.MAIL]=\"mail\";\nZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL=15;\nZmMailApp.AUTO_SAVE_IDLE_TIME=3;\nZmMailApp.DEFAULT_MAX_MESSAGE_SIZE=250000;\nZmMailApp.POP_DOWNLOAD_SINCE_ALL=0;\nZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE=1;\nZmMailApp.POP_DOWNLOAD_SINCE_FROM_NOW=2;\nZmMailApp.POP_DELETE_OPTION_KEEP=\"keep\";\nZmMailApp.POP_DELETE_OPTION_READ=\"read\";\nZmMailApp.POP_DELETE_OPTION_TRASH=\"trash\";\nZmMailApp.POP_DELETE_OPTION_HARD_DELETE=\"delete\";\nZmMailApp.SEND_RECEIPT_NEVER=\"never\";\nZmMailApp.SEND_RECEIPT_ALWAYS=\"always\";\nZmMailApp.SEND_RECEIPT_PROMPT=\"prompt\";\nZmMailApp.INC_MAP={};\nZmMailApp.INC_MAP[ZmSetting.INC_NONE]=[ZmSetting.INC_NONE,false,false];\nZmMailApp.INC_MAP[ZmSetting.INC_ATTACH]=[ZmSetting.INC_ATTACH,false,false];\nZmMailApp.INC_MAP[ZmSetting.INC_BODY]=[ZmSetting.INC_BODY,false,true];\nZmMailApp.INC_MAP[ZmSetting.INC_BODY_ONLY]=[ZmSetting.INC_BODY,false,false];\nZmMailApp.INC_MAP[ZmSetting.INC_BODY_PRE]=[ZmSetting.INC_BODY,true,false];\nZmMailApp.INC_MAP[ZmSetting.INC_BODY_HDR]=[ZmSetting.INC_BODY,false,true];\nZmMailApp.INC_MAP[ZmSetting.INC_BODY_PRE_HDR]=[ZmSetting.INC_BODY,true,true];\nZmMailApp.INC_MAP[ZmSetting.INC_SMART]=[ZmSetting.INC_SMART,false,false];\nZmMailApp.INC_MAP[ZmSetting.INC_SMART_PRE]=[ZmSetting.INC_SMART,true,false];\nZmMailApp.INC_MAP[ZmSetting.INC_SMART_HDR]=[ZmSetting.INC_SMART,false,true];\nZmMailApp.INC_MAP[ZmSetting.INC_SMART_PRE_HDR]=[ZmSetting.INC_SMART,true,true];\nZmMailApp.INC_MAP_REV={};\nAjxUtil.foreach(ZmMailApp.INC_MAP,function(a,c){var b=(c==ZmSetting.INC_NONE||c==ZmSetting.INC_ATTACH)?a[0]:a.join(\"|\");\nZmMailApp.INC_MAP_REV[b]=c\n});\nZmMailApp.GROUP_MAIL_BY_ITEM={};\nZmMailApp.GROUP_MAIL_BY_ITEM[ZmSetting.GROUP_BY_CONV]=ZmItem.CONV;\nZmMailApp.GROUP_MAIL_BY_ITEM[ZmSetting.GROUP_BY_MESSAGE]=ZmItem.MSG;\nZmMailApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"MailCore\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.setPackageLoadFunction(\"Mail\",new AjxCallback(this,this._postLoad,ZmOrganizer.FOLDER));\nAjxDispatcher.registerMethod(\"Compose\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.compose));\nAjxDispatcher.registerMethod(\"GetComposeController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getComposeController));\nAjxDispatcher.registerMethod(\"GetConvController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getConvController));\nAjxDispatcher.registerMethod(\"GetConvListController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getConvListController));\nAjxDispatcher.registerMethod(\"GetMsgController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getMsgController));\nAjxDispatcher.registerMethod(\"GetTradController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getTradController));\nAjxDispatcher.registerMethod(\"GetMailListController\",\"MailCore\",new AjxCallback(this,this.getMailListController));\nAjxDispatcher.registerMethod(\"GetIdentityCollection\",\"MailCore\",new AjxCallback(this,this.getIdentityCollection));\nAjxDispatcher.registerMethod(\"GetSignatureCollection\",\"MailCore\",new AjxCallback(this,this.getSignatureCollection));\nAjxDispatcher.registerMethod(\"GetDataSourceCollection\",\"MailCore\",new AjxCallback(this,this.getDataSourceCollection));\nAjxDispatcher.registerMethod(\"GetMailConfirmController\",[\"MailCore\",\"Mail\"],new AjxCallback(this,this.getConfirmController))\n};\nZmMailApp.prototype._registerSettings=function(a){var a=a||appCtxt.getSettings();\na.registerSetting(\"ALLOW_ANY_FROM_ADDRESS\",{name:\"zimbraAllowAnyFromAddress\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"AUTO_READ_RECEIPT_ENABLED\",{name:\"zimbraPrefMailRequestReadReceipts\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"AUTO_SAVE_DRAFT_INTERVAL\",{name:\"zimbraPrefAutoSaveDraftInterval\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LDAP_TIME,defaultValue:ZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL,isGlobal:true});\na.registerSetting(\"COLLAPSE_IMAP_TREES\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"COLOR_MESSAGES\",{name:\"zimbraPrefColorMessagesEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"COMPOSE_SAME_FORMAT\",{name:\"zimbraPrefForwardReplyInOriginalFormat\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CONVERSATIONS_ENABLED\",{name:\"zimbraFeatureConversationsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"CONVERSATION_ORDER\",{name:\"zimbraPrefConversationOrder\",type:ZmSetting.T_PREF,defaultValue:ZmSearch.DATE_DESC,isImplicit:true});\na.registerSetting(\"CONVERSATION_PAGE_SIZE\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:250,isGlobal:true});\na.registerSetting(\"CONV_SHOW_CALENDAR\",{name:\"zimbraPrefConvShowCalendar\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true});\na.registerSetting(\"DEDUPE_MSG_TO_SELF\",{name:\"zimbraPrefDedupeMessagesSentToSelf\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.DEDUPE_NONE});\na.registerSetting(\"DEDUPE_MSG_ENABLED\",{name:\"zimbraPrefMessageIdDedupingEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"DEFAULT_DISPLAY_NAME\",{type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"DETACH_COMPOSE_ENABLED\",{name:\"zimbraFeatureComposeInNewWindowEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"DETACH_MAILVIEW_ENABLED\",{name:\"zimbraFeatureOpenMailInNewWindowEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"DISPLAY_EXTERNAL_IMAGES\",{name:\"zimbraPrefDisplayExternalImages\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"END_DATE_ENABLED\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"FILTERS_ENABLED\",{name:\"zimbraFeatureFiltersEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"FILTERS_MAIL_FORWARDING_ENABLED\",{name:\"zimbraFeatureMailForwardingInFiltersEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"FORWARD_INCLUDE_HEADERS\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"FORWARD_INCLUDE_ORIG\",{name:\"zimbraPrefForwardIncludeOriginalText\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.INC_BODY,isGlobal:true});\na.registerSetting(\"FORWARD_INCLUDE_WHAT\",{type:ZmSetting.T_PREF,defaultValue:ZmSetting.INC_BODY,isGlobal:true});\na.registerSetting(\"FORWARD_MENU_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"FORWARD_USE_PREFIX\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"GROUP_MAIL_BY\",{name:\"zimbraPrefGroupMailBy\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.GROUP_BY_MESSAGE,isImplicit:true,isGlobal:true});\na.registerSetting(\"HIGHLIGHT_OBJECTS\",{name:\"zimbraMailHighlightObjectsMaxSize\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:70});\na.registerSetting(\"HTML_SIGNATURE_ENABLED\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"IDENTITIES_ENABLED\",{name:\"zimbraFeatureIdentitiesEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"INITIAL_SEARCH\",{name:\"zimbraPrefMailInitialSearch\",type:ZmSetting.T_PREF,defaultValue:\"in:inbox\"});\na.registerSetting(\"INITIAL_SEARCH_ENABLED\",{name:\"zimbraFeatureInitialSearchPreferenceEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_ATTACH_VIEW_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_BLACKLIST\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST});\na.registerSetting(\"TRUSTED_ADDR_LIST\",{name:\"zimbraPrefMailTrustedSenderList\",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST});\na.registerSetting(\"TRUSTED_ADDR_LIST_MAX_NUM_ENTRIES\",{name:\"zimbraMailTrustedSenderListMaxNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100});\na.registerSetting(\"MAIL_ACTIVITYSTREAM_FOLDER\",{name:\"zimbraMailActivityStreamFolder\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_INT,isImplicit:true,section:ZmSetting.M_IMPLICIT});\na.registerSetting(\"MAIL_BLACKLIST_MAX_NUM_ENTRIES\",{name:\"zimbraMailBlacklistMaxNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100});\na.registerSetting(\"MAIL_FOLDER_COLORS_ENABLED\",{name:\"zimbraPrefFolderColorEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"MAIL_FORWARDING_ADDRESS\",{name:\"zimbraPrefMailForwardingAddress\",type:ZmSetting.T_PREF});\na.registerSetting(\"MAIL_FORWARDING_ENABLED\",{name:\"zimbraFeatureMailForwardingEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_MANDATORY_SPELLCHECK\",{name:\"zimbraPrefMandatorySpellCheckEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_FROM_ADDRESS\",{name:\"zimbraPrefFromAddress\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST});\na.registerSetting(\"MAIL_FROM_ADDRESS_TYPE\",{name:\"zimbraPrefFromAddressType\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"sendAs\"});\na.registerSetting(\"MAIL_LIFETIME_GLOBAL\",{name:\"zimbraMailMessageLifetime\",type:ZmSetting.T_COS,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_INBOX_READ\",{name:\"zimbraPrefInboxReadLifetime\",type:ZmSetting.T_PREF,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_INBOX_UNREAD\",{name:\"zimbraPrefInboxUnreadLifetime\",type:ZmSetting.T_PREF,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_JUNK\",{name:\"zimbraPrefJunkLifetime\",type:ZmSetting.T_PREF,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_JUNK_GLOBAL\",{name:\"zimbraMailSpamLifetime\",type:ZmSetting.T_COS,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_SENT\",{name:\"zimbraPrefSentLifetime\",type:ZmSetting.T_PREF,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_TRASH\",{name:\"zimbraPrefTrashLifetime\",type:ZmSetting.T_PREF,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LIFETIME_TRASH_GLOBAL\",{name:\"zimbraMailTrashLifetime\",type:ZmSetting.T_COS,defaultValue:\"0\"});\na.registerSetting(\"MAIL_LOCAL_DELIVERY_DISABLED\",{name:\"zimbraPrefMailLocalDeliveryDisabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_NOTIFY_ALL\",{name:\"zimbraPrefShowAllNewMailNotifications\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_NOTIFY_SOUNDS\",{name:\"zimbraPrefMailSoundsEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_NOTIFY_APP\",{name:\"zimbraPrefMailFlashIcon\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_NOTIFY_BROWSER\",{name:\"zimbraPrefMailFlashTitle\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_NOTIFY_TOASTER\",{name:\"zimbraPrefMailToasterEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"MAIL_PRIORITY_ENABLED\",{name:\"zimbraFeatureMailPriorityEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_READ_RECEIPT_ENABLED\",{name:\"zimbraFeatureReadReceiptsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"MAIL_SEND_LATER_ENABLED\",{name:\"zimbraFeatureMailSendLaterEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"MAIL_SEND_READ_RECEIPTS\",{name:\"zimbraPrefMailSendReadReceipts\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"never\"});\na.registerSetting(\"MAIL_WHITELIST\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST});\na.registerSetting(\"MAIL_WHITELIST_MAX_NUM_ENTRIES\",{name:\"zimbraMailWhitelistMaxNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100});\na.registerSetting(\"MARK_MSG_READ\",{name:\"zimbraPrefMarkMsgRead\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0,isGlobal:true});\na.registerSetting(\"MAX_MESSAGE_SIZE\",{type:ZmSetting.T_PREF,defaultValue:ZmMailApp.DEFAULT_MAX_MESSAGE_SIZE});\na.registerSetting(\"NEW_WINDOW_COMPOSE\",{name:\"zimbraPrefComposeInNewWindow\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"NOTIF_ADDRESS\",{name:\"zimbraPrefNewMailNotificationAddress\",type:ZmSetting.T_PREF});\na.registerSetting(\"NOTIF_ENABLED\",{name:\"zimbraPrefNewMailNotificationEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"NOTIF_FEATURE_ENABLED\",{name:\"zimbraFeatureNewMailNotificationEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"OPEN_MAIL_IN_NEW_WIN\",{name:\"zimbraPrefOpenMailInNewWindow\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"POP_ENABLED\",{name:\"zimbraPop3Enabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:!appCtxt.isOffline});\na.registerSetting(\"POP_DOWNLOAD_SINCE_VALUE\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"\"});\na.registerSetting(\"POP_DOWNLOAD_SINCE\",{name:\"zimbraPrefPop3DownloadSince\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"\"});\na.registerSetting(\"POP_DELETE_OPTION\",{name:\"zimbraPrefPop3DeleteOption\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmMailApp.POP_DELETE_OPTION_HARD_DELETE});\na.registerSetting(\"POP_INCLUDE_SPAM\",{name:\"zimbraPrefPop3IncludeSpam\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"READING_PANE_LOCATION\",{name:\"zimbraPrefReadingPaneLocation\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true,isGlobal:true});\na.registerSetting(\"READING_PANE_LOCATION_CV\",{name:\"zimbraPrefConvReadingPaneLocation\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true});\na.registerSetting(\"READING_PANE_SASH_HORIZONTAL\",{name:\"zimbraPrefReadingPaneSashHorizontal\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_INT,isImplicit:true,section:ZmSetting.M_IMPLICIT});\na.registerSetting(\"READING_PANE_SASH_VERTICAL\",{name:\"zimbraPrefReadingPaneSashVertical\",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_INT,isImplicit:true,section:ZmSetting.M_IMPLICIT});\na.registerSetting(\"REPLY_INCLUDE_HEADERS\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"REPLY_INCLUDE_ORIG\",{name:\"zimbraPrefReplyIncludeOriginalText\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.INC_BODY,isGlobal:true});\na.registerSetting(\"REPLY_INCLUDE_WHAT\",{type:ZmSetting.T_PREF,defaultValue:ZmSetting.INC_BODY,isGlobal:true});\na.registerSetting(\"REPLY_MENU_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"REPLY_PREFIX\",{name:\"zimbraPrefForwardReplyPrefixChar\",type:ZmSetting.T_PREF,defaultValue:\">\",isGlobal:true});\na.registerSetting(\"REPLY_TO_ADDRESS\",{name:\"zimbraPrefReplyToAddress\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST});\na.registerSetting(\"REPLY_TO_ENABLED\",{name:\"zimbraPrefReplyToEnabled\",type:ZmSetting.T_PREF});\na.registerSetting(\"REPLY_USE_PREFIX\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"SAVE_DRAFT_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"SAVE_TO_IMAP_SENT\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"SAVE_TO_SENT\",{name:\"zimbraPrefSaveToSent\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"SAVE_TO_SENT_DELEGATED_TARGET\",{name:\"zimbraPrefDelegatedSendSaveTarget\",type:ZmSetting.T_PREF,defaultValue:\"owner\",isGlobal:true});\na.registerSetting(\"SELECT_AFTER_DELETE\",{name:\"zimbraPrefMailSelectAfterDelete\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.DELETE_SELECT_NEXT,isGlobal:true});\na.registerSetting(\"SENT_FOLDER_NAME\",{name:\"zimbraPrefSentMailFolder\",type:ZmSetting.T_PREF,defaultValue:\"sent\"});\na.registerSetting(\"SHOW_BCC\",{type:ZmSetting.T_PREF,defaultValue:false});\na.registerSetting(\"SHOW_FRAGMENTS\",{name:\"zimbraPrefShowFragments\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"SHOW_MAIL_CONFIRM\",{name:\"zimbraFeatureConfirmationPageEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"SHOW_CHATS_FOLDER\",{name:\"zimbraPrefShowChatsFolderInMail\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"SIGNATURE\",{name:\"zimbraPrefMailSignature\",type:ZmSetting.T_PREF});\na.registerSetting(\"SIGNATURE_ENABLED\",{name:\"zimbraPrefMailSignatureEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"SIGNATURE_STYLE\",{name:\"zimbraPrefMailSignatureStyle\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.SIG_OUTLOOK});\na.registerSetting(\"START_DATE_ENABLED\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"TAB_IN_EDITOR\",{name:\"zimbraPrefTabInEditorEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"USE_SEND_MSG_SHORTCUT\",{name:\"zimbraPrefUseSendMsgShortcut\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"USER_FOLDERS_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"VACATION_DURATION_ENABLED\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_DURATION_ALL_DAY\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"VACATION_FROM\",{name:\"zimbraPrefOutOfOfficeFromDate\",type:ZmSetting.T_PREF,defaultValue:\"\"});\na.registerSetting(\"VACATION_FROM_TIME\",{type:ZmSetting.T_PREF,defaultValue:\"\"});\na.registerSetting(\"VACATION_MSG\",{name:\"zimbraPrefOutOfOfficeReply\",type:ZmSetting.T_PREF,defaultValue:\"\"});\na.registerSetting(\"VACATION_EXTERNAL_TYPE\",{name:\"zimbraPrefExternalSendersType\",type:ZmSetting.T_PREF,defaultValue:\"ALL\"});\na.registerSetting(\"VACATION_EXTERNAL_SUPPRESS\",{name:\"zimbraPrefOutOfOfficeSuppressExternalReply\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_CALENDAR_TYPE\",{name:\"zimbraPrefOutOfOfficeFreeBusyStatus\",type:ZmSetting.T_PREF,defaultValue:\"OUTOFOFFICE\"});\na.registerSetting(\"VACATION_CALENDAR_APPT_ID\",{name:\"zimbraPrefOutOfOfficeCalApptID\",type:ZmSetting.T_METADATA,defaultValue:\"-1\",isImplicit:true,section:ZmSetting.M_IMPLICIT});\na.registerSetting(\"VACATION_CALENDAR_ENABLED\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_EXTERNAL_MSG\",{name:\"zimbraPrefOutOfOfficeExternalReply\",type:ZmSetting.T_PREF,defaultValue:\"\"});\na.registerSetting(\"VACATION_MSG_ENABLED\",{name:\"zimbraPrefOutOfOfficeReplyEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_EXTERNAL_MSG_ENABLED\",{name:\"zimbraPrefOutOfOfficeExternalReplyEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_MSG_REMIND_ON_LOGIN\",{name:\"zimbraPrefOutOfOfficeStatusAlertOnLogin\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"VACATION_MSG_FEATURE_ENABLED\",{name:\"zimbraFeatureOutOfOfficeReplyEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"VACATION_UNTIL\",{name:\"zimbraPrefOutOfOfficeUntilDate\",type:ZmSetting.T_PREF,defaultValue:\"\"});\na.registerSetting(\"VACATION_UNTIL_TIME\",{type:ZmSetting.T_PREF,defaultValue:\"\"})\n};\nZmMailApp.prototype._registerPrefs=function(){var c={MAIL:{title:ZmMsg.mail,icon:\"MailApp\",templateId:\"prefs.Pages#Mail\",priority:10,precondition:ZmSetting.MAIL_PREFERENCES_ENABLED,prefs:[ZmSetting.AUTO_READ_RECEIPT_ENABLED,ZmSetting.DEDUPE_MSG_TO_SELF,ZmSetting.DEDUPE_MSG_ENABLED,ZmSetting.DISPLAY_EXTERNAL_IMAGES,ZmSetting.DISPLAY_TIME_IN_MAIL_LIST,ZmSetting.GET_MAIL_ACTION,ZmSetting.INITIAL_SEARCH,ZmSetting.MAIL_BLACKLIST,ZmSetting.MAIL_FORWARDING_ADDRESS,ZmSetting.MAIL_LIFETIME_INBOX_READ,ZmSetting.MAIL_LIFETIME_INBOX_UNREAD,ZmSetting.MAIL_LIFETIME_JUNK,ZmSetting.MAIL_LIFETIME_SENT,ZmSetting.MAIL_LIFETIME_TRASH,ZmSetting.MAIL_LOCAL_DELIVERY_DISABLED,ZmSetting.MAIL_NOTIFY_SOUNDS,ZmSetting.MAIL_NOTIFY_ALL,ZmSetting.MAIL_NOTIFY_APP,ZmSetting.MAIL_NOTIFY_BROWSER,ZmSetting.MAIL_NOTIFY_TOASTER,ZmSetting.MAIL_WHITELIST,ZmSetting.MAIL_SEND_READ_RECEIPTS,ZmSetting.MARK_MSG_READ,ZmSetting.NOTIF_ADDRESS,ZmSetting.OFFLINE_NOTIFY_NEWMAIL_ON_INBOX,ZmSetting.OPEN_MAIL_IN_NEW_WIN,ZmSetting.PAGE_SIZE,ZmSetting.POP_DOWNLOAD_SINCE_VALUE,ZmSetting.POP_DOWNLOAD_SINCE,ZmSetting.POP_DELETE_OPTION,ZmSetting.POP_INCLUDE_SPAM,ZmSetting.POLLING_INTERVAL,ZmSetting.SELECT_AFTER_DELETE,ZmSetting.SHOW_FRAGMENTS,ZmSetting.COLOR_MESSAGES,ZmSetting.START_DATE_ENABLED,ZmSetting.VACATION_DURATION_ENABLED,ZmSetting.VACATION_DURATION_ALL_DAY,ZmSetting.VACATION_FROM,ZmSetting.VACATION_FROM_TIME,ZmSetting.VACATION_CALENDAR_ENABLED,ZmSetting.VACATION_MSG_ENABLED,ZmSetting.VACATION_MSG,ZmSetting.VACATION_EXTERNAL_MSG_ENABLED,ZmSetting.VACATION_EXTERNAL_MSG,ZmSetting.VACATION_EXTERNAL_TYPE,ZmSetting.VACATION_EXTERNAL_SUPPRESS,ZmSetting.VACATION_CALENDAR_TYPE,ZmSetting.VACATION_UNTIL,ZmSetting.VACATION_UNTIL_TIME,ZmSetting.VIEW_AS_HTML,ZmSetting.COMPOSE_AS_FORMAT,ZmSetting.COMPOSE_INIT_FONT_COLOR,ZmSetting.COMPOSE_INIT_FONT_FAMILY,ZmSetting.COMPOSE_INIT_FONT_SIZE,ZmSetting.FORWARD_INCLUDE_WHAT,ZmSetting.FORWARD_USE_PREFIX,ZmSetting.FORWARD_INCLUDE_HEADERS,ZmSetting.NEW_WINDOW_COMPOSE,ZmSetting.AUTO_SAVE_DRAFT_INTERVAL,ZmSetting.REPLY_INCLUDE_WHAT,ZmSetting.REPLY_USE_PREFIX,ZmSetting.REPLY_INCLUDE_HEADERS,ZmSetting.REPLY_PREFIX,ZmSetting.SAVE_TO_SENT,ZmSetting.TAB_IN_EDITOR,ZmSetting.USE_SEND_MSG_SHORTCUT,ZmSetting.COMPOSE_SAME_FORMAT,ZmSetting.MAIL_MANDATORY_SPELLCHECK],manageDirty:true,createView:function(e,f,d){AjxDispatcher.require(\"Alert\");\nreturn new ZmMailPrefsPage(e,f,d)\n}}};\nfor(var b in c){ZmPref.registerPrefSection(b,c[b])\n}ZmPref.registerPref(\"ACCOUNTS\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"AUTO_SAVE_DRAFT_INTERVAL\",{displayName:ZmMsg.autoSaveDrafts,displayContainer:ZmPref.TYPE_CHECKBOX,options:[0,ZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL]});\nZmPref.registerPref(\"AUTO_READ_RECEIPT_ENABLED\",{displayName:ZmMsg.autoReadReceiptRequest,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"USE_SEND_MSG_SHORTCUT\",{displayFunc:this.formatKeySeq.bind(this,AjxMessageFormat.format(ZmMsg.useSendMsgShortcut,[ZmKeys[\"compose.Send.display\"]])),displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"DEDUPE_MSG_TO_SELF\",{displayName:ZmMsg.removeDupesToSelf,displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.dedupeNone,ZmMsg.dedupeSecondCopy,ZmMsg.dedupeAll],options:[ZmSetting.DEDUPE_NONE,ZmSetting.DEDUPE_SECOND,ZmSetting.DEDUPE_ALL]});\nZmPref.registerPref(\"DEDUPE_MSG_ENABLED\",{displayName:ZmMsg.autoDeleteDedupeMsg,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"DISPLAY_EXTERNAL_IMAGES\",{displayName:ZmMsg.showExternalImages,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"DISPLAY_TIME_IN_MAIL_LIST\",{displayName:ZmMsg.displayTimeInMailList,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"END_DATE_ENABLED\",{displayName:ZmMsg.endOn,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"INITIAL_SEARCH\",{displayName:ZmMsg.initialMailSearch,displayContainer:ZmPref.TYPE_INPUT,maxLength:ZmPref.MAX_LENGTH[ZmSetting.INITIAL_SEARCH],errorMessage:AjxMessageFormat.format(ZmMsg.invalidInitialSearch,ZmPref.MAX_LENGTH[ZmSetting.INITIAL_SEARCH]),precondition:ZmSetting.INITIAL_SEARCH_ENABLED});\nZmPref.registerPref(\"MAIL_BLACKLIST\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"TRUSTED_ADDR_LIST\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"MAIL_FORWARDING_ADDRESS\",{displayName:ZmMsg.mailForwardingAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmMailApp.validateForwardEmail,errorMessage:ZmMsg.invalidEmail,precondition:ZmSetting.MAIL_FORWARDING_ENABLED,hint:ZmMsg.enterEmailAddress});\nZmPref.registerPref(\"MAIL_LIFETIME_INBOX_READ\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeInboxRead,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime});\nZmPref.registerPref(\"MAIL_LIFETIME_INBOX_UNREAD\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeInboxUnread,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime});\nZmPref.registerPref(\"MAIL_LIFETIME_JUNK\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:ZmMsg.lifetimeDurationDays,options:[1,3,7,30],approximateFunction:ZmPref.approximateLifetimeJunk,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetimeJunk});\nZmPref.registerPref(\"MAIL_LIFETIME_SENT\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeSent,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime});\nZmPref.registerPref(\"MAIL_LIFETIME_TRASH\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:ZmMsg.lifetimeDurationDays,options:[1,3,7,30],approximateFunction:ZmPref.approximateLifetimeTrash,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetimeTrash});\nZmPref.registerPref(\"MAIL_LOCAL_DELIVERY_DISABLED\",{displayName:ZmMsg.mailDeliveryDisabled,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.MAIL_FORWARDING_ENABLED,validationFunction:ZmMailApp.validateMailLocalDeliveryDisabled,errorMessage:ZmMsg.errorMissingFwdAddr});\nZmPref.registerPref(\"MAIL_NOTIFY_ALL\",{displayName:ZmMsg.messageNotificationFoldersLabel,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.messageNotificationFoldersInbox,ZmMsg.messageNotificationFoldersAll],options:[false,true]});\nZmPref.registerPref(\"MAIL_NOTIFY_SOUNDS\",{displayName:ZmMsg.playSound,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"MAIL_NOTIFY_APP\",{displayName:ZmMsg.flashMailAppTab,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"MAIL_NOTIFY_BROWSER\",{displayName:ZmMsg.flashBrowser,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"MAIL_SEND_READ_RECEIPTS\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.readReceiptNever,ZmMsg.readReceiptAlways,ZmMsg.readReceiptAsk],options:[ZmMailApp.SEND_RECEIPT_NEVER,ZmMailApp.SEND_RECEIPT_ALWAYS,ZmMailApp.SEND_RECEIPT_PROMPT],precondition:ZmSetting.MAIL_READ_RECEIPT_ENABLED});\nZmPref.registerPref(\"MAIL_WHITELIST\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"NOTIF_ADDRESS\",{displayName:ZmMsg.mailNotifAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmail,errorMessage:ZmMsg.invalidEmail,precondition:ZmSetting.NOTIF_FEATURE_ENABLED,hint:ZmMsg.enterEmailAddress,setFunction:ZmPref.setMailNotificationAddressValue});\nZmPref.registerPref(\"OPEN_MAIL_IN_NEW_WIN\",{displayName:ZmMsg.openMailNewWin,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.DETACH_MAILVIEW_ENABLED});\nZmPref.registerPref(\"POP_DOWNLOAD_SINCE_VALUE\",{displayContainer:ZmPref.TYPE_STATIC,precondition:ZmSetting.POP_ENABLED});\nZmPref.registerPref(\"POP_DOWNLOAD_SINCE\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.externalAccessPopDownloadAll,\"*** NOT SHOWN ***\",ZmMsg.externalAccessPopDownloadFromNow],options:[ZmMailApp.POP_DOWNLOAD_SINCE_ALL,ZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE,ZmMailApp.POP_DOWNLOAD_SINCE_FROM_NOW],displayFunction:ZmPref.downloadSinceDisplay,valueFunction:ZmPref.downloadSinceValue,precondition:ZmSetting.POP_ENABLED});\nZmPref.registerPref(\"POP_DELETE_OPTION\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.popDeleteHardDelete,ZmMsg.popDeleteTrash,ZmMsg.popDeleteRead,ZmMsg.popDeleteKeep],options:[ZmMailApp.POP_DELETE_OPTION_HARD_DELETE,ZmMailApp.POP_DELETE_OPTION_TRASH,ZmMailApp.POP_DELETE_OPTION_READ,ZmMailApp.POP_DELETE_OPTION_KEEP],precondition:ZmSetting.POP_ENABLED});\nZmPref.registerPref(\"POP_INCLUDE_SPAM\",{displayName:ZmMsg.popIncludeSpam,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"REPLY_TO_ADDRESS\",{displayName:ZmMsg.replyToAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmail,errorMessage:ZmMsg.invalidEmail});\nZmPref.registerPref(\"SELECT_AFTER_DELETE\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.selectNext,ZmMsg.selectPrevious,ZmMsg.selectAdapt],options:[ZmSetting.DELETE_SELECT_NEXT,ZmSetting.DELETE_SELECT_PREV,ZmSetting.DELETE_SELECT_ADAPT]});\nZmPref.registerPref(\"SIGNATURE\",{displayName:ZmMsg.signature,displayContainer:ZmPref.TYPE_TEXTAREA,maxLength:ZmPref.MAX_LENGTH[ZmSetting.SIGNATURE],errorMessage:AjxMessageFormat.format(ZmMsg.invalidSignature,ZmPref.MAX_LENGTH[ZmSetting.SIGNATURE])});\nZmPref.registerPref(\"SIGNATURE_ENABLED\",{displayName:ZmMsg.signatureEnabled,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"SIGNATURE_STYLE\",{displayName:ZmMsg.signatureStyle,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.aboveQuotedText,ZmMsg.atBottomOfMessage],options:[ZmSetting.SIG_OUTLOOK,ZmSetting.SIG_INTERNET]});\nZmPref.registerPref(\"SIGNATURES\",{displayContainer:ZmPref.TYPE_CUSTOM,initFunction:ZmPref.regenerateSignatureEditor});\nZmPref.registerPref(\"START_DATE_ENABLED\",{displayContainer:ZmPref.TYPE_CHECKBOX,displayName:ZmMsg.startOn,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"TAB_IN_EDITOR\",{displayName:ZmMsg.tabInEditor,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"VACATION_DURATION_ENABLED\",{displayContainer:ZmPref.TYPE_CHECKBOX,displayName:ZmMsg.oooDurationLabel,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"VACATION_DURATION_ALL_DAY\",{displayContainer:ZmPref.TYPE_CHECKBOX,displayName:ZmMsg.oooAllDayDurationLabel,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"VACATION_CALENDAR_ENABLED\",{displayContainer:ZmPref.TYPE_CHECKBOX,displayName:ZmMsg.vacationCalLabel,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"VACATION_FROM\",{displayName:ZmMsg.startDate,displayContainer:ZmPref.TYPE_INPUT,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,displayFunction:AjxDateUtil.dateGMT2Local,valueFunction:AjxDateUtil.dateLocal2GMT});\nZmPref.registerPref(\"VACATION_UNTIL\",{displayName:ZmMsg.endDate,displayContainer:ZmPref.TYPE_INPUT,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,displayFunction:AjxDateUtil.dateGMT2Local,valueFunction:AjxDateUtil.dateLocal2GMT});\nZmPref.registerPref(\"VACATION_MSG\",{displayName:ZmMsg.awayMessage,displayContainer:ZmPref.TYPE_TEXTAREA,maxLength:ZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE],errorMessage:AjxMessageFormat.format(ZmMsg.invalidAwayMessage,ZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE]),precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,validationFunction:ZmMailApp.validateVacationMsg});\nZmPref.registerPref(\"VACATION_MSG_ENABLED\",{displayName:ZmMsg.outOfOffice,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,errorMessage:ZmMsg.missingAwayMessage,displayOptions:[ZmMsg.noAutoReplyMessage,ZmMsg.autoReplyMessage],options:[false,true],inputId:[\"VACATION_MSG_DISABLED\",\"VACATION_MSG_ENABLED\"]});\nZmPref.registerPref(\"VACATION_EXTERNAL_TYPE\",{});\nZmPref.registerPref(\"VACATION_EXTERNAL_SUPPRESS\",{displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.vacationExternalAllStandard,ZmMsg.vacationExternalAllCustom,ZmMsg.vacationExternalAllExceptABCustom,ZmMsg.vacationExternalReplySuppress],options:[false,false,false,true],initFunction:ZmPref.initOOOVacationExternalSuppress,setFunction:ZmPref.addOOOVacationExternalPrefOnSave,changeFunction:ZmPref.handleOOOVacationExternalOptionChange,validationFunction:ZmMailApp.validateExternalVacationMsg,errorMessage:ZmMsg.missingAwayMessage});\nZmPref.registerPref(\"VACATION_CALENDAR_TYPE\",{displayName:ZmMsg.vacationExternalType,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.outOfOffice,ZmMsg.busy],options:[\"OUTOFOFFICE\",\"BUSY\"]});\nZmPref.registerPref(\"VACATION_EXTERNAL_MSG\",{displayName:ZmMsg.externalAwayMessage,displayContainer:ZmPref.TYPE_TEXTAREA,maxLength:ZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE],precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED});\nZmPref.registerPref(\"VACATION_EXTERNAL_MSG_ENABLED\",{});\nAjxDispatcher.require(\"Alert\");\nvar a=ZmDesktopAlert.getInstance().getDisplayText();\nZmPref.registerPref(\"MAIL_NOTIFY_TOASTER\",{displayFunc:function(){return a\n},precondition:!!a,displayContainer:ZmPref.TYPE_CHECKBOX});\nif(appCtxt.isOffline){ZmPref.registerPref(\"OFFLINE_NOTIFY_NEWMAIL_ON_INBOX\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.notifyNewMailOnInbox,ZmMsg.notifyNewMailOnAny],options:[true,false]})\n}};\nZmMailApp.prototype.formatKeySeq=function(a){new ZmShortcutList({cols:[]});\nreturn ZmShortcutList._formatDisplay(a)\n};\nZmMailApp.validateForwardEmail=function(b){if(!b||b==\"\"){var d=ZmPref.getPrefSectionWithPref(ZmSetting.MAIL_FORWARDING_ADDRESS);\nif(!d){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();\nvar c=a.getView(d.id).getFormObject(ZmSetting.MAIL_LOCAL_DELIVERY_DISABLED);\nif(c&&c.isSelected()){c.setSelected(false)\n}}return ZmPref.validateEmail(b)\n};\nZmMailApp.validateMailLocalDeliveryDisabled=function(c){if(!c){return true\n}var d=ZmPref.getPrefSectionWithPref(ZmSetting.MAIL_FORWARDING_ADDRESS);\nif(!d){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();\nvar b=a.getView(d.id).getFormObject(ZmSetting.MAIL_FORWARDING_ADDRESS);\nreturn(b!=null&&b.isValid())\n};\nZmMailApp.validateVacationMsg=function(c){if(c&&(c.length>0)){return true\n}var e=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_MSG_ENABLED);\nif(!e){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();\nvar b=a.getView(e.id).getFormObject(ZmSetting.VACATION_MSG_ENABLED);\nvar d=(b&&!(b.getSelectedValue()==\"true\"));\nif(!d){ZmPref.SETUP.VACATION_MSG.errorMessage=ZmMsg.missingAwayMessage\n}return d\n};\nZmMailApp.validateVacationMsgEnabled=function(c){if(!c){return true\n}var e=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_MSG);\nif(!e){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();\nvar b=a.getView(e.id).getFormObject(ZmSetting.VACATION_MSG);\nif(!b){return false\n}var d=b.getValue();\nreturn(d&&(d.length>0))\n};\nZmMailApp.validateExternalVacationMsg=function(){var d=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_MSG_ENABLED);\nif(!d){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView().getView(d.id);\nvar b=a.getFormObject(ZmSetting.VACATION_MSG_ENABLED);\nif(b&&b.getSelectedValue()===\"false\"){return true\n}var g=a.getFormObject(ZmSetting.VACATION_EXTERNAL_SUPPRESS);\nvar f=g.getText();\nif(f.indexOf(ZmMsg.vacationExternalAllStandard)>=0||f.indexOf(ZmMsg.vacationExternalReplySuppress)>=0){return true\n}var e=a.getFormObject(ZmSetting.VACATION_EXTERNAL_MSG);\nvar c=e.getValue();\nreturn(c&&(c.length>0))\n};\nZmMailApp.validateExternalVacationMsgEnabled=function(c){if(!c){return true\n}var e=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_EXTERNAL_MSG);\nif(!e){return false\n}var a=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();\nvar b=a.getView(e.id).getFormObject(ZmSetting.VACATION_EXTERNAL_MSG);\nif(!b){return false\n}var d=b.getValue();\nreturn(d&&(d.length>0))\n};\nZmMailApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_ADD_FILTER_RULE,{textKey:\"createFilter\",image:\"Plus\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_ADD_TO_FILTER_RULE,{textKey:\"addToFilter\",image:\"MailRule\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_ADD_SIGNATURE,{textKey:\"signature\",image:\"AddSignature\",tooltipKey:\"chooseSignature\"},ZmSetting.SIGNATURES_ENABLED);\nZmOperation.registerOp(ZmId.OP_CHECK_MAIL,{textKey:\"checkMail\",tooltipKey:\"checkMailPrefDefault\",image:\"Refresh\",textPrecedence:90,showImageInToolbar:true});\nZmOperation.registerOp(ZmId.OP_CREATE_APPT,{textKey:\"createAppt\",image:\"NewAppointment\"},ZmSetting.CALENDAR_ENABLED);\nZmOperation.registerOp(ZmId.OP_CREATE_TASK,{textKey:\"createTask\",image:\"NewTask\"},ZmSetting.TASKS_ENABLED);\nZmOperation.registerOp(ZmId.OP_DELETE_CONV,{textKey:\"delConv\",image:\"DeleteConversation\"},ZmSetting.CONVERSATIONS_ENABLED);\nZmOperation.registerOp(ZmId.OP_DELETE_MSG,{textKey:\"delMsg\",image:\"DeleteMessage\"});\nZmOperation.registerOp(ZmId.OP_DELETE_MENU,{textKey:\"del\",image:\"Delete\",tooltipKey:\"deleteTooltip\"});\nZmOperation.registerOp(ZmId.OP_DETACH_COMPOSE,{tooltipKey:\"detachComposeTooltip\",image:\"OpenInNewWindow\"});\nZmOperation.registerOp(ZmId.OP_DRAFT,null,ZmSetting.SAVE_DRAFT_ENABLED);\nZmOperation.registerOp(ZmId.OP_EDIT_FILTER_RULE,{textKey:\"filterEdit\",image:\"Edit\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_FORWARD,{textKey:\"forward\",tooltipKey:\"forwardTooltip\",image:\"Forward\",shortcut:ZmKeyMap.FORWARD,textPrecedence:46});\nZmOperation.registerOp(ZmId.OP_FORWARD_ATT,{textKey:\"forwardAtt\",tooltipKey:\"forwardAtt\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_FORWARD_CONV,{textKey:\"forwardConv\",tooltipKey:\"forwardConv\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_FORWARD_INLINE,{textKey:\"forwardInline\",tooltipKey:\"forwardTooltip\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_INC_ATTACHMENT,{textKey:\"includeMenuAttachment\"});\nZmOperation.registerOp(ZmId.OP_INC_BODY,{textKey:\"includeMenuBody\"});\nZmOperation.registerOp(ZmId.OP_INC_NONE,{textKey:\"includeMenuNone\"});\nZmOperation.registerOp(ZmId.OP_INC_SMART,{textKey:\"includeMenuSmart\"});\nZmOperation.registerOp(ZmId.OP_INCLUDE_HEADERS,{textKey:\"includeHeaders\"});\nZmOperation.registerOp(ZmId.OP_KEEP_READING,{textKey:\"keepReading\",tooltipKey:\"keepReadingTooltip\",shortcut:ZmKeyMap.KEEP_READING});\nZmOperation.registerOp(ZmId.OP_MARK_READ,{textKey:\"markAsRead\",image:\"ReadMessage\",shortcut:ZmKeyMap.MARK_READ});\nZmOperation.registerOp(ZmId.OP_MARK_UNREAD,{textKey:\"markAsUnread\",image:\"UnreadMessage\",shortcut:ZmKeyMap.MARK_UNREAD});\nZmOperation.registerOp(ZmId.OP_FLAG,{textKey:\"flag\",image:\"FlagRed\",shortcut:ZmKeyMap.FLAG},ZmSetting.FLAGGING_ENABLED);\nZmOperation.registerOp(ZmId.OP_UNFLAG,{textKey:\"unflag\",image:\"FlagDis\",shortcut:ZmKeyMap.FLAG},ZmSetting.FLAGGING_ENABLED);\nZmOperation.registerOp(ZmId.OP_MOVE_DOWN_FILTER_RULE,{textKey:\"filterMoveDown\",image:\"DownArrow\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_MOVE_TO_BCC,{textKey:\"moveToBcc\"});\nZmOperation.registerOp(ZmId.OP_MOVE_TO_CC,{textKey:\"moveToCc\"});\nZmOperation.registerOp(ZmId.OP_MOVE_TO_TO,{textKey:\"moveToTo\"});\nZmOperation.registerOp(ZmId.OP_MOVE_UP_FILTER_RULE,{textKey:\"filterMoveUp\",image:\"UpArrow\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_NEW_MESSAGE,{textKey:\"newEmail\",tooltipKey:\"newMessageTooltip\",image:\"NewMessage\",shortcut:ZmKeyMap.NEW_MESSAGE});\nZmOperation.registerOp(ZmId.OP_NEW_MESSAGE_WIN,{textKey:\"newEmail\",tooltipKey:\"newMessageTooltip\",image:\"NewMessage\",shortcut:ZmKeyMap.NEW_MESSAGE_WIN});\nZmOperation.registerOp(ZmId.OP_PRIORITY_HIGH,{textKey:\"priorityHigh\",image:\"PriorityHigh_list\"});\nZmOperation.registerOp(ZmId.OP_PRIORITY_LOW,{textKey:\"priorityLow\",image:\"PriorityLow_list\"});\nZmOperation.registerOp(ZmId.OP_PRIORITY_NORMAL,{textKey:\"priorityNormal\",image:\"PriorityNormal_list\"});\nZmOperation.registerOp(ZmId.OP_REMOVE_FILTER_RULE,{textKey:\"filterRemove\",image:\"Delete\"},ZmSetting.FILTERS_ENABLED);\nZmOperation.registerOp(ZmId.OP_REDIRECT,{textKey:\"mailRedirect\",tooltipKey:\"mailRedirectTooltip\",image:\"Redirect\"});\nZmOperation.registerOp(ZmId.OP_REPLY,{textKey:\"reply\",tooltipKey:\"replyTooltip\",image:\"Reply\",shortcut:ZmKeyMap.REPLY,textPrecedence:50});\nZmOperation.registerOp(ZmId.OP_REPLY_ALL,{textKey:\"replyAll\",tooltipKey:\"replyAllTooltip\",image:\"ReplyAll\",shortcut:ZmKeyMap.REPLY_ALL,textPrecedence:48});\nZmOperation.registerOp(ZmId.OP_REQUEST_READ_RECEIPT,{textKey:\"requestReadReceipt\",image:\"ReadMessage\"});\nZmOperation.registerOp(ZmId.OP_RESET,{textKey:\"reset\",image:\"Refresh\",tooltipKey:\"refreshFilters\"});\nZmOperation.registerOp(ZmId.OP_RUN_FILTER_RULE,{textKey:\"filterRun\",image:\"SwitchFormat\"},[ZmSetting.MAIL_ENABLED,ZmSetting.FILTERS_ENABLED]);\nZmOperation.registerOp(ZmId.OP_SAVE_DRAFT,{textKey:\"saveDraft\",tooltipKey:\"saveDraftTooltip\",image:\"DraftFolder\",shortcut:ZmKeyMap.SAVE},ZmSetting.SAVE_DRAFT_ENABLED);\nZmOperation.registerOp(ZmId.OP_SEND_MENU,{textKey:\"send\",tooltipKey:\"sendTooltip\",image:\"Send\"},ZmSetting.SAVE_DRAFT_ENABLED);\nZmOperation.registerOp(ZmId.OP_SEND_LATER,{textKey:\"sendLater\",tooltipKey:\"sendLaterTooltip\",image:\"SendLater\"},ZmSetting.SAVE_DRAFT_ENABLED);\nZmOperation.registerOp(ZmId.OP_SHOW_BCC,{textKey:\"showBcc\"});\nZmOperation.registerOp(ZmId.OP_SHOW_CONV,{textKey:\"showConv\",image:\"Conversation\"},ZmSetting.CONVERSATIONS_ENABLED);\nZmOperation.registerOp(ZmId.OP_SHOW_ORIG,{textKey:\"showOrig\",image:\"Message\"});\nZmOperation.registerOp(ZmId.OP_SPAM,{textKey:\"junkLabel\",tooltipKey:\"junkTooltip\",image:\"JunkMail\",shortcut:ZmKeyMap.SPAM,textPrecedence:70},ZmSetting.SPAM_ENABLED);\nZmOperation.registerOp(ZmId.OP_USE_PREFIX,{textKey:\"usePrefix\"})\n};\nZmMailApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.CONV,{app:ZmApp.MAIL,nameKey:\"conversation\",icon:\"Conversation\",soapCmd:\"ConvAction\",itemClass:\"ZmConv\",node:\"c\",organizer:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.TAG,ZmOrganizer.ZIMLET],searchType:\"conversation\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"MailCore\");\nreturn new ZmMailList(ZmItem.CONV,a)\n},this)});\nZmItem.registerItem(ZmItem.MSG,{app:ZmApp.MAIL,nameKey:\"message\",icon:\"Message\",soapCmd:\"MsgAction\",itemClass:\"ZmMailMsg\",node:\"m\",organizer:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.TAG,ZmOrganizer.ZIMLET],searchType:\"message\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"MailCore\");\nreturn new ZmMailList(ZmItem.MSG,a)\n},this)});\nZmItem.registerItem(ZmItem.ATT,{app:ZmApp.MAIL,nameKey:\"attachment\",icon:\"Attachment\",itemClass:\"ZmMimePart\",node:\"mp\",resultsList:AjxCallback.simpleClosure(function(a){return new ZmMailList(ZmItem.ATT,a)\n},this)})\n};\nZmMailApp.prototype._setupSearchToolbar=function(){if(appCtxt.get(ZmSetting.MAIL_ENABLED)){ZmSearchToolBar.addMenuItem(ZmId.SEARCH_MAIL,{msgKey:\"mail\",tooltipKey:\"searchMail\",icon:\"Message\",shareIcon:\"SharedMailFolder\",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_MAIL)})\n}};\nZmMailApp.prototype._registerApp=function(){var b={};\nb[ZmOperation.NEW_MESSAGE]=\"message\";\nvar a={};\na[ZmKeyMap.NEW_MESSAGE]=ZmOperation.NEW_MESSAGE;\na[ZmKeyMap.NEW_MESSAGE_WIN]=ZmOperation.NEW_MESSAGE_WIN;\nZmApp.registerApp(ZmApp.MAIL,{mainPkg:\"MailCore\",nameKey:\"mail\",icon:\"MailApp\",textPrecedence:70,chooserTooltipKey:\"goToMail\",viewTooltipKey:\"displayMailToolTip\",defaultSearch:appCtxt.isChildWindow?null:ZmId.SEARCH_MAIL,organizer:ZmOrganizer.FOLDER,overviewTrees:[ZmOrganizer.FOLDER,ZmOrganizer.SEARCH,ZmOrganizer.TAG],searchTypes:[ZmItem.MSG,ZmItem.CONV],newItemOps:b,actionCodes:a,gotoActionCode:ZmKeyMap.GOTO_MAIL,newActionCode:ZmKeyMap.NEW_MESSAGE,qsViews:[\"compose\",\"msg\"],chooserSort:10,defaultSort:10,upsellUrl:ZmSetting.MAIL_UPSELL_URL,searchResultsTab:true})\n};\nZmMailApp.prototype.startup=function(a){};\nZmMailApp.prototype.preNotify=function(o){if(!(o.deleted&&o.created&&o.modified)){return o\n}var g=false;\nvar h=o.deleted.id&&o.deleted.id.split(\",\");\nvar r={};\nvar k=[];\nif(h&&h.length){for(var A=0;\nA<h.length;\nA++){var v=h[A];\nvar s=ZmOrganizer.normalizeId(v);\nif(s<0){r[s]=true;\ng=true\n}else{k.push(v)\n}}}if(!g){return o\n}var p=false;\nvar q={};\nvar l={};\nfor(var F in o.created){var B=o.created[F];\nif(B&&B.length){for(var A=0;\nA<B.length;\nA++){var m=B[A];\nvar v=m.id;\nvar d=(F==\"m\")?\"|cid=\"+m.cid+\"|l=\"+m.l:\"|n=\"+m.n;\nAjxDebug.println(AjxDebug.NOTIFY,F+\": id=\"+v+\"|su='\"+m.su+\"'|f=\"+m.f+\"|d=\"+m.d+d);\nif(F==\"m\"){q[v]=m\n}else{if(F==\"c\"&&(m.n>1)){l[v]=m;\np=true\n}}}}}if(!p){return o\n}var y=false;\nvar z={};\nvar n={};\nvar B=o.modified.m;\nif(B&&B.length){for(var A=0;\nA<B.length;\nA++){var E=B[A];\nvar v=E.id;\nvar s=ZmOrganizer.normalizeId(v);\nvar b=s*-1;\nif(r[b]&&l[E.cid]){y=true;\nn[v]=E;\nz[E.cid]=appCtxt.multiAccounts?ZmOrganizer.getSystemId(b):b;\nl[E.cid]._wasVirtConv=true;\nvar f=appCtxt.getById(v),a;\nif(f){f.cid=E.cid;\na=f.folderId\n}l[E.cid].m=[{id:v,l:a}]\n}}}if(!y){return o\n}if(k.length){o.deleted.id=k.join(\",\")\n}else{delete o.deleted\n}var D=[];\nvar B=o.created.c;\nif(B&&B.length){for(var A=0;\nA<B.length;\nA++){var m=B[A];\nvar C=l[m.id];\nif(!(C&&C._wasVirtConv)){D.push(m)\n}}}if(D&&D.length){o.created.c=D\n}else{delete o.created.c\n}for(var v in q){var t=q[v];\nvar u=l[t.cid];\nif(u&&u._wasVirtConv){t._convCreateNode=u\n}}var w=[];\nfor(var j in z){var x=l[j];\nx.id=z[j];\nx._newId=j;\nw.push(x)\n}if(w.length){var e={};\ne.c=w;\nappCtxt.getRequestMgr()._handleModifies(e)\n}};\nZmMailApp.prototype.createNotify=function(e,g){if(!e.m&&!e.c&&!e.link){return\n}if(!g&&!this._noDefer&&this._deferNotifications(\"create\",e)){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: skipping/deferring notifications\");\nreturn\n}if(e.link){var f=e.link;\nfor(var d=0;\nd<f.length;\nd++){var c=f[d];\nif(appCtxt.cacheGet(c.id)){continue\n}this._handleCreateLink(c,ZmOrganizer.FOLDER)\n}}var h=this.getAllControllers();\nvar b=this._getCurrentViewController();\nif(b&&h[h.length-1]!==b){AjxUtil.arrayRemove(h,b);\nh.push(b)\n}for(var d=0;\nd<h.length;\nd++){var a=h[d];\nif(a&&a.isZmDoublePaneController){this._checkList(e,a.getList(),a,d==h.length-1)\n}}this._handleAlerts(e)\n};\nZmMailApp.prototype._handleAlerts=function(q){var a=q.m||[];\nif(a.length==0){return\n}AjxDispatcher.require(\"Alert\");\nvar r=appCtxt.getActiveAccount();\nvar b,p,g=false;\nvar k=0;\nfor(var o=0;\no<a.length;\no++){var t=a[o];\nvar e=(t&&t.f&&(t.f.indexOf(ZmItem.FLAG_UNREAD)!=-1))?ZmOrganizer.parseId(t.l):null;\nvar d=e&&e.account;\nif(!d||(d&&d.isOfflineInitialSync())){continue\n}if(appCtxt.isOffline&&e&&!d.isMain){var l=(appCtxt.get(ZmSetting.OFFLINE_NOTIFY_NEWMAIL_ON_INBOX))?(e.id==ZmOrganizer.ID_INBOX):(e.id!=ZmOrganizer.ID_SPAM&&e.id!=ZmOrganizer.ID_TRASH);\nif(l){this.globalMailCount++;\nd.inNewMailMode=true;\nvar u=appCtxt.getOverviewController()._overviewContainer;\nfor(var n in u){u[n].updateAccountInfo(d,true,true)\n}}}if(appCtxt.get(ZmSetting.MAIL_NOTIFY_ALL)||(e&&e.id==ZmOrganizer.ID_INBOX)){if(appCtxt.accountList.size()>1){ZmAccountAlert.get(d).start(this)\n}if(!b&&d==r&&appCtxt.get(ZmSetting.MAIL_NOTIFY_APP,null,d)){this.startAlert();\nb=true\n}if(!p&&appCtxt.get(ZmSetting.MAIL_NOTIFY_SOUNDS,null,d)){ZmSoundAlert.getInstance().start();\np=true\n}if(!g&&appCtxt.get(ZmSetting.MAIL_NOTIFY_BROWSER,null,d)){ZmBrowserAlert.getInstance().start(ZmMsg.newMessage);\ng=true\n}if(appCtxt.get(ZmSetting.MAIL_NOTIFY_TOASTER,null,d)&&k<5){var c=appCtxt.getById(t.id)||ZmMailMsg.createFromDom(t,{});\nvar f=(c.subject)?([c.subject,\" - \",(c.fragment||\"\")].join(\"\")):(c.fragment||\"\");\nvar m=c.getAddress(AjxEmailAddress.FROM);\nvar h=(m&&m instanceof AjxEmailAddress)?m.getName()||m.getAddress():(m&&typeof m==\"string\")?m:ZmMsg.unknown;\nvar s=(appCtxt.accountList.size()>1)?AjxMessageFormat.format(ZmMsg.newMailWithAccount,[h,d.getDisplayName()]):AjxMessageFormat.format(ZmMsg.newMail,h);\nZmDesktopAlert.getInstance().start(s,f);\nk++\n}}}};\nZmMailApp.prototype._checkList=function(f,e,d,i){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: handling mail creates for view \"+d.getCurrentViewId());\nif(!(e&&e instanceof ZmMailList)){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: list is not a ZmMailList: \"+e);\nreturn\n}var c={};\nvar g={};\nvar h=e.search.sortBy;\nvar a=this._checkType(f,ZmItem.CONV,c,e,h,null,i);\nvar b=this._checkType(f,ZmItem.MSG,g,e,h,c,i);\nif(a.gotMail||b.gotMail){e.notifyCreate(c,g)\n}if(a.hasMore||b.hasMore){var d=this._getCurrentViewController();\nif(d){d.setHasMore(true)\n}}};\nZmMailApp.prototype._getCurrentViewController=function(){var b;\nvar a=appCtxt.getCurrentViewType();\nif(a==ZmId.VIEW_CONVLIST){b=this.getConvListController()\n}else{if(a==ZmId.VIEW_TRAD){b=this.getTradController()\n}}return b\n};\nZmMailApp.prototype._checkType=function(creates,type,items,currList,sortBy,convs,last){var result={gotMail:false,hasMore:false};\nvar nodeName=ZmList.NODE[type];\nvar list=creates[nodeName];\nif(!(list&&list.length)){return result\n}var throttle;\nif(appCtxt.isOffline){throttle=(appCtxt.get(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES))?appCtxt.accountList.isInitialSyncing():appCtxt.getActiveAccount().isOfflineInitialSync()\n}if(throttle){if(!this._maxEntries){var mlv=this.getMailListController().getCurrentView().getMailListView();\nthis._maxEntries=mlv&&mlv.calculateMaxEntries()\n}if(this.numEntries>this._maxEntries){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: too many creates: num=\"+this.numEntries+\", max=\"+this._maxEntries);\nreturn result\n}}var INTERVAL_LENGTH=10*1000;\nvar INTERVAL_THRESHOLD=20;\nfor(var i=0;\ni<list.length;\ni++){var create=list[i];\nvar folder=create.l||\"conv\";\nvar now=new Date();\nvar data=this._throttleStats[folder];\nif(!data||now.getTime()-data.intervalStart.getTime()>INTERVAL_LENGTH){data=this._throttleStats[folder]={intervalStart:now,count:0}\n}data.count++;\nif(data.count>INTERVAL_THRESHOLD){if(data.count==INTERVAL_THRESHOLD+1){}result.hasMore=true;\ncontinue\n}AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: process create notification:\");\nvar extra=(type==ZmItem.MSG)?\"|cid=\"+create.cid+\"|l=\"+create.l:\"|n=\"+create.n;\nAjxDebug.println(AjxDebug.NOTIFY,type+\": id=\"+create.id+\"|su='\"+create.su+\"'|f=\"+create.f+\"|d=\"+create.d+extra);\nif(create._handled){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: create already handled \"+create.id);\ncontinue\n}if(last){create._handled=true\n}if(currList.type==ZmItem.MSG&&type==ZmItem.CONV){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: msg list ignoring conv create\");\ncontinue\n}if(appCtxt.isOffline){if((ZmList.ITEM_TYPE[nodeName]!=currList.type)&&(currList.type!=ZmItem.CONV)){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: type mismatch: \"+ZmList.ITEM_TYPE[nodeName]+\" / \"+currList.type);\ncontinue\n}}if(throttle&&this.numEntries>this._maxEntries){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: throttling\");\nresult.hasMore=true;\nbreak\n}var item=appCtxt.getById(create.id);\nif(!item){AjxDebug.println(AjxDebug.NOTIFY,\"ZmMailApp: create \"+type+\" object \"+create.id);\nvar itemClass=eval(ZmList.ITEM_CLASS[type]);\nitem=itemClass.createFromDom(create,{list:currList})\n}else{if(item.type==ZmItem.MSG){var conv=appCtxt.getById(item.cid);\nif(conv){conv.folders[item.folderId]=true\n}}}items[item.id]=item;\nresult.gotMail=true\n}return result\n};\nZmMailApp.prototype.modifyNotify=function(b,a){if(!b.m&&!b.c){return\n}if(!a&&!this._noDefer&&this._deferNotifications(\"modify\",b)){return\n}this._batchNotify(b.m);\nthis._batchNotify(b.c)\n};\nZmMailApp.prototype.postNotify=function(a){var b=this._checkReplenishListView;\nif(b&&!b._isPageless){b._checkReplenish();\nthis._checkReplenishListView=null\n}};\nZmMailApp.prototype.refresh=function(g){var f=appCtxt.getById(ZmFolder.ID_INBOX);\nif(f){this.setNewMailNotice(f)\n}if(!appCtxt.inStartup){this.resetOverview(this.getOverviewId());\nvar e=[ZmId.VIEW_TRAD,ZmId.VIEW_CONVLIST,ZmId.VIEW_CONV];\nvar a=appCtxt.getAppViewMgr();\nfor(var c=0;\nc<e.length;\nc++){var k=a.getViewsByType(e[c]);\nfor(var b=0;\nb<k.length;\nb++){var h=a.getViewComponent(ZmAppViewMgr.C_APP_CONTENT,k[b].id);\nif(h&&h.isZmDoublePaneView){h.isStale=true\n}}}var d=appCtxt.getCurrentViewId();\nAjxTimedAction.scheduleAction(new AjxTimedAction(this,this._checkRefresh,[d]),1000)\n}};\nZmMailApp.prototype._checkRefresh=function(b){if(appCtxt.getCurrentViewId()==b){var a=appCtxt.getCurrentView();\nif(a&&a.isStale&&a._staleHandler){a._staleHandler()\n}}};\nZmMailApp.prototype.handleOp=function(e,d){var b=false;\nvar c=true;\nif((e==ZmOperation.NEW_MESSAGE_WIN)||(e==ZmOperation.NEW_MESSAGE)){if(!appCtxt.isWebClientOffline()){b=(e==ZmOperation.NEW_MESSAGE_WIN)?true:this._inNewWindow(d&&d.ev);\nc=false\n}var a=new AjxCallback(this,this.compose,{action:ZmOperation.NEW_MESSAGE,inNewWindow:b});\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,a,null,c)\n}};\nZmMailApp.prototype.getOverviewPanelContent=function(){var b=!this._overviewPanelContent;\nvar a=ZmApp.prototype.getOverviewPanelContent.apply(this,arguments);\nif(b){appCtxt.getSearchController().updateOverview()\n}return a\n};\nZmMailApp.prototype.getOverviewContainer=function(){var b=!this._overviewContainer;\nvar a=ZmApp.prototype.getOverviewContainer.apply(this,arguments);\nif(b&&!appCtxt.get(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES)){appCtxt.getSearchController().updateOverview()\n}return a\n};\nZmMailApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newMessage,tooltip:ZmMsg.compose,icon:\"NewMessage\",iconDis:\"NewMessageDis\",defaultId:ZmOperation.NEW_MESSAGE,disabled:!this.containsWritableFolder()}\n};\nZmMailApp.prototype.launch=function(b,c){this._setLaunchTime(this.toString(),new Date());\nif(appCtxt.isExternalAccount()){var a=this._handleLoadLaunch.bind(this,b,c);\nAjxDispatcher.require([\"MailCore\",\"Mail\",\"Startup2\"],true,a,null,true)\n}else{this._handleLoadLaunch(b,c)\n}};\nZmMailApp.prototype._handleLoadLaunch=function(f,h){this._groupBy=appCtxt.get(ZmSetting.GROUP_MAIL_BY);\nif(!appCtxt.get(ZmSetting.CONVERSATIONS_ENABLED)&&this._groupBy===\"conversation\"){this._groupBy=\"message\"\n}var d;\nf=f||{};\nif(f.qsParams){var a=f.qsParams.view,g=f.qsParams.id;\nif(a==\"compose\"){this._showComposeView(h);\nreturn\n}else{if(g){a=a||\"msg\";\nif(a==\"list\"){d=[\"item:\",g].join(\"\");\nf.searchResponse=null;\nthis._forceMsgView=true\n}else{if(a==\"msg\"){var c=new ZmMailList(ZmItem.MSG);\nvar e=new ZmMailMsg(g,c,true);\nc.add(e);\nvar b={getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),markRead:(appCtxt.get(ZmSetting.MARK_MSG_READ)==ZmSetting.MARK_READ_NOW),callback:new AjxCallback(this,this._handleResponseMsgLoad,[e,h]),errorCallback:new AjxCallback(this,this._handleErrorMsgLoad,h)};\ne.load(b);\nreturn\n}}}}}this.mailSearch(d,h,f.searchResponse)\n};\nZmMailApp.prototype._handleErrorLaunch=function(b,a){if(a.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER||a.code==ZmCsfeException.MAIL_NO_SUCH_TAG||a.code==ZmCsfeException.MAIL_QUERY_PARSE_ERROR){var c={query:\"in:inbox\",callback:b.callback,errorCallback:null,types:b.types};\nappCtxt.getSearchController().search(c)\n}};\nZmMailApp.prototype._handleErrorMsgLoad=function(b,a){this.mailSearch();\nif(b){b.run()\n}this._notifyRendered();\nreturn false\n};\nZmMailApp.prototype._handleResponseMsgLoad=function(b,c){AjxDispatcher.require(\"Startup2\");\nvar a=AjxDispatcher.run(\"GetMsgController\");\nif(a){a.show(b,null,null,null,true);\nif(c){c.run()\n}this._notifyRendered();\nappCtxt.notifyZimlets(\"onMsgView\",[b,null,appCtxt.getCurrentView()],{waitUntilLoaded:true})\n}};\nZmMailApp.prototype.mailSearch=function(g,j,c,h){var e=appCtxt.isOffline&&appCtxt.inStartup&&appCtxt.accountList.defaultAccount;\nif(e){appCtxt.accountList.setActiveAccount(e)\n}var f=appCtxt.getSearchController();\nvar k,a;\nif(appCtxt.get(ZmSetting.OFFLINE_SHOW_ALL_MAILBOXES)&&appCtxt.accountList.size()>2){g=null;\nk=appCtxt.accountList.generateQuery(ZmOrganizer.ID_INBOX);\na=true;\nf.searchAllAccounts=true\n}else{if(appCtxt.isExternalAccount()){g=\"inid:\"+this.getDefaultFolderId()\n}else{if(appCtxt.isWebClientOffline()){g=g||\"in:inbox\"\n}else{g=g||appCtxt.get(ZmSetting.INITIAL_SEARCH,null,e)\n}}}var d=new AjxVector();\nd.add(h||this.getGroupMailBy());\nvar i=AjxUtil.get(c,\"Body\",\"SearchResponse\",\"sortBy\")||ZmSearch.DATE_DESC;\nvar b={searchFor:ZmId.SEARCH_MAIL,query:g,queryHint:k,types:d,limit:this.getLimit(),getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML,null,e),noUpdateOverview:a,offlineCache:true,accountName:(e&&e.name),callback:j,response:c,sortBy:i};\nb.errorCallback=new AjxCallback(this,this._handleErrorLaunch,b);\nf.search(b)\n};\nZmMailApp.prototype.showSearchResults=function(b,d,c){var a=this._handleLoadShowSearchResults.bind(this,b,d,c);\nAjxDispatcher.require(\"MailCore\",false,a,null,true)\n};\nZmMailApp.prototype._handleLoadShowSearchResults=function(b,e,c){var d=c?c.getCurrentViewId():ZmApp.MAIN_SESSION;\nvar a=((b.type==ZmItem.MSG)||!appCtxt.get(ZmSetting.CONVERSATIONS_ENABLED))?this.getTradController(d,c):this.getConvListController(d,c);\na.show(b);\nthis._setLoadedTime(this.toString(),new Date());\nif(this._forceMsgView){a.selectFirstItem();\nthis._forceMsgView=false\n}if(e){e.run(a)\n}this._notifyRendered();\nappCtxt.getAppViewMgr().updateTitle()\n};\nZmMailApp.prototype._parseComposeUrl=function(b){b=b||\"\";\nb.replace(/^mailto:/i,\"\");\nb=AjxStringUtil.urlComponentDecode(b);\nvar d=b.match(/\\bto=([^&]+)/i);\nvar g=d?AjxStringUtil.urlComponentDecode(d[1].replace(/\\+/g,\" \")):null;\ng=g&&AjxEmailAddress.isValid(g)?AjxStringUtil.urlComponentDecode(g):AjxStringUtil.htmlEncode(g);\nd=b.match(/\\bsubject=([^&]+)/i);\nvar e=d?(AjxStringUtil.urlComponentDecode(d[1]).replace(/\\+/g,\" \")):null;\nd=b.match(/\\bcc=([^&]+)/i);\nvar f=d?AjxStringUtil.urlComponentDecode(d[1].replace(/\\+/g,\" \")):null;\nf=f&&AjxEmailAddress.isValid(f)?f:AjxStringUtil.htmlEncode(f);\nd=b.match(/\\bbcc=([^&]+)/i);\nvar c=d?AjxStringUtil.urlComponentDecode(d[1].replace(/\\+/g,\" \")):null;\nc=c&&AjxEmailAddress.isValid(c)?c:AjxStringUtil.htmlEncode(c);\nd=b.match(/\\bbody=([^&]+)/i);\nvar a=d?(AjxStringUtil.urlComponentDecode(d[1]).replace(/\\+/g,\" \")):null;\nreturn{to:g,subject:AjxStringUtil.htmlEncode(e),cc:f,bcc:c,body:AjxStringUtil.htmlEncode(a)}\n};\nZmMailApp.prototype._showComposeView=function(g,c){var d=c||location.search;\nAjxDispatcher.require(\"Startup2\");\nvar i=AjxDispatcher.run(\"GetComposeController\");\nvar a=this._parseComposeUrl(d);\nvar f=a.to;\nif(f&&f.indexOf(\"mailto\")==0){f=f.replace(/mailto:/,\"\");\nvar e=f.split(\"?\");\na.to=e[0];\nif(e.length>1){e=e[1];\nvar h=this._parseComposeUrl(e);\na.to=a.to?(h.to?[a.to,\",\"+h.to].join(\"\"):a.to):h.to;\na.subject=h.subject||a.subject;\na.cc=h.cc||a.cc;\na.bcc=h.bcc||a.bcc;\na.body=h.body||a.body\n}}var b={action:ZmOperation.NEW_MESSAGE,toOverride:a.to,ccOverride:a.cc,bccOverride:a.bcc,subjOverride:a.subject,extraBodyText:a.body,extraBodyTextIsExternal:Boolean(a.body),callback:g};\nif(appCtxt.isOffline&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&appCtxt.getCurrentViewId()==ZmId.VIEW_COMPOSE){i.resetComposeForMailto(b)\n}else{i.doAction(b)\n}this._notifyRendered();\nreturn i\n};\nZmMailApp.prototype.getConvListController=function(b,a){return this.getSessionController({controllerClass:\"ZmConvListController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmMailApp.prototype.getConvController=function(a){return this.getSessionController({controllerClass:\"ZmConvController\",sessionId:a})\n};\nZmMailApp.prototype.getTradController=function(b,a){return this.getSessionController({controllerClass:\"ZmTradController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmMailApp.prototype.getMsgController=function(c){var b=this._sessionController[ZmId.VIEW_MSG];\nvar a;\nfor(var d in b){if(!b[d].isHidden&&b[d].getMsg()&&b[d].getMsg().nId==c){a=b[d];\nbreak\n}}if(a){c=a.getSessionId();\nthis._curSessionId[ZmId.VIEW_MSG]=c;\na.inactive=false;\nreturn a\n}return this.getSessionController({controllerClass:\"ZmMsgController\",sessionId:c})\n};\nZmMailApp.prototype.getComposeController=function(a){return this.getSessionController({controllerClass:\"ZmComposeController\",sessionId:a})\n};\nZmMailApp.prototype.getConfirmController=function(a){return this.getSessionController({controllerClass:\"ZmMailConfirmController\",sessionId:a})\n};\nZmMailApp.prototype.getMailListController=function(){var a=appCtxt.get(ZmSetting.GROUP_MAIL_BY);\nreturn(a==ZmSetting.GROUP_BY_CONV)?AjxDispatcher.run(\"GetConvListController\"):AjxDispatcher.run(\"GetTradController\")\n};\nZmMailApp.prototype.runRefresh=function(){this.getMailListController().runRefresh()\n};\nZmMailApp.prototype.compose=function(d){Dwt.setLoadingTime(\"ZmMailApp-compose\");\nd=d||{};\nif(!d.sessionId){var c=this._sessionController[ZmId.VIEW_COMPOSE];\nvar a;\nvar b=d.msg&&d.msg.nId;\nfor(var e in c){if(c[e].getMsg()&&c[e].getMsg().nId==b){a=c[e];\nbreak\n}}}if(!a){a=AjxDispatcher.run(\"GetComposeController\",d.sessionId)\n}appCtxt.composeCtlrSessionId=a.getSessionId();\na.doAction(d);\nDwt.setLoadedTime(\"ZmMailApp-compose\")\n};\nZmMailApp.prototype.setNewMailNotice=function(a){var c=appCtxt.getAppChooser();\nif(c){var d=c.getButton(ZmApp.MAIL);\nvar b=(a.numUnread>0)?\"EnvelopeOpen\":\"MailApp\";\nd.setImage(b)\n}if(a.id==ZmOrganizer.ID_INBOX){this._setFavIcon(a.numUnread)\n}this._setNewMailBadge()\n};\nZmMailApp.prototype._setNewMailBadge=function(){if(appCtxt.isOffline&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE)){if(AjxEnv.isMac&&window.platform){window.platform.icon().badgeText=(this.globalMailCount>0)?this.globalMailCount:null\n}else{if(AjxEnv.isWindows){window.platform.icon().imageSpec=(this.globalMailCount>0)?\"resource://webapp/icons/default/newmail.png\":\"resource://webapp/icons/default/launcher.ico\";\nwindow.platform.icon().title=(this.globalMailCount>0)?AjxMessageFormat.format(ZmMsg.unreadCount,this.globalMailCount):null\n}}}};\nZmMailApp.prototype.clearNewMailBadge=function(){this.globalMailCount=0;\nthis._setNewMailBadge()\n};\nZmMailApp.prototype._setFavIcon=function(a){var b;\nif(a==0){b=[appContextPath,\"/img/logo/favicon.ico\"].join(\"\")\n}else{if(a>9){b=[appContextPath,\"/img/logo/favicon_plus.ico\"].join(\"\")\n}else{b=[appContextPath,\"/img/logo/favicon_\",a,\".ico\"].join(\"\")\n}}Dwt.setFavIcon(b)\n};\nZmMailApp.prototype.getGroupMailBy=function(){var a=this._groupBy||appCtxt.get(ZmSetting.GROUP_MAIL_BY);\nreturn a?ZmMailApp.GROUP_MAIL_BY_ITEM[a]:ZmItem.MSG\n};\nZmMailApp.prototype.setGroupMailBy=function(a,b){this._groupBy=a;\nappCtxt.set(ZmSetting.GROUP_MAIL_BY,a,null,false,b)\n};\nZmMailApp.prototype.getLimit=function(b){var a=appCtxt.get(ZmSetting.PAGE_SIZE);\nreturn b?a:2*a\n};\nZmMailApp.addReplyMenu=function(a){var b=[ZmOperation.REPLY,ZmOperation.REPLY_ALL];\nvar c=new ZmActionMenu({parent:a,menuItems:b});\na.setMenu(c);\nreturn c\n};\nZmMailApp.addForwardMenu=function(a){var b=[ZmOperation.FORWARD_INLINE,ZmOperation.FORWARD_ATT];\nvar c=new ZmActionMenu({parent:a,menuItems:b});\na.setMenu(c);\nreturn c\n};\nZmMailApp.prototype.getDataSourceCollection=function(b){var c=window.parentAppCtxt||window.appCtxt;\nvar a=b?b.name:c.getActiveAccount().name;\nif(!this._dataSourceCollection[a]){this._dataSourceCollection[a]=new ZmDataSourceCollection();\nif(c.getActiveAccount().isMain){this._dataSourceCollection[a].initialize(c.getSettings().getInfoResponse.dataSources)\n}}return this._dataSourceCollection[a]\n};\nZmMailApp.prototype.getIdentityCollection=function(d){if(appCtxt.isChildWindow){if(!this._identityCollection){this._identityCollection=new ZmIdentityCollection()\n}return this._identityCollection\n}var b=d?d.name:appCtxt.getActiveAccount().name;\nif(!this._identityCollection[b]){var a=this._identityCollection[b]=new ZmIdentityCollection();\nvar c=appCtxt.getSettings(d);\nif(c){a.initialize(c.getInfoResponse.identities)\n}}return this._identityCollection[b]\n};\nZmMailApp.prototype.getSignatureCollection=function(c){var d=window.parentAppCtxt||window.appCtxt;\nc=c||d.getActiveAccount();\nvar a=c.name;\nvar b=d.getSettings(c);\nif(!this._signatureCollection[a]&&b){var e=this._signatureCollection[a]=new ZmSignatureCollection();\ne.initialize(b.getInfoResponse.signatures)\n}return this._signatureCollection[a]\n};\nZmMailApp.prototype._addSettingsChangeListeners=function(){ZmApp.prototype._addSettingsChangeListeners.call(this);\nif(!this._settingsListener){this._settingsListener=new AjxListener(this,this._settingsChangeListener)\n}var a=appCtxt.getSettings();\na.getSetting(ZmSetting.VIEW_AS_HTML).addChangeListener(this._settingListener);\na.getSetting(ZmSetting.TRUSTED_ADDR_LIST).addChangeListener(this._settingListener);\na.addChangeListener(this._settingsListener)\n};\nZmMailApp.prototype._settingChangeListener=function(c){ZmApp.prototype._settingChangeListener.call(this,c);\nif(c.type!=ZmEvent.S_SETTING){return\n}var b=c.source;\nvar e=this.getMailListController();\nif(e&&(b.id==ZmSetting.VIEW_AS_HTML||b.id==ZmSetting.TRUSTED_ADDR_LIST)){this.resetTrustedSendersList();\nvar a=e._doublePaneView;\nvar d=a?a.getMsg():null;\nif(d){a.reset();\na.setItem(d)\n}}};\nZmMailApp.prototype._settingsChangeListener=function(e){if(e.type!=ZmEvent.S_SETTINGS){return\n}var f=e.getDetail(\"settings\");\nif(!(f&&f.length)){return\n}var h=this.getMailListController();\nif(!h){return\n}var a=h.getCurrentViewType();\nvar g,d;\nfor(var b=0;\nb<f.length;\nb++){var c=f[b];\nif(c.id==ZmSetting.SHOW_FRAGMENTS){if(a!=ZmId.VIEW_MSG){g=d||a\n}}}g=d||g;\nif(g){h.switchView(g,true)\n}};\nZmMailApp.prototype.getTrustedSendersList=function(){if(!this._trustedList){var a=appCtxt.get(ZmSetting.TRUSTED_ADDR_LIST);\nif(a){this._trustedList=AjxVector.fromArray(a)\n}else{this._trustedList=new AjxVector()\n}}return this._trustedList\n};\nZmMailApp.prototype.resetTrustedSendersList=function(){this._trustedList=null\n};\nZmMailApp._handleOOORemindResponse=function(c,b){ZmMailApp._hideOOORemindDialog(c);\nvar a=document.getElementById(c._htmlElId+\"_dontRemind\");\nif(b||a.checked){ZmMailApp._saveRemindStatus(b,a.checked)\n}};\nZmMailApp._hideOOORemindDialog=function(a){if(a){a.popdown()\n}};\nZmMailApp._saveRemindStatus=function(a,b){var c=AjxSoapDoc.create(\"ModifyPrefsRequest\",\"urn:zimbraAccount\");\nif(a){var d=c.set(\"pref\",\"FALSE\");\nd.setAttribute(\"name\",\"zimbraPrefOutOfOfficeReplyEnabled\")\n}else{if(b){var d=c.set(\"pref\",\"FALSE\");\nd.setAttribute(\"name\",\"zimbraPrefOutOfOfficeStatusAlertOnLogin\")\n}}var e={soapDoc:c,asyncMode:true};\nif(a){e.callback=ZmMailApp._oooReplyCallback\n}appCtxt.getAppController().sendRequest(e)\n};\nZmMailApp._oooReplyCallback=function(){appCtxt.set(ZmSetting.VACATION_MSG_ENABLED,false)\n};\nZmMailApp.prototype._isOnVacation=function(){if(!appCtxt.get(ZmSetting.VACATION_MSG_ENABLED)){return false\n}var f=appCtxt.get(ZmSetting.VACATION_FROM);\nvar e=appCtxt.get(ZmSetting.VACATION_UNTIL);\nif(!f){return true\n}var b=new Date();\nvar d=new AjxDateFormat(\"yyyyMMddHHmmss'Z'\");\nvar c=d.parse(AjxDateUtil.dateGMT2Local(f));\nvar a=d.parse(AjxDateUtil.dateGMT2Local(e));\nreturn c<b&&b<a\n};\nZmMailApp.prototype._checkVacationReplyEnabled=function(){if(!appCtxt.get(ZmSetting.VACATION_MSG_REMIND_ON_LOGIN)){return\n}if(!this._isOnVacation()){return\n}var b=new DwtMessageDialog({parent:appCtxt.getShell(),buttons:[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],id:\"VacationDialog\"});\nvar c=AjxTemplate.expand(\"mail.Message#VacationRemindDialog\",{id:b._htmlElId});\nb.setTitle(ZmMsg.OOORemindDialogTitle);\nb.setContent(c);\nvar a=document.getElementById(b._htmlElId+\"_dontRemind\");\na.checked=false;\nb.registerCallback(DwtDialog.YES_BUTTON,ZmMailApp._handleOOORemindResponse,null,[b,true]);\nb.registerCallback(DwtDialog.NO_BUTTON,ZmMailApp._handleOOORemindResponse,null,[b,false]);\nb.popup()\n};\nZmMailApp.prototype._createVirtualFolders=function(){ZmOffline.addOutboxFolder()\n};\nZmMailApp.prototype.resetWebClientOfflineOperations=function(){ZmApp.prototype.resetWebClientOfflineOperations.apply(this);\nvar d=!appCtxt.isWebClientOffline();\nthis.refresh();\nvar b=appCtxt.getFolderTree().getByType(ZmOrganizer.FOLDER);\nvar f=this.getOverview();\nif(b&&f){for(var a=0;\na<b.length;\na++){var c=b[a];\nvar e=c&&f.getTreeItemById(c.id);\nif(!e){continue\n}if(d){e.setVisible(true)\n}else{if(c.id!=ZmFolder.ID_ROOT&&c.rid!=ZmFolder.ID_ROOT&&c.id!=ZmFolder.ID_OUTBOX&&c.webOfflineSyncDays===0){e.setVisible(false)\n}}}}};\nZmMailApp.prototype.enableMailPrefs=function(){AjxDispatcher.require(\"PreferencesCore\");\nthis._registerSettings();\nthis._registerOperations();\nthis._registerPrefs()\n};\nZmMailApp.FOLDERS_TO_OMIT=[ZmFolder.ID_TRASH,ZmFolder.ID_SPAM];\nZmMailApp.getFoldersToOmit=function(c){c=c||appCtxt.getCurrentSearch();\nvar b=ZmMailApp.FOLDERS_TO_OMIT,d=[],e=c&&c.folderId;\nvar f=c&&c.userInitiated;\nfor(var a=0;\na<b.length;\na++){if(!f&&b[a]!=e){d.push(b[a])\n}}return AjxUtil.arrayAsHash(d)\n};\nZmMailApp.getReplyFoldersToOmit=function(a){var b=ZmMailApp.getFoldersToOmit(a);\nb[ZmFolder.ID_DRAFTS]=true;\nreturn b\n}\n}if(AjxPackage.define(\"zimbraMail.calendar.ZmCalendarApp\")){ZmCalendarApp=function(b,a){ZmApp.call(this,ZmApp.CALENDAR,b,a);\nthis._addSettingsChangeListeners();\nthis._resByName={};\nthis._resByEmail={}\n};\nZmCalendarApp.prototype=new ZmApp;\nZmCalendarApp.prototype.constructor=ZmCalendarApp;\nZmCalendarApp.prototype.isZmCalendarApp=true;\nZmCalendarApp.prototype.toString=function(){return\"ZmCalendarApp\"\n};\nZmEvent.S_APPT=ZmId.ITEM_APPOINTMENT;\nZmEvent.S_RESOURCE=ZmId.ITEM_RESOURCE;\nZmItem.APPT=ZmEvent.S_APPT;\nZmItem.RESOURCE=ZmEvent.S_RESOURCE;\nZmOrganizer.CALENDAR=ZmId.ORG_CALENDAR;\nZmApp.CALENDAR=ZmId.APP_CALENDAR;\nZmApp.CLASS[ZmApp.CALENDAR]=\"ZmCalendarApp\";\nZmApp.SETTING[ZmApp.CALENDAR]=ZmSetting.CALENDAR_ENABLED;\nZmApp.UPSELL_SETTING[ZmApp.CALENDAR]=ZmSetting.CALENDAR_UPSELL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.CALENDAR]=40;\nZmApp.QS_ARG[ZmApp.CALENDAR]=\"calendar\";\nZmCalendarApp.REMINDER_START_DELAY=10000;\nZmCalendarApp.MINICAL_DELAY=5000;\nZmCalendarApp.VIEW_FOR_SETTING={};\nZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_DAY]=ZmId.VIEW_CAL_DAY;\nZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_WEEK]=ZmId.VIEW_CAL_WEEK;\nZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_WORK_WEEK]=ZmId.VIEW_CAL_WORK_WEEK;\nZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_MONTH]=ZmId.VIEW_CAL_MONTH;\nZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_LIST]=ZmId.VIEW_CAL_LIST;\nZmCalendarApp.COLORS=[];\nZmCalendarApp.COLORS[ZmOrganizer.C_ORANGE]=\"Orange\";\nZmCalendarApp.COLORS[ZmOrganizer.C_BLUE]=\"Blue\";\nZmCalendarApp.COLORS[ZmOrganizer.C_CYAN]=\"Cyan\";\nZmCalendarApp.COLORS[ZmOrganizer.C_GREEN]=\"Green\";\nZmCalendarApp.COLORS[ZmOrganizer.C_PURPLE]=\"Purple\";\nZmCalendarApp.COLORS[ZmOrganizer.C_RED]=\"Red\";\nZmCalendarApp.COLORS[ZmOrganizer.C_YELLOW]=\"Yellow\";\nZmCalendarApp.COLORS[ZmOrganizer.C_PINK]=\"Pink\";\nZmCalendarApp.COLORS[ZmOrganizer.C_GRAY]=\"Gray\";\nZmCalendarApp.CUTYPE_INDIVIDUAL=\"IND\";\nZmCalendarApp.CUTYPE_GROUP=\"GRO\";\nZmCalendarApp.CUTYPE_RESOURCE=\"RES\";\nZmCalendarApp.CUTYPE_ROOM=\"ROO\";\nZmCalendarApp.CUTYPE_UNKNOWN=\"UNK\";\nZmCalendarApp.STATUS_CANC=\"CANC\";\nZmCalendarApp.STATUS_COMP=\"COMP\";\nZmCalendarApp.STATUS_CONF=\"CONF\";\nZmCalendarApp.STATUS_DEFR=\"DEFERRED\";\nZmCalendarApp.STATUS_INPR=\"INPR\";\nZmCalendarApp.STATUS_NEED=\"NEED\";\nZmCalendarApp.STATUS_TENT=\"TENT\";\nZmCalendarApp.STATUS_WAIT=\"WAITING\";\nZmCalendarApp.METHOD_CANCEL=\"CANCEL\";\nZmCalendarApp.METHOD_PUBLISH=\"PUBLISH\";\nZmCalendarApp.METHOD_REPLY=\"REPLY\";\nZmCalendarApp.METHOD_REQUEST=\"REQUEST\";\nZmCalendarApp.METHOD_COUNTER=\"COUNTER\";\nZmCalendarApp.DEFAULT_WORKING_HOURS=\"1:N:0800:1700,2:Y:0800:1700,3:Y:0800:1700,4:Y:0800:1700,5:Y:0800:1700,6:Y:0800:1700,7:N:0800:1700\";\nZmCalendarApp.DEFAULT_APPT_DURATION=\"60\";\nZmCalendarApp.reminderTimeWarningDisplayMsgs=[ZmMsg.apptRemindNever,ZmMsg.apptRemindAtEventTime,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNWeeksBefore,ZmMsg.apptRemindNWeeksBefore];\nZmCalendarApp.reminderTimeWarningValues=[-1,0,1,5,10,15,30,45,60,120,180,240,300,1080,1440,2880,4320,5760,10080,20160];\nZmCalendarApp.reminderTimeWarningLabels=[-1,0,1,5,10,15,30,45,60,2,3,4,5,18,1,2,3,4,1,2];\nZmCalendarApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"CalendarCore\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.setPackageLoadFunction(\"Calendar\",new AjxCallback(this,this._postLoad,ZmOrganizer.CALENDAR));\nAjxDispatcher.registerMethod(\"GetCalController\",[\"MailCore\",\"CalendarCore\"],new AjxCallback(this,this.getCalController));\nAjxDispatcher.registerMethod(\"GetReminderController\",[\"MailCore\",\"CalendarCore\"],new AjxCallback(this,this.getReminderController));\nAjxDispatcher.registerMethod(\"ShowMiniCalendar\",[\"MailCore\",\"CalendarCore\"],new AjxCallback(this,this.showMiniCalendar));\nAjxDispatcher.registerMethod(\"GetApptComposeController\",[\"MailCore\",\"CalendarCore\",\"Calendar\",\"CalendarAppt\"],new AjxCallback(this,this.getApptComposeController))\n};\nZmCalendarApp.prototype._registerSettings=function(a){var a=a||appCtxt.getSettings();\na.registerSetting(\"CAL_ALWAYS_SHOW_MINI_CAL\",{name:\"zimbraPrefCalendarAlwaysShowMiniCal\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_APPT_VISIBILITY\",{name:\"zimbraPrefCalendarApptVisibility\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"public\",isGlobal:true});\na.registerSetting(\"CAL_EMAIL_REMINDERS_ADDRESS\",{name:\"zimbraPrefCalendarReminderEmail\",type:ZmSetting.T_PREF});\na.registerSetting(\"CAL_DEVICE_EMAIL_REMINDERS_ADDRESS\",{name:\"zimbraCalendarReminderDeviceEmail\",type:ZmSetting.T_PREF});\na.registerSetting(\"CAL_DEVICE_EMAIL_REMINDERS_ENABLED\",{name:\"zimbraFeatureCalendarReminderDeviceEmailEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"CAL_EXPORT\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE});\na.registerSetting(\"CAL_FIRST_DAY_OF_WEEK\",{name:\"zimbraPrefCalendarFirstDayOfWeek\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0,isGlobal:true});\na.registerSetting(\"CAL_FREE_BUSY_ACL\",{type:ZmSetting.T_PREF,defaultValue:ZmSetting.ACL_ALL});\na.registerSetting(\"CAL_FREE_BUSY_ACL_USERS\",{type:ZmSetting.T_PREF});\na.registerSetting(\"CAL_IMPORT\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE});\na.registerSetting(\"CAL_INVITE_ACL\",{type:ZmSetting.T_PREF,defaultValue:ZmSetting.ACL_ALL});\na.registerSetting(\"CAL_INVITE_ACL_USERS\",{type:ZmSetting.T_PREF});\na.registerSetting(\"CAL_REMINDER_NOTIFY_SOUNDS\",{name:\"zimbraPrefCalendarReminderSoundsEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_REMINDER_NOTIFY_BROWSER\",{name:\"zimbraPrefCalendarReminderFlashTitle\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_REMINDER_NOTIFY_TOASTER\",{name:\"zimbraPrefCalendarToasterEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_REMINDER_WARNING_TIME\",{name:\"zimbraPrefCalendarApptReminderWarningTime\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0,isGlobal:true});\na.registerSetting(\"CAL_SHOW_DECLINED_MEETINGS\",{name:\"zimbraPrefCalendarShowDeclinedMeetings\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"CAL_SHOW_TIMEZONE\",{name:\"zimbraPrefUseTimeZoneListInCalendar\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_USE_QUICK_ADD\",{name:\"zimbraPrefCalendarUseQuickAdd\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CALENDAR_INITIAL_VIEW\",{name:\"zimbraPrefCalendarInitialView\",type:ZmSetting.T_PREF,defaultValue:ZmSetting.CAL_DAY,isGlobal:true});\na.registerSetting(\"CAL_WORKING_HOURS\",{name:\"zimbraPrefCalendarWorkingHours\",type:ZmSetting.T_PREF,defaultValue:ZmCalendarApp.DEFAULT_WORKING_HOURS,isGlobal:true});\na.registerSetting(\"FREE_BUSY_VIEW_ENABLED\",{name:\"zimbraFeatureFreeBusyViewEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"DELETE_INVITE_ON_REPLY\",{name:\"zimbraPrefDeleteInviteOnReply\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"ENABLE_APPL_ICAL_DELEGATION\",{name:\"zimbraPrefAppleIcalDelegationEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_AUTO_ADD_INVITES\",{name:\"zimbraPrefCalendarAutoAddInvites\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"CAL_SEND_INV_DENIED_REPLY\",{name:\"zimbraPrefCalendarSendInviteDeniedAutoReply\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"CAL_INV_FORWARDING_ADDRESS\",{name:\"zimbraPrefCalendarForwardInvitesTo\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST,isGlobal:true});\na.registerSetting(\"CAL_SHOW_PAST_DUE_REMINDERS\",{name:\"zimbraPrefCalendarShowPastDueReminders\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_SHOW_CALENDAR_WEEK\",{name:\"zimbraPrefShowCalendarWeek\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_APPT_ALLOW_ATTENDEE_EDIT\",{name:\"zimbraPrefCalendarApptAllowAtendeeEdit\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_RESOURCE_DBL_BOOKING_ALLOWED\",{name:\"zimbraCalendarResourceDoubleBookingAllowed\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_SHOW_RESOURCE_TABS\",{name:\"zimbraCalendarShowResourceTabs\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true});\na.registerSetting(\"CAL_DEFAULT_APPT_DURATION\",{name:\"zimbraPrefCalendarDefaultApptDuration\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LDAP_TIME,defaultValue:ZmCalendarApp.DEFAULT_APPT_DURATION,isGlobal:true});\na.registerSetting(\"CAL_EXCEPTION_ON_SERIES_TIME_CHANGE\",{name:\"zimbraCalendarKeepExceptionsOnSeriesTimeChange\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_LOCATION_FIELDS_DISABLED\",{name:\"zimbraCalendarLocationDisabledFields\",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING,defaultValue:false,isGlobal:true});\na.registerSetting(\"CAL_DEFAULT_ID\",{name:\"zimbraPrefDefaultCalendarId\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"10\"});\na.registerSetting(\"CAL_SCALING\",{name:\"zimbraPrefCalenderScaling\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"30\"})\n};\nZmCalendarApp.prototype._registerPrefs=function(){var d={CALENDAR:{title:ZmMsg.calendar,icon:\"CalendarApp\",templateId:\"prefs.Pages#Calendar\",priority:80,precondition:ZmSetting.CALENDAR_ENABLED,prefs:[ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL,ZmSetting.CAL_AUTO_ADD_INVITES,ZmSetting.CAL_SEND_INV_DENIED_REPLY,ZmSetting.CAL_APPT_VISIBILITY,ZmSetting.CAL_EXPORT,ZmSetting.CAL_FIRST_DAY_OF_WEEK,ZmSetting.CAL_IMPORT,ZmSetting.CAL_REMINDER_WARNING_TIME,ZmSetting.CAL_REMINDER_NOTIFY_SOUNDS,ZmSetting.CAL_REMINDER_NOTIFY_BROWSER,ZmSetting.CAL_SHOW_DECLINED_MEETINGS,ZmSetting.CAL_DEFAULT_ID,ZmSetting.CAL_SHOW_TIMEZONE,ZmSetting.CAL_USE_QUICK_ADD,ZmSetting.CALENDAR_INITIAL_VIEW,ZmSetting.CAL_WORKING_HOURS,ZmSetting.DELETE_INVITE_ON_REPLY,ZmSetting.ENABLE_APPL_ICAL_DELEGATION,ZmSetting.CAL_FREE_BUSY_ACL,ZmSetting.CAL_FREE_BUSY_ACL_USERS,ZmSetting.CAL_INVITE_ACL,ZmSetting.CAL_INVITE_ACL_USERS,ZmSetting.CAL_REMINDER_NOTIFY_TOASTER,ZmSetting.CAL_INV_FORWARDING_ADDRESS,ZmSetting.CAL_SHOW_PAST_DUE_REMINDERS,ZmSetting.CAL_SHOW_CALENDAR_WEEK,ZmSetting.CAL_DEFAULT_APPT_DURATION,ZmSetting.CAL_LOCATION_FIELDS_DISABLED],manageDirty:true,createView:function(f,g,e){AjxDispatcher.require(\"Alert\");\nreturn new ZmCalendarPrefsPage(f,g,e)\n}}};\nfor(var c in d){ZmPref.registerPrefSection(c,d[c])\n}ZmPref.registerPref(\"CAL_ALWAYS_SHOW_MINI_CAL\",{displayName:ZmMsg.alwaysShowMiniCal,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_WORKING_HOURS\",{displayContainer:ZmPref.TYPE_CUSTOM});\nZmPref.registerPref(\"CAL_AUTO_ADD_INVITES\",{displayName:ZmMsg.autoAddInvites,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_SEND_INV_DENIED_REPLY\",{displayName:ZmMsg.sendInvDeniedAutoReply,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_EMAIL_REMINDERS_ADDRESS\",{displayName:ZmMsg.emailNotificationsDescription,displayContainer:ZmPref.TYPE_INPUT,errorMessage:ZmMsg.invalidEmail,hint:ZmMsg.enterEmailAddress});\nZmPref.registerPref(\"CAL_DEVICE_EMAIL_REMINDERS_ADDRESS\",{displayName:ZmMsg.deviceEmailNotificationsDescription,displayContainer:ZmPref.TYPE_INPUT,errorMessage:ZmMsg.invalidEmail,hint:ZmMsg.enterEmailAddress});\nZmPref.registerPref(\"CAL_EXPORT\",{displayName:ZmMsg.exportToICS,displayContainer:ZmPref.TYPE_EXPORT});\nZmPref.registerPref(\"CAL_FIRST_DAY_OF_WEEK\",{displayName:ZmMsg.calendarFirstDayOfWeek,displayContainer:ZmPref.TYPE_SELECT,displayOptions:AjxDateUtil.WEEKDAY_LONG,options:[0,1,2,3,4,5,6]});\nZmPref.registerPref(\"CAL_FREE_BUSY_ACL\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.freeBusyAllowAll,ZmMsg.freeBusyAllowLocal,ZmMsg.freeBusyAllowDomain,ZmMsg.freeBusyAllowNone,ZmMsg.freeBusyAllowSome],options:[ZmSetting.ACL_PUBLIC,ZmSetting.ACL_AUTH,ZmSetting.ACL_DOMAIN,ZmSetting.ACL_NONE,ZmSetting.ACL_USER]});\nZmPref.registerPref(\"CAL_FREE_BUSY_ACL_USERS\",{displayContainer:ZmPref.TYPE_TEXTAREA,hint:ZmMsg.enterEmailAddresses});\nZmPref.registerPref(\"CAL_IMPORT\",{displayName:ZmMsg.importFromICS,displayContainer:ZmPref.TYPE_IMPORT});\nZmPref.registerPref(\"CAL_INVITE_ACL\",{displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.invitesAllowAll,ZmMsg.invitesAllowLocal,ZmMsg.invitesAllowNone,ZmMsg.invitesAllowSome],options:[ZmSetting.ACL_PUBLIC,ZmSetting.ACL_AUTH,ZmSetting.ACL_NONE,ZmSetting.ACL_USER]});\nZmPref.registerPref(\"CAL_INVITE_ACL_USERS\",{displayContainer:ZmPref.TYPE_TEXTAREA,hint:ZmMsg.enterEmailAddresses});\nZmPref.registerPref(\"CAL_REMINDER_WARNING_TIME\",{displayName:ZmMsg.numberOfMinutes,displayContainer:ZmPref.TYPE_SELECT,displayOptions:ZmCalendarApp.getReminderTimeWarningDisplayOptions(),options:ZmCalendarApp.reminderTimeWarningValues,setFunction:ZmCalendarApp.setDefaultReminderTimePrefValueOnSave,loadFunction:ZmCalendarApp.postLoadSetDefaultReminderValue});\nZmPref.registerPref(\"CAL_SHOW_DECLINED_MEETINGS\",{displayName:ZmMsg.showDeclinedMeetings,displayContainer:ZmPref.TYPE_CHECKBOX});\nvar a=ZmCalendarApp.getDefaultCalendarFolders();\nZmPref.registerPref(\"CAL_DEFAULT_ID\",{displayName:ZmMsg.defaultCalendar,displayContainer:ZmPref.TYPE_SELECT,displayOptions:a.displayOptions,options:a.options});\nZmPref.registerPref(\"CAL_SHOW_TIMEZONE\",{displayName:ZmMsg.shouldShowTimezone,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_USE_QUICK_ADD\",{displayName:ZmMsg.useQuickAdd,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CALENDAR_INITIAL_VIEW\",{displayName:ZmMsg.calendarInitialView,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.calViewDay,ZmMsg.calViewWorkWeek,ZmMsg.calViewWeek,ZmMsg.calViewMonth,ZmMsg.calViewList],options:[ZmSetting.CAL_DAY,ZmSetting.CAL_WORK_WEEK,ZmSetting.CAL_WEEK,ZmSetting.CAL_MONTH,ZmSetting.CAL_LIST]});\nZmPref.registerPref(\"CAL_REMINDER_NOTIFY_SOUNDS\",{displayName:ZmMsg.playSound,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_REMINDER_NOTIFY_BROWSER\",{displayName:ZmMsg.flashBrowser,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"DELETE_INVITE_ON_REPLY\",{displayName:ZmMsg.deleteInviteOnReply,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"ENABLE_APPL_ICAL_DELEGATION\",{displayName:ZmMsg.enableAppleICalDelegation,displayContainer:ZmPref.TYPE_CHECKBOX});\nAjxDispatcher.require(\"Alert\");\nvar b=ZmDesktopAlert.getInstance().getDisplayText();\nZmPref.registerPref(\"CAL_REMINDER_NOTIFY_TOASTER\",{displayFunc:function(){return b\n},precondition:!!b,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_APPT_VISIBILITY\",{displayName:ZmMsg.calendarInitialApptVisibility,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg._public,ZmMsg._private],options:[ZmSetting.CAL_VISIBILITY_PUB,ZmSetting.CAL_VISIBILITY_PRIV]});\nZmPref.registerPref(\"CAL_INV_FORWARDING_ADDRESS\",{displayName:ZmMsg.inviteForwardingAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmailList,valueFunction:ZmPref.string2EmailList,errorMessage:ZmMsg.invalidEmail,hint:ZmMsg.enterEmailAddress});\nZmPref.registerPref(\"CAL_SHOW_PAST_DUE_REMINDERS\",{displayName:ZmMsg.apptPastDueReminderLabel,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_SHOW_CALENDAR_WEEK\",{displayName:ZmMsg.showWeekNumber,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"CAL_DEFAULT_APPT_DURATION\",{displayName:ZmMsg.defaultApptDuration,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[\"30\",\"60\",\"90\",\"120\"],options:[\"1800\",\"3600\",\"5400\",\"7200\"]})\n};\nZmCalendarApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_CAL_LIST_VIEW,{textKey:\"list\",tooltipKey:\"viewCalListTooltip\",image:\"CalListView\",shortcut:ZmKeyMap.CAL_LIST_VIEW});\nZmOperation.registerOp(ZmId.OP_CAL_REFRESH,{textKey:\"refresh\",tooltipKey:\"calRefreshTooltip\",image:\"Refresh\",shortcut:ZmKeyMap.REFRESH,showImageInToolbar:true});\nZmOperation.registerOp(ZmId.OP_CAL_VIEW_MENU,{textKey:\"view\",image:\"Appointment\"},null,AjxCallback.simpleClosure(function(a){ZmOperation.addDeferredMenu(ZmCalendarApp.addCalViewMenu,a)\n}));\nZmOperation.registerOp(ZmId.OP_DAY_VIEW,{textKey:\"viewDay\",tooltipKey:\"viewDayTooltip\",image:\"DayView\",shortcut:ZmKeyMap.CAL_DAY_VIEW});\nZmOperation.registerOp(ZmId.OP_EDIT_REPLY_ACCEPT,{textKey:\"replyAccept\",image:\"Check\"});\nZmOperation.registerOp(ZmId.OP_EDIT_REPLY_CANCEL);\nZmOperation.registerOp(ZmId.OP_EDIT_REPLY_TENTATIVE,{textKey:\"replyTentative\",image:\"QuestionMark\"});\nZmOperation.registerOp(ZmId.OP_EDIT_REPLY_DECLINE,{textKey:\"replyDecline\",image:\"Cancel\"});\nZmOperation.registerOp(ZmId.OP_INVITE_REPLY_ACCEPT,{textKey:\"editReply\",image:\"Check\"});\nZmOperation.registerOp(ZmId.OP_INVITE_REPLY_DECLINE,{textKey:\"editReply\",image:\"Cancel\"});\nZmOperation.registerOp(ZmId.OP_INVITE_REPLY_MENU,{textKey:\"editReply\",image:\"Reply\"},ZmSetting.MAIL_ENABLED,AjxCallback.simpleClosure(function(a){ZmOperation.addDeferredMenu(ZmCalendarApp.addInviteReplyMenu,a)\n}));\nZmOperation.registerOp(ZmId.OP_INVITE_REPLY_TENTATIVE,{textKey:\"editReply\",image:\"QuestionMark\"});\nZmOperation.registerOp(ZmId.OP_MONTH_VIEW,{textKey:\"viewMonth\",tooltipKey:\"viewMonthTooltip\",image:\"MonthView\",shortcut:ZmKeyMap.CAL_MONTH_VIEW});\nZmOperation.registerOp(ZmId.OP_MOUNT_CALENDAR,{textKey:\"mountCalendar\",image:\"GroupSchedule\"});\nZmOperation.registerOp(ZmId.OP_NEW_ALLDAY_APPT,{textKey:\"newAllDayAppt\",tooltipKey:\"newAllDayApptTooltip\",image:\"NewAppointment\"});\nZmOperation.registerOp(ZmId.OP_NEW_APPT,{textKey:\"newAppt\",tooltipKey:\"newApptTooltip\",image:\"NewAppointment\",shortcut:ZmKeyMap.NEW_APPT});\nZmOperation.registerOp(ZmId.OP_NEW_CALENDAR,{textKey:\"newCalendar\",image:\"NewAppointment\",tooltipKey:\"newCalendarTooltip\",shortcut:ZmKeyMap.NEW_CALENDAR});\nZmOperation.registerOp(ZmId.OP_ADD_EXTERNAL_CALENDAR,{textKey:\"addExternalCalendar\",image:\"NewAppointment\",tooltipKey:\"addExternalCalendarTooltip\",shortcut:ZmKeyMap.ADD_EXTERNAL_CALENDAR});\nZmOperation.registerOp(ZmId.OP_PRINT_CALENDAR,{textKey:\"print\",tooltipKey:\"printTooltip\",image:\"Print\",shortcut:ZmKeyMap.PRINT,textPrecedence:30,showImageInToolbar:true},ZmSetting.PRINT_ENABLED);\nZmOperation.registerOp(ZmId.OP_PROPOSE_NEW_TIME,{textKey:\"proposeNewTime\",image:\"ProposeTime\",showTextInToolbar:true,showImageInToolbar:true});\nZmOperation.registerOp(ZmId.OP_REINVITE_ATTENDEES,{textKey:\"reinviteAttendees\",image:\"MeetingRequest\"});\nZmOperation.registerOp(ZmId.OP_FB_VIEW,{textKey:\"viewFB\",tooltipKey:\"viewFBTooltip\",image:\"GroupSchedule\",shortcut:ZmKeyMap.CAL_FB_VIEW});\nZmOperation.registerOp(ZmId.OP_SEARCH_MAIL,{textKey:\"searchMail\",image:\"SearchMail\"},ZmSetting.MAIL_ENABLED);\nZmOperation.registerOp(ZmId.OP_SHARE_CALENDAR,{textKey:\"shareCalendar\",image:\"CalendarFolder\"});\nZmOperation.registerOp(ZmId.OP_TODAY,{textKey:\"today\",tooltipKey:\"todayTooltip\",image:\"Date\",shortcut:ZmKeyMap.TODAY});\nZmOperation.registerOp(ZmId.OP_VIEW_APPOINTMENT,{textKey:\"viewAppointment\",image:\"Appointment\"});\nZmOperation.registerOp(ZmId.OP_OPEN_APPT_INSTANCE,{textKey:\"openApptInstance\",image:\"Appointment\"});\nZmOperation.registerOp(ZmId.OP_OPEN_APPT_SERIES,{textKey:\"openApptSeries\",image:\"Appointment\"});\nZmOperation.registerOp(ZmId.OP_DELETE_APPT_INSTANCE,{textKey:\"deleteApptInstance\",image:\"Delete\"});\nZmOperation.registerOp(ZmId.OP_DELETE_APPT_SERIES,{textKey:\"deleteApptSeries\",image:\"Delete\"});\nZmOperation.registerOp(ZmId.OP_VIEW_APPT_INSTANCE,{textKey:\"apptInstance\",image:\"Appointment\"});\nZmOperation.registerOp(ZmId.OP_VIEW_APPT_SERIES,{textKey:\"apptSeries\",image:\"Appointment\"});\nZmOperation.registerOp(ZmId.OP_WEEK_VIEW,{textKey:\"viewWeek\",tooltipKey:\"viewWeekTooltip\",image:\"WeekView\",shortcut:ZmKeyMap.CAL_WEEK_VIEW});\nZmOperation.registerOp(ZmId.OP_WORK_WEEK_VIEW,{textKey:\"viewWorkWeek\",tooltipKey:\"viewWorkWeekTooltip\",image:\"WorkWeekView\",shortcut:ZmKeyMap.CAL_WORK_WEEK_VIEW});\nZmOperation.registerOp(ZmId.OP_FORWARD_APPT,{textKey:\"forward\",tooltipKey:\"forward\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_FORWARD_APPT_INSTANCE,{textKey:\"forwardInstance\",tooltipKey:\"forwardInstance\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_FORWARD_APPT_SERIES,{textKey:\"forwardSeries\",tooltipKey:\"forwardSeries\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_DUPLICATE_APPT,{textKey:\"createCopy\",tooltipKey:\"createCopy\",image:\"Copy\"});\nZmOperation.registerOp(ZmId.OP_INVITE_ATTENDEES,{textKey:\"inviteAttendees\",tooltipKey:\"inviteAttendees\",image:\"Group\"});\nZmOperation.registerOp(ZmId.OP_SEND_INVITE,{textKey:\"send\",tooltipKey:\"sendInvites\",image:\"MeetingRequest\"})\n};\nZmCalendarApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.APPT,{app:ZmApp.CALENDAR,nameKey:\"appointment\",icon:\"Appointment\",soapCmd:\"ItemAction\",itemClass:\"ZmAppt\",node:\"appt\",organizer:ZmOrganizer.CALENDAR,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.CALENDAR],searchType:\"appointment\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require([\"MailCore\",\"CalendarCore\"]);\nreturn new ZmApptList(ZmItem.APPT,a)\n},this)});\nZmItem.registerItem(ZmItem.RESOURCE,{app:ZmApp.CALENDAR,itemClass:\"ZmResource\",node:\"calResource\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require([\"MailCore\",\"CalendarCore\"]);\nreturn new ZmResourceList(null,a)\n},this)})\n};\nZmCalendarApp.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.CALENDAR,{app:ZmApp.CALENDAR,nameKey:\"calendar\",defaultFolder:ZmOrganizer.ID_CALENDAR,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmCalendar\",orgPackage:\"CalendarCore\",treeController:\"ZmCalendarTreeController\",labelKey:\"calendars\",itemsKey:\"appointments\",hasColor:true,defaultColor:ZmOrganizer.C_BLUE,treeType:ZmOrganizer.FOLDER,views:[\"appointment\"],folderKey:\"calendar\",mountKey:\"mountCalendar\",createFunc:\"ZmCalendar.create\",compareFunc:\"ZmFolder.sortCompareNonMail\",newOp:ZmOperation.NEW_CALENDAR,displayOrder:100,deferrable:true,childWindow:true})\n};\nZmCalendarApp.prototype._setupSearchToolbar=function(){var a={msgKey:\"appointments\",tooltipKey:\"searchAppts\",icon:\"Appointment\",shareIcon:\"SharedCalendarFolder\",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_APPOINTMENT)};\nif(!appCtxt.isOffline){a.setting=ZmSetting.CALENDAR_ENABLED\n}ZmSearchToolBar.addMenuItem(ZmItem.APPT,a)\n};\nZmCalendarApp.prototype._registerApp=function(){var c={};\nc[ZmOperation.NEW_APPT]=\"appointment\";\nvar b={};\nb[ZmOperation.NEW_CALENDAR]=\"calendar\";\nvar a={};\na[ZmKeyMap.NEW_APPT]=ZmOperation.NEW_APPT;\na[ZmKeyMap.NEW_CALENDAR]=ZmOperation.NEW_CALENDAR;\na[ZmKeyMap.ADD_EXTERNAL_CALENDAR]=ZmOperation.ADD_EXTERNAL_CALENDAR;\nZmApp.registerApp(ZmApp.CALENDAR,{mainPkg:\"Calendar\",nameKey:\"calendar\",icon:\"CalendarApp\",textPrecedence:60,chooserTooltipKey:\"goToCalendar\",viewTooltipKey:\"displayCalendar\",defaultSearch:ZmItem.APPT,organizer:ZmOrganizer.CALENDAR,overviewTrees:[ZmOrganizer.CALENDAR,ZmOrganizer.SEARCH,ZmOrganizer.TAG],newItemOps:c,newOrgOps:b,actionCodes:a,searchTypes:[ZmItem.APPT],gotoActionCode:ZmKeyMap.GOTO_CALENDAR,newActionCode:ZmKeyMap.NEW_APPT,chooserSort:30,defaultSort:20,upsellUrl:ZmSetting.CALENDAR_UPSELL_URL,searchResultsTab:true})\n};\nZmCalendarApp.prototype._getRefreshButtonTooltip=function(){return ZmMsg.showAllEventsFromSelectedCalendars\n};\nZmCalendarApp.prototype.startup=function(a){};\nZmCalendarApp.prototype.refresh=function(a){if(!appCtxt.inStartup){this.resetOverview(this.getOverviewId());\nAjxDispatcher.run(\"GetCalController\").refreshHandler(a)\n}};\nZmCalendarApp.prototype.runRefresh=function(){appCtxt.getCalManager().getCalViewController().runRefresh()\n};\nZmCalendarApp.prototype.deleteNotify=function(a,b){if(!b&&this._deferNotifications(\"delete\",a)){return\n}AjxDispatcher.run(\"GetCalController\").notifyDelete(a)\n};\nZmCalendarApp.prototype.createNotify=function(e,g){if(!e.folder&&!e.appt&&!e.link){return\n}if(!g&&!this._noDefer&&this._deferNotifications(\"create\",e)){return\n}var a=AjxDispatcher.run(\"GetCalController\");\nfor(var b in e){var f=e[b];\nfor(var d=0;\nd<f.length;\nd++){var c=f[d];\nif(appCtxt.cacheGet(c.id)){continue\n}if(b==\"folder\"){this._handleCreateFolder(c,ZmOrganizer.CALENDAR)\n}else{if(b==\"link\"){this._handleCreateLink(c,ZmOrganizer.CALENDAR)\n}else{if(b==\"appt\"){a.notifyCreate(c)\n}}}if((b==\"folder\"||b==\"link\")&&a){a._updateCheckedCalendars()\n}}}};\nZmCalendarApp.prototype.modifyNotify=function(b,a){if(!a&&!this._noDefer&&this._deferNotifications(\"modify\",b)){return\n}AjxDispatcher.run(\"GetCalController\").notifyModify(b)\n};\nZmCalendarApp.prototype.preNotify=function(b){var a=AjxDispatcher.run(\"GetCalController\");\nif(a){a.preNotify(b)\n}};\nZmCalendarApp.prototype.postNotify=function(b){var a=AjxDispatcher.run(\"GetCalController\");\nif(a){a.postNotify(b)\n}};\nZmCalendarApp.prototype.handleOp=function(b){if(!appCtxt.isWebClientOffline()){switch(b){case ZmOperation.NEW_APPT:var a=new AjxCallback(this,this._handleLoadNewAppt);\nAjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\"],false,a,null,true);\nbreak;\ncase ZmOperation.NEW_CALENDAR:var a=new AjxCallback(this,this._handleLoadNewCalendar);\nAjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\"],false,a,null,true);\nbreak;\ncase ZmOperation.ADD_EXTERNAL_CALENDAR:var a=new AjxCallback(this,this._handleLoadExternalCalendar);\nAjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\"],false,a,null,true);\nbreak\n}}};\nZmCalendarApp.prototype._handleLoadNewAppt=function(){Dwt.setLoadingTime(\"ZmCalendarApp-newAppt\");\nAjxDispatcher.run(\"GetCalController\").newAppointment(null,null,null,null);\nDwt.setLoadedTime(\"ZmCalendarApp-newAppt\")\n};\nZmCalendarApp.prototype._handleLoadNewCalendar=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nvar a=appCtxt.getNewCalendarDialog();\nif(!this._newCalendarCb){this._newCalendarCb=new AjxCallback(this,this._newCalendarCallback)\n}ZmController.showDialog(a,this._newCalendarCb)\n};\nZmCalendarApp.prototype._handleLoadExternalCalendar=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nvar b=appCtxt.getOverviewController();\nvar a=b.getTreeController(ZmOrganizer.CALENDAR);\nif(a){a._addExternalCalendarListener()\n}};\nZmCalendarApp.prototype.launch=function(b,c){this._setLaunchTime(this.toString(),new Date());\nvar a=new AjxCallback(this,this._handleLoadLaunch,[b,c]);\nAjxDispatcher.require([\"MailCore\",\"ContactsCore\",\"CalendarCore\",\"Calendar\"],true,a,null,true)\n};\nZmCalendarApp.prototype._handleLoadLaunch=function(f,h){var g=AjxDispatcher.run(\"GetCalController\");\nvar b=g.getDefaultViewType();\nvar e=null;\nf=f||{};\nif(f.qsParams){var d=f.qsParams.view;\nif(d){var a=ZmCalendarApp.VIEW_FOR_SETTING[d];\nif(a){b=a;\nvar c=f.qsParams.date;\nif(c){c=AjxDateUtil.parseServerDateTime(c);\nif(c&&!isNaN(c)){e=new Date((c).setHours(0,0,0,0))\n}}}}}if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){this.initResources()\n}ZmCalendarApp.postLoadSetDefaultReminderValue();\ng.show(b,e);\nthis._setLoadedTime(this.toString(),new Date());\nif(h){h.run()\n}this._setRefreshButtonTooltip()\n};\nZmCalendarApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newAppt,tooltip:ZmMsg.createNewAppt,icon:\"NewAppointment\",iconDis:\"NewAppointmentDis\",defaultId:ZmOperation.NEW_APPT,disabled:!this.containsWritableFolder()}\n};\nZmCalendarApp.prototype.showSearchResults=function(a,b){if(b){b.run(AjxDispatcher.run(\"GetCalController\"))\n}};\nZmCalendarApp.prototype.activate=function(d,a){this._createDeferredFolders(ZmApp.CALENDAR);\nZmApp.prototype.activate.apply(this,arguments);\nif(appCtxt.get(ZmSetting.CALENDAR_ENABLED)){var c=appCtxt.getAppViewMgr();\nvar b=(d||appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL))&&!c.isHidden(ZmAppViewMgr.C_TREE_FOOTER,a);\nAjxDispatcher.run(\"ShowMiniCalendar\",b)\n}};\nZmCalendarApp.prototype.resetWebClientOfflineOperations=function(){ZmApp.prototype.resetWebClientOfflineOperations.apply(this);\nvar a=this.getCalController();\nif(a){a._resetToolbarOperations();\na._clearViewActionMenu()\n}};\nZmCalendarApp.prototype.showMiniCalendar=function(a,b){var c=AjxDispatcher.run(\"GetCalController\").getMiniCalendar(b);\nc.setSkipNotifyOnPage(a&&!this._active);\nif(!this._active){c.setSelectionMode(DwtCalendar.DAY)\n}appCtxt.getAppViewMgr().displayComponent(ZmAppViewMgr.C_TREE_FOOTER,a)\n};\nZmCalendarApp.prototype.getListController=function(){return AjxDispatcher.run(\"GetCalController\")\n};\nZmCalendarApp.prototype.getCalController=function(b,a){AjxDispatcher.require([\"Startup2\",\"MailCore\",\"CalendarCore\"]);\nreturn this.getSessionController({controllerClass:\"ZmCalViewController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmCalendarApp.prototype.getFreeBusyCache=function(){if(!this._freeBusyCache){AjxDispatcher.require([\"MailCore\",\"CalendarCore\"]);\nthis._freeBusyCache=new ZmFreeBusyCache(this)\n}return this._freeBusyCache\n};\nZmCalendarApp.prototype.getReminderController=function(){if(!this._reminderController){AjxDispatcher.require([\"MailCore\",\"CalendarCore\"]);\nvar a=appCtxt.getCalManager();\nthis._reminderController=a.getReminderController();\nthis._reminderController._calController=AjxDispatcher.run(\"GetCalController\")\n}return this._reminderController\n};\nZmCalendarApp.prototype.getApptComposeController=function(a){AjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\",\"CalendarAppt\"]);\nreturn this.getSessionController({controllerClass:\"ZmApptComposeController\",sessionId:a})\n};\nZmCalendarApp.prototype.getSimpleApptComposeController=function(){AjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\",\"CalendarAppt\"]);\nreturn this.getSessionController({controllerClass:\"ZmSimpleApptComposeController\"})\n};\nZmCalendarApp.prototype.getApptViewController=function(a){AjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\",\"CalendarAppt\"]);\nreturn this.getSessionController({controllerClass:\"ZmApptController\",sessionId:a})\n};\nZmCalendarApp.prototype.initResources=function(){if(!this._locations){this._locations=new ZmResourceList(ZmCalBaseItem.LOCATION);\nthis._locations.isCanonical=true\n}if(!this._equipment){this._equipment=new ZmResourceList(ZmCalBaseItem.EQUIPMENT);\nthis._equipment.isCanonical=true\n}};\nZmCalendarApp.prototype.loadResources=function(){this.initResources();\nif(appCtxt.get(ZmSetting.GAL_ENABLED)){var a=new ZmBatchCommand();\nif(!this._locations.isLoaded){a.add(new AjxCallback(this._locations,this._locations.load))\n}if(!this._equipment.isLoaded){a.add(new AjxCallback(this._equipment,this._equipment.load))\n}if(a._cmds.length){a.run()\n}}};\nZmCalendarApp.prototype.getLocations=function(){this.initResources();\nreturn this._locations\n};\nZmCalendarApp.prototype.getEquipment=function(){this.initResources();\nreturn this._equipment\n};\nZmCalendarApp.prototype.getReminderCalendarFolderIds=function(){var c=[];\nif(AjxDispatcher.loaded(\"CalendarCore\")){c=AjxDispatcher.run(\"GetCalController\").getReminderCalendarFolderIds()\n}else{this._folderNames={};\nfor(var a=0;\na<this._deferredFolders.length;\na++){var b=this._deferredFolders[a];\nc.push(b.obj.id);\nthis._folderNames[b.obj.id]=b.obj.name\n}}return c\n};\nZmCalendarApp.prototype.getCheckedCalendarFolderIds=function(a,c){var f=[];\nif(AjxDispatcher.loaded(\"CalendarCore\")){f=AjxDispatcher.run(\"GetCalController\").getCheckedCalendarFolderIds(a,c)\n}else{this._folderNames={};\nfor(var b=0;\nb<this._deferredFolders.length;\nb++){var e=this._deferredFolders[b];\nvar d=(e&&e.obj&&e.obj.f)?e.obj.f:\"\";\nif(d&&(d.indexOf(ZmOrganizer.FLAG_CHECKED)!=-1)){if(a&&e.obj.zid!=null){continue\n}if(e.obj.id==ZmOrganizer.ID_TRASH&&!c){continue\n}f.push(e.obj.id);\nthis._folderNames[e.obj.id]=e.obj.name\n}}}return f\n};\nZmCalendarApp.prototype.getCalendarName=function(a){return appCtxt.getById(a)?appCtxt.getById(a).name:this._folderNames[a]\n};\nZmCalendarApp.createMiniCalButton=function(l,h,g,b,c){var f={parent:l};\nif(c===false){f.id=h\n}var j=new DwtButton(f);\nj.addDropDownSelectionListener(g);\nj.addSelectionListener(g);\nj.setDropDownHovImage(null);\nj.setData(Dwt.KEY_ID,h);\nif(AjxEnv.isIE){j.setSize(\"20\")\n}var i=new DwtMenu({parent:j,style:DwtMenu.CALENDAR_PICKER_STYLE});\ni.setSize(\"150\");\ni._table.width=\"100%\";\nj.setMenu(i,true);\nvar a=new DwtCalendar({parent:i});\na.setData(Dwt.KEY_ID,h);\na.setSkipNotifyOnPage(true);\nvar e=appCtxt.get(ZmSetting.CAL_FIRST_DAY_OF_WEEK)||0;\na.setFirstDayOfWeek(e);\na.addSelectionListener(b);\nvar k=appCtxt.getSettings().getSetting(ZmSetting.CAL_FIRST_DAY_OF_WEEK);\nif(k){var d=new AjxListener(null,ZmCalendarApp._settingChangeListener,a);\nk.addChangeListener(d)\n}if(c!==false){j.reparentHtmlElement(h)\n}return j\n};\nZmCalendarApp.createReminderButton=function(h,d,k,c){var e=new DwtButton({parent:h});\ne.addDropDownSelectionListener(k);\ne.setData(Dwt.KEY_ID,d);\nif(AjxEnv.isIE){e.setSize(\"20\")\n}var g=new DwtMenu({parent:e,style:DwtMenu.DROPDOWN_STYLE});\ng.setSize(\"150\");\ne.setMenu(g,true);\nvar f=appCtxt.get(ZmSetting.CAL_REMINDER_WARNING_TIME);\nfor(var a=0;\na<ZmCalendarApp.reminderTimeWarningDisplayMsgs.length;\na++){var j=ZmCalendarApp.__formatLabel(ZmCalendarApp.reminderTimeWarningDisplayMsgs[a],ZmCalendarApp.reminderTimeWarningLabels[a]);\nvar b=new DwtMenuItem({parent:g,style:DwtMenuItem.NO_STYLE});\nb.setText(j);\nb.setData(\"value\",ZmCalendarApp.reminderTimeWarningValues[a]);\nif(c){b.addSelectionListener(c)\n}}e.reparentHtmlElement(d);\ndelete d;\nreturn e\n};\nZmCalendarApp.getReminderSummary=function(a){var d=((a%60)==0);\nvar c=((a%(60*24))==0);\nvar b=((a%(60*24*7))==0);\nif(a===-1){return ZmMsg.apptRemindNever\n}if(a===0){return ZmMsg.apptRemindAtEventTime\n}if(b){return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNWeeksBefore,a/(60*24*7))\n}if(c){return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNDaysBefore,a/(60*24))\n}if(d){return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNHoursBefore,a/60)\n}return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNMinutesBefore,a)\n};\nZmCalendarApp._settingChangeListener=function(c,b){if(b.type!=ZmEvent.S_SETTING){return\n}var a=b.source;\nif(a.id==ZmSetting.CAL_FIRST_DAY_OF_WEEK){c.setFirstDayOfWeek(a.getValue())\n}};\nZmCalendarApp.prototype._newCalendarCallback=function(f,d,b,c,g){var e=appCtxt.getNewCalendarDialog();\ne.popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.CALENDAR)._doCreate(f,d,b,c,g)\n};\nZmCalendarApp.addInviteReplyMenu=function(a){var b=[ZmOperation.EDIT_REPLY_ACCEPT,ZmOperation.EDIT_REPLY_TENTATIVE,ZmOperation.EDIT_REPLY_DECLINE];\nvar c=new ZmActionMenu({parent:a,menuItems:b});\na.setMenu(c);\nreturn c\n};\nZmCalendarApp.addCalViewMenu=function(a){var b=[ZmOperation.DAY_VIEW,ZmOperation.WORK_WEEK_VIEW,ZmOperation.WEEK_VIEW,ZmOperation.MONTH_VIEW,ZmOperation.CAL_LIST_VIEW];\nif(appCtxt.get(ZmSetting.FREE_BUSY_VIEW_ENABLED)){b.push(ZmOperation.FB_VIEW)\n}var c=new ZmActionMenu({parent:a,menuItems:b});\na.setMenu(c);\nreturn c\n};\nZmCalendarApp.__formatLabel=function(b,a){b=b||\"\";\nreturn b.match(/\\{/)?AjxMessageFormat.format(b,a):b\n};\nZmCalendarApp.parseReminderString=function(l){var j={};\nj[ZmMsg.apptRemindNDaysBefore]=ZmCalItem.REMINDER_UNIT_DAYS;\nj[ZmMsg.apptRemindNMinutesBefore]=ZmCalItem.REMINDER_UNIT_MINUTES;\nj[ZmMsg.apptRemindNHoursBefore]=ZmCalItem.REMINDER_UNIT_HOURS;\nj[ZmMsg.apptRemindNWeeksBefore]=ZmCalItem.REMINDER_UNIT_WEEKS;\nl=AjxStringUtil.trim(l);\nvar k=l;\nvar g=k.replace(/\\D/g,\"\");\ng=AjxStringUtil.trim(g);\nif(l===ZmMsg.apptRemindAtEventTime){return{reminderValue:0,reminderUnits:ZmCalItem.REMINDER_UNIT_MINUTES}\n}if(g==\"\"){return{reminderValue:\"\",reminderUnits:ZmCalItem.REMINDER_NONE}\n}if(g.indexOf(\" \")>=0){g=g.split(\" \")[0]\n}for(var h in j){var b=ZmCalendarApp.__formatLabel(h,g);\nif(b!=\"\"&&b.toLowerCase()==l.toLowerCase()){return{reminderValue:g,reminderUnits:j[h],before:true}\n}}var f=parseInt(g);\nvar d={};\nd[ZmCalItem.REMINDER_UNIT_MINUTES]=AjxMsg.minute;\nd[ZmCalItem.REMINDER_UNIT_HOURS]=AjxMsg.hour;\nd[ZmCalItem.REMINDER_UNIT_DAYS]=AjxMsg.day;\nd[ZmCalItem.REMINDER_UNIT_WEEKS]=AjxMsg.week;\nvar c=ZmCalItem.REMINDER_UNIT_HOURS;\nfor(var e in d){if(k.indexOf(d[e])>=0){c=e;\nreturn{reminderValue:f?f:0,reminderUnits:c}\n}}var a={};\na[ZmCalItem.REMINDER_UNIT_MINUTES]=AjxMsg.minutes;\na[ZmCalItem.REMINDER_UNIT_HOURS]=AjxMsg.hours;\na[ZmCalItem.REMINDER_UNIT_DAYS]=AjxMsg.days;\na[ZmCalItem.REMINDER_UNIT_WEEKS]=AjxMsg.weeks;\nfor(var e in a){if(k.indexOf(a[e])>=0){c=e;\nreturn{reminderValue:f?f:0,reminderUnits:c}\n}}return{reminderValue:f?f:0,reminderUnits:c}\n};\nZmCalendarApp.convertReminderUnits=function(a,b){switch(b){case ZmCalItem.REMINDER_UNIT_MINUTES:return a;\ncase ZmCalItem.REMINDER_UNIT_HOURS:return a*60;\ncase ZmCalItem.REMINDER_UNIT_DAYS:return a*60*24;\ncase ZmCalItem.REMINDER_UNIT_WEEKS:return a*60*24*7;\ndefault:return 0\n}};\nZmCalendarApp.prototype.updateResourceCache=function(c){var b=c.getFullName();\nif(b){this._resByName[b.toLowerCase()]=c\n}var a=c.getEmail();\nif(a){this._resByEmail[a.toLowerCase()]=c\n}};\nZmCalendarApp.prototype._addSettingsChangeListeners=function(){ZmApp.prototype._addSettingsChangeListeners.call(this);\nif(!this._settingsListener){this._settingsListener=new AjxListener(this,this._settingsChangeListener)\n}var b=appCtxt.getSettings();\nvar a=b.getSetting(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL);\nif(a){a.addChangeListener(this._settingListener)\n}a=b.getSetting(ZmSetting.CAL_FIRST_DAY_OF_WEEK);\nif(a){a.addChangeListener(this._settingListener)\n}a=b.getSetting(ZmSetting.CAL_WORKING_HOURS);\nif(a){a.addChangeListener(this._settingListener)\n}a=b.getSetting(ZmSetting.CAL_SHOW_DECLINED_MEETINGS);\nif(a){a.addChangeListener(this._settingListener)\n}var b=appCtxt.getSettings();\nb.getSetting(ZmSetting.CAL_SHOW_CALENDAR_WEEK).addChangeListener(this._settingListener);\nb.addChangeListener(this._settingsListener)\n};\nZmCalendarApp.prototype._settingChangeListener=function(g){if(g.type!=ZmEvent.S_SETTING){return\n}var i=g.source;\nif(i.id==ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL){if(i.getValue()){var c=appCtxt.getAppViewMgr();\nvar h=!c.isHidden(ZmAppViewMgr.C_TREE_FOOTER,c.getCurrentViewId());\nAjxDispatcher.run(\"ShowMiniCalendar\",h)\n}else{if(!this._active){AjxDispatcher.run(\"ShowMiniCalendar\",false)\n}}}else{if(i.id==ZmSetting.CAL_FIRST_DAY_OF_WEEK){var f=AjxDispatcher.run(\"GetCalController\");\nvar e=f.getMiniCalendar();\nvar a=i.getValue();\ne.setFirstDayOfWeek(a);\nvar b=e.getDate();\nf.setDate(b,0,true)\n}else{if(i.id==ZmSetting.CAL_WORKING_HOURS){var f=AjxDispatcher.run(\"GetCalController\");\nvar d=f.getViewMgr();\nif(d){d.layoutWorkingHours()\n}}else{if(i.id==ZmSetting.CAL_SHOW_DECLINED_MEETINGS){var f=AjxDispatcher.run(\"GetCalController\");\nf.refreshCurrentView()\n}}}}};\nZmCalendarApp.prototype._settingsChangeListener=function(d){if(d.type!=ZmEvent.S_SETTINGS){return\n}var e=d.getDetail(\"settings\");\nif(!(e&&e.length)){return\n}for(var b=0;\nb<e.length;\nb++){var c=e[b];\nif(c.id==ZmSetting.CAL_SHOW_CALENDAR_WEEK){var a=AjxDispatcher.run(\"GetCalController\").recreateMiniCalendar();\nvar f=appCtxt.getCalManager();\nf.highlightMiniCal()\n}}};\nZmCalendarApp.prototype.showDayView=function(c){var b=AjxDispatcher.run(\"GetCalController\");\nvar a=b.getMiniCalendar();\nb.setDate(c,0,a.getForceRollOver());\nif(!b._viewVisible){b.show(ZmId.VIEW_CAL_DAY)\n}};\nZmCalendarApp.prototype.getDateToolTip=function(a,b){var c=AjxDispatcher.run(\"GetCalController\");\nreturn c.getDayToolTipText(a,null,null,true,b)\n};\nZmCalendarApp.prototype.importAppointment=function(d,c,b){var a=new AjxCallback(this,this._handleImportAppointment,[d,c,b]);\nAjxDispatcher.require([\"MailCore\",\"CalendarCore\",\"Calendar\"],false,a)\n};\nZmCalendarApp.prototype._handleImportAppointment=function(d,c,b){if(this._deferredFolders.length!=0){this._createDeferredFolders(ZmApp.CALENDAR)\n}var e=this._copyToDialog=appCtxt.getChooseFolderDialog();\nvar a=new AjxCallback(this,this._chooserCallback,[d,c,b]);\nZmController.showDialog(e,a,this._getCopyParams(e,d,c))\n};\nZmCalendarApp.prototype._getCopyParams=function(c,b,a){return{data:{msgId:b,partId:a},treeIds:[ZmOrganizer.CALENDAR],overviewId:c.getOverviewId(this._name),title:ZmMsg.addToCalendar,description:ZmMsg.targetFolder,appName:ZmApp.CALENDAR}\n};\nZmCalendarApp.prototype._chooserCallback=function(f,e,b,d){var h={ImportAppointmentsRequest:{_jsns:\"urn:zimbraMail\"}};\nvar c=h.ImportAppointmentsRequest;\nc.l=d.id;\nc.ct=\"text/calendar\";\nvar a=c.content={};\na.mid=f;\na.part=e;\nvar g={jsonObj:h,asyncMode:true,callback:(new AjxCallback(this,this._handleImportApptResponse,[d.id])),errorCallback:(new AjxCallback(this,this._handleImportApptError))};\nappCtxt.getAppController().sendRequest(g)\n};\nZmCalendarApp.prototype._handleImportApptResponse=function(a,b){appCtxt.getAppController().setStatusMsg(ZmMsg.addedToCalendar);\nappCtxt.getChooseFolderDialog().popdown();\nvar c=window.parentAppCtxt||window.appCtxt;\nif(c.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL)){var d=c.getCalManager();\nd.getMiniCalCache().clearCache();\nd.highlightMiniCal()\n}};\nZmCalendarApp.prototype._handleImportApptError=function(a){appCtxt.getAppController().setStatusMsg(ZmMsg.errorImportAppt,ZmStatusView.LEVEL_CRITICAL)\n};\nZmCalendarApp.getReminderTimeWarningDisplayOptions=function(){var b=[];\nfor(var a=0;\na<ZmCalendarApp.reminderTimeWarningDisplayMsgs.length;\na++){b.push(ZmCalendarApp.__formatLabel(ZmCalendarApp.reminderTimeWarningDisplayMsgs[a],ZmCalendarApp.reminderTimeWarningLabels[a]))\n}return b\n};\nZmCalendarApp.getDefaultCalendarFolders=function(){var m=ZmOrganizer.ITEM_ORGANIZER[ZmId.ITEM_APPOINTMENT];\nvar h=[];\nvar g=[];\nvar n=[];\nvar k=[];\nvar c;\nvar d=appCtxt.accountList.visibleAccounts;\nfor(var j=0;\nj<d.length;\nj++){var l=d[j];\nvar f=ZmApp.SETTING[ZmItem.APP[ZmId.ITEM_APPOINTMENT]];\nif((appCtxt.isOffline&&l.isMain)||!appCtxt.get(f,null,l)){continue\n}c=appCtxt.getFolderTree(l);\nh=h.concat(c.getByType(m))\n}if(appCtxt.isOffline){c=appCtxt.getFolderTree(appCtxt.accountList.mainAccount);\nh=h.concat(c.getByType(m))\n}for(var j=0;\nj<h.length;\nj++){var b=h[j];\nvar l=b.getAccount();\nif(b.noSuchFolder||b.isFeed()||(b.link&&b.isReadOnly())||b.isInTrash()){continue\n}if(appCtxt.multiAccounts&&b.nId==ZmOrganizer.ID_CALENDAR&&l.isCalDavBased()){continue\n}var e=appCtxt.multiAccounts?l.getIcon():b.getIconWithColor();\nvar a=AjxStringUtil.htmlDecode(appCtxt.multiAccounts?([b.getName(),\" (\",l.getDisplayName(),\")\"].join(\"\")):b.getName());\ng.push(a);\nn.push(b.id);\nk.push(e)\n}return{displayOptions:g,options:n,images:k}\n};\nZmCalendarApp.setDefaultReminderTimePrefValueOnSave=function(a,c,b){c===0?(c=-1):(c===-1?c=0:\"\");\na.setValue(c);\nb.push(a)\n};\nZmCalendarApp.postLoadSetDefaultReminderValue=function(){if(ZmCalendarApp.postLoadSetReminderCalled){return\n}var a=appCtxt.get(ZmSetting.CAL_REMINDER_WARNING_TIME);\nif(a===-1||a===0){a===-1?(a=0):(a=-1);\nappCtxt.set(ZmSetting.CAL_REMINDER_WARNING_TIME,a)\n}ZmCalendarApp.postLoadSetReminderCalled=true\n}\n}if(AjxPackage.define(\"zimbraMail.tasks.ZmTasksApp\")){ZmTasksApp=function(a){ZmApp.call(this,ZmApp.TASKS,a)\n};\nZmTasksApp.prototype=new ZmApp;\nZmTasksApp.prototype.constructor=ZmTasksApp;\nZmTasksApp.prototype.isZmTasksApp=true;\nZmTasksApp.prototype.toString=function(){return\"ZmTasksApp\"\n};\nZmEvent.S_TASK=ZmId.ITEM_TASK;\nZmItem.TASK=ZmEvent.S_TASK;\nZmOrganizer.TASKS=ZmEvent.S_TASK;\nZmApp.TASKS=ZmId.APP_TASKS;\nZmApp.CLASS[ZmApp.TASKS]=\"ZmTasksApp\";\nZmApp.SETTING[ZmApp.TASKS]=ZmSetting.TASKS_ENABLED;\nZmApp.LOAD_SORT[ZmApp.TASKS]=45;\nZmApp.QS_ARG[ZmApp.TASKS]=\"tasks\";\nZmTasksApp.REMINDER_START_DELAY=10000;\nZmTasksApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"TasksCore\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.setPackageLoadFunction(\"Tasks\",new AjxCallback(this,this._postLoad,ZmOrganizer.TASKS));\nAjxDispatcher.registerMethod(\"GetTaskListController\",[\"TasksCore\",\"Tasks\"],new AjxCallback(this,this.getTaskListController));\nAjxDispatcher.registerMethod(\"GetTaskController\",[\"TasksCore\",\"Tasks\"],new AjxCallback(this,this.getTaskController))\n};\nZmTasksApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_NEW_TASK,{textKey:\"newTask\",tooltipKey:\"newTaskTooltip\",image:\"NewTask\",shortcut:ZmKeyMap.NEW_TASK});\nZmOperation.registerOp(ZmId.OP_NEW_TASK_FOLDER,{textKey:\"newTaskFolder\",tooltipKey:\"newTaskFolderTooltip\",image:\"NewTaskList\"});\nZmOperation.registerOp(ZmId.OP_SHARE_TASKFOLDER,{textKey:\"shareTaskFolder\",image:\"TaskList\"});\nZmOperation.registerOp(ZmId.OP_PRINT_TASK,{textKey:\"printTask\",image:\"Print\",shortcut:ZmKeyMap.PRINT},ZmSetting.PRINT_ENABLED);\nZmOperation.registerOp(ZmId.OP_PRINT_TASKFOLDER,{textKey:\"printTaskFolder\",image:\"Print\"},ZmSetting.PRINT_ENABLED);\nZmOperation.registerOp(ZmId.OP_SORTBY_MENU,{tooltipKey:\"viewTooltip\",textKey:\"taskFilterBy\",image:\"SplitPane\",textPrecedence:80});\nZmOperation.registerOp(ZmId.OP_MARK_AS_COMPLETED,{tooltipKey:\"markAsCompleted\",textKey:\"markAsCompleted\",image:\"CheckboxChecked\",textPrecedence:80})\n};\nZmTasksApp.prototype._registerSettings=function(a){a=a||appCtxt.getSettings();\na.registerSetting(\"READING_PANE_LOCATION_TASKS\",{name:\"zimbraPrefTasksReadingPaneLocation\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true});\na.registerSetting(\"TASKS_FILTERBY\",{name:\"zimbraPrefTasksFilterBy\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.TASK_FILTER_ALL,isImplicit:true});\nif(!appCtxt.get(ZmSetting.HIGHLIGHT_OBJECTS)){a.registerSetting(\"HIGHLIGHT_OBJECTS\",{name:\"zimbraMailHighlightObjectsMaxSize\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:70})\n}};\nZmTasksApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.TASK,{app:ZmApp.TASKS,nameKey:\"task\",icon:\"TasksApp\",soapCmd:\"ItemAction\",itemClass:\"ZmTask\",node:\"task\",organizer:ZmOrganizer.TASKS,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.TASKS],searchType:\"task\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"TasksCore\");\nreturn new ZmList(ZmItem.TASK,a)\n},this)})\n};\nZmTasksApp.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.TASKS,{app:ZmApp.TASKS,nameKey:\"tasksFolder\",defaultFolder:ZmFolder.ID_TASKS,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmTaskFolder\",orgPackage:\"TasksCore\",treeController:\"ZmTaskTreeController\",labelKey:\"taskLists\",itemsKey:\"tasks\",folderKey:\"tasksFolder\",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,views:[\"task\"],createFunc:\"ZmOrganizer.create\",compareFunc:\"ZmFolder.sortCompareNonMail\",deferrable:true,newOp:ZmOperation.NEW_TASK_FOLDER,displayOrder:100})\n};\nZmTasksApp.prototype._setupSearchToolbar=function(){ZmSearchToolBar.addMenuItem(ZmItem.TASK,{msgKey:\"tasks\",tooltipKey:\"searchTasks\",icon:\"TasksApp\",shareIcon:\"SharedTaskList\",setting:ZmSetting.TASKS_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_TASK),disableOffline:true})\n};\nZmTasksApp.prototype._registerApp=function(){var c={};\nc[ZmOperation.NEW_TASK]=\"task\";\nvar b={};\nb[ZmOperation.NEW_TASK_FOLDER]=\"tasksFolder\";\nvar a={};\na[ZmKeyMap.NEW_TASK]=ZmOperation.NEW_TASK;\nZmApp.registerApp(ZmApp.TASKS,{mainPkg:\"Tasks\",nameKey:\"tasks\",icon:\"TasksApp\",textPrecedence:20,chooserTooltipKey:\"goToTasks\",defaultSearch:ZmItem.TASK,organizer:ZmOrganizer.TASKS,overviewTrees:[ZmOrganizer.TASKS,ZmOrganizer.SEARCH,ZmOrganizer.TAG],newItemOps:c,newOrgOps:b,actionCodes:a,searchTypes:[ZmItem.TASK],gotoActionCode:ZmKeyMap.GOTO_TASKS,newActionCode:ZmKeyMap.NEW_TASK,chooserSort:35,defaultSort:25,searchResultsTab:true})\n};\nZmTasksApp.prototype.postNotify=function(a){if(this._checkReplenishListView){var c=a.modified&&a.modified.task;\nvar b;\nif(c){b=c[0].items[0]\n}this._checkReplenishListView._checkReplenish(b,true);\nthis._checkReplenishListView=null\n}};\nZmTasksApp.prototype.handleOp=function(c,b){switch(c){case ZmOperation.NEW_TASK:b=b||{};\nvar a=new AjxCallback(this,this._handleLoadNewTask,[b]);\nAjxDispatcher.require([\"TasksCore\",\"Tasks\"],false,a,null,true);\nbreak;\ncase ZmOperation.NEW_TASK_FOLDER:var a=new AjxCallback(this,this._handleLoadNewTaskFolder);\nAjxDispatcher.require([\"TasksCore\",\"Tasks\"],false,a,null,true);\nbreak\n}};\nZmTasksApp.prototype._handleLoadNewTask=function(a){a.folderId=a.folderId||this.getTaskListController()._folderId;\nAjxDispatcher.run(\"GetTaskController\").show((new ZmTask(null,null,a&&a.folderId)))\n};\nZmTasksApp.prototype._handleLoadNewTaskFolder=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nvar a=appCtxt.getNewTaskFolderDialog();\nif(!this._newTaskFolderCb){this._newTaskFolderCb=new AjxCallback(this,this._newTaskFolderCallback)\n}ZmController.showDialog(a,this._newTaskFolderCb)\n};\nZmTasksApp.prototype.createNotify=function(j,b){if(!j.folder&&!j.task&&!j.link){return\n}if(!b&&this._deferNotifications(\"create\",j)){return\n}for(var a in j){var g=j[a];\nif(!g){continue\n}for(var d=0;\nd<g.length;\nd++){var e=g[d];\nif(appCtxt.cacheGet(e.id)){continue\n}if(a==\"folder\"){this._handleCreateFolder(e,ZmOrganizer.TASKS)\n}else{if(a==\"link\"){this._handleCreateLink(e,ZmOrganizer.TASKS)\n}else{if(a==\"task\"){var h=AjxDispatcher.run(\"GetTaskListController\").getList();\nif(h&&!AjxUtil.isEmpty(e.inv)&&!AjxUtil.isEmpty(e.inv[0].comp)){var c=h.controller.getAllowableTaskStatus();\nvar f=e.inv[0].comp[0].status;\nif(!c||c.indexOf(f)!==-1){h.notifyCreate(e)\n}}}}}}}};\nZmTasksApp.prototype.launch=function(b,c){this._setLaunchTime(this.toString(),new Date());\nvar a=new AjxCallback(this,this._handleLoadLaunch,c);\nAjxDispatcher.require([\"TasksCore\",\"Tasks\"],true,a,null,true)\n};\nZmTasksApp.prototype._handleLoadLaunch=function(b){var a=this._getExternalAccount();\nthis.search(null,null,null,null,(a&&a.name));\nif(b){b.run()\n}};\nZmTasksApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newTask,tooltip:ZmMsg.createNewTask,icon:\"NewTask\",iconDis:\"NewTaskDis\",defaultId:ZmOperation.NEW_TASK,disabled:!this.containsWritableFolder()}\n};\nZmTasksApp.prototype.showSearchResults=function(b,d,c){var a=this._handleLoadShowSearchResults.bind(this,b,d,c);\nAjxDispatcher.require(\"Tasks\",false,a,null,true)\n};\nZmTasksApp.prototype._handleLoadShowSearchResults=function(c,f,d){var b=c&&c.search&&c.search.isSimple()&&c.search.folderId||null;\nvar e=d?d.getCurrentViewId():ZmApp.MAIN_SESSION;\nvar a=AjxDispatcher.run(\"GetTaskListController\",e,d);\na.show(c,b);\nthis._setLoadedTime(this.toString(),new Date());\nif(f){f.run(a)\n}};\nZmTasksApp.prototype.runRefresh=function(){if(window.ZmTaskListController===undefined){return\n}AjxDispatcher.run(\"GetTaskListController\").runRefresh()\n};\nZmTasksApp.prototype.getListController=function(){return AjxDispatcher.run(\"GetTaskListController\")\n};\nZmTasksApp.prototype.getTaskListController=function(b,a){return this.getSessionController({controllerClass:\"ZmTaskListController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmTasksApp.prototype.getTaskController=function(a){return this.getSessionController({controllerClass:\"ZmTaskController\",sessionId:a})\n};\nZmTasksApp.prototype.newTaskFromMailItem=function(c,a){var b=c.subject||\"\";\nif(c instanceof ZmConv){c=c.getFirstHotMsg()\n}c.load({getHtml:false,callback:new AjxCallback(this,this._msgLoadedCallback,[c,a,b])})\n};\nZmTasksApp.prototype._msgLoadedCallback=function(d,a,c){var b=new ZmTask();\nb.setEndDate(AjxDateUtil.roundTimeMins(a,30));\nb.setFromMailMessage(d,c);\nthis.getTaskController().show(b,ZmCalItem.MODE_NEW,true)\n};\nZmTasksApp.prototype.search=function(a,b,d,i,g){var f=a?a.createQuery():\"\";\nf=f||(appCtxt.isExternalAccount()?\"inid:\"+this.getDefaultFolderId():\"in:tasks\");\nvar h=(a&&appCtxt.get(ZmSetting.SORTING_PREF,a.nId))||appCtxt.get(ZmSetting.SORTING_PREF,\"TKL-main\")||ZmSearch.DUE_DATE_ASC;\nvar c={query:f,types:[ZmItem.TASK],limit:this.getLimit(),searchFor:ZmItem.TASK,callback:i,sortBy:h,accountName:(g||(a&&a.getAccount().name))};\nvar e=appCtxt.getSearchController();\ne.searchAllAccounts=false;\ne.search(c)\n};\nZmTasksApp.prototype._newTaskFolderCallback=function(e,c,b){var d=appCtxt.getNewTaskFolderDialog();\nd.popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.TASKS)._doCreate(e,c,b)\n};\nZmTasksApp.prototype.getTaskFolderIds=function(a){var d=[];\nif(AjxDispatcher.loaded(\"TasksCore\")){d=AjxDispatcher.run(\"GetTaskListController\").getTaskFolderIds(a)\n}else{this._folderNames={};\nfor(var b=0;\nb<this._deferredFolders.length;\nb++){var c=this._deferredFolders[b];\nif(a&&c.obj.zid!=null){continue\n}d.push(c.obj.id);\nthis._folderNames[c.obj.id]=c.obj.name\n}}return d\n};\nZmTasksApp.prototype.getTaskFolderName=function(a){return appCtxt.getById(a)?appCtxt.getById(a).name:this._folderNames[a]\n};\nZmTasksApp.prototype.getReminderController=function(){if(!this._reminderController){AjxDispatcher.require(\"TasksCore\");\nvar a=appCtxt.getTaskManager();\nthis._reminderController=a.getReminderController();\nthis._reminderController._calController=a;\nthis._reminderController.refresh()\n}return this._reminderController\n};\nZmTasksApp.createpCompleteButton=function(g,e,j,d){var a=new DwtButton({parent:g});\na.addDropDownSelectionListener(j);\na.setData(Dwt.KEY_ID,e);\na.setSize(\"25\");\nvar f=new DwtMenu({parent:a,style:DwtMenu.DROPDOWN_STYLE});\nf.setSize(\"100\");\na.setMenu(f,true);\nvar h=new AjxMessageFormat(AjxMsg.percentageString);\nfor(var b=0;\nb<=100;\nb+=ZmTask.PCOMPLETE_INT){var c=new DwtMenuItem({parent:f,style:DwtMenuItem.NO_STYLE});\nc.setText((h.format(b)));\nc.setData(\"value\",b);\nif(d){c.addSelectionListener(d)\n}}a.reparentHtmlElement(e);\ndelete e;\nreturn a\n}\n}if(AjxPackage.define(\"zimbraMail.abook.ZmContactsApp\")){ZmContactsApp=function(b,a){ZmApp.call(this,ZmApp.CONTACTS,b,a);\nthis.contactsLoaded={};\nthis._contactList={};\nthis._initialized=false;\nthis._byEmail={};\nthis._byPhone={};\nthis._dlCache={}\n};\nZmContactsApp.prototype=new ZmApp;\nZmContactsApp.prototype.constructor=ZmContactsApp;\nZmContactsApp.prototype.isZmContactsApp=true;\nZmContactsApp.prototype.toString=function(){return\"ZmContactsApp\"\n};\nZmEvent.S_CONTACT=ZmId.ITEM_CONTACT;\nZmEvent.S_GROUP=ZmId.ITEM_GROUP;\nZmItem.CONTACT=ZmEvent.S_CONTACT;\nZmItem.GROUP=ZmEvent.S_GROUP;\nZmItem.GAL=ZmId.ITEM_GAL_CONTACT;\nZmOrganizer.ADDRBOOK=ZmId.ORG_ADDRBOOK;\nZmApp.CONTACTS=ZmId.APP_CONTACTS;\nZmApp.CLASS[ZmApp.CONTACTS]=\"ZmContactsApp\";\nZmApp.SETTING[ZmApp.CONTACTS]=ZmSetting.CONTACTS_ENABLED;\nZmApp.UPSELL_SETTING[ZmApp.CONTACTS]=ZmSetting.CONTACTS_UPSELL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.CONTACTS]=30;\nZmApp.QS_ARG[ZmApp.CONTACTS]=\"contacts\";\nZmContactsApp.SEARCHFOR_CONTACTS=1;\nZmContactsApp.SEARCHFOR_GAL=2;\nZmContactsApp.SEARCHFOR_PAS=3;\nZmContactsApp.SEARCHFOR_FOLDERS=4;\nZmContactsApp.SEARCHFOR_HAB=5;\nZmContactsApp.SEARCHFOR_MAX=50;\nZmContactsApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"ContactsCore\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.setPackageLoadFunction(\"Contacts\",new AjxCallback(this,this._postLoad,ZmOrganizer.ADDRBOOK));\nAjxDispatcher.registerMethod(\"GetContacts\",\"ContactsCore\",new AjxCallback(this,this.getContactList));\nAjxDispatcher.registerMethod(\"GetContactsForAllAccounts\",\"ContactsCore\",new AjxCallback(this,this.getContactListForAllAccounts));\nAjxDispatcher.registerMethod(\"GetContactListController\",[\"ContactsCore\",\"Contacts\"],new AjxCallback(this,this.getContactListController));\nAjxDispatcher.registerMethod(\"GetContactController\",[\"ContactsCore\",\"Contacts\"],new AjxCallback(this,this.getContactController))\n};\nZmContactsApp.prototype._registerSettings=function(a){var a=a||appCtxt.getSettings();\na.registerSetting(\"AUTO_ADD_ADDRESS\",{name:\"zimbraPrefAutoAddAddressEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true});\na.registerSetting(\"AUTOCOMPLETE_LIMIT\",{name:\"zimbraContactAutoCompleteMaxResults\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:20});\na.registerSetting(\"AUTOCOMPLETE_ON_COMMA\",{name:\"zimbraPrefAutoCompleteQuickCompletionOnComma\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"AUTOCOMPLETE_SHARE\",{name:\"zimbraPrefShareContactsInAutoComplete\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"AUTOCOMPLETE_SHARED_ADDR_BOOKS\",{name:\"zimbraPrefSharedAddrBookAutoCompleteEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"EXPORT\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE});\na.registerSetting(\"GAL_AUTOCOMPLETE\",{name:\"zimbraPrefGalAutoCompleteEnabled\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"IMPORT\",{type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE});\na.registerSetting(\"MAX_CONTACTS\",{name:\"zimbraContactMaxNumEntries\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:0});\na.registerSetting(\"NEW_ADDR_BOOK_ENABLED\",{name:\"zimbraFeatureNewAddrBookEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"PHONETIC_CONTACT_FIELDS\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:/^ja/.test(AjxEnv.DEFAULT_LOCALE)});\na.registerSetting(\"DETAILED_CONTACT_SEARCH_ENABLED\",{name:\"zimbraFeatureContactsDetailedSearchEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false})\n};\nZmContactsApp.prototype._registerPrefs=function(){var b={CONTACTS:{title:ZmMsg.addressBook,icon:\"ContactsApp\",templateId:\"prefs.Pages#Contacts\",priority:70,precondition:ZmSetting.CONTACTS_ENABLED,prefs:[ZmSetting.AUTO_ADD_ADDRESS,ZmSetting.AUTOCOMPLETE_ON_COMMA,ZmSetting.AUTOCOMPLETE_SHARE,ZmSetting.AUTOCOMPLETE_SHARED_ADDR_BOOKS,ZmSetting.EXPORT,ZmSetting.GAL_AUTOCOMPLETE,ZmSetting.INITIALLY_SEARCH_GAL,ZmSetting.IMPORT]}};\nfor(var a in b){ZmPref.registerPrefSection(a,b[a])\n}ZmPref.registerPref(\"AUTO_ADD_ADDRESS\",{displayName:ZmMsg.autoAddContacts,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"AUTOCOMPLETE_ON_COMMA\",{displayName:ZmMsg.autocompleteOnComma,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"AUTOCOMPLETE_SHARE\",{displayName:ZmMsg.autocompleteShare,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"AUTOCOMPLETE_SHARED_ADDR_BOOKS\",{displayName:ZmMsg.autocompleteSharedAddrBooks,displayContainer:ZmPref.TYPE_CHECKBOX});\nZmPref.registerPref(\"EXPORT\",{loadFunction:ZmPref.loadCsvFormats,displayContainer:ZmPref.TYPE_EXPORT});\nZmPref.registerPref(\"GAL_AUTOCOMPLETE\",{displayName:ZmMsg.galAutocomplete,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:[ZmSetting.GAL_AUTOCOMPLETE_ENABLED,ZmSetting.GAL_ENABLED]});\nZmPref.registerPref(\"IMPORT\",{displayName:ZmMsg.importFromCSV,displayContainer:ZmPref.TYPE_IMPORT});\nZmPref.registerPref(\"INITIALLY_SEARCH_GAL\",{displayName:ZmMsg.initiallySearchGal,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:function(){return appCtxt.get(ZmSetting.GAL_ENABLED)&&appCtxt.getActiveAccount().isZimbraAccount\n}})\n};\nZmContactsApp.prototype._createVirtualFolders=function(){if(!window.ZmContactList||!window.ZmAddrBook){return\n}ZmContactList.addDlFolder()\n};\nZmContactsApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_CONTACT);\nZmOperation.registerOp(ZmId.OP_EDIT_CONTACT,{textKey:\"AB_EDIT_CONTACT\",image:\"Edit\",shortcut:ZmKeyMap.EDIT});\nZmOperation.registerOp(ZmId.OP_NEW_ADDRBOOK,{textKey:\"newAddrBook\",tooltipKey:\"newAddrBookTooltip\",image:\"NewContactsFolder\"},ZmSetting.NEW_ADDR_BOOK_ENABLED);\nZmOperation.registerOp(ZmId.OP_NEW_CONTACT,{textKey:\"newContact\",tooltipKey:\"newContactTooltip\",image:\"NewContact\",shortcut:ZmKeyMap.NEW_CONTACT},ZmSetting.CONTACTS_ENABLED);\nZmOperation.registerOp(ZmId.OP_NEW_GROUP,{textKey:\"newGroup\",tooltipKey:\"newGroupTooltip\",image:\"NewGroup\"},ZmSetting.CONTACTS_ENABLED);\nZmOperation.registerOp(ZmId.OP_NEW_DISTRIBUTION_LIST,{textKey:\"newDistList\",tooltipKey:\"newDistListTooltip\",image:\"NewGroup\"},ZmSetting.CONTACTS_ENABLED);\nZmOperation.registerOp(ZmId.OP_PRINT_CONTACT,{textKey:\"printContact\",image:\"Print\",shortcut:ZmKeyMap.PRINT},ZmSetting.PRINT_ENABLED);\nZmOperation.registerOp(ZmId.OP_PRINT_ADDRBOOK,{textKey:\"printAddrBook\",image:\"Print\"},ZmSetting.PRINT_ENABLED);\nZmOperation.registerOp(ZmId.OP_SHARE_ADDRBOOK,{textKey:\"shareAddrBook\",image:\"SharedContactsFolder\"})\n};\nZmContactsApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.CONTACT,{app:ZmApp.CONTACTS,nameKey:\"contact\",icon:\"Contact\",soapCmd:\"ContactAction\",itemClass:\"ZmContact\",node:\"cn\",organizer:ZmOrganizer.ADDRBOOK,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.ZIMLET,ZmOrganizer.ADDRBOOK],searchType:\"contact\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"ContactsCore\");\nreturn new ZmContactList(a,a?a.isGalSearch||a.isGalAutocompleteSearch:null)\n},this)});\nZmItem.registerItem(ZmItem.GROUP,{nameKey:\"group\",icon:\"Group\",soapCmd:\"ContactAction\"});\nZmItem.registerItem(ZmItem.GAL,{app:ZmApp.CONTACTS})\n};\nZmContactsApp.prototype._registerOrganizers=function(){var a={};\nZmOrganizer.registerOrg(ZmOrganizer.ADDRBOOK,{app:ZmApp.CONTACTS,nameKey:\"addressBook\",defaultFolder:ZmOrganizer.ID_ADDRBOOK,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmAddrBook\",orgPackage:\"ContactsCore\",treeController:\"ZmAddrBookTreeController\",labelKey:\"contactLists\",itemsKey:\"contacts\",hasColor:true,defaultColor:ZmOrganizer.C_NONE,orgColor:a,treeType:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.ADDRBOOK],views:[\"contact\"],folderKey:\"contactsFolder\",mountKey:\"mountAddrBook\",createFunc:\"ZmOrganizer.create\",compareFunc:\"ZmFolder.sortCompareNonMail\",displayOrder:100,newOp:ZmOperation.NEW_ADDRBOOK,deferrable:true})\n};\nZmContactsApp.prototype._setupSearchToolbar=function(){ZmSearchToolBar.addMenuItem(ZmItem.CONTACT,{msgKey:\"contacts\",tooltipKey:\"searchPersonalContacts\",icon:\"Contact\",shareIcon:\"SharedContactsFolder\",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_CONTACT)});\nZmSearchToolBar.addMenuItem(ZmId.SEARCH_GAL,{msgKey:\"GAL\",tooltipKey:\"searchGALContacts\",icon:\"GAL\",setting:ZmSetting.GAL_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_GAL),disableOffline:true})\n};\nZmContactsApp.prototype._registerApp=function(){var c={};\nc[ZmOperation.NEW_CONTACT]=\"contact\";\nc[ZmOperation.NEW_GROUP]=\"group\";\nif(appCtxt.createDistListAllowed){c[ZmOperation.NEW_DISTRIBUTION_LIST]=\"distributionList\"\n}var b={};\nb[ZmOperation.NEW_ADDRBOOK]=\"contactsFolder\";\nvar a={};\na[ZmKeyMap.NEW_CONTACT]=ZmOperation.NEW_CONTACT;\nZmApp.registerApp(ZmApp.CONTACTS,{mainPkg:\"Contacts\",nameKey:\"addressBook\",icon:\"ContactsApp\",textPrecedence:40,chooserTooltipKey:\"goToContacts\",viewTooltipKey:\"displayContacts\",defaultSearch:ZmItem.CONTACT,organizer:ZmOrganizer.ADDRBOOK,overviewTrees:[ZmOrganizer.ADDRBOOK,ZmOrganizer.SEARCH,ZmOrganizer.TAG],searchTypes:[ZmItem.CONTACT],newItemOps:c,newOrgOps:b,actionCodes:a,gotoActionCode:ZmKeyMap.GOTO_CONTACTS,newActionCode:ZmKeyMap.NEW_CONTACT,trashViewOp:ZmOperation.SHOW_ONLY_CONTACTS,chooserSort:20,defaultSort:40,upsellUrl:ZmSetting.CONTACTS_UPSELL_URL,searchResultsTab:true})\n};\nZmContactsApp.prototype.createNotify=function(j,c){if(!j.folder&&!j.cn&&!j.link){return\n}if(!c&&!this._noDefer&&this._deferNotifications(\"create\",j)){return\n}for(var a in j){var g=j[a];\nif(g&&g.length){for(var e=0;\ne<g.length;\ne++){var f=g[e];\nif(appCtxt.cacheGet(f.id)){continue\n}if(a==\"folder\"){this._handleCreateFolder(f,ZmOrganizer.ADDRBOOK)\n}else{if(a==\"link\"){this._handleCreateLink(f,ZmOrganizer.ADDRBOOK)\n}else{if(a==\"cn\"){var h=AjxDispatcher.run(\"GetContactListController\");\nif(h._folderId==ZmFolder.ID_DLS){continue\n}var d=(h&&h.getFolderId())?h.getList():new ZmContactList(null);\nif(appCtxt.multiAccounts&&d.search&&d.search.folderId!=f.l){continue\n}d.notifyCreate(f);\nvar b=window.parentAppCtxt||window.appCtxt;\nb.clearAutocompleteCache(ZmAutocomplete.AC_TYPE_CONTACT);\nf._handled=true\n}}}}}}};\nZmContactsApp.prototype.modifyNotify=function(b,a){if(!b.cn){return\n}if(!a&&!this._noDefer&&this._deferNotifications(\"modify\",b)){return\n}this._batchNotify(b.cn)\n};\nZmContactsApp.prototype.postNotify=function(a){if(this._checkReplenishListView){this._checkReplenishListView._checkReplenish();\nthis._checkReplenishListView=null\n}};\nZmContactsApp.prototype.handleOp=function(c){if(!appCtxt.isWebClientOffline()){switch(c){case ZmOperation.NEW_CONTACT:case ZmOperation.NEW_DISTRIBUTION_LIST:case ZmOperation.NEW_GROUP:var b=(c==ZmOperation.NEW_CONTACT)?null:ZmItem.GROUP;\nvar a=new AjxCallback(this,this._handleLoadNewItem,[b,c==ZmOperation.NEW_DISTRIBUTION_LIST]);\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,a,null,true);\nbreak;\ncase ZmOperation.NEW_ADDRBOOK:var a=new AjxCallback(this,this._handleLoadNewAddrBook);\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,a,null,true);\nbreak\n}}};\nZmContactsApp.prototype._handleLoadNewItem=function(c,b){var a=new ZmContact(null,null,c,b);\nAjxDispatcher.run(\"GetContactController\").show(a)\n};\nZmContactsApp.prototype._handleLoadNewAddrBook=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nvar a=appCtxt.getNewAddrBookDialog();\nif(!this._newAddrBookCb){this._newAddrBookCb=new AjxCallback(this,this._newAddrBookCallback)\n}ZmController.showDialog(a,this._newAddrBookCb)\n};\nZmContactsApp.prototype.activate=function(a){ZmApp.prototype.activate.apply(this,arguments)\n};\nZmContactsApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newContact,tooltip:ZmMsg.createNewContact,icon:\"NewContact\",iconDis:\"NewContactDis\",defaultId:ZmOperation.NEW_CONTACT,disabled:!this.containsWritableFolder()}\n};\nZmContactsApp.prototype.launch=function(b,c){this._setLaunchTime(this.toString(),new Date());\nvar a=new AjxCallback(this,this._handleLoadLaunch,c);\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,a,null,true)\n};\nZmContactsApp.prototype._handleLoadLaunch=function(b){var a=\"in:contacts\";\nif(appCtxt.isExternalAccount()){a=\"inid:\"+this.getDefaultFolderId()\n}this._contactsSearch(a,b)\n};\nZmContactsApp.prototype._contactsSearch=function(a,d){var c={searchFor:ZmId.ITEM_CONTACT,query:a,limit:this.getLimit(),types:[ZmId.ITEM_CONTACT],callback:d};\nvar b=appCtxt.getSearchController();\nb.searchAllAccounts=false;\nb.search(c)\n};\nZmContactsApp.prototype.getLimit=function(b){var a=appCtxt.get(ZmSetting.PAGE_SIZE);\nreturn b?a:2*a\n};\nZmContactsApp.prototype.getInitialSearchType=function(){var a=appCtxt.getCurrentList();\nreturn(a&&(a instanceof ZmContactList)&&a.isGal)?ZmId.SEARCH_GAL:null\n};\nZmContactsApp.prototype.showSearchResults=function(b,d,c){var a=this._handleLoadShowSearchResults.bind(this,b,d,c);\nAjxDispatcher.require(\"Contacts\",false,a,null,true)\n};\nZmContactsApp.prototype._handleLoadShowSearchResults=function(e,h,f){var d=e&&e.search;\nvar b=d&&d.isSimple()&&d.folderId;\nvar c=d&&(d.contactSource==ZmId.SEARCH_GAL);\nvar g=f?f.getCurrentViewId():ZmApp.MAIN_SESSION;\nvar a=AjxDispatcher.run(\"GetContactListController\",g,f);\na.show(e,c,b);\nthis._setLoadedTime(this.toString(),new Date());\nif(h){h.run(a)\n}};\nZmContactsApp.prototype.runRefresh=function(){var a=AjxDispatcher.run(\"GetContactListController\");\na.runRefresh()\n};\nZmContactsApp.prototype.setActive=function(b){if(b){var a=AjxDispatcher.run(\"GetContactListController\");\na.show()\n}};\nZmContactsApp.prototype.isContactListLoaded=function(a){var b=(a||appCtxt.getActiveAccount().id);\nreturn(this._contactList[b]&&this._contactList[b].isLoaded)\n};\nZmContactsApp.prototype.getContactByEmail=function(f,g){if(!f){return null\n}var e=f.toLowerCase();\nvar d=this._byEmail[e];\nif(!d&&this._notFound(e)){this._removeAddrFromLookupGroup(e);\nif(g){g.run(null)\n}return null\n}if(d){this._removeAddrFromLookupGroup(e);\nd=this._realizeContact(d);\nd._lookupEmail=f;\nif(g){g.run(d)\n}return d\n}if(g){var j=null,c=false,a=[];\nif(this._addrLookupHash&&this._addrLookupHash[e]){if(this._addrLookupList){for(var b=0;\nb<this._addrLookupList.length;\nb++){a.push(this._addrLookupList[b])\n}j=this._getSearchForAddresses(this._addrLookupList);\nc=true;\nthis._addrLookupList=null\n}this._addrLookupHash[e].push(g)\n}else{j=this._getSearchForAddresses([f])\n}if(j){var h=new AjxCallback(this,this._handleResponseSearch,[c?a:e,c,g]);\nj.execute({callback:h,noBusyOverlay:true})\n}}};\nZmContactsApp.prototype._handleResponseSearch=function(l,e,n,o){var b=o.getResponse();\nvar f=b&&b.getResults(ZmItem.CONTACT);\nif(e){var k=f.getArray();\nfor(var d=0;\nd<k.length;\nd++){this._updateLookupCache(k[d])\n}for(var d=0;\nd<l.length;\nd++){var m=l[d];\nif(!this._byEmail[m]){this._updateLookupCache(null,m)\n}var h=this._addrLookupHash[m];\nif(h&&h.length){for(var c=0;\nc<h.length;\nc++){h[c].run(this._byEmail[m])\n}}this._removeAddrFromLookupGroup(m)\n}}else{var g=f?f.get(0):null;\nthis._updateLookupCache(g,l);\nthis._byEmail[l]=g;\nn.run(g)\n}};\nZmContactsApp.prototype.getContactsByEmails=function(b,h){var j=[],a=null,f=null;\nfor(var c=0,e=b.length;\nc<e;\nc++){var g=b[c];\nvar d=this.getContactByEmail(g.getAddress());\nif(d||d===null){j.push({address:g,contact:d})\n}else{a=a||[];\nf=f||[];\na.push(g);\nf.push(g.getAddress())\n}}if(!h){return j\n}if(!a){h.run(j);\nreturn j\n}var l=this._getSearchForAddresses(f);\nvar k=new AjxCallback(this,this._handleResponseSearchByEmails,[a,j,h]);\nl.execute({callback:k})\n};\nZmContactsApp.prototype._handleResponseSearchByEmails=function(a,m,l,n){var b=n.getResponse();\nvar h=b&&b.getResults(ZmItem.CONTACT);\nif(!h){l.run(m)\n}for(var f=0,e=h.size();\nf<e;\nf++){var d=h.get(f);\nfor(var c=1;\ntrue;\nc++){var j=ZmContact.getAttributeName(ZmContact.F_email,c);\nvar g=d.getAttr(j);\nif(!g){break\n}this._byEmail[g]=d\n}}for(var c=0,e=a.length;\nc<e;\nc++){var k=a[c];\nvar d=this.getContactByEmail(k.getAddress());\nm.push({address:k,contact:d})\n}l.run(m)\n};\nZmContactsApp.prototype._getSearchForAddresses=function(c){var a;\nif(c.length==1){a=[\"to:\",c[0],\" not #type:group\"]\n}else{a=[\"(\"];\nfor(var b=0,d=c.length;\nb<d;\nb++){if(b>0){a.push(\" OR \")\n}a.push(\"to:\");\na.push(c[b])\n}a.push(\") not #type:group\")\n}var e={query:a.join(\"\"),limit:c.length*2,types:AjxVector.fromArray([ZmItem.CONTACT])};\nreturn new ZmSearch(e)\n};\nZmContactsApp.prototype._notFound=function(a){return(a===null||Boolean(this._contactList[appCtxt.getActiveAccount().id]))\n};\nZmContactsApp.prototype.setAddrLookupGroup=function(b){this._addrLookupList=[];\nthis._addrLookupHash={};\nif(b&&b.length){for(var a=0;\na<b.length;\na++){if(b[a]){var c=b[a].address||b[a];\nc=(c&&AjxUtil.isString(c))?c.toLowerCase():null;\nif(c&&!this._addrLookupHash[c]){this._addrLookupList.push(c);\nthis._addrLookupHash[c]=[]\n}}}}};\nZmContactsApp.prototype._removeAddrFromLookupGroup=function(a){if(!(this._addrLookupList&&this._addrLookupList.length)){return\n}AjxUtil.arrayRemove(this._addrLookupList,a);\ndelete this._addrLookupHash[a]\n};\nZmContactsApp.prototype._updateLookupCache=function(b,e){if(e){this._byEmail[e]=b\n}if(b){for(var d=1;\ntrue;\nd++){var c=ZmContact.getAttributeName(ZmContact.F_email,d);\nvar a=b.getAttr(c);\nif(!a){break\n}this._byEmail[a.toLowerCase()]=b\n}}};\nZmContactsApp.prototype.getContactByPhone=function(a){if(!a){return null\n}var c=a.replace(/[^\\d]/g,\"\");\nvar b=this._phoneToContact[c];\nif(b){b.contact=this._realizeContact(b.contact)\n}return b\n};\nZmContactsApp.prototype._realizeContact=function(a){var c=appCtxt.getActiveAccount().id;\nvar b=this._contactList[c];\nreturn b?b._realizeContact(a):a\n};\nZmContactsApp.prototype.updateCache=function(a,b){this._updateHash(a,b,ZmContact.EMAIL_FIELDS,this._byEmail);\nif(appCtxt.get(ZmSetting.VOICE_ENABLED)){this._updateHash(a,b,ZmContact.PHONE_FIELDS,this._byPhone,true,true)\n}};\nZmContactsApp.prototype._updateHash=function(h,c,f,e,b,a){for(var g=0;\ng<f.length;\ng++){var l=f[g];\nfor(var d=1;\ntrue;\nd++){var k=ZmContact.getAttributeName(l,d);\nvar j=ZmContact.getAttr(h,k);\nif(!j){break\n}j=a?j.replace(/[^\\d]/g,\"\"):j.toLowerCase();\nif(c){e[j]=b?{contact:h,field:k}:h\n}else{delete e[j]\n}}}};\nZmContactsApp.prototype.getContactListForAllAccounts=function(){var a=[];\nvar c=appCtxt.accountList.visibleAccounts;\nfor(var b=0;\nb<c.length;\nb++){if(appCtxt.get(ZmSetting.CONTACTS_ENABLED,null,c[b])){a.push(c[b])\n}}if(a.length>0){this._loadContactsForAccount(a)\n}};\nZmContactsApp.prototype._loadContactsForAccount=function(a){var c=a.shift();\nif(c){var b=new AjxCallback(this,this._loadContactsForAccount,[a]);\nthis.getContactList(b,null,c)\n}};\nZmContactsApp.prototype.getContactList=function(g,a,e){var c=(e&&e.id)||appCtxt.getActiveAccount().id;\nif(!this._contactList[c]){try{if(this._parentController){this._contactList[c]=this._parentController.getApp(ZmApp.CONTACTS).getContactList()\n}else{this._contactList[c]=new ZmContactList(null);\nvar f=new AjxCallback(this,this._handleResponseGetContactList,[g]);\nvar b=(e&&e.getEmail());\nthis._contactList[c].load(f,a,b)\n}return this._contactList[c]\n}catch(d){this._contactList[c]=null;\nthrow d\n}}else{if(g&&g.isAjxCallback){g.run(this._contactList[c])\n}return this._contactList[c]\n}};\nZmContactsApp.prototype._handleResponseGetContactList=function(b){var a=appCtxt.getActiveAccount().id;\nthis.contactsLoaded[a]=true;\nif(b){b.run(this._contactList[a])\n}};\nZmContactsApp.prototype.getGalContactList=function(){if(!this._galContactList){try{this._galContactList=new ZmContactList(null,true);\nthis._galContactList.load()\n}catch(a){this._galContactList=null;\nthrow a\n}}return this._galContactList\n};\nZmContactsApp.prototype.createFromVCard=function(c,b){var a=new ZmContact(null);\na.createFromVCard(c,b)\n};\nZmContactsApp.prototype.getContactListController=function(b,a){return this.getSessionController({controllerClass:\"ZmContactListController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmContactsApp.prototype.getContactController=function(a){return this.getSessionController({controllerClass:\"ZmContactController\",sessionId:a})\n};\nZmContactsApp.prototype._newAddrBookCallback=function(e,c,b){var d=appCtxt.getNewAddrBookDialog();\nd.popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.ADDRBOOK)._doCreate(e,c,b)\n};\nZmContactsApp.prototype.getDL=function(a){return this._dlCache[a]\n};\nZmContactsApp.prototype.cacheDL=function(b,a){this._dlCache[b]=a\n};\nZmContactsApp.prototype.updateIdHash=function(a,b){var d=a.id;\nvar c=this.getContactList().getIdHash();\nif(!b){c[d]=a\n}else{delete c[d]\n}};\nZmContactsApp.prototype.resetWebClientOfflineOperations=function(){ZmApp.prototype.resetWebClientOfflineOperations.apply(this);\nvar b=this.getContactListController();\nvar c=b&&b.getCurrentToolbar();\nif(b&&c){b._resetOperations(c)\n}var d=this.getOverview();\nvar a=d&&d.getTreeItemById(ZmFolder.ID_DLS);\nif(a){a.setVisible(!appCtxt.isWebClientOffline())\n}}\n}if(AjxPackage.define(\"zimbraMail.briefcase.ZmBriefcaseApp\")){ZmBriefcaseApp=function(b,a){ZmApp.call(this,ZmApp.BRIEFCASE,b,a)\n};\nZmBriefcaseApp.prototype=new ZmApp;\nZmBriefcaseApp.prototype.constructor=ZmBriefcaseApp;\nZmBriefcaseApp.prototype.isZmBriefcaseApp=true;\nZmBriefcaseApp.prototype.toString=function(){return\"ZmBriefcaseApp\"\n};\nZmEvent.S_BRIEFCASE_ITEM=ZmId.ITEM_BRIEFCASE;\nZmItem.BRIEFCASE_ITEM=ZmEvent.S_BRIEFCASE_ITEM;\nZmItem.BRIEFCASE=ZmItem.BRIEFCASE_ITEM;\nZmEvent.S_BRIEFCASE_REVISION_ITEM=ZmId.ITEM_BRIEFCASE_REV;\nZmItem.BRIEFCASE_REVISION_ITEM=ZmEvent.S_BRIEFCASE_REVISION_ITEM;\nZmItem.BRIEFCASE_REVISION=ZmItem.BRIEFCASE_REVISION_ITEM;\nZmOrganizer.BRIEFCASE=ZmId.ORG_BRIEFCASE;\nZmApp.BRIEFCASE=ZmId.APP_BRIEFCASE;\nZmApp.CLASS[ZmApp.BRIEFCASE]=\"ZmBriefcaseApp\";\nZmApp.SETTING[ZmApp.BRIEFCASE]=ZmSetting.BRIEFCASE_ENABLED;\nZmApp.LOAD_SORT[ZmApp.BRIEFCASE]=65;\nZmApp.QS_ARG[ZmApp.BRIEFCASE]=\"briefcase\";\nZmApp.BUTTON_ID[ZmApp.BRIEFCASE]=ZmId.BRIEFCASE_APP;\nZmBriefcaseApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"BriefcaseCore\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.setPackageLoadFunction(\"Briefcase\",new AjxCallback(this,this._postLoad,ZmOrganizer.BRIEFCASE));\nAjxDispatcher.registerMethod(\"GetBriefcaseController\",[\"BriefcaseCore\",\"Briefcase\"],new AjxCallback(this,this.getBriefcaseController))\n};\nZmBriefcaseApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_NEW_BRIEFCASE,{textKey:\"newBriefcase\",image:\"NewFolder\",tooltipKey:\"newBriefcaseTooltip\",shortcut:ZmKeyMap.NEW_BRIEFCASE});\nZmOperation.registerOp(ZmId.OP_NEW_FILE,{textKey:\"uploadNewFile\",tooltipKey:\"uploadNewFile\",textPrecedence:70,showImageInToolbar:true,showTextInToolbar:true});\nZmOperation.registerOp(ZmId.OP_NEW_DOC,{textKey:\"newDocument\",tooltipKey:\"newDocument\",image:\"NewDoc\",shortcut:ZmKeyMap.NEW_DOC,textPrecedence:12});\nZmOperation.registerOp(ZmId.OP_SHARE_BRIEFCASE,{textKey:\"shareFolder\",image:\"SharedMailFolder\"},ZmSetting.SHARING_ENABLED);\nZmOperation.registerOp(ZmId.OP_OPEN_FILE,{textKey:\"openFile\",tooltipKey:\"openFileTooltip\",image:\"NewDoc\"});\nZmOperation.registerOp(ZmId.OP_SAVE_FILE,{textKey:\"saveFile\",tooltipKey:\"saveFileTooltip\",image:\"DownArrow\"});\nZmOperation.registerOp(ZmId.OP_VIEW_FILE_AS_HTML,{textKey:\"viewFileAsHtml\",tooltipKey:\"viewAsHtml\",image:\"HtmlDoc\"});\nZmOperation.registerOp(ZmId.OP_SEND_FILE,{textKey:\"sendLink\",tooltipKey:\"sendLink\",image:\"Send\"});\nZmOperation.registerOp(ZmId.OP_SEND_FILE_AS_ATT,{textKey:\"sendAsAttachment\",tooltipKey:\"sendAsAttachment\",image:\"Attachment\"});\nZmOperation.registerOp(ZmId.OP_SEND_FILE_MENU,{textKey:\"send\",image:\"Send\",textPrecedence:75});\nZmOperation.registerOp(ZmId.OP_EDIT_FILE,{textKey:\"edit\",image:\"Edit\"});\nZmOperation.registerOp(ZmId.OP_RENAME_FILE,{textKey:\"rename\",image:\"FileRename\"});\nZmOperation.registerOp(ZmId.OP_CHECKIN,{textKey:\"checkInFile\",image:\"Checkin\"});\nZmOperation.registerOp(ZmId.OP_CHECKOUT,{textKey:\"checkOutFile\",image:\"Checkout\"});\nZmOperation.registerOp(ZmId.OP_DISCARD_CHECKOUT,{textKey:\"checkOutFileDiscard\",image:\"DiscardCheckout\"});\nZmOperation.registerOp(ZmId.OP_VERSION_HISTORY,{textKey:\"versionHistory\",image:\"VersionHistory\"});\nZmOperation.registerOp(ZmId.OP_RESTORE_VERSION,{textKey:\"restoreCurrentVersion\",image:\"RestoreVersion\"});\nZmOperation.registerOp(ZmId.OP_DELETE_VERSION,{textKey:\"deleteVersion\",image:\"Delete\"})\n};\nZmBriefcaseApp.prototype._registerSettings=function(a){a=a||appCtxt.getSettings();\na.registerSetting(\"DOCS_ENABLED\",{name:\"zimbraFeatureBriefcaseDocsEnabled\",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true});\na.registerSetting(\"PREVIEW_ENABLED\",{type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false});\na.registerSetting(\"READING_PANE_LOCATION_BRIEFCASE\",{name:\"zimbraPrefBriefcaseReadingPaneLocation\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true})\n};\nZmBriefcaseApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.BRIEFCASE_ITEM,{app:ZmApp.BRIEFCASE,nameKey:\"file\",icon:\"GenericDoc\",soapCmd:\"ItemAction\",itemClass:\"ZmBriefcaseItem\",node:\"doc\",organizer:ZmOrganizer.BRIEFCASE,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.BRIEFCASE],searchType:\"document\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"BriefcaseCore\");\nreturn new ZmList(ZmItem.BRIEFCASE_ITEM,a)\n},this)})\n};\nZmBriefcaseApp.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.BRIEFCASE,{app:ZmApp.BRIEFCASE,nameKey:\"folder\",defaultFolder:ZmOrganizer.ID_BRIEFCASE,soapCmd:\"FolderAction\",firstUserId:256,orgClass:\"ZmBriefcase\",orgPackage:\"BriefcaseCore\",treeController:\"ZmBriefcaseTreeController\",labelKey:\"briefcaseFolders\",itemsKey:\"files\",treeType:ZmOrganizer.FOLDER,views:[\"document\"],folderKey:\"briefcase\",mountKey:\"mountFolder\",createFunc:\"ZmOrganizer.create\",compareFunc:\"ZmFolder.sortCompareNonMail\",deferrable:true,newOp:ZmOperation.NEW_BRIEFCASE,displayOrder:100,hasColor:true,defaultColor:ZmOrganizer.C_NONE,childWindow:true})\n};\nZmBriefcaseApp.prototype._setupSearchToolbar=function(){ZmSearchToolBar.addMenuItem(ZmItem.BRIEFCASE_ITEM,{msgKey:\"files\",tooltipKey:\"searchForFiles\",icon:\"Doc\",shareIcon:null,setting:ZmSetting.BRIEFCASE_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_BRIEFCASE),disableOffline:true})\n};\nZmBriefcaseApp.prototype._registerApp=function(){var c={};\nc[ZmOperation.NEW_DOC]=\"document\";\nvar b={};\nb[ZmOperation.NEW_BRIEFCASE]=\"briefcase\";\nvar a={};\na[ZmKeyMap.NEW_FILE]=ZmOperation.NEW_FILE;\na[ZmKeyMap.NEW_BRIEFCASE]=ZmOperation.NEW_BRIEFCASE;\na[ZmKeyMap.NEW_DOC]=ZmOperation.NEW_DOC;\nZmApp.registerApp(ZmApp.BRIEFCASE,{mainPkg:\"Briefcase\",nameKey:\"briefcase\",icon:\"Briefcase\",textPrecedence:30,chooserTooltipKey:\"gotoBriefcase\",defaultSearch:ZmItem.BRIEFCASE_ITEM,organizer:ZmOrganizer.BRIEFCASE,overviewTrees:[ZmOrganizer.BRIEFCASE,ZmOrganizer.TAG],searchTypes:[ZmItem.BRIEFCASE_ITEM],newItemOps:c,newOrgOps:b,actionCodes:a,gotoActionCode:ZmKeyMap.GOTO_BRIEFCASE,newActionCode:ZmKeyMap.NEW_DOC,chooserSort:70,defaultSort:60,searchResultsTab:true})\n};\nZmBriefcaseApp.prototype.createNotify=function(d,f){if(!d.folder&&!d.doc&&!d.link){return\n}if(!f&&!this._noDefer&&this._deferNotifications(\"create\",d)){return\n}for(var a in d){var e=d[a];\nfor(var c=0;\n(e!=null)&&c<e.length;\nc++){var b=e[c];\nif(appCtxt.cacheGet(b.id)){continue\n}if(a==\"folder\"){this._handleCreateFolder(b,ZmOrganizer.BRIEFCASE)\n}else{if(a==\"link\"){this._handleCreateLink(b,ZmOrganizer.BRIEFCASE)\n}else{if(a==\"doc\"){var g=AjxDispatcher.run(\"GetBriefcaseController\");\ng.handleCreateNotify(b)\n}}}}}};\nZmBriefcaseApp.prototype.modifyNotify=function(c,a){if(!c.doc){return\n}var b=AjxDispatcher.run(\"GetBriefcaseController\");\nb.handleModifyNotify(c)\n};\nZmBriefcaseApp.prototype.handleOp=function(c){switch(c){case ZmOperation.NEW_FILE:var a=new AjxCallback(this,this._handleNewItem);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],false,a,null,true);\nbreak;\ncase ZmOperation.NEW_BRIEFCASE:var a=new AjxCallback(this,this._handleLoadNewBriefcase);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],false,a,null,true);\nbreak;\ncase ZmOperation.NEW_DOC:var b=new AjxCallback(this,this.newDoc,[ZmMimeTable.APP_ZIMBRA_DOC]);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],true,b,null);\nbreak\n}};\nZmBriefcaseApp.prototype.newDoc=function(i,a,g){var b=appCtxt.getOverviewController();\nvar d=b.getTreeController(ZmOrganizer.BRIEFCASE);\nvar c=ZmOrganizer.ID_BRIEFCASE;\nif(d){var e=d.getTreeView(this.getOverviewId());\nvar h=e?e.getSelected():null;\nc=h?h.id:ZmOrganizer.ID_BRIEFCASE\n}if(AjxDispatcher.run(\"GetBriefcaseController\").chkFolderPermission(c)){if(i==ZmMimeTable.APP_ZIMBRA_DOC){var f=appCtxt.getNewWindow(false,null,null,g);\nif(f){f.command=\"documentEdit\";\nf.params={name:a,folderId:c}\n}}}};\nZmBriefcaseApp.getDocWindowFeatures=function(){return[\"width=\",(screen.width||640),\",\",\"height=\",(screen.height||480),\",\",\"scrollbars=yes,\",\"resizable=yes\"].join(\"\")\n};\nZmBriefcaseApp.prototype._handleNewItem=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nAjxDispatcher.run(\"GetBriefcaseController\").__popupUploadDialog(ZmMsg.uploadFileToBriefcase)\n};\nZmBriefcaseApp.prototype._handleLoadNewBriefcase=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\nif(!this._newBriefcaseCb){this._newBriefcaseCb=this._newBriefcaseCallback.bind(this)\n}ZmController.showDialog(appCtxt.getNewBriefcaseDialog(),this._newBriefcaseCb)\n};\nZmBriefcaseApp.prototype.launch=function(c,d){this._setLaunchTime(this.toString(),new Date());\nvar a=this._handleLoadLaunch.bind(this,d);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],true,a,null,true);\nif(appCtxt.isExternalAccount()){var b=appCtxt.getAppController().getNewButton();\nb.removePullDownMenuOptions()\n}};\nZmBriefcaseApp.prototype._handleLoadLaunch=function(a){this.search();\nif(a){a.run()\n}};\nZmBriefcaseApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newDocument,tooltip:ZmMsg.newDocument,icon:\"NewDoc\",iconDis:\"NewDocDis\",defaultId:ZmOperation.NEW_DOC,disabled:!this.containsWritableFolder()}\n};\nZmBriefcaseApp.prototype.search=function(e){e=e||{};\nvar a=e.folderId||(appCtxt.isExternalAccount()?this.getDefaultFolderId():ZmOrganizer.ID_BRIEFCASE);\nvar b=appCtxt.getById(a);\nvar d={query:e.query||b.createQuery(),types:[ZmItem.BRIEFCASE_ITEM],limit:this.getLimit(),searchFor:ZmId.ITEM_BRIEFCASE,callback:e.callback,accountName:e.accountName,noRender:e.noRender};\nvar c=appCtxt.getSearchController();\nc.searchAllAccounts=false;\nc.search(d)\n};\nZmBriefcaseApp.prototype.showSearchResults=function(b,d,c){var a=this._handleLoadShowSearchResults.bind(this,b,d,c);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],false,a,null,true)\n};\nZmBriefcaseApp.prototype._handleLoadShowSearchResults=function(b,e,c){var d=c?c.getCurrentViewId():ZmApp.MAIN_SESSION;\nvar a=AjxDispatcher.run(\"GetBriefcaseController\",d,c);\na.show(b);\nthis._setLoadedTime(this.toString(),new Date());\nif(e){e.run(a)\n}};\nZmBriefcaseApp.prototype.setActive=function(a){};\nZmBriefcaseApp.prototype.getLimit=function(b){var a=appCtxt.get(ZmSetting.PAGE_SIZE);\nreturn b?a:2*a\n};\nZmBriefcaseApp.prototype._newBriefcaseCallback=function(d,c,b){appCtxt.getNewBriefcaseDialog().popdown();\nvar a=appCtxt.getOverviewController();\na.getTreeController(ZmOrganizer.BRIEFCASE)._doCreate(d,c,b)\n};\nZmBriefcaseApp.prototype.getBriefcaseController=function(b,a){return this.getSessionController({controllerClass:\"ZmBriefcaseController\",sessionId:b||ZmApp.MAIN_SESSION,searchResultsController:a})\n};\nZmBriefcaseApp.prototype.createFromAttachment=function(d,c,b){var a=new AjxCallback(this,this._handleCreateFromAttachment,[d,c,b]);\nAjxDispatcher.require([\"BriefcaseCore\",\"Briefcase\"],false,a)\n};\nZmBriefcaseApp.prototype._handleCreateFromAttachment=function(c,b,a){if(this._deferredFolders.length!=0){this._createDeferredFolders(ZmApp.BRIEFCASE)\n}AjxDispatcher.run(\"GetBriefcaseController\").createFromAttachment(c,b,a)\n};\nZmBriefcaseApp.prototype._createDeferredFolders=function(a){AjxPackage.require(\"BriefcaseCore\");\nZmApp.prototype._createDeferredFolders.call(this,a)\n};\nZmBriefcaseApp.prototype.initExternalDndUpload=function(e,n,m,k,a){var u=\"\";\nif(!AjxEnv.supportsHTML5File){if(k){k.run()\n}return\n}if(!e){e=n.files\n}var l=0;\nif(e){var t;\nvar q=[];\nvar h={};\nvar g=ZmAppCtxt.handleWindowOpener();\nvar d=g.get(ZmSetting.DOCUMENT_SIZE_LIMIT);\nvar c=AjxDispatcher.run(\"GetBriefcaseController\");\nif(!a){if(c){a=c.getFolderId()\n}if(!a||a==ZmOrganizer.ID_TRASH){a=ZmOrganizer.ID_BRIEFCASE\n}}if(this.chkFolderPermission(a)){var s=appCtxt.getById(a);\nvar f=appCtxt.getZmUploadManager();\nvar h=[];\nfor(var o=0;\no<e.length;\no++){var j=f.getErrors(e[o],d);\nif(j){h.push(j)\n}}if(h.length>0){var b=f.createUploadErrorMsg(h,d,\"<br>\");\nvar p=appCtxt.getMsgDialog();\np.setMessage(b,DwtMessageDialog.WARNING_STYLE);\np.popup()\n}else{var r={attachment:false,uploadFolder:s,files:e,notes:\"\",allResponses:null,start:0,curView:null,preAllCallback:null,initOneUploadCallback:null,progressCallback:null,errorCallback:null,completeOneCallback:null,completeAllCallback:this.uploadSaveDocs.bind(this),completeDocSaveCallback:this._finishUpload.bind(this,null)};\nf.upload(r)\n}}}};\nZmBriefcaseApp.prototype.chkFolderPermission=function(a){var c=appCtxt.getById(a);\nif(c.isRemote()&&c.isReadOnly()){var b=appCtxt.getMsgDialog();\nb.setMessage(ZmMsg.errorPermissionCreate,DwtMessageDialog.WARNING_STYLE);\nb.popup();\nreturn false\n}return true\n};\nZmBriefcaseApp.prototype.uploadSaveDocs=function(k,e,f,j){if(f!=AjxPost.SC_OK){var l=appCtxt.getAppController().createErrorMessage(ZmItem.BRIEFCASE,f);\nthis._popupErrorDialog(l,e.errorCallback)\n}else{var h;\nif(k){h=[];\nvar a=e.files;\nif(k.length===a.length){for(var g=0;\ng<a.length;\ng++){var c=a[g];\nvar d=k[g];\nvar b=(d&&d.aid);\nh.push({name:c.name,fullname:c.name,notes:e.notes,version:c.version,id:c.id,guid:b,preventDuplicate:c.preventDuplicate})\n}e.docFiles=h\n}}else{h=e.docFiles;\nif(j){j=j.split(\",\");\nfor(var g=0;\ng<h.length;\ng++){h[g].guid=j[g]\n}}}if(e.uploadFolder){this._uploadSaveDocs2(e)\n}else{this._completeUpload(e)\n}}};\nZmBriefcaseApp.prototype._popupErrorDialog=function(c,a){if(a){a.run()\n}var b=appCtxt.getMsgDialog();\nb.setMessage(c,DwtMessageDialog.CRITICAL_STYLE);\nb.popup()\n};\nZmBriefcaseApp.prototype._uploadSaveDocs2=function(d){var e=[];\nvar h=false;\nvar g=d.docFiles;\nfor(var f=0;\nf<g.length;\nf++){var c=g[f];\nif(c.done){continue\n}h=true;\nvar a={_jsns:\"urn:zimbraMail\",requestId:f,doc:{}};\nvar j=a.doc;\nif(c.id){j.id=c.id;\nj.ver=c.version\n}else{j.l=d.uploadFolder.id\n}if(c.notes){j.desc=c.notes\n}j.upload={id:c.guid};\ne.push(a)\n}if(h){var m={BatchRequest:{_jsns:\"urn:zimbra\",onerror:\"continue\",SaveDocumentRequest:((e.length==1)?e[0]:e)}};\nvar l=this._uploadSaveDocsResponse.bind(this,d);\nvar b={jsonObj:m,asyncMode:true,callback:l};\nvar k=appCtxt.getAppController();\nk.sendRequest(b)\n}else{this._completeUpload(d)\n}};\nZmBriefcaseApp.prototype._uploadSaveDocsResponse=function(A,b){var o=b&&b._data&&b._data.BatchResponse;\nvar y=A.docFiles;\nif(o&&o.SaveDocumentResponse){for(var v=0;\nv<o.SaveDocumentResponse.length;\nv++){var a=o.SaveDocumentResponse[v];\ny[a.requestId].done=true;\ny[a.requestId].name=a.doc[0].name;\ny[a.requestId].id=a.doc[0].id;\ny[a.requestId].ver=a.doc[0].ver;\ny[a.requestId].version=a.doc[0].ver\n}}var m=false;\nvar g=false;\nvar e=false;\nvar k=false;\nvar c=0;\nvar l=[];\nif(o&&o.Fault){var j=[];\nvar e=false,d=\"Unknown\",x=\"Unknown\";\nfor(var v=0;\nv<o.Fault.length;\nv++){var h=o.Fault[v];\nvar t=h.Detail.Error;\nc=t.Code;\nvar q=t.a;\nk=(c==ZmCsfeException.LOCKED);\nvar z=y[h.requestId];\nif((c==ZmCsfeException.MAIL_ALREADY_EXISTS)&&z.preventDuplicate){g=true\n}else{if(c==ZmCsfeException.MAIL_ALREADY_EXISTS||c==ZmCsfeException.MODIFY_CONFLICT){for(var n in q){var r=q[n];\nswitch(r.n){case\"itemId\":z.id=r._content;\nbreak;\ncase\"id\":z.id=r._content;\nbreak;\ncase\"ver\":z.version=r._content;\nbreak;\ncase\"name\":z.name=r._content;\nbreak\n}}z.version=z.version||1;\nl.push(z)\n}else{if(c==ZmCsfeException.MAIL_QUOTA_EXCEEDED){m=true\n}else{if(c===ZmCsfeException.UPLOAD_REJECTED){e=true;\nfor(var n in q){var r=q[n];\nswitch(r.n){case\"reason\":x=r._content;\nbreak;\ncase\"name\":d=r._content;\nbreak\n}}}}j[h.requestId]=h\n}}}}if(A.preResolveConflictCallback){A.preResolveConflictCallback.run()\n}if(m){this._popupErrorDialog(ZmMsg.errorQuotaExceeded,A.errorCallback);\nreturn\n}else{if(g){this._popupErrorDialog(AjxMessageFormat.format(ZmMsg.itemWithFileNameExits,z.name),A.errorCallback);\nreturn\n}else{if(k){this._popupErrorDialog(ZmMsg.errorItemLocked,A.errorCallback);\nreturn\n}else{if(e){var f=AjxMessageFormat.format(ZmMsg.uploadRejectedError,[d,x]);\nthis._popupErrorDialog(f,A.errorCallback);\nreturn\n}else{if(c==ZmCsfeException.SVC_PERM_DENIED){this._popupErrorDialog(ZmMsg.errorPermissionDenied,A.errorCallback);\nreturn\n}}}}}var u=l.length;\nvar s=A.conflictAction||ZmBriefcaseApp.ACTION_KEEP_MINE;\nif(u>0&&s==ZmBriefcaseApp.ACTION_ASK){var w=appCtxt.getUploadConflictDialog();\nw.popup(A.uploadFolder,l,this._uploadSaveDocs2.bind(this,A))\n}else{if(u>0&&s==ZmBriefcaseApp.ACTION_KEEP_MINE){if(A.conflictAction){this._shieldSaveDocs(A)\n}else{this._uploadSaveDocs2(A)\n}}else{this._completeUpload(A)\n}}};\nZmBriefcaseApp.prototype._shieldSaveDocs=function(b){var a=appCtxt.getYesNoMsgDialog();\na.reset();\na.setButtonListener(DwtDialog.YES_BUTTON,new AjxListener(this,this._shieldSaveDocsYesCallback,[a,b]));\na.setMessage(ZmMsg.uploadConflictShield,DwtMessageDialog.WARNING_STYLE,ZmMsg.uploadConflict);\na.popup()\n};\nZmBriefcaseApp.prototype._shieldSaveDocsYesCallback=function(b,a){this._uploadSaveDocs2(a);\nb.popdown()\n};\nZmBriefcaseApp.prototype._completeUpload=function(a){if(a.completeDocSaveCallback){a.completeDocSaveCallback.run(a.docFiles,a.uploadFolder)\n}};\nZmBriefcaseApp.prototype._finishUpload=function(a,d,f){var e=[];\nfor(var c in d){var b=d[c].name;\ne.push(b)\n}this._handlePostUpload(f,e,d);\nif(a){a(d)\n}};\nZmBriefcaseApp.prototype._handlePostUpload=function(c,b,a){var d=ZmMsg.successfullyUploaded;\nif(a.length>1){d=AjxMessageFormat.format(ZmMsg.successfullyUploadedFiles,a.length)\n}appCtxt.setStatusMsg(d,ZmStatusView.LEVEL_INFO);\nvar e=AjxDispatcher.run(\"GetBriefcaseController\");\ne.resetSelection()\n};\nZmBriefcaseApp.ACTION_KEEP_MINE=\"mine\";\nZmBriefcaseApp.ACTION_KEEP_THEIRS=\"theirs\";\nZmBriefcaseApp.ACTION_ASK=\"ask\"\n}if(AjxPackage.define(\"zimbraMail.voicemail.ZmVoiceApp\")){ZmVoiceApp=function(b,a){this.phones=[];\nthis._nameToPhone={};\nthis.accordionItem=null;\nthis.soapInfo={method:\"SearchVoiceRequest\",namespace:\"urn:zimbraVoice\",response:\"SearchVoiceResponse\",additional:null};\nthis._storeprincipal=null;\nZmApp.call(this,ZmApp.VOICE,b,a)\n};\nZmEvent.S_VOICEMAIL=ZmId.APP_VOICE;\nZmItem.VOICEMAIL=ZmId.ITEM_VOICEMAIL;\nZmEvent.S_CALL=ZmId.ITEM_CALL;\nZmItem.CALL=ZmEvent.S_CALL;\nZmOrganizer.VOICE=ZmEvent.S_VOICEMAIL;\nZmApp.VOICE=\"Voice\";\nZmApp.CLASS[ZmApp.VOICE]=\"ZmVoiceApp\";\nZmApp.SETTING[ZmApp.VOICE]=ZmSetting.VOICE_ENABLED;\nZmApp.UPSELL_SETTING[ZmApp.VOICE]=ZmSetting.VOICE_UPSELL_ENABLED;\nZmApp.LOAD_SORT[ZmApp.VOICE]=80;\nZmApp.QS_ARG[ZmApp.VOICE]=\"voice\";\nZmVoiceApp.overviewFallbackApp=ZmApp.PORTAL;\nZmVoiceApp.prototype=new ZmApp;\nZmVoiceApp.prototype.constructor=ZmVoiceApp;\nZmVoiceApp.prototype.isZmVoiceApp=true;\nZmVoiceApp.prototype.toString=function(){return\"ZmVoiceApp\"\n};\nZmVoiceApp.AUDIO_MP3_FORMAT=\"audio/mpeg\";\nZmVoiceApp.AUDIO_WAV_FORMAT=\"audio/wav\";\nZmVoiceApp.ERROR_CODE_AUTH=\"voice.UNABLE_TO_AUTH\";\nZmVoiceApp.audioType=ZmVoiceApp.AUDIO_MP3_FORMAT;\nZmVoiceApp.hasTrashFolder=false;\nZmVoiceApp.prototype._defineAPI=function(){AjxDispatcher.setPackageLoadFunction(\"Voicemail\",new AjxCallback(this,this._postLoadCore));\nAjxDispatcher.registerMethod(\"GetVoiceController\",\"Voicemail\",new AjxCallback(this,this.getVoiceController));\nAjxDispatcher.registerMethod(\"GetCallListController\",\"Voicemail\",new AjxCallback(this,this.getCallListController))\n};\nZmVoiceApp.prototype._registerItems=function(){ZmItem.registerItem(ZmItem.VOICEMAIL,{app:ZmApp.VOICE,nameKey:\"voicemail\",icon:\"Voicemail\",soapCmd:\"VoiceMsgAction\",itemClass:\"ZmVoicemail\",node:\"vm\",organizer:ZmOrganizer.VOICE,dropTargets:[ZmOrganizer.VOICE],searchType:\"voicemail\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"Voicemail\");\nreturn new ZmVoiceList(ZmItem.VOICEMAIL,a)\n},this)});\nZmItem.registerItem(ZmItem.CALL,{app:ZmApp.VOICE,nameKey:\"call\",icon:\"Voicemail\",soapCmd:\"VoiceMsgAction\",itemClass:\"ZmCall\",node:\"cl\",organizer:ZmOrganizer.VOICE,searchType:\"calllog\",resultsList:AjxCallback.simpleClosure(function(a){AjxDispatcher.require(\"Voicemail\");\nreturn new ZmVoiceList(ZmItem.CALL,a)\n},this)})\n};\nZmVoiceApp.prototype._registerOperations=function(){ZmOperation.registerOp(ZmId.OP_CALL_BACK,{textKey:\"callBack\",image:\"CallManager\",tooltipKey:\"callBackTooltip\"});\nZmOperation.registerOp(ZmId.OP_MARK_HEARD,{textKey:\"markAsHeard\",image:\"MarkAsHeard\",shortcut:ZmKeyMap.MARK_HEARD});\nZmOperation.registerOp(ZmId.OP_MARK_UNHEARD,{textKey:\"markAsUnheard\",image:\"MarkAsUnheard\",shortcut:ZmKeyMap.MARK_UNHEARD});\nZmOperation.registerOp(ZmId.OP_VIEW_BY_DATE,{textKey:\"viewByDate\"});\nZmOperation.registerOp(ZmId.OP_REPLY_BY_EMAIL,{textKey:\"replyByEmail\",tooltipKey:\"replyByEmailTooltip\",image:\"Reply\"});\nZmOperation.registerOp(ZmId.OP_FORWARD_BY_EMAIL,{textKey:\"forwardByEmail\",tooltipKey:\"forwardByEmailTooltip\",image:\"Forward\"});\nZmOperation.registerOp(ZmId.OP_DOWNLOAD_VOICEMAIL,{textKey:\"downloadVoicemail\",tooltipKey:\"downloadVoicemailTooltip\",image:\"Save\"});\nZmOperation.registerOp(ZmId.OP_NEW_CALL,{textKey:\"newCall\",tooltipKey:\"newCallTooltip\",shortcut:ZmKeyMap.NEW_CALL,image:\"PlacedCalls\"})\n};\nZmVoiceApp.prototype._registerOrganizers=function(){ZmOrganizer.registerOrg(ZmOrganizer.VOICE,{app:ZmApp.VOICE,nameKey:\"voicemailFolder\",defaultFolder:0,firstUserId:256,orgClass:\"ZmVoiceFolder\",orgPackage:\"Voicemail\",treeController:\"ZmVoiceTreeController\",labelKey:\"voicemail\",itemsKey:\"messages\",views:[\"voicemail\"],createFunc:\"ZmOrganizer.create\",compareFunc:\"ZmVoiceFolder.sortCompare\",displayOrder:100,deferrable:false})\n};\nZmVoiceApp.prototype._registerApp=function(){var a={};\na[ZmOperation.NEW_CALL]=\"call\";\nZmApp.registerApp(ZmApp.VOICE,{mainPkg:\"Voicemail\",nameKey:\"voice\",icon:\"VoicemailApp\",qsArg:\"voicemail\",chooserTooltipKey:\"goToVoice\",defaultSearch:ZmId.SEARCH_MAIL,overviewTrees:[ZmOrganizer.VOICE],searchTypes:[ZmItem.VOICEMAIL],gotoActionCode:ZmKeyMap.GOTO_VOICE,chooserSort:15,defaultSort:15,newItemOps:a,upsellUrl:ZmSetting.VOICE_UPSELL_URL})\n};\nZmVoiceApp.prototype._registerPrefs=function(){};\nZmVoiceApp.prototype._registerSettings=function(a){a=a||appCtxt.getSettings();\na.registerSetting(\"VOICE_PAGE_SIZE\",{name:\"zimbraPrefVoiceItemsPerPage\",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:25});\na.registerSetting(\"VOICE_PAGE_SIZE_MAX\",{name:\"zimbraMaxVoiceItemsPerPage\",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100})\n};\nZmVoiceApp.prototype.handleOp=function(a){switch(a){case ZmOperation.NEW_CALL:this.displayClickToCallDlg();\nbreak;\ndefault:}};\nZmVoiceApp.prototype.deleteNotify=function(a){this._handleDeletes(a)\n};\nZmVoiceApp.prototype.createNotify=function(a){this._handleCreates(a)\n};\nZmVoiceApp.prototype.modifyNotify=function(a){this._handleModifies(a)\n};\nZmVoiceApp.prototype.getOverviewId=function(){var a=this.accordionItem?this.accordionItem.data.phone.name:\"\";\nreturn[this._name,a].join(\":\")\n};\nZmVoiceApp.prototype.getOverviewContainer=function(){if(!this._overviewContainer){var a=[ZmApp.OVERVIEW_ID,this._name].join(\"_\");\nvar b={appName:this._name,containerId:a,posStyle:Dwt.ABSOLUTE_STYLE,parent:appCtxt.getShell(),controller:appCtxt.getOverviewController()};\nb.id=ZmId.getOverviewContainerId(a);\nthis._overviewContainer=appCtxt.getOverviewController()._overviewContainer[a]=new ZmVoiceOverviewContainer(b)\n}return this._overviewContainer\n};\nZmVoiceApp.prototype.getNewButtonProps=function(){return{text:ZmMsg.newCall,tooltip:ZmMsg.newCallTooltip,icon:\"PlacedCalls\",iconDis:\"PlacedCallsDis\",defaultId:ZmOperation.NEW_CALL}\n};\nZmVoiceApp.prototype.getVoiceInfo=function(g,a,b){if(!this.phones.length){if(!this._gettingVoiceInfo){var c=AjxSoapDoc.create(\"GetVoiceInfoRequest\",\"urn:zimbraVoice\");\nvar f=new AjxCallback(this,this._handleResponseVoiceInfo);\nvar d=new AjxCallback(this,this._handleErrorResponseVoiceInfo);\nvar e={soapDoc:c,asyncMode:true,noBusyOverlay:b,callback:f,errorCallback:d};\nappCtxt.getAppController().sendRequest(e);\nthis._gettingVoiceInfo=true\n}if(g){this._voiceInfoCallbacks=this._voiceInfoCallbacks||[];\nthis._voiceInfoCallbacks.push(g)\n}if(a){this._voiceInfoErrorCallbacks=this._voiceInfoErrorCallbacks||[];\nthis._voiceInfoErrorCallbacks.push(a)\n}}else{if(g){g.run()\n}}};\nZmVoiceApp.prototype._handleResponseVoiceInfo=function(a){var b=new AjxCallback(this,this._handleResponseVoiceInfo2,[a]);\nAjxPackage.require({name:\"Voicemail\",callback:b})\n};\nZmVoiceApp.prototype._handleResponseVoiceInfo2=function(b){var f=b._data.GetVoiceInfoResponse;\nthis._storeprincipal=f.storeprincipal[0];\nthis._setAudioType(f);\nthis.soapInfo.additional={storeprincipal:this._storeprincipal};\nvar c=f.phone;\nfor(var d=0,e=c.length;\nd<e;\nd++){var g=c[d];\nvar a=new ZmPhone();\na._loadFromDom(g);\nthis.phones.push(a);\nthis._nameToPhone[a.name]=a;\nif(g.folder&&g.folder.length){a.folderTree=new ZmVoiceFolderTree();\nif(d==0){this._setHasTrashFolder(g.folder[0].folder)\n}a.folderTree.loadFromJs(g.folder[0],a)\n}}if(this._voiceInfoCallbacks){for(d=0,e=this._voiceInfoCallbacks.length;\nd<e;\nd++){this._voiceInfoCallbacks[d].run(b)\n}}this._voiceInfoCallbacks=null;\nthis._voiceInfoErrorCallbacks=null;\nthis._gettingVoiceInfo=false\n};\nZmVoiceApp.prototype._setAudioType=function(a){if(a.audioType&&a.audioType[0]&&a.audioType[0]._content){ZmVoiceApp.audioType=a.audioType[0]._content\n}};\nZmVoiceApp.prototype._setHasTrashFolder=function(c){if(c&&c.length){var a=c.length;\nfor(var b=0;\nb<a;\nb++){if(c[b].id.indexOf(ZmVoiceFolder.TRASH_ID)==0){ZmVoiceApp.hasTrashFolder=true;\nreturn\n}}}};\nZmVoiceApp.prototype._handleErrorResponseVoiceInfo=function(a){var c=false;\nif(this._voiceInfoErrorCallbacks){for(var b=0,d=this._voiceInfoErrorCallbacks.length;\nb<d;\nb++){c=this._voiceInfoErrorCallbacks[b].run(a)||c\n}}this._voiceInfoCallbacks=null;\nthis._voiceInfoErrorCallbacks=null;\nthis._gettingVoiceInfo=false;\nif(!c){this.processErrors(a)\n}return true\n};\nZmVoiceApp.prototype.refreshFolders=function(e,a){if(this.phones.length){var b=AjxSoapDoc.create(\"GetVoiceFolderRequest\",\"urn:zimbraVoice\");\nthis.setStorePrincipal(b);\nvar d=new AjxCallback(this,this._handleResponseUpdateFolders,[e]);\nvar c={soapDoc:b,asyncMode:true,callback:d,errorCallback:a};\nappCtxt.getAppController().sendRequest(c)\n}else{if(e){e.run()\n}}};\nZmVoiceApp.prototype._handleResponseUpdateFolders=function(g,b){var c=b._data.GetVoiceFolderResponse.phone;\nfor(var d=0,e=c.length;\nd<e;\nd++){var f=c[d];\nvar a=this._nameToPhone[f.name];\nif(a){this._updateFolders(a,f.folder[0].folder)\n}}if(g){g.run()\n}};\nZmVoiceApp.prototype._updateFolders=function(b,g){var f=b.folderTree;\nfor(var c=0,e=g.length;\nc<e;\nc++){var a=g[c];\nvar d=f.getByName(a.name);\nif(d){d.notifyModify(a)\n}}};\nZmVoiceApp.prototype.search=function(d,g,f){var a=(d.getSearchType()==ZmItem.VOICEMAIL)?ZmId.VIEW_VOICEMAIL:ZmId.VIEW_CALL_LIST;\nif((a==ZmId.VIEW_VOICEMAIL)&&!d.phone.hasVoiceMail){AjxDispatcher.run(\"GetVoiceController\").show(null,d);\nthis._setupOverviewContainer();\nif(g){g.run(null)\n}}else{if(!f){f=appCtxt.get(ZmSetting.SORTING_PREF,a)\n}var e={soapInfo:this.soapInfo,types:AjxVector.fromArray([d.getSearchType()]),sortBy:f,query:d.getSearchQuery(),limit:this.getLimit()};\nvar b=new ZmSearch(e);\nvar c=new AjxCallback(this,this._handleResponseSearch,[d,g]);\nb.execute({callback:c})\n}};\nZmVoiceApp.prototype._handleResponseSearch=function(a,i,b){var d=b._data;\nvar e=d.getResults(a.getSearchType());\ne.folder=a;\nvar g=(a.getSearchType()==ZmItem.VOICEMAIL)?AjxDispatcher.run(\"GetVoiceController\"):AjxDispatcher.run(\"GetCallListController\");\ng.show(d,a);\nthis._setupOverviewContainer();\nthis.selectFolderInOverview(a);\nvar c=d.getAttribute(\"vfi\");\nif(c){a.notifyModify(c[0])\n}if(this._paramId){var f=g.getList();\nvar j=f.getById(this._paramId);\nif(j){var h=g.getListView();\nh.setSelection(j,true);\nh.setPlaying(j)\n}}if(i){i.run(d)\n}};\nZmVoiceApp.prototype._setupOverviewContainer=function(){this.getOverviewContainer();\nif(!this._overviewContainer.initialized){var a=this._getOverviewParams();\na.overviewTrees=this._getOverviewTrees();\na.phones=this.phones;\nthis._overviewContainer.initialize(a)\n}};\nZmVoiceApp.prototype.markItemsHeard=function(b,c,e,a){var d=c?\"read\":\"!read\";\nthis._performAction(b,d,null,e,a)\n};\nZmVoiceApp.prototype._performAction=function(j,g,d,l,f){if(!j.length){if(l){l.run(j)\n}return\n}var a=[];\nfor(var e=0,h=j.length;\ne<h;\ne++){a[e]=j[e].id\n}var k=AjxSoapDoc.create(\"VoiceMsgActionRequest\",\"urn:zimbraVoice\");\nthis.setStorePrincipal(k);\nvar b=k.set(\"action\");\nb.setAttribute(\"op\",g);\nb.setAttribute(\"id\",a.join(\",\"));\nb.setAttribute(\"phone\",j[0].getPhone().name);\nfor(var e in d){b.setAttribute(e,d[e])\n}var c={soapDoc:k,asyncMode:true,callback:l,errorCallback:f};\nappCtxt.getAppController().sendRequest(c)\n};\nZmVoiceApp.prototype.launch=function(a,b){this._showApp(a,b)\n};\nZmVoiceApp.prototype._showApp=function(b,c){this._paramId=(b.qsParams?b.qsParams.id:null);\nvar a=new AjxCallback(this,this._handleLoadLaunch,[c]);\nAjxDispatcher.require(\"Voicemail\",true,a,null,true)\n};\nZmVoiceApp.prototype._handleLoadLaunch=function(c){var b=new AjxCallback(this,this._handleResponseLoadLaunchGotInfo,c);\nvar a=new AjxCallback(this,this._handleErrorLoadLaunchGotInfo,c);\nthis.getVoiceInfo(b,a)\n};\nZmVoiceApp.prototype._handleErrorLoadLaunchGotInfo=function(d,a){var c;\nthis._loadError=true;\nswitch(a.code){case\"voice.SECONDARY_NOT_ALLOWED\":case\"voice.ACCOUNT_NOT_CPNI_COMPLIANT\":case\"voice.ACCOUNT_CPNI_NOT_AVAILABLE\":this._showUpsellMessage(a.code);\nc=true;\nbreak;\ncase\"voice.UNABLE_TO_RETRIEVE_PROFILE_SUMMARY\":default:var b=appCtxt.getApp(ZmVoiceApp.overviewFallbackApp);\nif(b){b.launch()\n}c=false;\nbreak\n}this.setOverviewPanelContent(false);\nif(d instanceof AjxCallback){d.run()\n}return c\n};\nZmVoiceApp.prototype._showUpsellMessage=function(b){if(!this._showingSecondaryMessage){this._showingSecondaryMessage=true;\nvar a=new DwtControl({parent:appCtxt.getShell(),posStyle:Dwt.ABSOLUTE_STYLE});\na.setScrollStyle(DwtControl.SCROLL);\nvar d=null;\nif(b==\"voice.ACCOUNT_NOT_CPNI_COMPLIANT\"||b==\"voice.ACCOUNT_CPNI_NOT_AVAILABLE\"){d=ZMsg[b+\"_PREFS\"]\n}a.getHtmlElement().innerHTML=d||ZMsg[\"voice.SECONDARY_NOT_ALLOWED_VOICE\"];\nvar e={};\ne[ZmAppViewMgr.C_APP_CONTENT]=a;\nvar c=[ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_TOOLBAR_TOP,ZmAppViewMgr.C_SASH];\nvar f=\"VoiceMessage\";\nthis.createView({viewId:f,appName:this._name,controller:appCtxt.getAppController(),elements:e,hide:c,isFullScreen:true,isAppView:true});\nthis.pushView(f,true)\n}};\nZmVoiceApp.prototype._handleResponseLoadLaunchGotInfo=function(c,a){this._loadError=false;\nvar b=this.getStartFolder();\nif(b){this.search(b,c)\n}else{if(c){c.run()\n}}};\nZmVoiceApp.prototype.setStartPhone=function(a,c){this._startPhone=a;\nif(c){var b=this.getStartFolder();\nif(this.view!=ZmId.VIEW_VOICEMAIL){this.pushView(ZmId.VIEW_VOICEMAIL)\n}if(this.getVoiceController().getFolder()!=b){this.search(b);\nthis.getVoiceController().setFolder(b,true)\n}this.selectFolderInOverview(b)\n}};\nZmVoiceApp.prototype.getStartFolder=function(b){var e=0;\nvar c=0;\nvar d=b||this._startPhone;\nif(d){for(c=0;\nc<this.phones.length;\nc++){var a=this.phones[c];\nif(a.name==d){e=c\n}}}else{for(c=0;\nc<this.phones.length;\nc++){var a=this.phones[c];\nif(a.hasVoiceMail){e=c;\nbreak\n}}}return this.phones[e].folderTree.getByName(ZmVoiceFolder.VOICEMAIL)\n};\nZmVoiceApp.prototype.selectFolderInOverview=function(a){var c=this.getOverviewContainer().getOverviews();\nfor(id in c){var b=c[id];\nif(b.phone==a.phone){b.setSelected(a.id,\"Voice\")\n}else{b.itemSelected(null)\n}}};\nZmVoiceApp.prototype.getVoiceController=function(){if(!this._voiceController){this._voiceController=new ZmVoicemailListController(this._container,this)\n}return this._voiceController\n};\nZmVoiceApp.prototype.getCallListController=function(){if(!this._callListController){this._callListController=new ZmCallListController(this._container,this)\n}return this._callListController\n};\nZmVoiceApp.prototype.setStorePrincipal=function(b){var c=b.set(\"storeprincipal\");\nfor(var a in this._storeprincipal){c.setAttribute(a,this._storeprincipal[a])\n}};\nZmVoiceApp.prototype.setOverviewPanelContent=function(b){if((this._showingSecondaryMessage||this._loadError)&&ZmVoiceApp.overviewFallbackApp){var a=appCtxt.getApp(ZmVoiceApp.overviewFallbackApp);\nif(a){return a.setOverviewPanelContent(b)\n}}return ZmApp.prototype.setOverviewPanelContent.call(this,b)\n};\nZmVoiceApp.prototype.redoSearch=function(){var b=appCtxt.getAppViewMgr().getAppView(ZmApp.VOICE);\nif(b){var a;\nif(b==ZmId.VIEW_VOICEMAIL){a=AjxDispatcher.run(\"GetVoiceController\")\n}else{if(b==ZmId.VIEW_CALL_LIST){a=AjxDispatcher.run(\"GetCallListController\")\n}}if(a){this.search(a.getFolder())\n}}};\nZmVoiceApp.prototype._handleDeletes=function(a){};\nZmVoiceApp.prototype._handleCreates=function(a){};\nZmVoiceApp.prototype._handleModifies=function(a){};\nZmVoiceApp.prototype._getOverviewTrees=function(){return[ZmOrganizer.VOICE]\n};\nZmVoiceApp.prototype.registerUCProvider=function(a){this._UCProvider=a\n};\nZmVoiceApp.prototype.displayClickToCallDlg=function(a){if(this._UCProvider){this._UCProvider.display(a)\n}};\nZmVoiceApp.prototype.processErrors=function(c){var a=ZmMsg.voicemailErrorUnknown;\nif(!c.code){return\n}if(c.code==ZmVoiceApp.ERROR_CODE_AUTH){a=ZmMsg.voicemailErrorAuthFailure\n}if(this._UCProvider){a=this._UCProvider.getErrorDescription(c)||a\n}var b=appCtxt.getErrorDialog();\nb.setMessage(a,a,DwtMessageDialog.CRITICAL_STYLE);\nb.popup();\nreturn\n};\nZmVoiceApp.prototype.hasVoicePIN=function(a){if(this._UCProvider){return this._UCProvider.hasVoicePIN()\n}return true\n}\n}}if(AjxPackage.define(\"dwt.Widgets\")){AjxTemplate.register(\"dwt.Widgets#DwtAlert\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" width=100%><tr><td width=1%><div id=\\'';\na[c++]=e.id;\na[c++]=\"_icon' style='margin-right:5px;'></div></td><td width=99%><table role=\\\"presentation\\\"><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='DwtAlertTitle'></td></tr><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_content' class='DwtAlertContent'></td></tr></table></td><td width=1%><div id='\";\na[c++]=e.id;\na[c++]=\"_dismiss' style='margin-left:5px;'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtAlert\"},false);\nAjxTemplate.register(\"dwt.Widgets\",AjxTemplate.getTemplate(\"dwt.Widgets#DwtAlert\"),AjxTemplate.getParams(\"dwt.Widgets#DwtAlert\"));\nAjxTemplate.register(\"dwt.Widgets#DwtCheckbox\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZCheckboxTable'><tr><td><label id='\";\na[c++]=e.id;\na[c++]=\"_text_left' for='\";\na[c++]=e.id;\na[c++]=\"_input' class='Text' style='text-align:right'></label></td><td><input id='\";\na[c++]=e.id;\na[c++]=\"_input' name='\";\na[c++]=e.name;\na[c++]=\"' value='\";\na[c++]=e.value;\na[c++]=\"' type='\";\na[c++]=e.type;\na[c++]=\"' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_text_left \";\na[c++]=e.id;\na[c++]=\"_text_right'></td><td><label id='\";\na[c++]=e.id;\na[c++]=\"_text_right' for='\";\na[c++]=e.id;\na[c++]=\"_input' class='Text' style='text-align:left'></label></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtCheckbox\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtBaseDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='DwtDialog WindowOuterContainer'><table role=\\\"presentation\\\"><tr id='\";\na[c++]=e.dragId;\na[c++]=\"'><td class='minWidth'>\";\na[c++]=e.icon;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='DwtDialogTitle'>\";\na[c++]=e.title;\na[c++]=\"</td><td class='minWidth'><div class='\";\na[c++]=e.closeIcon2;\na[c++]=\"'></div></td><td class='minWidth'><div class='\";\na[c++]=e.closeIcon1;\na[c++]=\"'></div></td></tr><tr><td class='WindowInnerContainer' colspan='4'><div id='\";\na[c++]=e.id;\na[c++]=\"_content' class='DwtDialogBody'></div>\";\nif(e.controlsTemplateId){a[c++]=AjxTemplate.expand(e.controlsTemplateId,e)\n}a[c++]=\"</td></tr></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"20\",id:\"dwt.Widgets#DwtBaseDialog\",height:\"32\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtDialogControls\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='horizSep' id=\\\"\";\na[c++]=e.id;\na[c++]=\"_buttonsSep\\\"></div><div id='\";\na[c++]=e.id;\na[c++]=\"_buttons' class='DwtDialogButtonBar'>\";\nif(AjxEnv.isNav){a[c++]=\"<input type='button' id='\";\na[c++]=e.id;\na[c++]=\"_focus' style='height:0px;width:0px;display:none;'>\"\n}a[c++]=\"</div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtDialogControls\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtSemiModalDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='DwtDialog LightWindowOuterContainer'><table role=\\\"presentation\\\" style='cursor:move;'><tr id='\";\na[c++]=e.dragId;\na[c++]=\"'><td class='minWidth'>\";\na[c++]=e.icon;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='DwtDialogTitle'>\";\na[c++]=e.title;\na[c++]=\"</td><td class='minWidth'><div class='\";\na[c++]=e.closeIcon2;\na[c++]=\"'></div></td><td class='minWidth'><div class='\";\na[c++]=e.closeIcon1;\na[c++]=\"'></div></td></tr><tr><td class='LightWindowInnerContainer full_size' colspan='4'><div id='\";\na[c++]=e.id;\na[c++]=\"_content' class='DwtDialogBody'></div><div class='horizSep'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_buttons' class='DwtDialogButtonBar'>\";\nif(AjxEnv.isNav){a[c++]=\"<input type='button' id='\";\na[c++]=e.id;\na[c++]=\"_focus' style='height:0px;width:0px;display:none;'>\"\n}a[c++]=\"</div></td></tr></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"20\",id:\"dwt.Widgets#DwtSemiModalDialog\",height:\"32\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtToolTip\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='tooltipContents' class='DwtToolTipBody'></div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"5\",id:\"dwt.Widgets#DwtToolTip\",height:\"5\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtVerticalSash\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='DwtVerticalSash'><div class='VSashContainer'><div class='VSashThumb ImgVSash_thumb'></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"0\",id:\"dwt.Widgets#DwtVerticalSash\",height:\"0\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtHorizontalSash\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='DwtHorizontalSash'><div class='HSashContainer'><div class='HSashThumb ImgHSash_thumb'></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"0\",id:\"dwt.Widgets#DwtHorizontalSash\",height:\"0\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtMissingSoundPlayer\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='DwtMissingSoundPlayer'><tr><td nowrap class='ImgCritical'>&nbsp;</td><td nowrap>\";\na[c++]=ZmMsg.missingPlugin;\na[c++]=\"</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtMissingSoundPlayer\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtVerticalSlider\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgVerticalSliderThumb'></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtVerticalSlider\",\"class\":\"DwtSlider DwtVerticalSlider\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtHorizontalSlider\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgHorizontalSliderThumb'></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtHorizontalSlider\",\"class\":\"DwtSlider DwtHorizontalSlider\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZLabel\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZWidgetTable ZLabelBorder'><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_title'\\t\\tclass='ZWidgetTitle'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_right_icon' \\tclass='ZRightIcon ZWidgetIcon'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZLabel\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"Button\";\nb[d++]='<table role=\"presentation\" class=\\'ZWidgetTable Z';\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border' style='table-layout:auto;' cellspacing='0'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title'\\t\\tclass='ZWidgetTitle'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_right_icon' \\tclass='ZRightIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_dropdown' \\tclass='ZDropDown'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"dwt.Widgets#ZButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZImageOnlyButton\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_left_icon'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZImageOnlyButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarButton\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\ne.buttonClass=e.buttonClass||\"ToolbarButton\";\na[c++]=AjxTemplate.expand(\"#ZButton\",e);\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZBorderlessButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"Button\";\nb[d++]='<table role=\"presentation\" class=\\'ZWidgetTable Z';\nb[d++]=a;\nb[d++]=\"Table' style='table-layout:auto;'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title'\\t\\tclass='ZWidgetTitle'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_right_icon' \\tclass='ZRightIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_dropdown' \\tclass='ZDropDown'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"dwt.Widgets#ZBorderlessButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZLinkButton\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\nif(e.noDropDown){a[c++]=\"<a href='javascript:;' onclick='return false;' id='\";\na[c++]=e.id;\na[c++]=\"_title'></a>\"\n}else{a[c++]=\"<table role=\\\"presentation\\\" class='DwtLinkButtonTable' style='table-layout:auto;'><tr><td class='ZWidgetTitle'><a href='javascript:;' onclick='return false;' id='\";\na[c++]=e.id;\na[c++]=\"_title'></a></td><td id='\";\na[c++]=e.id;\na[c++]=\"_dropdown' class='DwtLinkButtonDropDownArrowTd'><div class='DwtLinkButtonDropDownArrow'><center><div class='DwtLinkButtonDropDownArrowRow' style='width:7px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:5px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:3px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:1px;'>&nbsp;</div></center></div></td></tr></table>\"\n}return d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZLinkButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZButtonColorDisplay\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_color' class='DwtButtonColorPicker-display' unselectable></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZButtonColorDisplay\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtComboBox\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td width=*><div id=\\'';\na[c++]=e.id;\na[c++]=\"_input'></div></td><td><div id='\";\na[c++]=e.id;\na[c++]=\"_button'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtComboBox\",\"class\":\"DwtComboBox\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtComboBoxButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"Button\";\nb[d++]='<table role=\"presentation\" class=\\'Z';\nb[d++]=a;\nb[d++]=\"Border'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_dropdown' class='ZDropDown'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"dwt.Widgets#DwtComboBoxButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_tabbar'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_page'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabView\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBar\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" width='100%'><tr valign='bottom' id='\";\na[c++]=e.id;\na[c++]=\"_items'>\";\na[c++]=AjxTemplate.expand(\"#ZTabBarPrefix\",e);\na[c++]=AjxTemplate.expand(\"#ZTabBarSuffix\",e);\na[c++]=\"</tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBar\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBarPrefix\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<td id='\";\na[c++]=e.id;\na[c++]=\"_prefix'><div class='ZTabBarPrefix'></div></td>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBarPrefix\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBarSuffix\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<td id='\";\na[c++]=e.id;\na[c++]=\"_suffix' width='100%'><div class='ZTabBarSuffix'></div></td>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBarSuffix\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTab\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"Tab\";\nb[d++]='<table role=\"presentation\" id=\\'';\nb[d++]=f.id;\nb[d++]=\"_select' class='Z\";\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border ZWidgetTable ZWidgetBorder'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title' class='ZWidgetTitle'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"dwt.Widgets#ZTab\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBarFloat\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_items'>\";\na[c++]=AjxTemplate.expand(\"#ZTabBarPrefixFloat\",e);\na[c++]=AjxTemplate.expand(\"#ZTabBarSuffixFloat\",e);\na[c++]=\"</div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBarFloat\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBarPrefixFloat\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_prefix' class='ZTabBarPrefix'>&nbsp;</div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBarPrefixFloat\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabBarSuffixFloat\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_suffix' class='ZTabBarSuffix'>&nbsp;</div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabBarSuffixFloat\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabFloat\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"Tab\";\nb[d++]='<table role=\"presentation\" id=\\'';\nb[d++]=f.id;\nb[d++]=\"_select' class='Z\";\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border ZWidgetBorder'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title' class='ZWidgetTitle'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"dwt.Widgets#ZTabFloat\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTabPage\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTabPage\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZSelectAutoSizingContainer\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\"';\na[c++]=e.id;\na[c++]='_select_container\">';\na[c++]=AjxTemplate.expand(e.selectTemplateId,e.selectData);\na[c++]='</td></tr><tr><td><table role=\"presentation\" id=\"';\na[c++]=e.id;\na[c++]='_pseudoitems_container\"></table></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZSelectAutoSizingContainer\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZSelect\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=AjxTemplate.expand(\"#ZButton\",e);\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZSelect\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZSelectMenu\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=AjxTemplate.expand(\"#ZMenu\",e);\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZSelectMenu\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZSelectMenuItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=AjxTemplate.expand(\"#ZMenuItem\",e);\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZSelectMenuItem\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbar\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZToolbarTable'><tr id='\";\na[c++]=e.id;\na[c++]=\"_items'>\";\na[c++]=AjxTemplate.expand(\"#ZToolbarPrefix\",e);\na[c++]=AjxTemplate.expand(\"#ZToolbarSuffix\",e);\na[c++]=\"</tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbar\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarPrefix\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarPrefix\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarSuffix\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarSuffix\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.itemId;\na[c++]=\"'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarItem\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarSeparator\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.itemId;\na[c++]=\"' class='ZToolbarSeparator'>&nbsp;</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarSeparator\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarSpacer\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.itemId;\na[c++]=\"' class='ZToolbarSpacer'>&nbsp;</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarSpacer\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZToolbarFiller\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.itemId;\na[c++]=\"' class='ZToolbarFiller' width='100%'>&nbsp;</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZToolbarFiller\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZField\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<input id='\";\na[c++]=e.id;\na[c++]=\"_field' class='ZFieldInput'>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZField\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZTreeItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='\";\na[c++]=e.divClassName;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_div'><table role=\\\"presentation\\\" id='\";\na[c++]=e.id;\na[c++]='_table\\' style=\"table-layout:fixed; width:100%\"><tr><td style=\"width:20px\" align=center nowrap id=\\'';\na[c++]=e.id;\na[c++]=\"_nodeCell'></td>\";\nif(e.isCheckedStyle){a[c++]='<td style=\"width:20px\" nowrap id=\\'';\na[c++]=e.id;\na[c++]='_checkboxCell\\' class=\"ZTreeItemCheckboxCell\"><div class=\"ZTreeItemCheckbox\" id=\\'';\na[c++]=e.id;\na[c++]=\"_checkbox'><div class=\\\"ZTreeItemCheckboxImg\\\" id='\";\na[c++]=e.id;\na[c++]=\"_checkboxImg'>\";\na[c++]=AjxImg.getImageHtml(\"MenuCheck\");\na[c++]=\"</div></div></td>\"\n}a[c++]=\"<td style=\\\"width:20px\\\" nowrap class='imageCell' id='\";\na[c++]=e.id;\na[c++]=\"_imageCell'></td><td nowrap class='\";\na[c++]=e.textClassName;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_textCell'></td><td class='imageCell' id='\";\na[c++]=e.id;\na[c++]=\"_extraCell'></td></tr></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZTreeItem\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZHeaderTreeItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='\";\na[c++]=e.divClassName;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_div'><table role=\\\"presentation\\\" id='\";\na[c++]=e.id;\na[c++]=\"_table'><tr>\";\nif(!e.noNodeCell){a[c++]=\"<td align=center nowrap id='\";\na[c++]=e.id;\na[c++]=\"_nodeCell'></td>\"\n}a[c++]=\"<td nowrap class='imageCell' id='\";\na[c++]=e.id;\na[c++]=\"_imageCell'></td><td nowrap class='\";\na[c++]=e.textClassName;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_textCell' width=\\\"100%\\\"></td><td class='\";\na[c++]=e.textClassName;\na[c++]=\" FakeAnchor' id='\";\na[c++]=e.id;\na[c++]=\"_optCell'><div id='\";\na[c++]=e.id;\na[c++]=\"_optButton'/></td></tr></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZHeaderTreeItem\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZAccordion\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_div'><table role=\\\"presentation\\\" class='ZAccordionTable ZWidget' id='\";\na[c++]=e.id;\na[c++]=\"_accordion_table'></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZAccordion\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZAccordionItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_header_\";\na[c++]=e.itemNum;\na[c++]=\"' class='ZAccordionHeader'><table role=\\\"presentation\\\" class='ZAccordionHeaderBorder ZWidgetTable'><tr><td><div class='\";\na[c++]=e.icon;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_icon_\";\na[c++]=e.itemNum;\na[c++]=\"'></div></td><td><div class='ZAccordionTitle' id='\";\na[c++]=e.id;\na[c++]=\"_title_\";\na[c++]=e.itemNum;\na[c++]=\"'>\";\na[c++]=e.title;\na[c++]=\"</div></td><td><div class='ImgAccordionClosed' id='\";\na[c++]=e.id;\na[c++]=\"_status_\";\na[c++]=e.itemNum;\na[c++]=\"'></div></td></tr></table></div><div class='ZAccordionBody' id='\";\na[c++]=e.id;\na[c++]=\"_body_\";\na[c++]=e.itemNum;\na[c++]=\"'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZAccordionItem\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtTabView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" width='100%' backgroundColor='\";\na[c++]=e.bgcolor;\na[c++]=\"'><tr align='left' valign='middle'><td id='\";\na[c++]=e.id;\na[c++]=\"_tabs' class='DwtTabTable' nowrap align='left' valign='middle' width='100%'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtTabView\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtTabBar\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<!-- TODO -->\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtTabBar\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtTabSpacer\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" width='100%'><tr></tr><tr></tr><tr><td><div class='ImgTabSpacer'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtTabSpacer\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenu\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_container' class='ZMenuBorder'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenu\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenuItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder'><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_check' class='ZCheckIcon'><div></div></td><td id='\";\na[c++]=e.id;\na[c++]=\"_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='ZWidgetTitle'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_dropdown' class='ZDropDown'><div></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenuItem\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenuItemSeparator\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder ZMenuItemSeparatorBorder'><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='ZWidgetTitle'><div class='ZMenuItem-Separator'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenuItemSeparator\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenuItemBlankCheck\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ZMenuItem-BlankCheck'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenuItemBlankCheck\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenuItemBlankIcon\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ZMenuItem-BlankIcon'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenuItemBlankIcon\"},false);\nAjxTemplate.register(\"dwt.Widgets#ZMenuItemBlankCascade\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ZMenuItem-BlankCascade'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#ZMenuItemBlankCascade\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtListView-NoResults\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" width='100%'><tr><td class='NoResults'>\\n\";\na[c++]=\"\\t\\t\\t\\t\";\na[c++]=e.message;\na[c++]=\"\\n\";\na[c++]=\"\\t\\t\\t</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtListView-NoResults\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtPasswordField\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td><div id=\\'';\na[c++]=e.id;\na[c++]=\"_input'></div></td><td><div id='\";\na[c++]=e.id;\na[c++]=\"_show_password'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtPasswordField\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtFormRows\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" class=\"ZPropertySheet\" cellspacing=\"6\"><tbody id=\"';\na[c++]=e.id;\na[c++]='_rows\" tabindex=\"100\"></tbody></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtFormRows\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtFormRow\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr id=\"';\na[c++]=e.id;\na[c++]='_row\" class=\"DwtFormRow\"><td><div id=\"';\na[c++]=e.id;\na[c++]='\" tabindex=\"100\"></div></td><td><div id=\"';\na[c++]=e.id;\na[c++]='_add\" class=\"DwtFormRowAdd\" tabindex=\"200\"></div></td><td><div id=\"';\na[c++]=e.id;\na[c++]='_remove\" class=\"DwtFormRowRemove\" tabindex=\"300\"></div></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtFormRow\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtColorPicker\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_colors'><div class='Text'>\";\na[c++]=AjxMsg.colorsStandard;\na[c++]=\"</div><div class='Colors First'><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorRed;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorOrange;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorYellow;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorGreen;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorCyan;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorBlue;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorPurple;\na[c++]=\";'></div><div class='Color' style='background-color:\";\na[c++]=AjxMsg.colorPink;\na[c++]=\";'></div><div class='Color' style='background-color:white;'></div><div class='Color' style='background-color:black;'></div></div><div class='Text'>\";\na[c++]=AjxMsg.colorsCustom;\na[c++]=\"</div><div class='Colors First'><div class='Color' style='background-color:#ff8686;'></div><div class='Color' style='background-color:#ff9966;'></div><div class='Color' style='background-color:#ffff99;'></div><div class='Color' style='background-color:#ccffcc;'></div><div class='Color' style='background-color:#ccffff;'></div><div class='Color' style='background-color:#99ccff;'></div><div class='Color' style='background-color:#ccccff;'></div><div class='Color' style='background-color:#ffccff;'></div><div class='Color' style='background-color:#ededed;'></div><div class='Color' style='background-color:#808080;'></div></div><div class='Colors'><div class='Color' style='background-color:#ff0000;'></div><div class='Color' style='background-color:#ff6600;'></div><div class='Color' style='background-color:#ffcc33;'></div><div class='Color' style='background-color:#66cc66;'></div><div class='Color' style='background-color:#00cccc;'></div><div class='Color' style='background-color:#3366ff;'></div><div class='Color' style='background-color:#6666ff;'></div><div class='Color' style='background-color:#cc33cc;'></div><div class='Color' style='background-color:#d5d5d5;'></div><div class='Color' style='background-color:#666666;'></div></div><div class='Colors'><div class='Color' style='background-color:#cc0000;'></div><div class='Color' style='background-color:#cc6600;'></div><div class='Color' style='background-color:#cc9933;'></div><div class='Color' style='background-color:#009900;'></div><div class='Color' style='background-color:#339999;'></div><div class='Color' style='background-color:#3333ff;'></div><div class='Color' style='background-color:#6633ff;'></div><div class='Color' style='background-color:#993399;'></div><div class='Color' style='background-color:#cccccc;'></div><div class='Color' style='background-color:#4d4d4d;'></div></div><div class='Colors'><div class='Color' style='background-color:#990000;'></div><div class='Color' style='background-color:#993300;'></div><div class='Color' style='background-color:#996633;'></div><div class='Color' style='background-color:#006600;'></div><div class='Color' style='background-color:#336666;'></div><div class='Color' style='background-color:#000099;'></div><div class='Color' style='background-color:#330099;'></div><div class='Color' style='background-color:#663366;'></div><div class='Color' style='background-color:#b3b3b3;'></div><div class='Color' style='background-color:#333333;'></div></div><div class='Colors'><div class='Color' style='background-color:#330000;'></div><div class='Color' style='background-color:#663300;'></div><div class='Color' style='background-color:#333300;'></div><div class='Color' style='background-color:#003300;'></div><div class='Color' style='background-color:#003333;'></div><div class='Color' style='background-color:#000066;'></div><div class='Color' style='background-color:#330066;'></div><div class='Color' style='background-color:#330033;'></div><div class='Color' style='background-color:#aaaaaa;'></div><div class='Color' style='background-color:#1a1a1a;'></div></div></div>\";\nif(!e.hideNoFill){a[c++]=\"<div class='Text' style='margin-top:4px;'><div id='\";\na[c++]=e.id;\na[c++]=\"_default'></div></div>\"\n}if(e.allowColorInput){a[c++]=\"<div class='Text' style='margin-top:4px;'><table role=\\\"presentation\\\" border=\\\"0\\\" width='100%'><tr><td><div id='\";\na[c++]=e.id;\na[c++]=\"_input'></div></td><td><div id='\";\na[c++]=e.id;\na[c++]='_button\\'></div></td></tr></table><table role=\"presentation\" class=\\'DwtColorPickerLabel\\' border=\"0\"><tr><td><div>';\na[c++]=AjxMsg.previewResult;\na[c++]=\"</div></td><td><div id='\";\na[c++]=e.id;\na[c++]=\"_preview' class='Color'></div></td><td><div id='\";\na[c++]=e.id;\na[c++]=\"_error'></div></td></tr></table></div>\"\n}return d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtColorPicker\"},false);\nAjxTemplate.register(\"dwt.Widgets#DwtColorPickerButton\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder'><tr><td><div id='\";\na[c++]=e.id;\na[c++]=\"_color' class='Color'></div></td><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='ZWidgetTitle'\\n\";\na[c++]=\"\\t\\t\\t\";\nif(AjxEnv.isIE){a[c++]=\"\\n\";\na[c++]=\"\\t\\t\\t\\tstyle='width:auto;'\\n\";\na[c++]=\"\\t\\t\\t\"\n}a[c++]=\"\\n\";\na[c++]=\"\\t\\t\\t></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#DwtColorPickerButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"dwt.Widgets#SVGGradient\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<?xml version=\"1.0\" ?><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\"\\n';\na[c++]='\\t     viewBox=\"0 0 1 1\" preserveAspectRatio=\"none\"><linearGradient id=\"thegradient\"\\n';\na[c++]='\\t\\t                gradientUnits=\"userSpaceOnUse\"\\n';\na[c++]='\\t\\t                x1=\"';\na[c++]=e.x1;\na[c++]='\" y1=\"';\na[c++]=e.y1;\na[c++]='\" x2=\"';\na[c++]=e.x2;\na[c++]='\" y2=\"';\na[c++]=e.y2;\na[c++]='\"><stop offset=\"0%\" stop-color=\"';\na[c++]=e.startColor;\na[c++]='\"\\n';\na[c++]='\\t\\t\\t            stop-opacity=\"1\"/><stop offset=\"100%\" stop-color=\"';\na[c++]=e.endColor;\na[c++]='\"\\n';\na[c++]='\\t\\t\\t            stop-opacity=\"1\"/></linearGradient><rect x=\"0\" y=\"0\" width=\"1\" height=\"1\"\\n';\na[c++]='\\t\\tfill=\"url(#thegradient)\" /></svg>';\nreturn d?a.length:a.join(\"\")\n},{id:\"dwt.Widgets#SVGGradient\"},false)\n}if(AjxPackage.define(\"share.App\")){AjxTemplate.register(\"share.App#Loading\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" style='width:100%; height=100%'><tr><td align='center' valign='middle'><br><br><br>\";\na[c++]=ZmMsg.loading;\na[c++]=\"<br><br><div class='Imgwait_64'></div><br><br><br></td></tr><tr><td style='height:100%'>&nbsp;</td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#Loading\"},false);\nAjxTemplate.register(\"share.App\",AjxTemplate.getTemplate(\"share.App#Loading\"),AjxTemplate.getParams(\"share.App#Loading\"));\nAjxTemplate.register(\"share.App#Banner\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" style='width:100%; height:100%'><tr><td align='center' valign='middle'><a\";\nif(e.url&&e.url!=\"\"){a[c++]=\" href='\";\na[c++]=e.url;\na[c++]=\"' target='_blank'\"\n}a[c++]=\"><div class='ImgAppBanner' \";\nif(e.isOffline){a[c++]=\" style='width:220px;' \"\n}a[c++]=\"></div></a></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#Banner\"},false);\nAjxTemplate.register(\"share.App#UserInfo\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='skin_table'><!--\\n\";\na[c++]=\"\\t\";\nif(e.showOfflineLink){a[c++]='<tr><td id=\\'skin_td_switch_offline\\' colspan=3><a href=\"https://www.zimbra.com/products/desktop.html\" target=\"_blank\">';\na[c++]=ZmMsg.switchToOfflineClientEx;\na[c++]=\"</a></td></tr>\"\n}a[c++]=\"\\n\";\na[c++]=\"--><tr>\";\nif(e.adminUrl){a[c++]='<td id=\"skin_container_adminlink\"><a target=\"_blank\" href=\"';\na[c++]=e.adminUrl;\na[c++]='\">';\na[c++]=ZmMsg.adminLinkLabel;\na[c++]=\"</a></td>\"\n}a[c++]=\"<td id='skin_container_help'><span id='skin_container_help_button'></span></td><td id='skin_container_logoff'><a href='javascript:;' onclick='ZmZimbraMail._onClickLogOff();'>\";\na[c++]=e.logoutText;\na[c++]=\"</a></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#UserInfo\"},false);\nAjxTemplate.register(\"share.App#PrintView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<html><head><title>\";\na[c++]=ZmMsg.zimbraLabel;\na[c++]=\" \";\na[c++]=e.username;\na[c++]=\"</title><link rel='stylesheet' href='\";\na[c++]=e.appContextPath;\na[c++]=\"/css/msgview,zm.css?v=\";\na[c++]=e.cacheKillerVersion;\na[c++]=\"' media='screen'></link>\";\nif(e.onloadStr){a[c++]=\"<script language='javascript'>\\n\";\na[c++]=\"\\t\\t\\t\\t\\tfunction handleOnload() {\\n\";\na[c++]=\"\\t\\t\\t\\t\\t\\t\";\na[c++]=e.onloadStr;\na[c++]=\";\\n\";\na[c++]=\"\\t\\t\\t\\t\\t}\\n\";\na[c++]=\"\\t\\t\\t\\t<\\/script></head><body onload='handleOnload();'>\"\n}else{a[c++]=\"</head><body>\"\n}a[c++]=\"<table role=\\\"presentation\\\" width=100%><tr><td class='ZmPrintView-company'>\";\na[c++]=ZmMsg.zimbraTitle;\na[c++]=\" \";\na[c++]=ZmMsg.splashScreenAppName;\na[c++]=\"</td><td class='ZmPrintView-username' align=right>\";\na[c++]=e.username;\na[c++]=\"</td></tr></table><hr><div style='padding:10px'>\";\na[c++]=e.content;\na[c++]=\"</div></body></html>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#PrintView\"},false);\nAjxTemplate.register(\"share.App#FolderTooltip\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\nif(AjxEnv.isIE&&(e.name.length>65)){a[c++]='<table role=\"presentation\" style=\"width:350px;\">'\n}else{a[c++]='<table role=\"presentation\">'\n}a[c++]=\"<tr><th colspan=2 style='padding-bottom:5px; text-align:left; max-width:350px;'><div id='tt_f_name' style='overflow-x:hidden;'>\";\na[c++]=AjxStringUtil.htmlEncode(e.name);\na[c++]=\"</div></th></tr><tr><td id='tt_m_label' valign='top' style='padding-right:20px'>\";\na[c++]=AjxMessageFormat.format(ZmMsg.makeLabel,e.itemText);\na[c++]=\"</td><td id='tt_m_count' valign='top'>\";\na[c++]=e.numTotal;\na[c++]=\"</td></tr>\";\nif(e.numUnread){a[c++]=\"<tr><td id='tt_u_label' valign='top'>\";\na[c++]=AjxMessageFormat.format(ZmMsg.makeLabel,e.unreadLabel);\na[c++]=\"</td><td id='tt_u_count' valign='top' style='font-weight:bold'>\";\na[c++]=e.numUnread;\na[c++]=\"</td></tr>\"\n}if(e.sizeTotal){a[c++]=\"<tr><td id='tt_s_label' valign='top'>\";\na[c++]=ZmMsg.sizeLabel;\na[c++]=\"</td><td id='tt_s_value' valign='top'>\";\na[c++]=AjxUtil.formatSize(e.sizeTotal);\na[c++]=\"</td></tr>\"\n}a[c++]=\"</table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#FolderTooltip\"},false);\nAjxTemplate.register(\"share.App#ZimbraAccountTooltip\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\">';\nif(e.lastSync&&e.lastSync!=\"\"){a[c++]=\"<tr><td class='nobreak' align=right>\";\na[c++]=ZmMsg.lastSync;\na[c++]=\":</td><td class='nobreak'>\";\na[c++]=e.lastSync;\na[c++]=\"</td></tr>\"\n}else{if(e.hasNotSynced){a[c++]=\"<tr><td class='nobreak' colspan=2>\";\na[c++]=ZmMsg.neverSynced;\na[c++]=\"</td></tr>\"\n}}if(e.status&&e.status!=\"\"){a[c++]=\"<tr><td align=right valign=top>\";\na[c++]=ZmMsg.status;\na[c++]=\":</td><td>\";\na[c++]=e.status;\na[c++]=\"</td></tr>\"\n}if(!e.hasNotSynced){a[c++]=\"<tr><td align=right valign=top>\";\na[c++]=ZmMsg.offlineQuota;\na[c++]=\"</td><td>\";\na[c++]=e.quota;\na[c++]=\"</td></tr>\"\n}a[c++]=\"</table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#ZimbraAccountTooltip\"},false);\nAjxTemplate.register(\"share.App#presenceButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"ToolbarButton\";\nb[d++]='<table role=\"presentation\" class=\\'ZWidgetTable Z';\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border' style='table-layout:auto;'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title'\\t\\tclass='ZWidgetTitle'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"share.App#presenceButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"share.App#ZmTaskbarItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_button' class='ZmTaskbarButtonParent'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_content' class='ZmTaskbarContentParent' style='display:none;'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#ZmTaskbarItem\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"share.App#ZmStatusImageButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"ToolbarButton\";\nb[d++]='<table role=\"presentation\" class=\\'ZWidgetTable Z';\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border' style='table-layout:auto;'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_status_icon'\\tclass='ZLeftIcon ZWidgetIcon'><div></div></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"share.App#ZmStatusImageButton\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"share.App#NetworkStatus\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" width=90><tr><td class=\"ZmNetworkStatusIcon\" onclick=\"ZmZimbraMail.handleNetworkStatusClick();\" id=\"';\na[c++]=e.id;\na[c++]='_networkStatusText\"></td><td class=\"ZmNetworkStatusIcon\" align=right width=18 onclick=\"ZmZimbraMail.handleNetworkStatusClick();\" id=\"';\na[c++]=e.id;\na[c++]='_networkStatusIcon\"></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"share.App#NetworkStatus\"},false)\n}if(AjxPackage.define(\"share.Dialogs\")){AjxTemplate.register(\"share.Dialogs#TableProperties\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" class=\"ZmHEDialog\"><tr><td><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.description;\na[c++]='</legend><table role=\"presentation\" width=\"100%\"><tr><td class=\"Label\" style=\"width:auto\">';\na[c++]=ZmMsg.caption;\na[c++]='</td><td width=\"100%\" id=\"';\na[c++]=e.id;\na[c++]='_Caption\"></td></tr><tr><td class=\"Label\" style=\"width:auto\">';\na[c++]=ZmMsg.summary;\na[c++]='</td><td width=\"100%\" id=\"';\na[c++]=e.id;\na[c++]='_Summary\"></td></tr></table></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.layout;\na[c++]='</legend><table role=\"presentation\"><tr><td class=\"Label\">';\na[c++]=ZmMsg.tableWidth;\na[c++]='</td><td colspan=\"4\"><table role=\"presentation\"><tr><td style=\"padding-right:2px\"><input id=\"';\na[c++]=e.id;\na[c++]='_WidthAuto\" checked=\"checked\" name=\"';\na[c++]=e.id;\na[c++]='_WidthAuto\" type=\"radio\" /></td><td style=\"padding-right:2em\" colspan=\"2\"><label for=\"';\na[c++]=e.id;\na[c++]='_WidthAuto\">';\na[c++]=ZmMsg.auto;\na[c++]='</label></td></tr><tr><td style=\"padding-right:2px\"><input id=\"';\na[c++]=e.id;\na[c++]='_WidthAuto1\" name=\"';\na[c++]=e.id;\na[c++]='_WidthAuto\" type=\"radio\" /></td><td style=\"padding-right:3px\" id=\"';\na[c++]=e.id;\na[c++]='_Width\"></td><td id=\"';\na[c++]=e.id;\na[c++]='_WidthUnit\"></td></tr></table></td></tr></table><table role=\"presentation\" id=\"';\na[c++]=e.id;\na[c++]='_AdvancedMode1\" style=\"margin-top:4px; display:none\"><tr><td class=\"Label\">';\na[c++]=ZmMsg.tableAlignment;\na[c++]='</td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_Align\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td><table role=\"presentation\" class=\"ZPropertySheet\" cellspacing=\"6\"><tr><td><input type=\"checkbox\" id=\"';\na[c++]=e.id;\na[c++]='_FixedLayout\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_FixedLayout\">';\na[c++]=ZmMsg.fixedCellWidth;\na[c++]='</label></td></tr></table></td></tr></table></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.textStyle;\na[c++]='</legend><table role=\"presentation\"><tr><td class=\"Label\">';\na[c++]=ZmMsg.textAlign;\na[c++]='</td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_TextAlign\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\">';\na[c++]=ZmMsg.fontColorLabel;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_ForegroundColor\"></td></tr><tr><td class=\"Label\">';\na[c++]=ZmMsg.verticalAlign;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_TextVAlign\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\">';\na[c++]=ZmMsg.fontBackgroundLabel;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_BackgroundColor\"></td></tr></table></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.borderStyle;\na[c++]='</legend><table role=\"presentation\"><tr><td class=\"Label\">';\na[c++]=ZmMsg.borderWidth;\na[c++]='</td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_BorderWidth\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\">';\na[c++]=ZmMsg.borderColorLabel;\na[c++]='</td><td><table role=\"presentation\"><tr><td id=\"';\na[c++]=e.id;\na[c++]='_BorderColor\"></td></tr></table></td></tr><tr><td class=\"Label\">';\na[c++]=ZmMsg.cellPadding;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_CellPadding\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\">';\na[c++]=ZmMsg.borderStyleLabel;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_BorderStyle\"></td></tr><tr id=\"';\na[c++]=e.id;\na[c++]='_AdvancedMode2\" style=\"display:none\"><td class=\"Label\">';\na[c++]=ZmMsg.cellSpacing;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_BorderSpacing\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td colspan=\"2\" style=\"padding:2px 0\"><table role=\"presentation\" align=\"center\" class=\"ZPropertySheet\" cellspacing=\"6\"><tr><td><input type=\"checkbox\" id=\"';\na[c++]=e.id;\na[c++]='_BorderCollapse\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_BorderCollapse\">';\na[c++]=ZmMsg.collapsedBorders;\na[c++]=\"</label></td></tr></table></td></tr></table></fieldset></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#TableProperties\"},false);\nAjxTemplate.register(\"share.Dialogs\",AjxTemplate.getTemplate(\"share.Dialogs#TableProperties\"),AjxTemplate.getParams(\"share.Dialogs#TableProperties\"));\nAjxTemplate.register(\"share.Dialogs#CellProperties\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" class=\"ZmHEDialog\"><tr><td><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.borderStyle;\na[c++]='</legend><table role=\"presentation\" width=\"100%\"><tr><td style=\"width:19em\"><!-- If you\\'re wondering why this has to be so complex, check out this bug:\\n';\na[c++]='\\t\\t\\t\\t\\t\\t\\t\\thttps://bugzilla.mozilla.org/show_bug.cgi?id=258255 --><div style=\"padding-left:1em; padding-top:1em\">';\na[c++]=ZmMsg.clickToDrawABorder;\na[c++]='</div><div style=\"margin-top:10px;\"><table role=\"presentation\" align=\"center\"><tr><td>';\na[c++]=ZmMsg.styleLabel;\na[c++]=\"</td><td>\";\na[c++]=ZmMsg.colorLabel;\na[c++]=\"</td><td>\";\na[c++]=ZmMsg.widthLabel;\na[c++]='</td></tr><tr><td id=\"';\na[c++]=e.id;\na[c++]='_BorderStyle\"></td><td><!-- embedded in a table so the widget doesn\\'t enlarge --><table role=\"presentation\"><tr><td id=\"';\na[c++]=e.id;\na[c++]='_BorderColor\"></td></tr></table></td><td id=\"';\na[c++]=e.id;\na[c++]='_BorderWidth\"></td></tr></table></div><table role=\"presentation\" id=\"';\na[c++]=e.id;\na[c++]='_PreviewGridHolder\" style=\"width:100px; height:100px;\" align=\"center\"><tr><td><table role=\"presentation\" align=\"center\"><tr><td><table role=\"presentation\" id=\"';\na[c++]=e.id;\na[c++]='_PreviewGrid\" style=\"background-color:white; border:1px dashed #ccc;\"><tr><td style=\"border:1px dashed #ccc;\"><div style=\"width:30px; height:30px;\"></div></td><td style=\"border:1px dashed #ccc;\"><div style=\"width:30px; height:30px;\"></div></td></tr><tr><td style=\"border:1px dashed #ccc;\"><div style=\"width:30px; height:30px;\"></div></td><td style=\"border:1px dashed #ccc;\"><div style=\"width:30px; height:30px;\"></div></td></tr></table></td></tr></table></td></tr></table></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td valign=\"top\"><div style=\"padding-left:1em; padding-top:1em; padding-bottom:1em\">';\na[c++]=ZmMsg.orPickAStyleBelow;\na[c++]='</div><table role=\"presentation\" align=\"center\" id=\"';\na[c++]=e.id;\na[c++]='_QuickBorders\"><tr><td></td><td></td><td></td><td></td><td></td></tr></table></td></tr></table></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.layout;\na[c++]='</legend><table role=\"presentation\"><tr><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableWidth\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableWidth\">';\na[c++]=ZmMsg.widthLabel;\na[c++]='</label></td></tr></table></td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_Width\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableHorizPadding\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableHorizPadding\">';\na[c++]=ZmMsg.paddingHorizontal;\na[c++]='</label></td></tr></table></td><td id=\"';\na[c++]=e.id;\na[c++]='_HorizPadding\"></td></tr><tr><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableHeight\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableHeight\">';\na[c++]=ZmMsg.heightLabel;\na[c++]='</label></td></tr></table></td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_Height\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableVertPadding\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableVertPadding\">';\na[c++]=ZmMsg.paddingVertical;\na[c++]='</label></td></tr></table></td><td id=\"';\na[c++]=e.id;\na[c++]='_VertPadding\"></td></tr></table></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.textStyle;\na[c++]='</legend><table role=\"presentation\"><tr><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableTextAlign\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableTextAlign\">';\na[c++]=ZmMsg.textAlign;\na[c++]='</label></td></tr></table></td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_TextAlign\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableForegroundColor\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableForegroundColor\">';\na[c++]=ZmMsg.fontColorLabel;\na[c++]='</label></td></tr></table></td><td id=\"';\na[c++]=e.id;\na[c++]='_ForegroundColor\"></td></tr><tr><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableTextVAlign\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableTextVAlign\">';\na[c++]=ZmMsg.verticalAlign;\na[c++]='</label></td></tr></table></td><td class=\"col2\" id=\"';\na[c++]=e.id;\na[c++]='_TextVAlign\"></td><td class=\"VSep-L\">&nbsp;</td><td class=\"VSep-R\">&nbsp;</td><td class=\"Label\"><table role=\"presentation\" align=\"right\"><tr><td style=\"padding-right:3px\"><input id=\"';\na[c++]=e.id;\na[c++]='_EnableBackgroundColor\" type=\"checkbox\" /></td><td><label for=\"';\na[c++]=e.id;\na[c++]='_EnableBackgroundColor\">';\na[c++]=ZmMsg.fontBackgroundLabel;\na[c++]='</label></td></tr></table></td><td id=\"';\na[c++]=e.id;\na[c++]='_BackgroundColor\"></td></tr></table></fieldset></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#CellProperties\"},false);\nAjxTemplate.register(\"share.Dialogs#EditorInsertLink\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" class=\"ZmHEDialog\"><tr><td><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.linkText;\na[c++]=\"</legend>\";\na[c++]=ZmMsg.linkTextDesc;\na[c++]='<br /><div id=\"';\na[c++]=e.id;\na[c++]='_linkTextCont\"></div></fieldset><fieldset class=\"ZmFieldset\"><legend class=\"ZmLegend\">';\na[c++]=ZmMsg.linkTarget;\na[c++]=\"</legend>\";\na[c++]=ZmMsg.linkTargetDesc;\na[c++]='<br /><table role=\"presentation\"><tr><td id=\"';\na[c++]=e.id;\na[c++]='_linkTargetCont\" style=\"padding-right:5px\"></td><td id=\"';\na[c++]=e.id;\na[c++]='_testBtnCont\"></td></tr></table></fieldset></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#EditorInsertLink\"},false);\nAjxTemplate.register(\"share.Dialogs#NewSearch\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" ';\na[c++]=AjxEnv.isWebKitBased?\"width='320'>\":\">\";\na[c++]=\"<tr><td class='Label' colspan=2 style='padding:0px 0px 5px 0px;'>\";\na[c++]=ZmMsg.searchName;\na[c++]=\" </td></tr><tr><td><input autocomplete=OFF type='text' class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_nameField' /></td></tr><tr><td>&nbsp;</td></tr><tr><td><div id='\";\na[c++]=e.id;\na[c++]='_overviewDiv\\'><div class=\"Label\">';\na[c++]=ZmMsg.newSearchParent;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_folderTreeCell'></div></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#NewSearch\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmMountFolderDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" border=0 width=375><tr><td colspan=2>';\na[c++]=ZmMsg.mountInstructions1;\na[c++]='</td></tr><tr><td width=50 style=\"text-align:right;\">';\na[c++]=ZmMsg.emailLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]='_email\\'></td></tr><tr><td width=50 style=\"text-align:right;\">';\na[c++]=ZmMsg.folderLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_folder'></td></tr><tr><td><br></td></tr><tr><td colspan=2>\";\na[c++]=ZmMsg.mountInstructions2;\na[c++]='</td></tr><tr><td width=50 style=\"text-align:right;\">';\na[c++]=ZmMsg.nameLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]='_name\\'></td></tr><tr><td width=50 style=\"text-align:right;\">';\na[c++]=ZmMsg.colorLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_color'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmMountFolderDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmPromptDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td class='Label' id='\";\na[c++]=e.id;\na[c++]=\"_label'/></tr><tr><td><input type=\";\na[c++]=e.type;\na[c++]=\" autocomplete=OFF class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_name' /></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmPromptDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewTagDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td class='Label'>\";\na[c++]=ZmMsg.tagName;\na[c++]=\":</td>\";\nif(appCtxt.multiAccounts){a[c++]=\"<td class='Label'>\";\na[c++]=ZmMsg.colorLabel;\na[c++]=\"</td><td class='Label'>\";\na[c++]=ZmMsg.accountLabel;\na[c++]=\"</td>\"\n}a[c++]=\"</tr><tr><td><input type=text autocomplete=OFF id='\";\na[c++]=e.id;\na[c++]=\"_name' /></td><td id='\";\na[c++]=e.id;\na[c++]=\"_tagColor' style=\\\"padding-right:16px;\\\"></td><td id='\";\na[c++]=e.id;\na[c++]=\"_account'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewTagDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmContactGroupDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td class='Label'>\";\na[c++]=ZmMsg.groupNameLabel;\na[c++]=\":</td></tr><tr><td><input type=text autocomplete=OFF id='\";\na[c++]=e.id;\na[c++]=\"_name' size='25' /></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmContactGroupDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmTimezonePicker\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td colspan='2' class='Label'>\";\na[c++]=ZmMsg.selectTimezoneInfo;\na[c++]='</td></tr><tr><td width=50 style=\"text-align:right;\">';\na[c++]=ZmMsg.selectTimezoneLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_tzSelect'></td></tr><tr><td></td><td id='\";\na[c++]=e.id;\na[c++]=\"_tzShowAll'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmTimezonePicker\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmAttachDialog-MyComputerTab\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div style='overflow:auto'><form accept-charset='utf-8' method='POST' action='\";\na[c++]=e.uri;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_uploadForm' enctype='multipart/form-data'><input type='hidden' name='_charset_' /><table role=\\\"presentation\\\" id='\";\na[c++]=e.id;\na[c++]=\"_attachmentTable' class='iframeTable'></table></form></div><div><table role=\\\"presentation\\\" id='\";\na[c++]=e.id;\na[c++]=\"_attachmentButtonTable'></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmAttachDialog-MyComputerTab\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmAttachDialog-MyComputerTab-AddAttachment\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td><div class='attachText'>\";\na[c++]=ZmMsg.attach;\na[c++]=\":</div></td><td class='nobreak'><input id='\";\na[c++]=e.id;\na[c++]=\"_input' type='file' multiple name='\";\na[c++]=e.uploadName;\na[c++]=\"' size=40>&nbsp;\\n\";\na[c++]=\"\\t\\t\\t\\t<span id='\";\na[c++]=e.id;\na[c++]='_remove\\' onmouseover=\\'this.style.cursor=\"pointer\"\\' onmouseout=\\'this.style.cursor=\"default\"\\' class=\"ZmAttachDialog-removeLink\">';\na[c++]=ZmMsg.remove;\na[c++]=\"</span><span id='\";\na[c++]=e.id;\na[c++]=\"_size'>&nbsp;</span></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmAttachDialog-MyComputerTab-AddAttachment\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewOrgDialogRemote\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr><td class='Label'>\";\na[c++]=ZmMsg.feedLabel;\na[c++]=\"</td><td><table role=\\\"presentation\\\"><tr><td><input type='checkbox' id='\";\na[c++]=e.id;\na[c++]=\"_remote' style='width:initial;' /></td><td class='Label'><label for='\";\na[c++]=e.id;\na[c++]=\"_remote'> \";\na[c++]=e.remoteLabel;\na[c++]=\" </label></td></tr></table></td></tr><tr style='display:none;' id='\";\na[c++]=e.id;\na[c++]=\"_remoteURLrow'><td class='Label' id='\";\na[c++]=e.id;\na[c++]=\"_remoteURLlbl'>\";\na[c++]=ZmMsg.urlLabel;\na[c++]=\"</td><td><input autocomplete='off' type='text' class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_remoteURLfield' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_remoteURLlbl' /></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewOrgDialogRemote\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewOrgDialogName\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr valign='center'><td class='Label' id ='\";\na[c++]=e.id;\na[c++]=\"_lblName'>\";\na[c++]=ZmMsg.nameLabel;\na[c++]=\"</td><td><input autocomplete='off' type='text' class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_name' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_lblName' /></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewOrgDialogName\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewOrgDialogColor\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr><td class='Label' id ='\";\na[c++]=e.id;\na[c++]=\"_lblColor'>\";\na[c++]=ZmMsg.colorLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_colorSelect'></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewOrgDialogColor\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewOrgDialogFolder\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr><td class='Label' id='\";\na[c++]=e.id;\na[c++]=\"_parentLabel'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_parentValue'></td></tr><tr><td colspan=2 id='\";\na[c++]=e.id;\na[c++]=\"_folderTree'></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewOrgDialogFolder\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmNewCalDialogFreeBusy\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr><td colspan=2><table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr valign='center'><td style='width:2em;'><input type='checkbox' id='\";\na[c++]=e.id;\na[c++]=\"_excludeFbCheckbox' /></td><td class='Label'><label for='\";\na[c++]=e.id;\na[c++]=\"_excludeFbCheckbox'> \";\na[c++]=ZmMsg.excludeFromFreeBusy;\na[c++]=\" </label></td></tr></table></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmNewCalDialogFreeBusy\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmRenameDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td class='ZmFieldLabel'><span id='\";\na[c++]=e.id;\na[c++]=\"_renameLabel'>\";\na[c++]=e.newLabel;\na[c++]=\":</span></td></tr><tr><td><input type='text' autocomplete='off' class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_name' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_renameLabel' /></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmRenameDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmPasswordUpdateDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" class=\\'ZPropertySheet\\' cellspacing=\\'6\\'><tr><td colspan=\"2\" id=\"';\na[c++]=e.id;\na[c++]=\"_desc\\\"></td></tr><tr><td class='Label' style='padding:0; text-align:right;'>\";\na[c++]=e.labelAcct;\na[c++]=': </td><td id=\"';\na[c++]=e.id;\na[c++]=\"_acct\\\"></td></tr><tr><td class='Label' style='padding:0; text-align:right;'>\";\na[c++]=e.labelPasswd;\na[c++]=\": </td><td><input type='password' style='padding:0;' autocomplete='off' class='Field' id='\";\na[c++]=e.id;\na[c++]=\"_name' /></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmPasswordUpdateDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmTimeDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_description' style='padding:3px 3px 10px;'>\";\na[c++]=e.description;\na[c++]=\"</div><table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6' width='330'><tr><td class='ZmFieldLabelRight'>\";\na[c++]=e.label;\na[c++]=':</td><td><table role=\"presentation\"><tr><td>';\na[c++]=AjxTemplate.expand(\"#DateField\",{id:e.id+\"_date\"});\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_miniCal' class=\\\"miniCalendarButton\\\" style='padding-right:1em;'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_time'></td></tr></table></td></tr><tr><td class='ZmFieldLabelRight'>\";\na[c++]=ZmMsg.selectTimezoneLabel;\na[c++]=\"</td><td id='\";\na[c++]=e.id;\na[c++]=\"_tzSelect'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmTimeDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#DateField\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<input autocomplete='off' style='height:22px;' type='text' size=14 id='\";\na[c++]=e.id;\na[c++]=\"' value='\";\na[c++]=e.value;\na[c++]=\"'>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#DateField\"},false);\nAjxTemplate.register(\"share.Dialogs#UploadDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<div><div id=\"';\na[c++]=e.id;\na[c++]='_label\" style=\"margin-bottom:0.5em;\">';\na[c++]=ZmMsg.uploadChoose;\na[c++]=\"</div><div style=\\\"margin-bottom:0.5em;margin-left:1em;\\\"><form accept-charset='utf-8' method='POST' action='\";\na[c++]=e.uri;\na[c++]=\"' id='\";\na[c++]=e.id;\na[c++]=\"_form' enctype='multipart/form-data'><table role=\\\"presentation\\\" id='\";\na[c++]=e.id;\na[c++]=\"_table' class='ZPropertySheet' cellspacing='6'></table></form></div><table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr id=\\\"\";\na[c++]=e.id;\na[c++]='_actionRow\"><td>';\na[c++]=ZmMsg.uploadAction;\na[c++]='</td><td id=\"';\na[c++]=e.id;\na[c++]='_conflict\"></td></tr><tr><td colspan=\"2\" id=\"';\na[c++]=e.id;\na[c++]='_notesTD\"><div>';\na[c++]=ZmMsg.notesLabel;\na[c++]='</div><textarea id=\"';\na[c++]=e.id;\na[c++]='_notes\" style=\"height:80px; width:450px;\"></textarea></td></tr><tr><td colspan=\"2\" id=\"';\na[c++]=e.id;\na[c++]='_info\"></td></tr><tr><td colspan=\"2\" id=\"';\na[c++]=e.id;\na[c++]='_msg\" style=\"width:450px;\"></td></tr></table></div>';\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#UploadDialog\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmFolderRetentionView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\" style=\\'margin:10px;\\'><tr><td><input id=\"';\na[c++]=e.id;\na[c++]=\"_keepCheckbox\\\" type='checkbox'></td><td class='ZmFolderRetentionLabel' colspan=2><label for=\\\"\";\na[c++]=e.id;\na[c++]='_keepCheckbox\">';\na[c++]=ZmMsg.messageRetentionEnable;\na[c++]=\"</label></td></tr><tr><td></td><td colspan=2 style='padding-bottom:.5em;'>\";\na[c++]=ZmMsg.messageRetentionExplanation;\na[c++]=\"</td></tr><tr><td></td><td class='ZmFieldLabelRight'><span id='\";\na[c++]=e.id;\na[c++]=\"_retentionLabel'>\";\na[c++]=ZmMsg.messageRetentionRange;\na[c++]=\"</span></td><td class='ZmFolderPolicySelection'><select id='\";\na[c++]=e.id;\na[c++]=\"_keep' aria-label='\";\na[c++]=ZmMsg.type;\na[c++]=\"' class='ZmFolderPolicySelect'/><input id='\";\na[c++]=e.id;\na[c++]=\"_keepValue' class='ZmFolderPolicyAmountInput' type='text' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_retentionLabel' /><select id='\";\na[c++]=e.id;\na[c++]=\"_keepUnit' aria-label='\";\na[c++]=ZmMsg.unit;\na[c++]=\"' class='ZmFolderPolicyUnitSelect' /></td></tr><tr><td colspan=3>&nbsp;</td></tr><tr><td><input id=\\\"\";\na[c++]=e.id;\na[c++]=\"_purgeCheckbox\\\" type='checkbox'></td><td class='ZmFolderRetentionLabel' colspan=2><label for=\\\"\";\na[c++]=e.id;\na[c++]='_purgeCheckbox\">';\na[c++]=ZmMsg.messageDisposalEnable;\na[c++]=\"</label></td></tr><tr><td></td><td colspan=2 style='padding-bottom:.5em;'>\";\na[c++]=ZmMsg.messageDisposalExplanation;\na[c++]=\"</td></tr><tr><td></td><td class='ZmFieldLabelRight'><span id='\";\na[c++]=e.id;\na[c++]=\"_disposalLabel'>\";\na[c++]=ZmMsg.messageDisposalThreshold;\na[c++]=\"</span></td><td class='ZmFolderPolicySelection'><select id='\";\na[c++]=e.id;\na[c++]=\"_purge' aria-label='\";\na[c++]=ZmMsg.type;\na[c++]=\"' class='ZmFolderPolicySelect'/><input id='\";\na[c++]=e.id;\na[c++]=\"_purgeValue' class='ZmFolderPolicyAmountInput' type='text' aria-labelledby='\";\na[c++]=e.id;\na[c++]=\"_disposalLabel' /><select id='\";\na[c++]=e.id;\na[c++]=\"_purgeUnit' aria-label='\";\na[c++]=ZmMsg.unit;\na[c++]=\"' class='ZmFolderPolicyUnitSelect' /></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmFolderRetentionView\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmTwoFactorSetup\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<div class=\"ZmTwoFactorSetup\"><div id=\\'';\na[c++]=e.id;\na[c++]=\"_description'><p>\";\na[c++]=ZmMsg.twoStepAuthDescription;\na[c++]=\"</p></div><div id='\";\na[c++]=e.id;\na[c++]=\"_password'><h4>\";\na[c++]=ZmMsg.twoStepAuthPassword;\na[c++]=\"</h4><p>\";\na[c++]=ZmMsg.twoStepAuthPasswordDescription;\na[c++]=' \"<span>';\na[c++]=e.username;\na[c++]='</span>\".</p><div class=\"ZmTwoFactorSetupContainer\"><div id=\\'';\na[c++]=e.id;\na[c++]='_password_error\\' style=\"display:none;margin-left:163px;\" class=\"ZmTwoFactorSetupError\">';\na[c++]=ZmMsg.offlinePasswordUpdateFailure;\na[c++]='</div><label for=\"';\na[c++]=e.id;\na[c++]='_password_input\">';\na[c++]=ZmMsg.passwordLabel;\na[c++]='</label><input type=\"password\" id=\"';\na[c++]=e.id;\na[c++]='_password_input\" autocomplete=\"off\"/></div></div><div id=\\'';\na[c++]=e.id;\na[c++]=\"_authentication'><h4>\";\na[c++]=ZmMsg.twoStepAuthApp;\na[c++]=\"</h4><div>\";\na[c++]=ZmMsg.twoStepAuthAppDescription;\na[c++]='</div><div style=\"margin:15px;\"><a href=\"';\na[c++]=ZmMsg.twoStepAuthAppURL;\na[c++]='\" target=\"_blank\" title=\"';\na[c++]=ZmMsg.twoStepAuthAppURL;\na[c++]='\">';\na[c++]=ZmMsg.twoStepAuthAppURL;\na[c++]=\"</a></div><div>\";\na[c++]=ZmMsg.twoStepAuthAppFooter;\na[c++]=\"</div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_email'><h4>\";\na[c++]=ZmMsg.twoStepAuthEmail;\na[c++]=\"</h4><p>\";\na[c++]=ZmMsg.twoStepAuthEmailDescription;\na[c++]='</p><div class=\"ZmTwoFactorSetupContainer\"><span id=\"';\na[c++]=e.id;\na[c++]='_email_key\" class=\"email-key\"></span></div></div><div id=\\'';\na[c++]=e.id;\na[c++]=\"_code'><div id='\";\na[c++]=e.id;\na[c++]=\"_code_description'><h4>\";\na[c++]=ZmMsg.twoStepAuthCode;\na[c++]=\"</h4><p>\";\na[c++]=ZmMsg.twoStepAuthCodeDescription;\na[c++]=\"</p></div><div id='\";\na[c++]=e.id;\na[c++]='_code_error\\' style=\"display:none;\"><h4 class=\"ZmTwoFactorSetupError\">';\na[c++]=ZmMsg.twoStepAuthCodeError;\na[c++]=\"</h4><p>\";\na[c++]=ZmMsg.twoStepAuthCodeErrorDescription;\na[c++]='</p></div><div class=\"ZmTwoFactorSetupContainer\"><label for=\"';\na[c++]=e.id;\na[c++]='_code_input\">';\na[c++]=ZmMsg.code;\na[c++]=' : </label><input type=\"text\" id=\"';\na[c++]=e.id;\na[c++]='_code_input\" autocomplete=\"off\"/></div></div><div id=\\'';\na[c++]=e.id;\na[c++]=\"_success'><h4>\";\na[c++]=ZmMsg.twoStepAuthSuccess;\na[c++]=\"</h4><p>\";\na[c++]=ZmMsg.twoStepAuthSuccessDescription;\na[c++]=\"</p></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmTwoFactorSetup\"},false);\nAjxTemplate.register(\"share.Dialogs#ZmPasswordRecovery\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class=\\\"ZmPasswordRecoverySetup\\\"><div class='ImgLoginBanner'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_get_recovery_account'><p>\";\na[c++]=ZmMsg.passwordRecoveryGetAccountDescription;\na[c++]=\"</p><div class='ZmPasswordRecoverySetupContainer'><div id='\";\na[c++]=e.id;\na[c++]=\"_account_input_error' style='display:none;' class='ZmPasswordRecoverySetupError'><table><tr><td><img class='ZLoginErrorIcon' altkey='ALT_ERROR' src='/img/dwt/ImgCritical_32.png' /></td><td id='\";\na[c++]=e.id;\na[c++]=\"_account_input_error_message'>\";\na[c++]=ZmMsg.offlinePasswordUpdateFailure;\na[c++]=\"</td></tr></table></div><label for='\";\na[c++]=e.id;\na[c++]=\"_account_input'>\";\na[c++]=ZmMsg.passwordRecoveryAccountLabel;\na[c++]=\"</label><input type='text' id='\";\na[c++]=e.id;\na[c++]=\"_account_input' size='35' autocomplete='off'/></div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_request_code'><p id='\";\na[c++]=e.id;\na[c++]=\"_request_code_description'></p><div id='\";\na[c++]=e.id;\na[c++]=\"_request_code_error' style='display:none;' class='ZmPasswordRecoverySetupError'><table><tr><td><img class='ZLoginErrorIcon' altkey='ALT_ERROR' src='/img/dwt/ImgCritical_32.png' /></td><td id='\";\na[c++]=e.id;\na[c++]=\"_request_code_error_message'>\";\na[c++]=ZmMsg.offlinePasswordUpdateFailure;\na[c++]=\"</td></tr></table></div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_validate_code'><p id='\";\na[c++]=e.id;\na[c++]=\"_validate_code_description'>\";\na[c++]=ZmMsg.passwordRecoveryCodeValidationDescription;\na[c++]=\"</p><div class='ZmPasswordRecoverySetupContainer'><div id='\";\na[c++]=e.id;\na[c++]=\"_validate_code_error' style='display:none;' class='ZmPasswordRecoverySetupError'><table><tr><td><img class='ZLoginErrorIcon' altkey='ALT_ERROR' src='/img/dwt/ImgCritical_32.png' /></td><td id='\";\na[c++]=e.id;\na[c++]=\"_validate_code_error_message'>\";\na[c++]=ZmMsg.passwordRecoveryCodeValidationError;\na[c++]=\"</td></tr></table></div><div id='\";\na[c++]=e.id;\na[c++]=\"_validate_input'><label for='\";\na[c++]=e.id;\na[c++]=\"_code_input'>\";\na[c++]=ZmMsg.passwordRecoveryCodeLabel;\na[c++]=\"</label><input type='text' id='\";\na[c++]=e.id;\na[c++]=\"_code_input' size='35' autocomplete='off'/></div></div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_code_success'><p>\";\na[c++]=ZmMsg.passwordRecoveryCodeSuccessDescription;\na[c++]=\"</p><table role='presentation' width=100% class='ZPropertySheet' cellspacing='6'><tr><td class='ZOptionsField'><button id='\";\na[c++]=e.id;\na[c++]=\"_CONTINUE_BUTTON' class='ZmPasswordRecoveryButton' tabindex=0></button></td><td><button id='\";\na[c++]=e.id;\na[c++]=\"_RESET_PASSWORD' class='ZmPasswordRecoveryButton' tabindex=0></button></td></tr></table></div><div id='\";\na[c++]=e.id;\na[c++]=\"_reset_password'><div id='\";\na[c++]=e.id;\na[c++]=\"_reset_password_description'><p>\";\na[c++]=ZmMsg.passwordRecoveryResetDescription;\na[c++]=\"</p></div><div id='\";\na[c++]=e.id;\na[c++]=\"_reset_password_error' style='display:none;' class='ZmPasswordRecoverySetupError'><table><tr><td><img class='ZLoginErrorIcon' altkey='ALT_ERROR' src='/img/dwt/ImgCritical_32.png' /></td><td id='\";\na[c++]=e.id;\na[c++]=\"_reset_password_error_message'>\";\na[c++]=ZmMsg.passwordRecoveryResetError;\na[c++]=\"</td></tr></table></div><div class='ZmPasswordRecoverySetupContainer'><label for='\";\na[c++]=e.id;\na[c++]=\"_password_new_input'>\";\na[c++]=ZmMsg.passwordRecoveryResetNewLabel;\na[c++]=\"</label><input type='password' id='\";\na[c++]=e.id;\na[c++]=\"_password_new_input' size='35' autocomplete='off'/><br /><br /><label for='\";\na[c++]=e.id;\na[c++]=\"_password_confirm_input'>\";\na[c++]=ZmMsg.passwordRecoveryResetConfirmLabel;\na[c++]=\"</label><input type='password' id='\";\na[c++]=e.id;\na[c++]=\"_password_confirm_input' size='35' autocomplete='off'/></div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_password_reset_success' style='margin-top: 60px;'><div class='ZmPasswordRecoverySetupContainer'><div class='ZmPasswordRecoverySetupInfo'><table><tr><td><img class='ZLoginInfoIcon' src='/img/dwt/ImgInformation_32.png' /></td><td>\";\na[c++]=ZmMsg.passwordRecoveryResetSuccessDescription;\na[c++]=\"</td></tr></table></div></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Dialogs#ZmPasswordRecovery\"},false)\n}if(AjxPackage.define(\"share.Quota\")){AjxTemplate.register(\"share.Quota#UsedLimited\",function(b,g,f,a){var e=Boolean(a);\nf=(typeof f==\"string\"?{id:f}:f)||{};\na=a||[];\nvar d=a.length;\nvar c=\"quotaUsed\";\nif(f.percent<85&&f.percent>65){c=\"quotaWarning\"\n}else{if(f.percent>=85){c=\"quotaCritical\"\n}}a[d++]=\"<div class='BannerBar'><div class='quotabar'><div style='width:\";\na[d++]=f.percent;\na[d++]=\"%' class='\";\na[d++]=c;\na[d++]=\"'></div></div></div>\";\nreturn e?a.length:a.join(\"\")\n},{id:\"share.Quota#UsedLimited\",\"class\":\"BannerBar\"},false);\nAjxTemplate.register(\"share.Quota\",AjxTemplate.getTemplate(\"share.Quota#UsedLimited\"),AjxTemplate.getParams(\"share.Quota#UsedLimited\"));\nAjxTemplate.register(\"share.Quota#UsedUnlimited\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='BannerTextQuota' style='display:none;'>\";\na[c++]=e.desc;\na[c++]=\"</div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Quota#UsedUnlimited\"},false);\nAjxTemplate.register(\"share.Quota#Tooltip\",function(b,g,f,a){var e=Boolean(a);\nf=(typeof f==\"string\"?{id:f}:f)||{};\na=a||[];\nvar d=a.length;\nif(f.username!=f.login){a[d++]='<div style=\"text-align:center;\">';\na[d++]=f.login;\na[d++]=\"</div>\"\n}a[d++]='<div style=\"text-align:center;margin-top:3px;\">';\nif(f.quota){var c=AjxMessageFormat.format(ZmMsg.usingDescLimited,[f.size,\"(\"+f.percent+\"%)\",f.limit]);\na[d++]=c\n}else{a[d++]=\"\\n\";\na[d++]=\"                    \";\na[d++]=f.desc;\na[d++]=\"\\n\";\na[d++]=\"                \"\n}a[d++]=\"</div>\";\nreturn e?a.length:a.join(\"\")\n},{id:\"share.Quota#Tooltip\"},false)\n}if(AjxPackage.define(\"share.Widgets\")){AjxTemplate.register(\"share.Widgets#ZmToolBarSeparator\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.itemId;\na[c++]=\"' valign='middle'><div class='vertSep'></div></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmToolBarSeparator\"},false);\nAjxTemplate.register(\"share.Widgets\",AjxTemplate.getTemplate(\"share.Widgets#ZmToolBarSeparator\"),AjxTemplate.getParams(\"share.Widgets#ZmToolBarSeparator\"));\nAjxTemplate.register(\"share.Widgets#ZmAppChooser\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZToolbarTable'><tr valign='middle' id='\";\na[c++]=e.id;\na[c++]=\"_items'><td id='\";\na[c++]=e.id;\na[c++]='_suffix\\' valign=bottom><div class=\\'ZAppTabSpacer\\'></div></td><td width=\"100%\" valign=\"middle\" align=\"right\" style=\"padding-right: 10px;\" id=\"admin_link_container\">\\n';\na[c++]=\"                &nbsp;\\n\";\na[c++]=\"            </td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmAppChooser\",\"class\":\"ZWidget\"},false);\nAjxTemplate.register(\"share.Widgets#ZmAppChooserItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=AjxTemplate.expand(\"dwt.Widgets#ZToolbarItem\",e);\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmAppChooserItem\"},false);\nAjxTemplate.register(\"share.Widgets#ZmAppChooserButton\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"AppTab\";\nb[d++]='<table role=\"presentation\" class=\\'ZWidgetTable Z';\nb[d++]=a;\nb[d++]=\"Table Z\";\nb[d++]=a;\nb[d++]=\"Border'style='table-layout:auto;'><tr><td id='\";\nb[d++]=f.id;\nb[d++]=\"_left_icon'  \\tclass='ZLeftIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_title'\\t\\tclass='ZWidgetTitle'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_right_icon' \\tclass='ZRightIcon ZWidgetIcon'></td><td id='\";\nb[d++]=f.id;\nb[d++]=\"_dropdown' \\tclass='ZDropDown'></td></tr></table>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"share.Widgets#ZmAppChooserButton\",\"class\":\"ZAppTab\"},false);\nAjxTemplate.register(\"share.Widgets#ZmAppChooserSpacer\",function(c,g,f,b){var e=Boolean(b);\nf=(typeof f==\"string\"?{id:f}:f)||{};\nb=b||[];\nvar d=b.length;\nvar a=f.buttonClass||\"AppTab\";\nb[d++]=\"<div class='Z\";\nb[d++]=a;\nb[d++]=\"Spacer'></div>\";\nreturn e?b.length:b.join(\"\")\n},{id:\"share.Widgets#ZmAppChooserSpacer\"},false);\nAjxTemplate.register(\"share.Widgets#ZToast\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ZToastBG'><div class='ZToastContent'><div id='\";\na[c++]=e.id;\na[c++]=\"_icon' class='ZToastIcon'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_text' class='ZToastText'></div></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZToast\",\"class\":\"ZToastInfo\"},false);\nAjxTemplate.register(\"share.Widgets#ZmSearchToolBar\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZToolbarTable'><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_searchMenuButton' class='ZmSearchToolbarCell'></td><td><div class='ZmSearchToolbarDiv'><div id='\";\na[c++]=e.id;\na[c++]=\"_inputField' class='ZmSearchInput'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_searchButton' class='ZmSearchButton' hint='icon'></div></div></td><!-- UNCOMMENT THIS IF YOU WANT CUSTOM SEARCH TO APPEAR AS A SEPARATE BUTTON ON SEARCH TOOLBAR\\n\";\na[c++]=\"\\t\\t\\t<td class='ZmSearchToolbarSeparatorCell'><div id='\";\na[c++]=e.id;\na[c++]=\"_customSearchButtonSep' class='vertSep' style='display:none'></div></td><td id='\";\na[c++]=e.id;\na[c++]=\"_customSearchButton' class='ZmSearchToolbarCell'></td><td class='ZmSearchToolbarSeparatorCell'><div class='vertSep'></div></td><td id='\";\na[c++]=e.id;\na[c++]=\"_saveButton' hint='icon' class='ZmSearchToolbarCell'></td>\\n\";\na[c++]=\"\\t\\t\\t--><!-- UNCOMMENT THIS FOR THE ADVANCED BUTTONS TO APPEAR\\n\";\na[c++]=\"\\t\\t\\t<td class='ZmSearchToolbarSeparatorCell'><div class='vertSep'></div></td><td id='\";\na[c++]=e.id;\na[c++]=\"_advancedButton' hint='text' class='ZmSearchToolbarCell'></td>\\n\";\na[c++]=\"\\t\\t\\t--></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmSearchToolBar\"},false);\nAjxTemplate.register(\"share.Widgets#ZmSearchResultsToolBar\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZToolbarTable'><tr><td class='ZmSearchResultText'><div id='\";\na[c++]=e.id;\na[c++]=\"_icon' class='ImgWarning_12' style='display:none; margin-right:5px;'></div><span id='\";\na[c++]=e.id;\na[c++]=\"_label'></span></td><td><table role=\\\"presentation\\\"><tr id='\";\na[c++]=e.id;\na[c++]=\"_items'><td id='\";\na[c++]=e.id;\na[c++]=\"_inputFieldCell' class='ZmSearchResultInputField'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_searchButton'   class='ZmSearchResultButton'></td><td id='\";\na[c++]=e.id;\na[c++]=\"_saveButton'     class='ZmSearchResultButton'></td></tr></table></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmSearchResultsToolBar\"},false);\nAjxTemplate.register(\"share.Widgets#ZmSearchResultsFilterPanel\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_basicPanel'><div class='header'>\";\na[c++]=ZmMsg.basicFilters;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_basic'></div></div><div id='\";\na[c++]=e.id;\na[c++]=\"_advancedPanel'><div class='header'>\";\na[c++]=ZmMsg.advancedFilters;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_advanced'></div></div><div><div class='header'>\";\na[c++]=ZmMsg.conditionals;\na[c++]=\"</div><div style='margin:5px;'>\";\na[c++]=ZmMsg.conditionalsDesc;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_conditionals'></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmSearchResultsFilterPanel\"},false);\nAjxTemplate.register(\"share.Widgets#ZmPeopleAutocompleteListView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr id='\";\na[c++]=e.rowId;\na[c++]='\\'><td><table role=\"presentation\" style=\"{padding-top:4px; padding-bottom:4px}\"><tr>';\nif(e.photoUrl){a[c++]='<td><img src=\"';\na[c++]=e.photoUrl;\na[c++]='\" width=32 height=32></img></td>'\n}else{a[c++]=\"<td>\";\na[c++]=AjxImg.getImageHtml(\"Person_32\");\na[c++]=\"</td>\"\n}a[c++]=\"<td><div class='ZmPeopleSearch-fullname' id='\";\na[c++]=e.rowId;\na[c++]=\"-fullName'></div>\";\nif(e.title){a[c++]=\"<div class='ZmPeopleSearch-title' id='\";\na[c++]=e.rowId;\na[c++]=\"-title'>\";\na[c++]=e.title;\na[c++]=\"</div>\"\n}a[c++]=\"<? if (data.email){ ?><div id='\";\na[c++]=e.rowId;\na[c++]=\"-email'></div><? } ?><? if (data.phone} { ?><div class='ZmPeopleSearch-phone' id='\";\na[c++]=e.rowId;\na[c++]=\"-phone'>\";\na[c++]=e.phone;\na[c++]=\"</div><? } ?></td></tr></table></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmPeopleAutocompleteListView\"},false);\nAjxTemplate.register(\"share.Widgets#ZmPeopleAutocompleteListView-NoResults\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr id='\";\na[c++]=e.rowId;\na[c++]='\\'><td class=\"ZmPeopleSearch-noresults\">';\na[c++]=ZmMsg.noCallResults;\na[c++]=\"</td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmPeopleAutocompleteListView-NoResults\"},false);\nAjxTemplate.register(\"share.Widgets#ZmPeopleAutocompleteListView-MoreResults\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<tr><td><table role=\\\"presentation\\\"><tr><td width='32'>&nbsp;</td><td>\";\na[c++]=ZmMsg.morePeopleResults;\na[c++]=\"</td></tr></table></td></tr>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmPeopleAutocompleteListView-MoreResults\"},false);\nAjxTemplate.register(\"share.Widgets#ZmChooseFolderDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ChooserDialog'><span id='\";\na[c++]=e.id;\na[c++]=\"_folderDescDivId' style='margin: 0; margin-bottom: 2px'></span><div>\";\na[c++]=ZmMsg.chooserDescription;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_inputDivId'></div><div class='overview' id='\";\na[c++]=e.id;\na[c++]=\"_folderTreeDivId'></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmChooseFolderDialog\"},false);\nAjxTemplate.register(\"share.Widgets#ZmChooseAccountDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ChooserDialog' style='width:300px'><table role=\\\"presentation\\\" width=100%><tr><td><center><div id='\";\na[c++]=e.id;\na[c++]=\"_chooseAccountMsg'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_accountSelectId'></div></center></td></tr></table></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmChooseAccountDialog\"},false);\nAjxTemplate.register(\"share.Widgets#ZmPickTagDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='ChooserDialog'><div style='width:300px'>\";\na[c++]=ZmMsg.chooserDescription;\na[c++]=\"</div><div id='\";\na[c++]=e.id;\na[c++]=\"_inputDivId'></div><div style='background-color:white; width:100%; overflow:auto' id='\";\na[c++]=e.id;\na[c++]=\"_tagTreeDivId'></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmPickTagDialog\"},false);\nAjxTemplate.register(\"share.Widgets#ZmDebugLogDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div class='DebugLogDialog-desc' id='\";\na[c++]=e.id;\na[c++]=\"_desc'></div><div class='DebugLogDialog-log' id='\";\na[c++]=e.id;\na[c++]=\"_log'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmDebugLogDialog\"},false);\nAjxTemplate.register(\"share.Widgets#ZmDumpsterDialog\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<table role=\"presentation\"><tr><td id=\\'';\na[c++]=e.id;\na[c++]=\"_inputContainerId' class=\\\"DumpsterSearchInput\\\"></td><td id='\";\na[c++]=e.id;\na[c++]=\"_searchButtonContainerId'></td></tr></table><div id='\";\na[c++]=e.id;\na[c++]=\"_toolbar'></div><div id='\";\na[c++]=e.id;\na[c++]=\"_listview'></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmDumpsterDialog\"},false);\nAjxTemplate.register(\"share.Widgets#ZmShareProxyToolTip\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<div style=\"width:250px\"><div class=\"Img';\na[c++]=e.icon;\na[c++]='\" style=\"float:left;vertical-align:top\"></div><div style=\"font-weight:bold;font-size:1.1em;padding:3px;\">';\na[c++]=AjxStringUtil.htmlEncode(e.normalizedFolderPath);\na[c++]='</div><div style=\"clear:both;\"><table role=\"presentation\" class=\"ZPropertySheet\" cellspacing=\"6\"><tr valign=\"top\"><th align=\"right\">';\na[c++]=ZmMsg.ownerLabel;\na[c++]=\"</th><td>\";\na[c++]=AjxStringUtil.htmlEncode(e.normalizedOwnerName);\na[c++]='</td></tr><tr valign=\"top\"><th align=\"right\">';\na[c++]=ZmMsg.granteeLabel;\na[c++]=\"</th><td>\";\na[c++]=AjxStringUtil.htmlEncode(e.normalizedGranteeName);\na[c++]='</td></tr><tr valign=\"top\"><th align=\"right\">';\na[c++]=ZmMsg.roleLabel;\na[c++]=\"</th><td>\";\na[c++]=e.roleName;\na[c++]=\" (\";\na[c++]=e.roleActions;\na[c++]=')</td></tr><tr height=\"4\"><td></td><td></td></tr><tr valign=\"top\"><th align=\"right\">';\na[c++]=ZmMsg.noteLabel;\na[c++]='</th><td><div style=\"margin-top:4px;font-size:.9em;\">';\na[c++]=AjxMessageFormat.format(ZmMsg.sharedFoldersLinkHint,[AjxStringUtil.htmlEncode(e.defaultMountpointName)]);\na[c++]=\"</div></td></tr></table></div></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmShareProxyToolTip\"},false);\nAjxTemplate.register(\"share.Widgets#ZmShareSearchView\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]='<div class=\"FilterTree\" style=\"width:300px;\"><div id=\"';\na[c++]=e.id;\na[c++]='_FILTER\" tabindex=\"100\"></div><div id=\"';\na[c++]=e.id;\na[c++]='_TREE\" tabindex=\"200\"></div></div><table role=\"presentation\" width=\"100%\" class=\"ZPropertySheet\" cellspacing=\"6\"><tr><td>';\na[c++]=ZmMsg.sharedFoldersFindLabel;\na[c++]='</td><td><div id=\"';\na[c++]=e.id;\na[c++]='_EMAIL\" tabindex=\"300\"></div></td><td><div id=\"';\na[c++]=e.id;\na[c++]='_SEARCH\" tabindex=\"400\"></div></td></tr><tr><td>';\na[c++]=ZmMsg.includeLabel;\na[c++]=\":</td><td colspan='2'><div id=\\\"\";\na[c++]=e.id;\na[c++]='_APP\" tabindex=\"500\"></div></td></tr></table>';\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmShareSearchView\"},false);\nAjxTemplate.register(\"share.Widgets#ZmAddressInputField\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.holderId;\na[c++]=\"' class='addrBubbleHolder-empty'><span id='\";\na[c++]=e.dragInsertionBarId;\na[c++]=\"' style='display:none' class='addrBubbleInsertionBar'>&nbsp;</span><\";\na[c++]=e.inputTagName;\na[c++]=\" autocomplete='off' aria-autocomplete='true' class='addrInputField user_font_system' id='\";\na[c++]=e.inputId;\na[c++]=\"'\\n\";\na[c++]=\"\\t\\t\";\nif(e.label){a[c++]=\" aria-label='\";\na[c++]=e.label;\na[c++]=\"' \"\n}a[c++]=\"\\n\";\na[c++]=\"\\t\\t /></div>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"share.Widgets#ZmAddressInputField\"},false)\n}if(AjxPackage.define(\"zimbra.Widgets\")){AjxTemplate.register(\"zimbra.Widgets#ZmErrorDialogControls\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<div id='\";\na[c++]=e.id;\na[c++]=\"_buttons' class='DwtDialogButtonBar'>\";\nif(AjxEnv.isNav){a[c++]=\"<input type='button' id='\";\na[c++]=e.id;\na[c++]=\"_focus' style='height:0px;width:0px;display:none;'>\"\n}a[c++]=\"</div>\";\nreturn d?a.length:a.join(\"\")\n},{width:\"20\",id:\"zimbra.Widgets#ZmErrorDialogControls\",height:\"32\"},false);\nAjxTemplate.register(\"zimbra.Widgets\",AjxTemplate.getTemplate(\"zimbra.Widgets#ZmErrorDialogControls\"),AjxTemplate.getParams(\"zimbra.Widgets#ZmErrorDialogControls\"));\nAjxTemplate.register(\"zimbra.Widgets#ZmErrorDialogContent\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" width='100%' height='100%'><tr><td>\";\na[c++]=e.message;\na[c++]=\"</td></tr>\";\nif(e.showDetails){a[c++]=\"<tr><td><hr/></td></tr><tr><td style='height:100%;vertical-align:top;'>\\n\";\na[c++]=\"\\t\\t\\t\\t\";\na[c++]=e.detail;\na[c++]=\"\\n\";\na[c++]=\"\\t\\t\\t</td></tr>\"\n}a[c++]=\"</table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"zimbra.Widgets#ZmErrorDialogContent\"},false);\nAjxTemplate.register(\"zimbra.Widgets#ZmColorMenuItem\",function(b,f,e,a){var d=Boolean(a);\ne=(typeof e==\"string\"?{id:e}:e)||{};\na=a||[];\nvar c=a.length;\na[c++]=\"<table role=\\\"presentation\\\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder'><tr><td id='\";\na[c++]=e.id;\na[c++]=\"_title' class='ZWidgetTitle'></td></tr></table>\";\nreturn d?a.length:a.join(\"\")\n},{id:\"zimbra.Widgets#ZmColorMenuItem\",\"class\":\"ZWidget\"},false)\n};\n"
                    },
                    "redirectURL": "",
                    "headersSize": 364,
                    "bodySize": 1001287
                },
                "cache": {},
                "timings": {
                    "send": 0,
                    "wait": 0,
                    "receive": 0
                }
            }
        ],
        "_webSocketEntries": {},
        "_settings": {
            "_proxy": {}
        }
    }
}
