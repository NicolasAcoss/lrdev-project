{
    "log": {
        "version": "1.2",
        "creator": {
            "name": "DevWeb",
            "version": "1.2"
        },
        "pages": [
            {
                "startedDateTime": "2022-12-06T11:38:19.207168Z",
                "id": "page_1",
                "title": "https://mail.etu.univ-lorraine.fr/service/zimlet/res/Zimlets-nodev_all.js.zgz",
                "pageTimings": {}
            }
        ],
        "entries": [
            {
                "pageref": "page_1",
                "startedDateTime": "2022-12-06T11:38:19.207168Z",
                "time": 0,
                "_isResource": false,
                "request": {
                    "method": "GET",
                    "url": "https://mail.etu.univ-lorraine.fr/service/zimlet/res/Zimlets-nodev_all.js.zgz?language=fr&cosId=3c378b01-3a7b-4fa9-b5f3-c2ad5b13825e",
                    "httpVersion": "HTTP/2.0",
                    "cookies": [
                        {
                            "name": "UL-AUTHTRACE",
                            "value": "TRACE-4112-JXC2ao-ce1Zm2D1QbNJ8m16DlLYEFM9cZACAS-LEIA",
                            "httpOnly": false
                        },
                        {
                            "name": "JSESSIONID",
                            "value": "node01ewv5q86m64i21vkfxtflutla86873.node0",
                            "httpOnly": false
                        },
                        {
                            "name": "ZM_AUTH_TOKEN",
                            "value": "0_a80cf5ba65b244a73d683b9482d447f357160abf_69643d33363a62636630316235642d373166332d343464652d396163322d3235343836613061666531323b6578703d31333a313637303336363239323738353b747970653d363a7a696d6272613b753d313a613b7469643d31303a313932323132303830333b76657273696f6e3d31343a382e382e31355f47415f333836393b",
                            "httpOnly": false
                        }
                    ],
                    "headers": [
                        {
                            "name": "accept",
                            "value": "*/*"
                        },
                        {
                            "name": "accept-encoding",
                            "value": "gzip, deflate, br"
                        },
                        {
                            "name": "accept-language",
                            "value": "fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3"
                        },
                        {
                            "name": "cookie",
                            "value": "UL-AUTHTRACE=TRACE-4112-JXC2ao-ce1Zm2D1QbNJ8m16DlLYEFM9cZACAS-LEIA; JSESSIONID=node01ewv5q86m64i21vkfxtflutla86873.node0; ZM_AUTH_TOKEN=0_a80cf5ba65b244a73d683b9482d447f357160abf_69643d33363a62636630316235642d373166332d343464652d396163322d3235343836613061666531323b6578703d31333a313637303336363239323738353b747970653d363a7a696d6272613b753d313a613b7469643d31303a313932323132303830333b76657273696f6e3d31343a382e382e31355f47415f333836393b"
                        },
                        {
                            "name": "dnt",
                            "value": "1"
                        },
                        {
                            "name": "referer",
                            "value": "https://mail.etu.univ-lorraine.fr/"
                        },
                        {
                            "name": "sec-fetch-dest",
                            "value": "script"
                        },
                        {
                            "name": "sec-fetch-mode",
                            "value": "no-cors"
                        },
                        {
                            "name": "sec-fetch-site",
                            "value": "same-origin"
                        },
                        {
                            "name": "te",
                            "value": "trailers"
                        },
                        {
                            "name": "user-agent",
                            "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0"
                        }
                    ],
                    "queryString": [
                        {
                            "name": "language",
                            "value": "fr"
                        },
                        {
                            "name": "cosId",
                            "value": "3c378b01-3a7b-4fa9-b5f3-c2ad5b13825e"
                        }
                    ],
                    "headersSize": -1,
                    "bodySize": -1
                },
                "response": {
                    "status": 200,
                    "statusText": "OK",
                    "httpVersion": "HTTP/2.0",
                    "cookies": null,
                    "headers": [
                        {
                            "name": "cache-control",
                            "value": "no-store, no-cache, must-revalidate, max-age=0"
                        },
                        {
                            "name": "content-type",
                            "value": "text/javascript"
                        },
                        {
                            "name": "date",
                            "value": "Tue, 06 Dec 2022 10:38:19 GMT"
                        },
                        {
                            "name": "expires",
                            "value": "Tue, 24 Jan 2000 17:46:50 GMT"
                        },
                        {
                            "name": "pragma",
                            "value": "no-cache"
                        },
                        {
                            "name": "server",
                            "value": "nginx"
                        },
                        {
                            "name": "vary",
                            "value": "User-Agent"
                        },
                        {
                            "name": "x-recouv-allowed",
                            "value": "Recouv"
                        }
                    ],
                    "content": {
                        "size": 227593,
                        "mimeType": "",
                        "text": "if(!window.com_zimbra_emailtemplates){\ncom_zimbra_emailtemplates={}\n}\na=com_zimbra_emailtemplates;\na.EmailTemplatesZimlet_templates=\"Templates\";\na.EmailTemplatesZimlet_tooltip=\"Allows users to setup and insert Templates\";\na.EmailTemplatesZimlet_folderNotExist=\"Template's folder does not exist\";\na.EmailTemplatesZimlet_bodyOnly=\"Insert (body only)\";\na.EmailTemplatesZimlet_bodyAndSubject=\"Insert (body & subject)\";\na.EmailTemplatesZimlet_bodySubjectAndParticipants=\"Insert (body, subject & participants)\";\na.EmailTemplatesZimlet_reloadTemplates=\"Reload Templates\";\na.EmailTemplatesZimlet_preferences=\"Preferences\";\na.EmailTemplatesZimlet_replaceTemplateData=\"Replace Template Data\";\na.EmailTemplatesZimlet_replaceGenericData=\"Please replace the following generic text(s) with valid data\";\na.EmailTemplatesZimlet_couldNotInsertApptAttendees=\"Could not insert appointment's attendees\";\na.EmailTemplatesZimlet_templateFolderPath=\"Template Folder's path:\";\na.EmailTemplatesZimlet_setTemplatesFolder=\"Set Templates Folder\";\na.EmailTemplatesZimlet_selectTemplatesFolder=\"Please select a folder where Templates are stored\";\na.EmailTemplatesZimlet_save=\"Save\";\na.EmailTemplatesZimlet_saved=\"Template saved successfully\";\na.EmailTemplatesZimlet_saved_title=\"Template saved\";\na.EmailTemplatesZimlet_restartBrowser=\"The browser must be refreshed for the changes to take effect.  Continue?\";\na.EmailTemplatesZimlet_noSubject=\"You haven't specified a subject. Please do so prior saving the template!\";\na.EmailTemplatesZimlet_noSubject_title=\"No subject!\";\na.EmailTemplatesZimlet_genericNames=\"Generic Names\";\na.EmailTemplatesZimlet_helpLine1=\"You can use generic names technique to replace common words. Just before inserting the template <br/>Zimlet will alert you to replace them\";\na.EmailTemplatesZimlet_helpLine2=\"For example: You could have <strong>hi ${firstName}</strong> in the body or in the subject\";\na.EmailTemplatesZimlet_helpLine3=\"<strong>Generic Name Rules:</strong><br/>1. The name of the generic word <strong>can only contain</strong> letters, numbers and underscore \";\na.EmailTemplatesZimlet_helpLine4=\"For example: <strong>${firstName}</strong>, <strong>${first123}</strong> or  <strong>${First_Name}</strong>\";\na.EmailTemplatesZimlet_helpLine5=\"2.The generic names are <strong>case sensitive</strong>.\";\na.EmailTemplatesZimlet_helpLine6=\"For example:<strong>${firstName}</strong> and <strong>${FIRSTNAME}</strong> are considered different\";\ndelete a;\nif(!window.com_zimbra_emailtemplates){\ncom_zimbra_emailtemplates={}\n}\na=com_zimbra_emailtemplates;\na.label=\"Mod\\u00e8les de mail\";\na.description=\"Permet aux utilisateurs d'ins\\u00e9rer des Mod\\u00e8les de mail\";\na.EmailTemplatesZimlet_templates=\"Mod\\u00e8les\";\na.EmailTemplatesZimlet_tooltip=\"Permet aux utilisateurs de param\\u00e9trer et d'ins\\u00e9rer des mod\\u00e8les\";\na.EmailTemplatesZimlet_folderNotExist=\"Dossier de mod\\u00e8les inexistant\";\na.EmailTemplatesZimlet_bodyOnly=\"Ins\\u00e9rer (corps uniquement)\";\na.EmailTemplatesZimlet_bodyAndSubject=\"Ins\\u00e9rer (corps et objet)\";\na.EmailTemplatesZimlet_bodySubjectAndParticipants=\"Ins\\u00e9rer (corps, objet et participants)\";\na.EmailTemplatesZimlet_reloadTemplates=\"Recharger mod\\u00e8les\";\na.EmailTemplatesZimlet_preferences=\"Pr\\u00e9f\\u00e9rences\";\na.EmailTemplatesZimlet_replaceTemplateData=\"Remplacer les donn\\u00e9es des mod\\u00e8les\";\na.EmailTemplatesZimlet_replaceGenericData=\"Veuillez remplacer les textes g\\u00e9n\\u00e9riques suivants avec des donn\\u00e9es valides\";\na.EmailTemplatesZimlet_couldNotInsertApptAttendees=\"Impossible d'ins\\u00e9rer les participants au rendez-vous\";\na.EmailTemplatesZimlet_templateFolderPath=\"Chemin du dossier de mod\\u00e8les\\u00a0:\";\na.EmailTemplatesZimlet_setTemplatesFolder=\"D\\u00e9finir le dossier de mod\\u00e8les\";\na.EmailTemplatesZimlet_selectTemplatesFolder=\"Veuillez s\\u00e9lectionner un dossier o\\u00f9 sont stock\\u00e9s les mod\\u00e8les\";\na.EmailTemplatesZimlet_save=\"Enregistrer\";\na.EmailTemplatesZimlet_saved=\"Mod\\u00e8le enregistr\\u00e9 avec succ\\u00e8s\";\na.EmailTemplatesZimlet_saved_title=\"Mod\\u00e8le enregistr\\u00e9\";\na.EmailTemplatesZimlet_restartBrowser=\"La fen\\u00eatre du navigateur doit \\u00eatre rafra\\u00eechie pour appliquer les changements. Continuer ?\";\na.EmailTemplatesZimlet_noSubject=\"Vous n'avez pas sp\\u00e9cifi\\u00e9 d'objet. Veuillez le faire avant de sauvegarder le mod\\u00e8le !\";\na.EmailTemplatesZimlet_noSubject_title=\"Aucun objet !\";\na.EmailTemplatesZimlet_genericNames=\"Noms g\\u00e9n\\u00e9riques\";\na.EmailTemplatesZimlet_helpLine1=\"Vous pouvez utiliser une technique de noms g\\u00e9n\\u00e9riques pour remplacer des mots communs. Juste avant d'ins\\u00e9rer le mod\\u00e8le <br/>Zimlet vous avertira lorsqu'il faudra les remplacer\";\na.EmailTemplatesZimlet_helpLine2=\"Par exemple, vous pouvez avoir <strong>Salut ${pr\\u00e9nom}</strong> dans le corps ou dans l'objet\";\na.EmailTemplatesZimlet_helpLine3=\"<strong>R\\u00e8gles de noms g\\u00e9n\\u00e9riques\\u00a0:</strong><br/>1. Le nom du mot g\\u00e9n\\u00e9rique <strong>peut contenir uniquement</strong> des lettres, des chiffres et tiret bas \";\na.EmailTemplatesZimlet_helpLine4=\"Par exemple\\u00a0: <strong>${pr\\u00e9nom}</strong>, <strong>${pr\\u00e9nom123}</strong> ou  <strong>${Pr\\u00e9nom_Nom}</strong>\";\na.EmailTemplatesZimlet_helpLine5=\"2. Les noms g\\u00e9n\\u00e9riques sont <strong>sensibles \\u00e0 la casse</strong>.\";\na.EmailTemplatesZimlet_helpLine6=\"Par exemple\\u00a0:<strong>${Pr\\u00e9nom}</strong> et <strong>${PR\\u00c9NOM}</strong> sont consid\\u00e9r\\u00e9s comme diff\\u00e9rents\";\ndelete a;\nif(!window.com_zimbra_attachmail){\ncom_zimbra_attachmail={}\n}\na=com_zimbra_attachmail;\na.label=\"Email Attacher\";\na.description=\"Attach email messages when composing a new message.\";\na.AttachMailZimlet_panel_label=\"Email Attacher\";\na.AttachMailZimlet_panel_tooltip='Adds an \"Attach Mail\" tab to the compose toolbar \"Add Attachment\" dialog.';\na.AttachMailZimlet_tab_label=\"Mail\";\na.AttachMailZimlet_tab_button_search=\"Search\";\na.AttachMailZimlet_tab_button_view=\"View Message\";\ndelete a;\nif(!window.com_zimbra_attachmail){\ncom_zimbra_attachmail={}\n}\na=com_zimbra_attachmail;\na.label=\"Email Attacher\";\na.description=\"Joignez des mails lorsque vous en r\\u00e9digez un nouveau.\";\na.AttachMailZimlet_panel_label=\"Email Attacher\";\na.AttachMailZimlet_panel_tooltip='Ajoute une \\u00e9tiquette \"Joindre mail\" \\u00e0 la barre d\\u2019outils de composition de la bo\\u00eete de dialogue \"Ajouter pi\\u00e8ce jointe\".';\na.AttachMailZimlet_tab_label=\"Mail\";\na.AttachMailZimlet_tab_button_search=\"Rechercher\";\na.AttachMailZimlet_tab_button_view=\"Visualiser message\";\ndelete a;\nif(!window.com_zimbra_srchhighlighter){\ncom_zimbra_srchhighlighter={}\n}\na=com_zimbra_srchhighlighter;\na.label=\"Search Highlighter\";\na.description=\"After a mail search, this Zimlet highlights Search terms with yellow color.\";\na.SearchHighlighterZimlet_MenuLabel=\"Clear Search Highlights\";\na.SearchHighlighterZimlet_ZimletError=\"Search Highlighter Zimlet Error:\";\ndelete a;\nif(!window.com_zimbra_srchhighlighter){\ncom_zimbra_srchhighlighter={}\n}\na=com_zimbra_srchhighlighter;\na.label=\"Surligneur de recherche\";\na.description=\"Apr\\u00e8s une recherche de mail, ce Zimlet surligne les termes de la recherche en jaune\";\na.SearchHighlighterZimlet_MenuLabel=\"\\u00c9liminer Surligner la recherche\";\na.SearchHighlighterZimlet_ZimletError=\"Erreur surligneur de recherche Zimlet\\u00a0:\";\ndelete a;\nif(!window.com_zimbra_stickynotes){\ncom_zimbra_stickynotes={}\n}\na=com_zimbra_stickynotes;\na.label=\"StickyNotes\";\na.description=\"Add a sticky note to email messages.\";\na.sn_label=\"StickyNotes\";\na.sn_tooltip=\"Add a sticky note to email messages\";\na.sn_EmailsWithStickyNotes=\"Emails with StickyNotes\";\na.sn_notesSaved=\"StickyNotes Saved\";\na.sn_preferences=\"Preferences\";\na.sn_addToolbarButton=\"Add StickyNotes button to main toolbar\";\na.sn_enableStickyNotesZimlet=\"Enable Sticky Notes Zimlet\";\na.sn_notes=\"Notes: Changing above preferences would refresh browser\";\ndelete a;\nif(!window.com_zimbra_stickynotes){\ncom_zimbra_stickynotes={}\n}\na=com_zimbra_stickynotes;\na.sn_label=\"Post-It\";\na.sn_tooltip=\"Ajouter un Post-It aux messages\";\na.sn_EmailsWithStickyNotes=\"Courriers \\u00e9lectroniques avec Post-It\";\na.sn_notesSaved=\"Post-It enregistr\\u00e9s\";\na.sn_preferences=\"Pr\\u00e9f\\u00e9rences\";\na.sn_addToolbarButton=\"Ajouter un bouton Post-It \\u00e0 la barre d'outils principale\";\na.sn_enableStickyNotesZimlet=\"Activer le Zimlet Post-It\";\na.sn_notes=\"Remarques\\u00a0: la modification des pr\\u00e9f\\u00e9rences ci-dessus actualisera le navigateur\";\ndelete a;\nif(!window.com_zimbra_securemail){\ncom_zimbra_securemail={}\n}\na=com_zimbra_securemail;\na.label=\"Secure Email\";\na.description=\"Sign & verify emails with S/MIME\";\na.prefSection=\"Secure Email\";\na.prefSecurityLabel=\"Settings\";\na.prefSecurityAuto=\"Remember setting from last email\";\na.prefSecurityNone=\"Do not sign or encrypt\";\na.prefSecuritySign=\"Sign only\";\na.prefSecurityBoth=\"Sign and encrypt\";\na.dontSignMessage=\"Don\\u2019t Sign\";\na.signMessage=\"Sign\";\na.signAndEncryptMessage=\"Sign and Encrypt\";\na.browseBtnLabel=\"Browse to certificate...\";\na.settingHeader=\"Default Setting for New Emails\";\na.settingHelpText=\"You can change this when sending an email.\";\na.certificateHeader=\"Certificate\";\na.certificateHelpText=\"Please upload a certificate to enable Secure Email.\";\na.certificateUploadingHelpText=\"Uploading and verifying...\";\na.certificateLoadingHelpText=\"Getting your certificate...\";\na.certificateViewLabel=\"View\";\na.certificateRemoveLabel=\"Remove\";\na.certificateRemoveWarning=\"Are you sure you would like to remove this certificate?\";\na.dragDropLabel=\"Drag and Drop a certificate here\";\na.uploadOptionsOr=\"or\";\na.uploadOptionsAnd=\"and\";\na.saveToCompleteUpload=\"Click Save to complete upload\";\na.passwordDialogTitle=\"Password Required\";\na.passwordDialogCancel=\"Cancel\";\na.passwordDialogSubmit=\"Submit\";\na.passwordDialogError=\"Invalid Password. Please try again.\";\na.passwordDialogInputLabel=\"Please enter password for this certificate\";\na.certificate=\"Certificate\";\na.certSubject=\"Issued to\";\na.certSubjectCN=\"Common Name (CN)\";\na.certSubjectOrg=\"Organization (O)\";\na.certSubjectOrgUnit=\"Organizational Unit (OU)\";\na.certSubjectEmail=\"Email\";\na.certSubjectCountry=\"Country\";\na.certSubjectState=\"State\";\na.certSubjectCity=\"City\";\na.certIssuer=\"Issued by\";\na.certIssuerCN=\"Common Name (CN)\";\na.certIssuerOrg=\"Organization (O)\";\na.certIssuerOrgUnit=\"Organizational Unit (OU)\";\na.certIssuerEmail=\"Email\";\na.certIssuerCountry=\"Country\";\na.certIssuerState=\"State\";\na.certIssuerCity=\"City\";\na.certValidity=\"Period of Validity\";\na.certValidityBegin=\"Begins on\";\na.certValidityEnd=\"Ends on\";\na.certInfo=\"Fingerprints\";\na.certInfoSN=\"Serial number\";\na.certInfoAlg=\"Algorithm\";\na.subjectAltName=\"Subject Alternative Name\";\na.subjectAltNameotherName=\"Other Name\";\na.subjectAltNamerfc822Name=\"Email\";\na.subjectAltNamedNSName=\"Domain\";\na.subjectAltNamex400Address=\"X.400\";\na.subjectAltNamedirectoryName=\"Directory\";\na.subjectAltNameediPartyName=\"EDI Party\";\na.subjectAltNameuniformResourceIdentifier=\"URI\";\na.subjectAltNameiPAddress=\"IP Address\";\na.subjectAltNameregisteredID=\"Registered ID\";\na.signedMsg=\"Signed by\";\na.encryptedMsg=\"This message is encrypted\";\na.signedAndencryptedMsg=\"Signed and Encrypted by\";\na.tamperedMsg=\"This message has been tampered with\";\na.invalidCertificateMsg=\"Certificate is invalid\";\na.expiredCertificateMsg=\"Certificate expired\";\na.notYetValidCertificateMsg=\"Certificate is not yet valid\";\na.revokedCertificateMsg=\"Certificate is revoked\";\na.untrustedCertificateMsg=\"Certificate is not trusted\";\na.certificateEmailInvalidMsg=\"Certificate is invalid because the email address does not match\";\na.invalidSignatureMsg=\"Signature is invalid\";\na.signatureValidationFailedMsg=\"Unable to validate signature\";\na.certificateViewFullLabel=\"View certificate\";\na.tamperedCertificate=\"This certificate has been tampered with\";\na.invalidCertificate=\"This certificate is not yet valid\";\na.expiredCertificate=\"This certificate has expired\";\na[\"decryptionError.LOAD_CERTIFICATE_FAILED\"]=\"This message cannot be decrypted because your certificate is not valid or is missing.\";\na[\"decryptionError.LOAD_PRIVATE_KEY_FAILED\"]=\"This message cannot be decrypted because your private key is not valid or is missing.\";\na[\"decryptionError.DECRYPTION_FAILED\"]=\"Something went wrong and this message cannot be decrypted.\";\na[\"decryptionError.USER_CERT_MISMATCH\"]=\"This message cannot be decrypted because it was not encrypted with your current certificate.\";\na.security=\"Security\";\na.validFileTypes=\"Valid file types are\";\na.allowedFileTypes=\"Allowed file types are\";\na.invalidCertificateUploaded=\"Certificate validation failed. Invalid certificate uploaded.\";\na.duplicateCertificateUploaded=\"This certificate already exists\";\na[\"smime.ENCRYPTION_FAILED\"]=\"Message encryption failed.\";\na[\"smime.SIGNING_FAILED\"]=\"Message signing failed.\";\na[\"smime.RECIPIENT_SMIME_CERT_NOT_FOUND\"]=\"No valid public certificate found for {0}\";\na[\"smime.MSG_ENCRYPTION_FAILED\"]=\"Something went wrong and this message cannot be encrypted.\";\na[\"smime.MSG_SIGNING_FAILED\"]=\"Something went wrong and this message cannot be signed.\";\na[\"smime.LOAD_CERTIFICATE_FAILED\"]=\"No certificate found.\";\na[\"smime.USER_CERT_NOT_YET_VALID\"]=\"Certificate is not yet valid.\";\na[\"smime.CERT_VALIDATION_FAILED\"]=\"Certificate validation failed.\";\na[\"smime.USER_CERT_EXPIRED\"]=\"Certificate has expired.\";\na[\"smime.USER_CERT_REVOKED\"]=\"Certificate has been revoked.\";\na[\"smime.USER_CERT_EMAIL_ADDRESS_NOT_MATCHING\"]=\"Certificate email address does not match your account email address.\";\na[\"smime.USER_CERT_NOT_TRUSTED\"]=\"Certificate is not from trusted authority.\";\na[\"smime.OPERATION_DENIED\"]=\"This operation is not permitted\";\na[\"smime.DELEGATE_SEND_SECURE_PERM_DENIED\"]=\"Delegate can not send Secure Mail on behalf of owner.\";\na[\"smime.SERVER_EXTENSION_NOT_INSTALLED\"]=\"S/MIME extension for server is not installed. Please contact your System Administrator.\";\ndelete a;\nif(!window.com_zimbra_securemail){\ncom_zimbra_securemail={}\n}\na=com_zimbra_securemail;\na.label=\"Messagerie s\\u00e9curis\\u00e9e\";\na.description=\"Signer et v\\u00e9rifier les mails avec S/MIME\";\na.prefSection=\"Messagerie s\\u00e9curis\\u00e9e\";\na.prefSecurityLabel=\"Param\\u00e8tres\";\na.prefSecurityAuto=\"M\\u00e9moriser le param\\u00e8tre du dernier mail\";\na.prefSecurityNone=\"Ne pas signer ni crypter\";\na.prefSecuritySign=\"Signer uniquement\";\na.prefSecurityBoth=\"Signer et crypter\";\na.dontSignMessage=\"Ne pas signer\";\na.signMessage=\"Signer\";\na.signAndEncryptMessage=\"Signer et crypter\";\na.browseBtnLabel=\"Rechercher le certificat...\";\na.settingHeader=\"Param\\u00e8tre par d\\u00e9faut pour les nouveaux mails\";\na.settingHelpText=\"Vous pouvez modifier ce param\\u00e8tre \\u00e0 chaque envoi de mail.\";\na.certificateHeader=\"Certificat\";\na.certificateHelpText=\"Pour activer la messagerie s\\u00e9curis\\u00e9e, vous devez uploader un certificat.\";\na.certificateUploadingHelpText=\"Upload et v\\u00e9rification...\";\na.certificateLoadingHelpText=\"Lecture du certificat...\";\na.certificateViewLabel=\"Afficher\";\na.certificateRemoveLabel=\"Retirer\";\na.certificateRemoveWarning=\"Voulez-vous vraiment retirer ce certificat ?\";\na.dragDropLabel=\"Glissez-d\\u00e9posez un certificat ici\";\na.uploadOptionsOr=\"ou\";\na.uploadOptionsAnd=\"et\";\na.saveToCompleteUpload=\"Pour valider l\\u2019upload de ce certificat, cliquez sur Enregistrer.\";\na.passwordDialogTitle=\"Mot de passe requis\";\na.passwordDialogCancel=\"Annuler\";\na.passwordDialogSubmit=\"Envoyer\";\na.passwordDialogError=\"Mot de passe incorrect. R\\u00e9essayez.\";\na.passwordDialogInputLabel=\"Vous devez entrer le mot de passe associ\\u00e9 \\u00e0 ce certificat \";\na.certificate=\"Certificat\";\na.certSubject=\"\\u00c9mis pour\";\na.certSubjectCN=\"Nom commun (CN)\";\na.certSubjectOrg=\"Soci\\u00e9t\\u00e9 (O)\";\na.certSubjectOrgUnit=\"Division commerciale (OU)\";\na.certSubjectEmail=\"Adresse mail\";\na.certSubjectCountry=\"Pays\";\na.certSubjectState=\"R\\u00e9gion\";\na.certSubjectCity=\"Ville\";\na.certIssuer=\"\\u00c9mis par\";\na.certIssuerCN=\"Nom commun (CN)\";\na.certIssuerOrg=\"Soci\\u00e9t\\u00e9 (O)\";\na.certIssuerOrgUnit=\"Division commerciale (OU)\";\na.certIssuerEmail=\"Adresse mail\";\na.certIssuerCountry=\"Pays\";\na.certIssuerState=\"R\\u00e9gion\";\na.certIssuerCity=\"Ville\";\na.certValidity=\"P\\u00e9riode de validit\\u00e9\";\na.certValidityBegin=\"Commence le\";\na.certValidityEnd=\"Se termine le\";\na.certInfo=\"Empreintes\";\na.certInfoSN=\"Num\\u00e9ro de s\\u00e9rie\";\na.certInfoAlg=\"Algorithme\";\na.subjectAltName=\"Valeur SAN du certificat\";\na.subjectAltNameotherName=\"Autre nom\";\na.subjectAltNamerfc822Name=\"Adresse mail\";\na.subjectAltNamedNSName=\"Domaine\";\na.subjectAltNamex400Address=\"X.400\";\na.subjectAltNamedirectoryName=\"Annuaire\";\na.subjectAltNameediPartyName=\"Valeur EDI\";\na.subjectAltNameuniformResourceIdentifier=\"URI\";\na.subjectAltNameiPAddress=\"Adresse IP\";\na.subjectAltNameregisteredID=\"Identifiant enregistr\\u00e9\";\na.signedMsg=\"Sign\\u00e9 par\";\na.encryptedMsg=\"Ce mail est crypt\\u00e9.\";\na.signedAndencryptedMsg=\"Sign\\u00e9 et crypt\\u00e9 par\";\na.tamperedMsg=\"Ce mail a \\u00e9t\\u00e9 falsifi\\u00e9.\";\na.invalidCertificateMsg=\"Ce certificat n\\u2019est pas valide.\";\na.expiredCertificateMsg=\"Ce certificat a expir\\u00e9.\";\na.notYetValidCertificateMsg=\"Ce certificat n\\u2019est pas encore valide.\";\na.revokedCertificateMsg=\"Ce certificat a \\u00e9t\\u00e9 r\\u00e9voqu\\u00e9.\";\na.untrustedCertificateMsg=\"Ce certificat n\\u2019a pas \\u00e9t\\u00e9 approuv\\u00e9.\";\na.certificateEmailInvalidMsg=\"Ce certificat n\\u2019est pas valide : l\\u2019adresse mail ne correspond pas.\";\na.invalidSignatureMsg=\"Cette signature n\\u2019est pas valide.\";\na.signatureValidationFailedMsg=\"Impossible de valider la signature.\";\na.certificateViewFullLabel=\"Afficher le certificat\";\na.tamperedCertificate=\"Ce certificat a \\u00e9t\\u00e9 falsifi\\u00e9.\";\na.invalidCertificate=\"Ce certificat n\\u2019est pas encore valide\";\na.expiredCertificate=\"Ce certificat a expir\\u00e9.\";\na[\"decryptionError.LOAD_CERTIFICATE_FAILED\"]=\"Impossible de d\\u00e9crypter ce mail : certificat manquant ou invalide.\";\na[\"decryptionError.LOAD_PRIVATE_KEY_FAILED\"]=\"Impossible de d\\u00e9crypter ce mail : cl\\u00e9 priv\\u00e9e manquante ou invalide.\";\na[\"decryptionError.DECRYPTION_FAILED\"]=\"Erreur : impossible de d\\u00e9crypter ce mail.\";\na[\"decryptionError.USER_CERT_MISMATCH\"]=\"Impossible de d\\u00e9crypter ce mail : il n\\u2019a pas \\u00e9t\\u00e9 crypt\\u00e9 avec votre certificat actuel.\";\na.security=\"S\\u00e9curit\\u00e9\";\na.validFileTypes=\"Types de fichiers valides :\";\na.allowedFileTypes=\"Types de fichier autoris\\u00e9s :\";\na.invalidCertificateUploaded=\"Impossible de valider ce certificat. Le certificat upload\\u00e9 est invalide.\";\na.duplicateCertificateUploaded=\"Ce certificat existe d\\u00e9j\\u00e0\";\na[\"smime.ENCRYPTION_FAILED\"]=\"Impossible de crypter ce mail.\";\na[\"smime.SIGNING_FAILED\"]=\"La signature de ce mail n\\u2019a pas \\u00e9t\\u00e9 accept\\u00e9e.\";\na[\"smime.RECIPIENT_SMIME_CERT_NOT_FOUND\"]=\"Aucun certificat public valide n\\u2019a \\u00e9t\\u00e9 trouv\\u00e9 pour : {0}.\";\na[\"smime.MSG_ENCRYPTION_FAILED\"]=\"Erreur : impossible de crypter ce mail.\";\na[\"smime.MSG_SIGNING_FAILED\"]=\"Erreur : impossible de signer ce mail.\";\na[\"smime.LOAD_CERTIFICATE_FAILED\"]=\"Aucun certificat n\\u2019a \\u00e9t\\u00e9 trouv\\u00e9. \";\na[\"smime.USER_CERT_NOT_YET_VALID\"]=\"Ce certificat n\\u2019est pas encore valide.\";\na[\"smime.CERT_VALIDATION_FAILED\"]=\"Impossible de valider ce certificat.\";\na[\"smime.USER_CERT_EXPIRED\"]=\"Ce certificat a expir\\u00e9.\";\na[\"smime.USER_CERT_REVOKED\"]=\"Ce certificat a \\u00e9t\\u00e9 r\\u00e9voqu\\u00e9.\";\na[\"smime.USER_CERT_EMAIL_ADDRESS_NOT_MATCHING\"]=\"L\\u2019adresse mail d\\u00e9clar\\u00e9e sur le certificat ne correspond pas \\u00e0 l\\u2019adresse mail associ\\u00e9e \\u00e0 votre compte.\";\na[\"smime.USER_CERT_NOT_TRUSTED\"]=\"Ce certificat n\\u2019a pas \\u00e9t\\u00e9 \\u00e9mis par une autorit\\u00e9 de certification de confiance.\";\na[\"smime.OPERATION_DENIED\"]=\"Cette op\\u00e9ration n\\u2019est pas autoris\\u00e9e.\";\na[\"smime.DELEGATE_SEND_SECURE_PERM_DENIED\"]=\"Les d\\u00e9l\\u00e9gu\\u00e9s ne peuvent pas envoyer de mails s\\u00e9curis\\u00e9s de la part du propri\\u00e9taire.\";\na[\"smime.SERVER_EXTENSION_NOT_INSTALLED\"]=\"L\\u2019extension S/MIME pour le serveur n\\u2019est pas install\\u00e9e. Contactez votre administrateur syst\\u00e8me.\";\ndelete a;\nif(!window.com_zimbra_email){\ncom_zimbra_email={}\n}\na=com_zimbra_email;\na.zimletLabel=\"Email Contact Details\";\na.description=\"Highlights and previews associated contact details for an email address.\";\na.preferencesSaved=\"Preferences Saved\";\na.emailZimletPreferences=\"Email Zimlet Preferences\";\na.label=\"Email\";\na.tooltip=\"Shows Email Zimlet\\u2019s preferences\";\na.VERYSMALL=\"Very Small\";\na.SMALL=\"Small\";\na.MEDIUM=\"Medium\";\na.LARGE=\"Large\";\na.XL=\"XL\";\na[\"2XL\"]=\"2XL\";\na.selectToolTipSize=\"Please select tool-tip\\u2019s size:\";\na.rightClickForMoreOptions=\"Right click for more options\";\na.contact=\"Contact\";\na.close=\"Close\";\na.slideTooltip=\"Email Profile\";\na.slideMailTooltip=\"New Email\";\na.slideCalendarTooltip=\"New Appointment\";\na.slideChatTooltip=\"Chat\";\na.loading=\"Loading...\";\na.msg_available=\"Available\";\na.msg_unavailable=\"Unavailable\";\na.msg_busy=\"Busy\";\na.msg_away=\"Away\";\na.msg_dnd=\"Do not disturb\";\na.msg_onthephone=\"On the phone\";\na.msg_vacation=\"Vacation\";\na.msg_unknown=\"Unknown\";\na.postalAddress=\"{0} {1} {2} {3}\";\na.jobTitleDepartmentCompany=\"jobTitle,department,company\";\ndelete a;\nif(!window.com_zimbra_email){\ncom_zimbra_email={}\n}\na=com_zimbra_email;\na.zimletLabel=\"D\\u00e9tails contact mail\";\na.description=\"Souligne et donne un aper\\u00e7u des d\\u00e9tails contact associ\\u00e9s \\u00e0 une adresse mail.\";\na.preferencesSaved=\"Les pr\\u00e9f\\u00e9rences ont \\u00e9t\\u00e9 enregistr\\u00e9es.\";\na.emailZimletPreferences=\"Pr\\u00e9f\\u00e9rences mail Zimlet\";\na.label=\"Adresse mail\";\na.tooltip=\"Affiche les pr\\u00e9f\\u00e9rences mail Zimlet\";\na.VERYSMALL=\"Tr\\u00e8s petit\";\na.SMALL=\"Petit\";\na.MEDIUM=\"Moyen\";\na.LARGE=\"Grand\";\na.XL=\"XL\";\na[\"2XL\"]=\"2XL\";\na.selectToolTipSize=\"Veuillez s\\u00e9lectionner la taille de l\\u2019info-bulle\\u00a0: \";\na.rightClickForMoreOptions=\"Cliquez avec le bouton droit de la souris pour plus d\\u2019options\";\na.contact=\"Contact\";\na.close=\"Fermer\";\na.slideTooltip=\"Profil de messagerie\";\na.slideMailTooltip=\"Nouveau mail\";\na.slideCalendarTooltip=\"Nouveau rendez-vous\";\na.slideChatTooltip=\"Chat\";\na.loading=\"Chargement...\";\na.msg_available=\"Disponible\";\na.msg_unavailable=\"Indisponible\";\na.msg_busy=\"Occup\\u00e9\";\na.msg_away=\"Absent\";\na.msg_dnd=\"Ne pas d\\u00e9ranger\";\na.msg_onthephone=\"Au t\\u00e9l\\u00e9phone\";\na.msg_vacation=\"Cong\\u00e9\";\na.msg_unknown=\"Inconnu\";\na.jobTitleDepartmentCompany=\"jobTitle,department,company\";\ndelete a;\nif(!window.com_zimbra_holidaycalendars){\ncom_zimbra_holidaycalendars={}\n}\na=com_zimbra_holidaycalendars;\na.label=\"Holiday Calendars\";\na.description=\"Subscribe to Holiday Calendars of various countries.\";\na.HolidayCalendarsZimlet_panel_label=\"Holiday Calendars\";\na.HolidayCalendarsZimlet_panel_tooltip=\"Subscribe to Holiday Calendars of various countries.\";\na.HolidayCalendarsZimlet_dialog_title=\"Subscribe to Holiday Calendars\";\na.HolidayCalendarsZimlet_dialog_subscribeButton=\"Subscribe\";\na.HolidayCalendarsZimlet_createFolderMsg=\"Creating ''{0}'' Calendar...\";\na.HolidayCalendarsZimlet_successSubscribing=\"Successfully subscribed to ''{0}'' calendar\";\na.HolidayCalendarsZimlet_errorSubscribing=\"Error subscribing to holiday calendar\";\na.HolidayCalendarsZimlet_holidays_australian=\"Australian Holidays\";\na.HolidayCalendarsZimlet_holidays_chineseSimplified=\"Chinese Lunar Simplified Holidays\";\na.HolidayCalendarsZimlet_holidays_brazil=\"Brazil Holidays\";\na.HolidayCalendarsZimlet_holidays_danish=\"Danish Holidays\";\na.HolidayCalendarsZimlet_holidays_dutch=\"Dutch Holidays\";\na.HolidayCalendarsZimlet_holidays_irish=\"Irish Holidays\";\na.HolidayCalendarsZimlet_holidays_finnish=\"Finnish Holidays\";\na.HolidayCalendarsZimlet_holidays_french=\"French Holidays\";\na.HolidayCalendarsZimlet_holidays_german=\"German Holidays\";\na.HolidayCalendarsZimlet_holidays_hongKong=\"Hong Kong Holidays\";\na.HolidayCalendarsZimlet_holidays_india=\"India Holidays\";\na.HolidayCalendarsZimlet_holidays_italian=\"Italian Holidays\";\na.HolidayCalendarsZimlet_holidays_japanese=\"Japanese Holidays\";\na.HolidayCalendarsZimlet_holidays_mexican=\"Mexican Holidays\";\na.HolidayCalendarsZimlet_holidays_norwegian=\"Norwegian Holidays\";\na.HolidayCalendarsZimlet_holidays_newZealand=\"New Zealand Holidays\";\na.HolidayCalendarsZimlet_holidays_portuguese=\"Portuguese Holidays\";\na.HolidayCalendarsZimlet_holidays_southAfrican=\"South African Holidays\";\na.HolidayCalendarsZimlet_holidays_southKorean=\"South Korean Holidays\";\na.HolidayCalendarsZimlet_holidays_swedish=\"Swedish Holidays\";\na.HolidayCalendarsZimlet_holidays_spain=\"Spain Holidays\";\na.HolidayCalendarsZimlet_holidays_taiwan=\"Taiwan Holidays\";\na.HolidayCalendarsZimlet_holidays_uk=\"UK Holidays\";\na.HolidayCalendarsZimlet_holidays_us=\"US Holidays\";\na.HolidayCalendarsZimlet_vacs_za=\"Holidays - Area A\";\na.HolidayCalendarsZimlet_vacs_zb=\"Holidays - Area B\";\na.HolidayCalendarsZimlet_vacs_zc=\"Holidays - Area C\";\na.HolidayCalendarsZimlet_vacs_zabc=\"Holidays - Area A,B et C\";\na.HolidayCalendarsZimlet_jours_feries=\"Public holidays\";\ndelete a;\nif(!window.com_zimbra_holidaycalendars){\ncom_zimbra_holidaycalendars={}\n}\na=com_zimbra_holidaycalendars;\na.label=\"Calendriers de vacances\";\na.description=\"Inscrivez-vous aux calendriers de vacances de plusieurs pays.\";\na.HolidayCalendarsZimlet_panel_label=\"Calendriers de vacances\";\na.HolidayCalendarsZimlet_panel_tooltip=\"Inscrivez-vous aux calendriers de vacances de plusieurs pays.\";\na.HolidayCalendarsZimlet_dialog_title=\"Inscrivez-vous aux calendriers de vacances\";\na.HolidayCalendarsZimlet_dialog_subscribeButton=\"S'abonner\";\na.HolidayCalendarsZimlet_createFolderMsg=\"Cr\\u00e9ation du calendrier ''{0}''...\";\na.HolidayCalendarsZimlet_successSubscribing=\"Abonnement au calendrier ''{0}'' r\\u00e9ussi\";\na.HolidayCalendarsZimlet_errorSubscribing=\"Erreur lors de l'abonnement au calendrier de vacances\";\na.HolidayCalendarsZimlet_holidays_australian=\"Vacances australiennes\";\na.HolidayCalendarsZimlet_holidays_chineseSimplified=\"Vacances chinoises lunaires simplifi\\u00e9es\";\na.HolidayCalendarsZimlet_holidays_brazil=\"Vacances br\\u00e9siliennes\";\na.HolidayCalendarsZimlet_holidays_danish=\"Vacances danoise\";\na.HolidayCalendarsZimlet_holidays_dutch=\"Vacances n\\u00e9erlandaises\";\na.HolidayCalendarsZimlet_holidays_irish=\"Vacances irlandaises\";\na.HolidayCalendarsZimlet_holidays_finnish=\"Vacances finlandaises\";\na.HolidayCalendarsZimlet_holidays_french=\"Vacances fran\\u00e7aises\";\na.HolidayCalendarsZimlet_holidays_german=\"Vacances allemandes\";\na.HolidayCalendarsZimlet_holidays_hongKong=\"Vacances de Hong Kong\";\na.HolidayCalendarsZimlet_holidays_india=\"Vacances indiennes\";\na.HolidayCalendarsZimlet_holidays_italian=\"Vacances italiennes\";\na.HolidayCalendarsZimlet_holidays_japanese=\"Vacances japonaises\";\na.HolidayCalendarsZimlet_holidays_mexican=\"Vacances mexicaines\";\na.HolidayCalendarsZimlet_holidays_norwegian=\"Vacances norv\\u00e9giennes\";\na.HolidayCalendarsZimlet_holidays_newZealand=\"Vacances n\\u00e9o-z\\u00e9landaises\";\na.HolidayCalendarsZimlet_holidays_portuguese=\"Vacances portugaises\";\na.HolidayCalendarsZimlet_holidays_southAfrican=\"Vacances sud-africaines\";\na.HolidayCalendarsZimlet_holidays_southKorean=\"Vacances sud-cor\\u00e9ennes\";\na.HolidayCalendarsZimlet_holidays_swedish=\"Vacances su\\u00e9doises\";\na.HolidayCalendarsZimlet_holidays_spain=\"Vacances espagnoles\";\na.HolidayCalendarsZimlet_holidays_taiwan=\"Vacances ta\\u00efwanaises\";\na.HolidayCalendarsZimlet_holidays_uk=\"Vacances du Royaume-Uni\";\na.HolidayCalendarsZimlet_holidays_us=\"Vacances des \\u00c9tats-Unis\";\na.HolidayCalendarsZimlet_vacs_za=\"Vacances - Zone A\";\na.HolidayCalendarsZimlet_vacs_zb=\"Vacances - Zone B\";\na.HolidayCalendarsZimlet_vacs_zc=\"Vacances - Zone C\";\na.HolidayCalendarsZimlet_vacs_zabc=\"Vacances - Zone A,B et C\";\na.HolidayCalendarsZimlet_jours_feries=\"Jours feri\\u00e9s\";\ndelete a;\nif(!window.com_zimbra_ymemoticons){\ncom_zimbra_ymemoticons={}\n}\na=com_zimbra_ymemoticons;\na.label=\"Yahoo! Emoticons\";\na.description=\"Displays Yahoo! Emoticons images in email messages.\";\na.yahooEmoticons=\"Yahoo! Emoticons\";\na.temporarilyDisableInMail=\"Temporarily disable in Mail\";\na.preferences=\"Preferences\";\na.enableInMail=\"Enable Emoticons In Mail\";\na.yahoo_emoticons_pref_dialog_title=\"Yahoo! Emoticons Preferences\";\na.emoticon_happy=\"happy\";\na.emoticon_sad=\"sad\";\na.emoticon_pumpkin=\"pumpkin\";\na.emoticon_coffee=\"coffee\";\na.emoticon_blushing=\"blushing\";\na.emoticon_not_talking=\"not talking\";\na.emoticon_big_hug=\"big hug\";\na.emoticon_d_oh=\"d\\u2019oh\";\na.emoticon_shame_on_you=\"shame on you\";\na.emoticon_time_out=\"time out\";\na.emoticon_monkey=\"monkey\";\na.emoticon_clown=\"clown\";\na.emoticon_sleepy=\"sleepy\";\na.emoticon_batting_eyelashes=\"batting eyelashes\";\na.emoticon_liar=\"liar\";\na.emoticon_party=\"party\";\na.emoticon_angry=\"angry\";\na.emoticon_confused=\"confused\";\na.emoticon_whew=\"whew!\";\na.emoticon_daydreaming=\"daydreaming\";\na.emoticon_big_grin=\"big grin\";\na.emoticon_dancing=\"dancing\";\na.emoticon_nerd=\"nerd\";\na.emoticon_chatterbox=\"chatterbox\";\na.emoticon_wave=\"wave\";\na.emoticon_call_me=\"call me\";\na.emoticon_drooling=\"drooling\";\na.emoticon_yawn=\"yawn\";\na.emoticon_surprise=\"surprise\";\na.emoticon_hiro=\"hiro\";\na.emoticon_laughing=\"laughing\";\na.emoticon_raised_eyebrow=\"raised eyebrow\";\na.emoticon_idea=\"idea\";\na.emoticon_on_the_phone=\"on the phone\";\na.emoticon_nailbiting=\"nailbiting\";\na.emoticon_yin_yang=\"yin yang\";\na.emoticon_kiss=\"kiss\";\na.emoticon_at_wits_end=\"at wits\\u2019 end\";\na.emoticon_billy=\"billy\";\na.emoticon_I_dont_know=\"I don\\u2019t know\";\na.emoticon_hypnotized=\"hypnotized\";\na.emoticon_cow=\"cow\";\na.emoticon_applause=\"applause\";\na.emoticon_waiting=\"waiting\";\na.emoticon_love_struck=\"love struck\";\na.emoticon_dont_tell_anyone=\"don\\u2019t tell anyone\";\na.emoticon_chicken=\"chicken\";\na.emoticon_bug=\"bug\";\na.emoticon_star=\"star\";\na.emoticon_straight_face=\"straight face\";\na.emoticon_crying=\"crying\";\na.emoticon_skull=\"skull\";\na.emoticon_angel=\"angel\";\na.emoticon_phbbbbt=\"phbbbbt\";\na.emoticon_alien=\"alien\";\na.emoticon_broken_heart=\"broken heart\";\na.emoticon_loser=\"loser\";\na.emoticon_pig=\"pig\";\na.emoticon_bring_it_on=\"bring it on\";\na.emoticon_feeling_beat_up=\"feeling beat up\";\na.emoticon_money_eyes=\"money eyes\";\na.emoticon_thinking=\"thinking\";\na.emoticon_peace_sign=\"peace sign\";\na.emoticon_oh_go_on=\"oh go on\";\na.emoticon_good_luck=\"good luck\";\na.emoticon_not_listening=\"not listening\";\na.emoticon_tongue=\"tongue\";\na.emoticon_not_worthy=\"not worthy\";\na.emoticon_whistling=\"whistling\";\na.emoticon_sigh=\"sigh\";\na.emoticon_puppy_dog_eyes=\"puppy dog eyes\";\na.emoticon_devil=\"devil\";\na.emoticon_talk_to_the_hand=\"talk to the hand\";\na.emoticon_rolling_eyes=\"rolling eyes\";\na.emoticon_flag=\"flag\";\na.emoticon_april=\"april\";\na.emoticon_silly=\"silly\";\na.emoticon_rolling_on_the_floor=\"rolling on the floor\";\na.emoticon_frustrated=\"frustrated\";\na.emoticon_cool=\"cool\";\na.emoticon_winking=\"winking\";\na.emoticon_smug=\"smug\";\na.emoticon_sick=\"sick\";\na.emoticon_cowboy=\"cowboy\";\na.emoticon_worried=\"worried\";\na.emoticon_hee_hee=\"hee hee\";\na.emoticon_praying=\"praying\";\na.emoticon_rose=\"rose\";\ndelete a;\nif(!window.com_zimbra_ymemoticons){\ncom_zimbra_ymemoticons={}\n}\na=com_zimbra_ymemoticons;\na.label=\"\\u00c9motic\\u00f4nes Yahoo!\";\na.description=\"Affiche des images \\u00c9motic\\u00f4nes Yahoo! dans les mails\";\na.yahooEmoticons=\"\\u00c9motic\\u00f4nes Yahoo!\";\na.temporarilyDisableInMail=\"D\\u00e9sactivez temporairement pour cet envoi\";\na.preferences=\"Pr\\u00e9f\\u00e9rences\";\na.enableInMail=\"Autoriser les \\u00e9motic\\u00f4nes dans les mails\";\na.yahoo_emoticons_pref_dialog_title=\"Yahoo! Pr\\u00e9f\\u00e9rences des \\u00e9motic\\u00f4nes\";\na.yahoo_emoticons_toaster_enabled=\"\\u00c9motic\\u00f4nes activ\\u00e9es dans la messagerie.\";\na.yahoo_emoticons_toaster_disabled=\"\\u00c9motic\\u00f4nes d\\u00e9sactiv\\u00e9es dans la messagerie.\";\na.yahoo_emoticons_toaster_temporarily_disabled=\"\\u00c9motic\\u00f4nes d\\u00e9sactiv\\u00e9es temporairement.\";\na.emoticon_happy=\"heureux\";\na.emoticon_sad=\"triste\";\na.emoticon_pumpkin=\"citrouille\";\na.emoticon_coffee=\"caf\\u00e9\";\na.emoticon_blushing=\"rougissement\";\na.emoticon_not_talking=\"pas bavard\";\na.emoticon_big_hug=\"grande \\u00e9treinte\";\na.emoticon_d_oh=\"Pff\";\na.emoticon_shame_on_you=\"quelle honte\\u00a0!\";\na.emoticon_time_out=\"on se calme\\u00a0!\";\na.emoticon_monkey=\"singe\";\na.emoticon_clown=\"clown\";\na.emoticon_sleepy=\"envie de dormir\";\na.emoticon_batting_eyelashes=\"\\u0153illade\";\na.emoticon_liar=\"menteur\";\na.emoticon_party=\"f\\u00eate\";\na.emoticon_angry=\"en col\\u00e8re\";\na.emoticon_confused=\"perplexe\";\na.emoticon_whew=\"\\u00e7a alors\\u00a0!\";\na.emoticon_daydreaming=\"r\\u00eaverie\";\na.emoticon_big_grin=\"grand sourire\";\na.emoticon_dancing=\"danse\";\na.emoticon_nerd=\"nerd\";\na.emoticon_chatterbox=\"pipelette\";\na.emoticon_wave=\"signe de la main\";\na.emoticon_call_me=\"appelle-moi\";\na.emoticon_drooling=\"j\\u2019en bave\\u00a0!\";\na.emoticon_yawn=\"b\\u00e2illement\";\na.emoticon_surprise=\"surprise\";\na.emoticon_hiro=\"hiro\";\na.emoticon_laughing=\"rire\";\na.emoticon_raised_eyebrow=\"sourcils fronc\\u00e9s\";\na.emoticon_idea=\"id\\u00e9e\";\na.emoticon_on_the_phone=\"au t\\u00e9l\\u00e9phone\";\na.emoticon_nailbiting=\"angoissant\";\na.emoticon_yin_yang=\"yin yang\";\na.emoticon_kiss=\"baiser\";\na.emoticon_at_wits_end=\"d\\u00e9pass\\u00e9\";\na.emoticon_billy=\"ch\\u00e8vre\";\na.emoticon_I_dont_know=\"j\\u2019sais pas\";\na.emoticon_hypnotized=\"hypnotis\\u00e9\";\na.emoticon_cow=\"vache\";\na.emoticon_applause=\"applaudissements\";\na.emoticon_waiting=\"attente\";\na.emoticon_love_struck=\"coup de foudre\";\na.emoticon_dont_tell_anyone=\"ne le dites \\u00e0 personne\";\na.emoticon_chicken=\"poulet\";\na.emoticon_bug=\"insecte\";\na.emoticon_star=\"\\u00e9toile\";\na.emoticon_straight_face=\"impassible\";\na.emoticon_crying=\"pleurs\";\na.emoticon_skull=\"cr\\u00e2ne\";\na.emoticon_angel=\"ange\";\na.emoticon_phbbbbt=\"blblblbl\";\na.emoticon_alien=\"extra-terrestre\";\na.emoticon_broken_heart=\"c\\u0153ur bris\\u00e9\";\na.emoticon_loser=\"incapable\";\na.emoticon_pig=\"cochon\";\na.emoticon_bring_it_on=\"provocation\";\na.emoticon_feeling_beat_up=\"\\u00e9puis\\u00e9\";\na.emoticon_money_eyes=\"r\\u00eaves d\\u2019argent\";\na.emoticon_thinking=\"pensif\";\na.emoticon_peace_sign=\"symbole de paix\";\na.emoticon_oh_go_on=\"sans blague\\u00a0?!\";\na.emoticon_good_luck=\"bonne chance\";\na.emoticon_not_listening=\"pas attentif\";\na.emoticon_tongue=\"langue\";\na.emoticon_not_worthy=\"\\u00e7a ne vaut pas le coup\";\na.emoticon_whistling=\"siffleur\";\na.emoticon_sigh=\"soupir\";\na.emoticon_puppy_dog_eyes=\"yeux de petit chien\";\na.emoticon_devil=\"diable\";\na.emoticon_talk_to_the_hand=\"parle \\u00e0 ma main\";\na.emoticon_rolling_eyes=\"roule les yeux\";\na.emoticon_flag=\"drapeau\";\na.emoticon_april=\"avril\";\na.emoticon_silly=\"b\\u00eatise\";\na.emoticon_rolling_on_the_floor=\"mort de rire\";\na.emoticon_frustrated=\"frustr\\u00e9\";\na.emoticon_cool=\"cool\";\na.emoticon_winking=\"clin d\\u2019\\u0153il\";\na.emoticon_smug=\"fier\";\na.emoticon_sick=\"malade\";\na.emoticon_cowboy=\"cow-boy\";\na.emoticon_worried=\"inquiet\";\na.emoticon_hee_hee=\"hi hi\";\na.emoticon_praying=\"pri\\u00e8re\";\na.emoticon_rose=\"rose\";\ndelete a;\nif(!window.com_zimbra_date){\ncom_zimbra_date={}\n}\na=com_zimbra_date;\na.label=\"Date\";\na.description=\"Highlights dates, previews associated appointments and creates a link to the calendar.\";\na.viewDay=\"Day\";\na.appointmentNewTitle=\"New Appointment\";\na.searchForMessages=\"Search for mail messages\";\na.boundaryTrue=\"true\";\na.boundaryFalse=\"false\";\na[\"format.boundary\"]=\"true\";\na[\"format1.pattern\"]=\"(today|tonight|this morning)\";\na[\"format1.rule\"]=\"now\";\na[\"format2.pattern\"]=\"(tomorrow night|tomorrow morning|tomorrow)\";\na[\"format2.rule\"]=\"now +1 day\";\na[\"format3.pattern\"]=\"(last night|yesterday morning|yesterday)\";\na[\"format3.rule\"]=\"now -1 day\";\na[\"format4.pattern\"]=\"(this|next) {dayname}\";\na[\"format4.rule\"]=\"now +1 {dayname}\";\na[\"format5.pattern\"]=\"last {dayname}\";\na[\"format5.rule\"]=\"now -1 {dayname}\";\na[\"format6.pattern\"]=\"{weekord} {dayname} (of|in) {monthname}\";\na[\"format6.rule\"]=\"now date=1 +1 {monthname} week={weekord},{dayname}\";\na[\"format7.pattern\"]=\"{weekord} {dayname}\";\na[\"format7.rule\"]=\"now week={weekord},{dayname}\";\na[\"format8.pattern\"]=\"{datenum}(st|nd|rd|th)? (of|in) {monthname}\";\na[\"format8.rule\"]=\"now month={monthname},{datenum}\";\na[\"format9.pattern\"]=\"{monthname} {datenum}(st|nd|rd|th)?.? {timenum}.?(am|pm)\";\na[\"format9.rule\"]=\"now month={monthname},{datenum}\";\na[\"format10.pattern\"]=\"{datenum}(st|nd|rd|th)? {monthname} {timenum}.?(am|pm)\";\na[\"format10.rule\"]=\"now month={monthname},{datenum}\";\na[\"format11.pattern\"]=\"{monthname} {datenum}(st|nd|rd|th).? {militarytimenum} (hrs|hours)\";\na[\"format11.rule\"]=\"now month={monthname},{datenum}\";\na[\"format12.pattern\"]=\"{datenum}(st|nd|rd|th).? {monthname}.? {militarytimenum} (hrs|hours)\";\na[\"format12.rule\"]=\"now month={monthname},{datenum}\";\na[\"format13.pattern\"]=\"{monthname} {datenum}(st|nd|rd|th).? {yearnum}\";\na[\"format13.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format14.pattern\"]=\"{dayname}.? {datenum} {monthname} {yearnum}\";\na[\"format14.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format15.pattern\"]=\"{dayname}.? {monthname}  {datenum}\";\na[\"format15.rule\"]=\"now month={monthname},{datenum}\";\na[\"format16.pattern\"]=\"{monthname} {datenum}(st|nd|rd|th)?\";\na[\"format16.rule\"]=\"now month={monthname},{datenum}\";\na[\"format17.pattern\"]=\"{datenum} {monthname}.? {yearnum}\";\na[\"format17.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format18.pattern\"]=\"{monthnum}/{datenum}/{yearnum}\";\na[\"format18.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format19.pattern\"]=\"{yearnum}-{monthnum}-{datenum}\";\na[\"format19.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format20.pattern\"]=\"{monthname} {yearnum}\";\na[\"format20.rule\"]=\"now year={yearnum},{monthname},1\";\na[\"format21.pattern\"]=\"{dayname}\";\na[\"format21.rule\"]=\"now +1 {dayname}\";\na[\"format22.pattern\"]=\"{datenum}(st|nd|rd|th)? {monthname}.? {yearnum}\";\na[\"format22.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format23.pattern\"]=\"Thanksgiving\";\na[\"format23.rule\"]=\"now month=November week=fourth,Thursday\";\na[\"format24.pattern\"]=\"Christmas Eve\";\na[\"format24.rule\"]=\"now month=December,24\";\na[\"format25.pattern\"]=\"Christmas\";\na[\"format25.rule\"]=\"now month=December,25\";\na[\"format26.pattern\"]=\"New Year\\u2019?s Eve\";\na[\"format26.rule\"]=\"now month=December,31\";\na[\"format27.pattern\"]=\"New Year\\u2019?s Day\";\na[\"format27.rule\"]=\"now +1 year month=January,1\";\na[\"format28.pattern\"]=\"###\";\ndelete a;\nif(!window.com_zimbra_date){\ncom_zimbra_date={}\n}\na=com_zimbra_date;\na.label=\"Date\";\na.description=\"Souligne les dates, donne un aper\\u00e7u des rendez-vous associ\\u00e9s et cr\\u00e9e un lien vers le calendrier.\";\na.viewDay=\"Jour\";\na.appointmentNewTitle=\"Nouveau rendez-vous\";\na.searchForMessages=\"Rechercher des mails\";\na.boundaryTrue=\"true\";\na.boundaryFalse=\"false\";\na[\"format.boundary\"]=\"true\";\na[\"format1.pattern\"]=\"(aujourd\\u2019hui|ce soir|ce matin|aujourd\\u2019?hui)\";\na[\"format1.rule\"]=\"now\";\na[\"format2.pattern\"]=\"(demain soir|demain matin|demain)\";\na[\"format2.rule\"]=\"now +1 day\";\na[\"format3.pattern\"]=\"(hier soir|hier matin|hier)\";\na[\"format3.rule\"]=\"now -1 day\";\na[\"format4.pattern\"]=\"(ce|le prochain) {dayname}\";\na[\"format4.rule\"]=\"now +1 {dayname}\";\na[\"format5.pattern\"]=\"le dernier {dayname}\";\na[\"format5.rule\"]=\"now -1 {dayname}\";\na[\"format6.pattern\"]=\"{weekord} {dayname} (de\\u00a0:) {monthname}\";\na[\"format6.rule\"]=\"now date=1 +1 {monthname} week={weekord},{dayname}\";\na[\"format7.pattern\"]=\"{weekord} {dayname}\";\na[\"format7.rule\"]=\"now week={weekord},{dayname}\";\na[\"format8.pattern\"]=\"jour num\\u00e9ro {datenum} (de) {monthname}\";\na[\"format8.rule\"]=\"now month={monthname},{datenum}\";\na[\"format9.pattern\"]=\"{monthname} {datenum}(er|e)\\u00a0? {timenum}.?\";\na[\"format9.rule\"]=\"now month={monthname},{datenum}\";\na[\"format10.pattern\"]=\"{datenum}(er|e)\\u00a0? {monthname} {timenum}.?\";\na[\"format10.rule\"]=\"now month={monthname},{datenum}\";\na[\"format11.pattern\"]=\"{monthname} {datenum}(er|e)\\u00a0? {militarytimenum} (h|heures)\";\na[\"format11.rule\"]=\"now month={monthname},{datenum}\";\na[\"format12.pattern\"]=\"{datenum}(er|e)\\u00a0? {monthname}.? {militarytimenum} (h|heures)\";\na[\"format12.rule\"]=\"now month={monthname},{datenum}\";\na[\"format13.pattern\"]=\"{monthname} {datenum}(er|e)\\u00a0? {yearnum}\";\na[\"format13.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format14.pattern\"]=\"{dayname}.? {datenum} {monthname} {yearnum}\";\na[\"format14.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format15.pattern\"]=\"{dayname}.? {monthname} {datenum}\";\na[\"format15.rule\"]=\"now month={monthname},{datenum}\";\na[\"format16.pattern\"]=\"{monthname} {datenum}(er|e)\\u00a0?\";\na[\"format16.rule\"]=\"now month={monthname},{datenum}\";\na[\"format17.pattern\"]=\"{datenum} {monthname}.? {yearnum}\";\na[\"format17.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format18.pattern\"]=\"{datenum}/{monthnum}/{yearnum} \";\na[\"format18.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format19.pattern\"]=\"{yearnum}-{monthnum}-{datenum}\";\na[\"format19.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format20.pattern\"]=\"{monthname} {yearnum}\";\na[\"format20.rule\"]=\"now year={yearnum},{monthname},1\";\na[\"format21.pattern\"]=\"{dayname}\";\na[\"format21.rule\"]=\"now +1 {dayname}\";\na[\"format22.pattern\"]=\"{datenum}(er|e)\\u00a0? {monthname}.? {yearnum} \";\na[\"format22.rule\"]=\"now year={yearnum},{monthname},{datenum}\";\na[\"format23.pattern\"]=\"Thanksgiving\";\na[\"format23.rule\"]=\"now month=November week=fourth,Thursday\";\na[\"format24.pattern\"]=\"Veille de No\\u00ebl\";\na[\"format24.rule\"]=\"now month=December,24\";\na[\"format25.pattern\"]=\"Jour de No\\u00ebl\";\na[\"format25.rule\"]=\"now month=December,25\";\na[\"format26.pattern\"]=\"Veille du jour de l\\u2019an\";\na[\"format26.rule\"]=\"now month=December,31\";\na[\"format27.pattern\"]=\"Jour de l\\u2019an\";\na[\"format27.rule\"]=\"now +1 year month=January,1\";\na[\"format28.pattern\"]=\"{datenum}/{monthnum}/{yearnum}\";\na[\"format28.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format29.pattern\"]=\"{datenum}-{monthnum}-{yearnum}\";\na[\"format29.rule\"]=\"now year={yearnum},{monthnum},{datenum}\";\na[\"format30.pattern\"]=\"###\";\ndelete a;\nif(!window.com_zimbra_attachcontacts){\ncom_zimbra_attachcontacts={}\n}\na=com_zimbra_attachcontacts;\na.label=\"Attach Contacts\";\na.description=\"Allows Attaching contacts when composing a new message.\";\na.ACZ_tab_label=\"Contacts\";\na.ACZ_tab_button_search=\"Search\";\na.ACZ_NoContactsFound=\"No contacts found.\";\na.ACZ_Send=\"Forward\";\na.ACZ_SendContact=\"Forward Contact\";\na.ACZ_SendContactsAsAttachments=\"Send Contacts as email attachments\";\na.ACZ_more=\"({0} more)\";\ndelete a;\nif(!window.com_zimbra_attachcontacts){\ncom_zimbra_attachcontacts={}\n}\na=com_zimbra_attachcontacts;\na.label=\"Joindre contacts\";\na.description=\"Permet de Joindre des contacts lorsque vous composez un nouveau message.\";\na.ACZ_tab_label=\"Contacts\";\na.ACZ_tab_button_search=\"Rechercher\";\na.ACZ_NoContactsFound=\"Aucun contact n\\u2019a \\u00e9t\\u00e9 trouv\\u00e9.\";\na.ACZ_Send=\"Faire suivre\";\na.ACZ_SendContact=\"Faire suivre contact\";\na.ACZ_SendContactsAsAttachments=\"Envoyer les contacts comme des pi\\u00e8ces jointes au mail\";\na.ACZ_more=\"(encore {0})\";\ndelete a;\nfunction com_zimbra_srchhltr_HandlerObject(){}\ncom_zimbra_srchhltr_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_srchhltr_HandlerObject.prototype.constructor=com_zimbra_srchhltr_HandlerObject;\nvar SearchHighlighterZimlet=com_zimbra_srchhltr_HandlerObject;\nSearchHighlighterZimlet.prototype.init=function(){\nthis._searchController=appCtxt.getSearchController();\nthis._spanIds=[]\n};\nSearchHighlighterZimlet.prototype.match=function(o,h){\nthis._setRegExps();\nif(this._regexps.length==0){\nreturn\n}\nvar t=this._regexps;\nvar n=null;\nfor(var s=0;\ns<t.length;\n++s){\nvar r=t[s];\nr.lastIndex=h;\nvar e=r.exec(o);\nif(e&&e[0]!=\"\"){\nif(!n||e.index<n.index){\nn=e;\nn.matchLength=e[0].length;\nreturn n\n}}}\nreturn n\n};\nSearchHighlighterZimlet.prototype.generateSpan=function(n,e,r,s,o){\nvar t=appCtxt.getCurrentApp();\nif(t&&t.isZmSearchApp){\nvar h=Dwt.getNextId();\nthis._spanIds.push(h);\nn[e++]=[\"<span id= '\",h,\"'class='ZmSearchResult'>\",AjxStringUtil.htmlEncode(r),\"</span>\"].join(\"\")\n}else{\nn[e++]=AjxStringUtil.htmlEncode(r)\n}\nreturn e\n};\nSearchHighlighterZimlet.prototype._getSearchWords=function(t){\nif(!t){\nreturn[]\n}\nvar e=[];\nvar n=(new ZmParsedQuery(t)).getTokens();\nfor(var o=0;\no<n.length;\no++){\nif(n[o].op===ZmParsedQuery.OP_CONTENT&&(o==0||(n[o-1].op!==ZmParsedQuery.COND_NOT))){\ne.push(n[o].arg)\n}}\nreturn AjxUtil.uniq(e)\n};\nSearchHighlighterZimlet.prototype._setRegExps=function(){\nthis._currentSearchQuery=(this._searchController.currentSearch)?this._searchController.currentSearch.query:null;\nif(!this._oldSearchQuery||this._currentSearchQuery!=this._oldSearchQuery){\nvar r=this._getSearchWords(this._currentSearchQuery);\nthis._regexps=[];\ntry{\nvar s,o,h;\nfor(var t=0;\nt<r.length;\nt++){\no=r[t];\nh=o[o.length-1]==\"*\"?true:false;\no=o.replace(/^\\W*/,\"\").replace(/\\W*$/,\"\");\no=AjxStringUtil.regExEscape(o);\nif(h){\no=o.concat(\"\\\\S*\")\n}\nif(s){\ns=s+\"|\"+o\n}else{\ns=o\n}}\nif(s){\ns=\"\\\\b(\"+s+\")\\\\b\";\nthis._regexps.push(new RegExp(s,\"ig\"))\n}}\ncatch(n){\nthis._regexps=[]\n}\nthis._oldSearchQuery=this._currentSearchQuery\n}};\nSearchHighlighterZimlet.prototype.onParticipantActionMenuInitialized=function(e,t){\nthis.onActionMenuInitialized(e,t)\n};\nSearchHighlighterZimlet.prototype.onActionMenuInitialized=function(e,t){\nthis.addMenuButton(e,t)\n};\nSearchHighlighterZimlet.prototype.addMenuButton=function(t,s){\nvar e=\"COM_ZIMBRA_SEARCH_WORD_HIGHLIGHTER_ZIMLET\";\nvar n=this.getMessage(\"SearchHighlighterZimlet_MenuLabel\");\nif(!s.getMenuItem(e)){\nvar r={\nid:e,text:n,image:\"Search\"};\nvar o=ZmOperation.defineOperation(null,r);\ns.addOp(e,1000);\ns.addSelectionListener(e,new AjxListener(this,this._clearSearchWordHighlights,t))\n}};\nSearchHighlighterZimlet.prototype._clearSearchWordHighlights=function(s){\nvar h=appCtxt.getAppViewMgr().getCurrentView();\nvar l;\nif(h.getItemView){\nl=h.getItemView()\n}else{\nif(h.getMsgView){\nl=h.getMsgView()\n}}\nif(!l){\nreturn\n}\nvar e=l.getDocument();\nif(!e){\nvar t=l.getHTMLElId();\nif(t){\nvar d=document.getElementById(t+\"_body__iframe\");\nif(!AjxEnv.isIE){\nif(d){\ne=d.contentDocument\n}}else{\nif(d){\ne=d.contentWindow.document\n}}}}\nfor(var n=0;\nn<this._spanIds.length;\nn++){\nvar o=document.getElementById(this._spanIds[n]);\nvar r;\nif(e!=undefined||e!=null){\nr=e.getElementById(this._spanIds[n])\n}\nif((o!=undefined)&&(o.className!=undefined)){\no.className=\"\"\n}\nif((r!=undefined)&&(r.className!=undefined)){\nr.className=\"\"\n}}\nthis._spanIds=[]\n};\nAjxTemplate.register(\"com_zimbra_email.templates.Email1#Frame\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]=\"<div id='UnknownPersonSlide_Frame' style='background:white;display:block;height:100%;overflow:auto;padding:10px;'><table width='100%'><tr><td valign='top' width='65'><div id=\\\"\";\ne[o++]=s.photoParentId;\ne[o++]='\"></div></td><td><div id=\"';\ne[o++]=s.textDivId;\ne[o++]=\"\\\" style='margin-left:10px;'></div></td></tr></table></div>\";\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"Frame\"}\n,true);\nAjxPackage.define(\"com_zimbra_email.templates.Email1\");\nAjxTemplate.register(\"com_zimbra_email.templates.Email1\",AjxTemplate.getTemplate(\"com_zimbra_email.templates.Email1#Frame\"),AjxTemplate.getParams(\"com_zimbra_email.templates.Email1#Frame\"));\nAjxTemplate.register(\"com_zimbra_email.templates.Email1#ContactDetails\",function(e,t,h,s){\nvar o=Boolean(s);\nh=(typeof h==\"string\"?{\nid:h}\n:h)||{};\ns=s||[];\nvar n=s.length;\nif(h.fullName){\ns[n++]=\"<div><label id='UnknownPersonSlide_NameAnchorId' class='FakeAnchor' style='font-size:15px;font-weight:bold;'>\";\ns[n++]=AjxStringUtil.htmlEncode(h.fullName);\ns[n++]=\"</label></div>\"\n}\ns[n++]=\"<table style='margin-bottom:.5em;'><tr id='row_Presence'><td><div id='img_Presence'></div></td><td><label id='text_Presence'></label></td></tr></table>\";\nvar d=this.com_zimbra_email.jobTitleDepartmentCompany.split(\",\");\nvar l=d.length;\nvar r;\nfor(r=0;\nr<l;\nr++){\ns[n++]=\"<div><label>\";\ns[n++]=AjxStringUtil.htmlEncode(h[d[r]]);\ns[n++]=\"</label></div>\"\n}\nif(h.email){\ns[n++]=\"<div><label  id='UnknownPersonSlide_EmailAnchorId' class='FakeAnchor'>\";\ns[n++]=AjxStringUtil.htmlEncode(h.email);\ns[n++]=\"</label></div>\"\n}\nif(h.mobilePhone){\ns[n++]=\"<div><label id='UnknownPersonSlide_mobilePhoneAnchorId' class='FakeAnchor'>\";\ns[n++]=AjxStringUtil.htmlEncode(h.mobilePhone);\ns[n++]=\" (\";\ns[n++]=ZmMsg.cell;\ns[n++]=\")</label></div>\"\n}\nif(h.workPhone){\ns[n++]=\"<div><label id='UnknownPersonSlide_workPhoneAnchorId' class='FakeAnchor'>\";\ns[n++]=AjxStringUtil.htmlEncode(h.workPhone);\ns[n++]=\" (\";\ns[n++]=ZmMsg.work;\ns[n++]=\")</label></div>\"\n}\nif(h.homePhone){\ns[n++]=\"<div><label id='UnknownPersonSlide_workPhoneAnchorId' class='FakeAnchor'>\";\ns[n++]=AjxStringUtil.htmlEncode(h.homePhone);\ns[n++]=\" (\";\ns[n++]=ZmMsg.home;\ns[n++]=\")</label></div>\"\n}\nif(h.address){\ns[n++]=\"<div><label>\";\ns[n++]=AjxStringUtil.htmlEncode(h.address);\ns[n++]=\" (\";\ns[n++]=ZmMsg.work;\ns[n++]=\")</label></div>\"\n}\nreturn o?s.length:s.join(\"\")\n}\n,{\nid:\"ContactDetails\"}\n,true);\nfunction com_zimbra_email_handlerObject(){\nthis.isPrimaryEmailTooltip=true\n}\ncom_zimbra_email_handlerObject.prototype=new ZmZimletBase();\ncom_zimbra_email_handlerObject.prototype.constructor=com_zimbra_email_handlerObject;\nvar EmailTooltipZimlet=com_zimbra_email_handlerObject;\nEmailTooltipZimlet.NEW_FILTER=\"__new__\";\nEmailTooltipZimlet.MAILTO_RE=/^mailto:[\\x27\\x22]?([^@?&\\x22\\x27]+@[^@?&]+\\.[^@?&\\x22\\x27]+)[\\x27\\x22]?/;\nEmailTooltipZimlet.tooltipWidth=280;\nEmailTooltipZimlet.prototype.init=function(){\nif(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"])\n}\nthis._prefDialog=new EmailToolTipPrefDialog(this);\nthis._subscriberZimlets=[];\nthis._presenceProvider=null;\nthis._preLoadImgs();\nthis._presenceCache=[]\n};\nEmailTooltipZimlet.prototype.doubleClicked=function(){\nthis.singleClicked()\n};\nEmailTooltipZimlet.prototype.singleClicked=function(){\nthis._prefDialog.popup()\n};\nEmailTooltipZimlet.prototype._getHtmlContent=function(n,h,o,e,t,d){\nif(o instanceof AjxEmailAddress){\nvar e=window.parentAppCtxt||window.appCtxt;\nvar r=e.getApp(ZmApp.CONTACTS);\nvar s=r&&r.getContactByEmail(o.address);\nif(r&&!s&&s!==null){\nvar l=new AjxCallback(this,this._handleResponseGetContact,[n,h,o,t,d]);\nr.getContactByEmail(o.address,l)\n}\nreturn this._updateHtmlContent(n,h,o,s,t,d)\n}else{\nn[h++]=AjxStringUtil.htmlEncode(o);\nreturn h\n}};\nEmailTooltipZimlet.prototype._updateHtmlContent=function(n,t,l,e,r,o){\nvar h=AjxStringUtil.htmlEncode(l.toString(o&&o.shortAddress));\nvar s=r&&document.getElementById(r);\nif(s){\ns.innerHTML=h\n}else{\nn[t++]=h;\nreturn t\n}};\nEmailTooltipZimlet.prototype._handleResponseGetContact=function(n,t,r,s,o,e){\nif(e){\nthis._updateHtmlContent(n,t,r,e,s,o)\n}};\nEmailTooltipZimlet.prototype.hoverOut=function(e,t,n,o){\nif(!this.tooltip){\nreturn\n}\nthis._hoverOver=false;\nthis.tooltip.setSticky(true);\nsetTimeout(AjxCallback.simpleClosure(this.popDownIfMouseNotOnSlide,this),700)\n};\nEmailTooltipZimlet.prototype.popDownIfMouseNotOnSlide=function(){\nif(this._hoverOver){\nreturn\n}else{\nif(this.slideShow&&this.slideShow.isMouseOverTooltip){\nreturn\n}else{\nif(this.tooltip){\nthis.tooltip.setSticky(false);\nthis.tooltip.popdown()\n}}}};\nEmailTooltipZimlet.prototype.popdown=function(){\nthis._hoverOver=false;\nif(this.tooltip){\nthis.tooltip.setSticky(false);\nthis.tooltip.popdown()\n}};\nEmailTooltipZimlet.prototype.addSubscriberZimlet=function(e,o,t){\nthis._subscriberZimlets.push(e);\nif(o){\nthis.primarySubscriberZimlet=e\n}\nif(t&&t.presenceCallback&&!this._presenceProvider){\nthis._presenceProvider=t.presenceCallback\n}};\nEmailTooltipZimlet.prototype.onEmailHover=function(t,n,e,h,s){\nvar o=DwtShell.getShell(window);\nvar r=o.getToolTip();\nr.setContent('<div id=\"zimletTooltipDiv\"/>',true);\nthis.x=e;\nthis.y=h;\nif(!this.toolTipPoppedUp(s,t,n,document.getElementById(\"zimletTooltipDiv\"))){\nr.popup(e,h,true,new AjxCallback(this,this.hoverOut,t,n,s))\n}\nreturn true\n};\nEmailTooltipZimlet.prototype.toolTipPoppedUp=function(o,n,t,e){\nvar r=appCtxt.getToolTipMgr().getToolTip(ZmToolTipMgr.PERSON,{\naddress:n}\n);\nif(r){\nvar s=document.getElementById(\"zimletTooltipDiv\");\nif(s){\ns.innerHTML=r\n}\nreturn false\n}\nreturn true\n};\nEmailTooltipZimlet.prototype.onHoverOverEmailInList=function(t,r,s){\nif(!t||!t.address){\nreturn false\n}\nvar e=r?r.docX:this.x;\nvar h=r?r.docY:this.y;\nthis.noRightClick=s;\nvar n=DwtShell.getShell(window);\nvar o=n.getHoverMgr();\no.setHoverOutDelay(500);\nreturn this.handleHover(t,null,e,h)\n};\nEmailTooltipZimlet.prototype.handleHover=function(t,o,e,r,s,n){\nthis._hoverOver=true;\nthis._initializeProps(t,o,e,r,s);\nappCtxt.notifyZimlets(\"onEmailHoverOver\",[this],{\nwaitUntilLoaded:true}\n);\nif(this.primarySubscriberZimlet){\nthis.primarySubscriberZimlet.showTooltip();\nreturn true\n}\nthis._unknownPersonSlide=new UnknownPersonSlide();\nthis._unknownPersonSlide.onEmailHoverOver(this);\nthis._unknownPersonSlide.showTooltip();\nreturn true\n};\nEmailTooltipZimlet.prototype._initializeProps=function(t,n,e,l,s){\nif(!this.seriesAnimation){\nthis.seriesAnimation=new SeriesAnimation()\n}\nthis.seriesAnimation.reset();\nvar o=DwtShell.getShell(window);\nvar r=o.getToolTip();\nr.setContent('<div id=\"zimletTooltipDiv\"></div>',true);\nthis.x=e;\nthis.y=l;\nthis.tooltip=r;\nr.setListener((AjxEnv.isIE8?DwtEvent.ONMOUSELEAVE:DwtEvent.ONMOUSEOUT),new AjxListener(this,this.hoverOut));\nvar h=(t.isAjxEmailAddress)?t.address:t;\nh=AjxStringUtil.parseMailtoLink(h).to;\nthis.emailAddress=h;\nthis.fullName=(t instanceof AjxEmailAddress)?t.name:\"\";\nthis.canvas=document.getElementById(\"zimletTooltipDiv\");\nthis.slideShow=new EmailToolTipSlideShow(this,this.canvas);\nthis.contextMenu=this.getActionMenu(t,s,n,false)\n};\nEmailTooltipZimlet.prototype._preLoadImgs=function(){\nthis._busyImg=new Image();\nthis._busyImg.src=this.getResource(\"img/EmailZimlet_busy.gif\");\nthis._unknownPersonImg=new Image();\nthis._unknownPersonImg.src=this.getResource(\"img/UnknownPerson_dataNotFound.jpg\")\n};\nEmailTooltipZimlet.prototype.showBusyImg=function(e,t,s){\nvar n=s?this.y+s:this.y;\nvar o=t?this.x+t:this.x;\nthis._busyImg.style.top=n;\nthis._busyImg.style.left=o;\nthis._busyImg.style.display=\"block\";\nthis._busyImg.style.position=\"absolute\";\nthis._busyImg.style.zIndex=\"500\";\nthis._busyImgTimer=setTimeout(AjxCallback.simpleClosure(this._handleNoImg,this,e),4000)\n};\nEmailTooltipZimlet.prototype.showLoadingAtId=function(e,o){\nvar t=document.getElementById(o);\nt.innerHTML=[\"<br/><br/><label style='color:gray'>\",ZmMsg.loading,\"</label>\"].join(\"\");\nthis._busyImgTimer=setTimeout(AjxCallback.simpleClosure(this._handleNoImgAtId,this,e,o),4000)\n};\nEmailTooltipZimlet.prototype._handleNoImgAtId=function(e,t){\nclearTimeout(this._busyImgTimer);\nif(e){\ne.run()\n}};\nEmailTooltipZimlet.prototype._handleNoImg=function(e){\nclearTimeout(this._busyImgTimer);\nthis._busyImg.style.zIndex=\"100\";\nthis._busyImg.style.display=\"none\";\nif(e){\ne.run()\n}};\nEmailTooltipZimlet.prototype.hideBusyImg=function(){\nclearTimeout(this._busyImgTimer);\nthis._busyImg.style.zIndex=\"100\";\nthis._busyImg.style.display=\"none\"\n};\nEmailTooltipZimlet.prototype._getAddress=function(e){\nreturn e.isAjxEmailAddress?e.address:e\n};\nEmailTooltipZimlet.prototype._phoneListener=function(e){\nif(!e){\nreturn\n}\nappCtxt.notifyZimlets(\"onPhoneClicked\",[e],{\nwaitUntilLoaded:true}\n)\n};\nEmailTooltipZimlet.prototype._imListener=function(e){\nif(!e){\nreturn\n}};\nEmailTooltipZimlet.prototype.animateOpacity=function(h,s,e,t){\nthis.changeOpac(s,document.getElementById(h).style);\nvar o=Math.round(t/100);\nvar r=0;\nvar n=document.getElementById(h).style;\nif(s>e){\nfor(i=s;\ni>=e;\ni--){\nsetTimeout(AjxCallback.simpleClosure(this.changeOpac,this,i,n),(r*o));\nr++\n}}else{\nif(s<e){\nfor(i=s;\ni<=e;\ni++){\nsetTimeout(AjxCallback.simpleClosure(this.changeOpac,this,i,n),(r*o));\nr++\n}}}};\nEmailTooltipZimlet.prototype.changeOpac=function(e,t){\nt.opacity=(e/100);\nt.MozOpacity=(e/100);\nt.KhtmlOpacity=(e/100);\nt.zoom=1\n};\nEmailTooltipZimlet.prototype.openCenteredWindow=function(o){\nthis.popdown();\nvar n=800;\nvar e=600;\nvar h=parseInt((screen.availWidth/2)-(n/2));\nvar r=parseInt((screen.availHeight/2)-(e/2));\nvar t=\"width=\"+n+\",height=\"+e+\",status,resizable,left=\"+h+\",top=\"+r+\"screenX=\"+h+\",screenY=\"+r;\nvar s=window.open(o,\"subWind\",t);\nif(!s){\nthis._showWarningMsg(ZmMsg.popupBlocker)\n}};\nEmailToolTipSlideShow.mainDivId=\"EmailZimlet_slidesMainDiv\";\nEmailToolTipSlideShow.navDivId=\"EmailZimlet_slidesNavDiv\";\nEmailToolTipSlideShow.navTableRowId=\"EmailZimlet_slidesNavTableRow\";\nfunction EmailToolTipSlideShow(e,t){\nthis.slidesIconAndSlideMap=[];\nthis.numberOfSlides=0;\nthis.emailZimlet=e;\nthis.canvas=t;\nthis._createFrame(t);\nthis.mainDiv=document.getElementById(EmailToolTipSlideShow.mainDivId);\nthis.navDiv=document.getElementById(EmailToolTipSlideShow.navDivId);\nthis.navTableRow=document.getElementById(EmailToolTipSlideShow.navTableRowId);\nthis.currentSelectCellId=null;\nthis.currentSlideId=null;\nthis.navDiv.onclick=AjxCallback.simpleClosure(this._handleClick,this);\nt.onmouseover=AjxCallback.simpleClosure(this.handleMouseOver,this);\nt.onmouseout=AjxCallback.simpleClosure(this.handleMouseOut,this);\nthis.mainDiv.style.width=EmailTooltipZimlet.tooltipWidth+\"px\";\nthis.navDiv.style.width=EmailTooltipZimlet.tooltipWidth+\"px\"\n}\nEmailToolTipSlideShow.prototype._createFrame=function(e){\ne.innerHTML=[\"<div id='\",EmailToolTipSlideShow.mainDivId,\"'></div>\",\"<div id='\",EmailToolTipSlideShow.navDivId,\"'>\",\"<div class='horizsep'></div>\",\"<table width=100%><tr id='\",EmailToolTipSlideShow.navTableRowId,\"'>\",\"</tr></table></div>\"].join(\"\")\n};\nEmailToolTipSlideShow.prototype._handleClick=function(o){\nif(!o){\nvar o=window.event\n}\nvar t;\nif(o.target){\nt=o.target\n}else{\nif(o.srcElement){\nt=o.srcElement\n}}\nif(t.nodeType==3){\nt=t.parentNode\n}\nif(t.id){\nif(this.slidesIconAndSlideMap[t.id]){\nthis.slidesIconAndSlideMap[t.id].select()\n}}};\nEmailToolTipSlideShow.prototype.addSlide=function(e,t){\ne.slideShow=this;\nif(!t){\nt=this.numberOfSlides\n}\nthis.slidesIconAndSlideMap[e.iconDivId]=e;\nvar o=document.createElement(\"div\");\no.id=e.id;\no.style.display=\"none\";\nthis.mainDiv.appendChild(o);\no.innerHTML=e.html;\nthis._insertSlideIcon(e);\nthis.numberOfSlides++\n};\nEmailToolTipSlideShow.prototype._insertSlideIcon=function(e){\nvar r=e.iconName;\nvar n=e.iconDivId;\nvar t=e.selectCellId;\nvar o=e.name;\nvar s=this.navTableRow.insertCell(0);\nthis._insertIconHtml(s,t,o,n,r)\n};\nEmailToolTipSlideShow.prototype._insertIconHtml=function(n,e,t,o,s){\nn.align=\"center\";\nn.id=e;\nn.innerHTML=[\"<div title='\",t,\"' id='\",o,\"' class='Img\",s,\"' style='cursor:pointer;'></div>\"].join(\"\")\n};\nEmailToolTipSlideShow.prototype.handleMouseOver=function(){\nthis.isMouseOverTooltip=true\n};\nEmailToolTipSlideShow.prototype.handleMouseOut=function(){\nthis.isMouseOverTooltip=false;\nthis.emailZimlet.hoverOut()\n};\nfunction EmailToolTipSlide(o,n,s,e,t){\nthis.html=o;\nthis.visible=n;\nthis.iconName=s;\nthis.id=Dwt.getNextId();\nthis.iconDivId=Dwt.getNextId();\nthis.selectCellId=Dwt.getNextId();\nthis.slideShow=null;\nthis.canvasElement=null;\nthis._selectCallback=e;\nthis.name=t\n}\nEmailToolTipSlide.prototype.select=function(){\nif(this.slideShow.currentSlideId){\ndocument.getElementById(this.slideShow.currentSlideId).style.display=\"none\"\n}\ndocument.getElementById(this.id).style.display=\"block\";\nthis.slideShow.currentSlideId=this.id;\nif(this.slideShow.currentSelectCellId){\ndocument.getElementById(this.slideShow.currentSelectCellId).style.background=\"\"\n}\ndocument.getElementById(this.selectCellId).style.display=\"none\";\nthis.slideShow.currentSelectCellId=this.selectCellId;\nif(this._selectCallback){\nthis._selectCallback.run()\n}};\nEmailToolTipSlide.prototype.setCanvasElement=function(e){\nthis.canvasElement=e\n};\nEmailToolTipSlide.prototype.setInfoMessage=function(e){\nthis._appendMsg2Slide(e,\"EmailToolTipSlideMsgColor\")\n};\nEmailToolTipSlide.prototype.setErrorMessage=function(e){\nthis._appendMsg2Slide(e,\"EmailToolTipSlideErrorColor\")\n};\nEmailToolTipSlide.prototype._appendMsg2Slide=function(o,e){\nvar t=[\"<div class='EmailToolTipSlideText \",e,\"'>\",o,\"</div>\"].join(\"\");\nif(this.canvasElement){\nthis.canvasElement.innerHTML=t\n}};\nEmailToolTipSlide.prototype.clearSlideMessage=function(t,e){\nif(this.canvasElement){\nthis.canvasElement.innerHTML=\"\"\n}};\nfunction EmailToolTipPrefDialog(e){\nthis.zimlet=e;\nthis.emailZimlet_tooltipArea=this.zimlet.getUserProperty(\"emailZimlet_tooltipArea\");\nif(!this.emailZimlet_tooltipArea){\nthis.emailZimlet_tooltipArea=EmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_MEDIUM]\n}\nthis.updateEmailTooltipSize()\n}\nEmailToolTipPrefDialog.SIZE_VERYSMALL=\"VERYSMALL\";\nEmailToolTipPrefDialog.SIZE_SMALL=\"SMALL\";\nEmailToolTipPrefDialog.SIZE_MEDIUM=\"MEDIUM\";\nEmailToolTipPrefDialog.SIZE_LARGE=\"LARGE\";\nEmailToolTipPrefDialog.SIZE_XL=\"XL\";\nEmailToolTipPrefDialog.DIMENSIONS=[];\nEmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_VERYSMALL]=\"220px x 130px\";\nEmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_SMALL]=\"230px x 140px\";\nEmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_MEDIUM]=\"280px x 150px\";\nEmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_LARGE]=\"260px x 200px\";\nEmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_XL]=\"270px x 210px\";\nEmailToolTipPrefDialog.prototype.updateEmailTooltipSize=function(){\nvar e=this.emailZimlet_tooltipArea.replace(/px/ig,\"\");\nvar t=e.split(\" x \");\nEmailTooltipZimlet.tooltipWidth=t[0];\nEmailTooltipZimlet.tooltipHeight=t[1]\n};\nfunction SeriesAnimation(){\nthis._objsToAnimate=[];\nthis._objIdAndAnimationTypeMap=[]\n}\nSeriesAnimation.prototype.startAnimation=function(){\nthis._animateNextItem()\n};\nSeriesAnimation.prototype.reset=function(){\nthis._objsToAnimate=[];\nthis._objIdAndAnimationTypeMap=[]\n};\nSeriesAnimation.prototype.addFadeIn=function(e,t){\nthis._addObjs({\nobjId:e,aType:\"FADEIN\",endingOpac:t,millisecs:null}\n)\n};\nSeriesAnimation.prototype.addPause=function(e){\nthis._addObjs({\nobjId:\"__PAUSE__\",aType:\"PAUSE\",endingOpac:null,millisecs:e}\n)\n};\nSeriesAnimation.prototype.addFadeOut=function(e,t){\nthis._addObjs({\nobjId:e,aType:\"FADEOUT\",endingOpac:t,millisecs:null}\n)\n};\nSeriesAnimation.prototype.addslideUp=function(t,e){\nthis._addObjs({\nobjId:t,aType:\"SLIDEUP\",endHeightPercent:e}\n)\n};\nSeriesAnimation.prototype.addslideDown=function(t,e){\nthis._addObjs({\nobjId:t,aType:\"SLIDEDOWN\",endHeightPercent:e}\n)\n};\nSeriesAnimation.prototype.addZoomIn=function(o,e,n,t){\nthis._addObjs({\nobjId:o,aType:\"ZOOMIN\",objWidth:e,objHeight:n,zoomByThisPixels:t}\n)\n};\nSeriesAnimation.prototype._addObjs=function(n){\nvar o=n.objId;\nvar e=n.aType;\nvar t=o+Dwt.getNextId();\nthis._objIdAndAnimationTypeMap[t]=n;\nthis._objsToAnimate.push(t)\n};\nSeriesAnimation.prototype._animate=function(s){\nvar n=s.objId;\nvar t=s.aType;\nif(n.indexOf(\"__PAUSE__\")==-1&&!document.getElementById(n)){\nthis.reset();\nreturn\n}\nif(n.indexOf(\"__PAUSE__\")==-1){\ndocument.getElementById(n).style.display=\"block\"\n}\nif(t==\"FADEOUT\"){\nvar r=s.endingOpac?s.endingOpac:0;\nthis._animateOpacity(n,100,r,500)\n}else{\nif(t==\"PAUSE\"){\nthis._animatePause(s.millisecs)\n}else{\nif(t==\"FADEIN\"){\nvar r=s.endingOpac?s.endingOpac:100;\nthis._animateOpacity(n,0,r,500)\n}else{\nif(t==\"SLIDEUP\"){\nvar o=s.endHeightPercent?s.endHeightPercent:100;\nthis._animateSliding(n,o,t,500)\n}else{\nif(t==\"SLIDEDOWN\"){\nvar o=s.endHeightPercent?s.endHeightPercent:0;\nthis._animateSliding(n,o,t,500)\n}else{\nif(t==\"ZOOMIN\"){\nvar e=s.zoomByThisPixels?s.zoomByThisPixels:0;\nthis._animateZoomIn(s)\n}}}}}}};\nSeriesAnimation.prototype._animateZoomIn=function(h){\nvar n=document.getElementById(h.objId);\nvar r=n.style;\nvar o=h.objWidth;\nvar e=h.objHeight;\nvar t=h.zoomByThisPixels;\nvar s=2;\nvar l=0;\nfor(i=0;\ni<t;\ni++){\nif(i==t-1){\nsetTimeout(AjxCallback.simpleClosure(this._zoomInItem,this,r,(o+i),(e+i),true),(l*s))\n}else{\nsetTimeout(AjxCallback.simpleClosure(this._zoomInItem,this,r,(o+i),(e+i),false),(l*s))\n}\nl++\n}};\nSeriesAnimation.prototype._zoomInItem=function(n,o,e,t){\nn.width=o;\nn.height=e;\nif(t){\nthis._animateNextItem()\n}};\nSeriesAnimation.prototype._animateSliding=function(o,t,e,n){\nvar s=Math.round(n/100);\nvar l=0;\nvar r=document.getElementById(o).style;\nvar h=Math.round(document.getElementById(o).offsetHeight);\nif(e==\"SLIDEUP\"){\nfor(i=h;\ni<=t;\ni++){\nif(i==t){\nsetTimeout(AjxCallback.simpleClosure(this._changeHeight,this,i,r,true),(l*s))\n}else{\nsetTimeout(AjxCallback.simpleClosure(this._changeHeight,this,i,r,false),(l*s))\n}\nl++\n}}else{\nif(e==\"SLIDEDOWN\"){\nfor(i=h;\ni>=t;\ni--){\nif(i==t){\nsetTimeout(AjxCallback.simpleClosure(this._changeHeight,this,i,r,true),(l*s))\n}else{\nsetTimeout(AjxCallback.simpleClosure(this._changeHeight,this,i,r,false),(l*s))\n}\nl++\n}}}};\nSeriesAnimation.prototype._animateOpacity=function(l,s,e,t){\nvar h=document.getElementById(l);\nif(!h){\nthis.reset();\nreturn\n}\nthis._changeOpac(s,h.style);\nvar o=Math.round(t/100);\nvar r=0;\nvar n=h.style;\nif(s>e){\nfor(i=s;\ni>=e;\ni--){\nif(i==e){\nsetTimeout(AjxCallback.simpleClosure(this._changeOpac,this,i,n,true),(r*o))\n}else{\nsetTimeout(AjxCallback.simpleClosure(this._changeOpac,this,i,n,false),(r*o))\n}\nr++\n}}else{\nif(s<e){\nfor(i=s;\ni<=e;\ni++){\nif(i==e){\nsetTimeout(AjxCallback.simpleClosure(this._changeOpac,this,i,n,true),(r*o))\n}else{\nsetTimeout(AjxCallback.simpleClosure(this._changeOpac,this,i,n,false),(r*o))\n}\nr++\n}}}};\nSeriesAnimation.prototype._changeHeight=function(e,o,t){\no.height=e;\nif(t){\nthis._animateNextItem()\n}};\nSeriesAnimation.prototype._changeOpac=function(t,o,e){\nif(!o){\nreturn\n}\no.opacity=(t/100);\no.MozOpacity=(t/100);\no.KhtmlOpacity=(t/100);\no.zoom=1;\no.filter=\"progid:DXImageTransform.Microsoft.Alpha(opacity=\"+t+\")\";\nif(e){\nthis._animateNextItem()\n}};\nSeriesAnimation.prototype._animateNextItem=function(){\nif(this._objsToAnimate.length==0){\nreturn\n}\nvar e=this._objsToAnimate[0];\nvar t=this._objIdAndAnimationTypeMap[e];\nthis._objsToAnimate.splice(0,1);\nthis._animate(t)\n};\nSeriesAnimation.prototype._animatePause=function(e){\nsetTimeout(AjxCallback.simpleClosure(this._animateNextItem,this),e)\n};\nfunction UnknownPersonSlide(){}\nUnknownPersonSlide.PHOTO_ID=\"unkownPerson_photoBG\";\nUnknownPersonSlide.PHOTO_PARENT_ID=\"unkownPerson_photoBGDiv\";\nUnknownPersonSlide.TEXT_DIV_ID=\"unkownPerson_TextDiv\";\nUnknownPersonSlide.DOMAIN=\"\";\nUnknownPersonSlide.WIDTH=65;\nUnknownPersonSlide.HEIGHT=80;\nUnknownPersonSlide.prototype.onEmailHoverOver=function(e){\ne.addSubscriberZimlet(this,false);\nthis.emailZimlet=e;\nthis._alwaysSetTooltipToSmall();\nthis._presenceCache=this.emailZimlet._presenceCache\n};\nUnknownPersonSlide.prototype._alwaysSetTooltipToSmall=function(){\nvar t=EmailToolTipPrefDialog.DIMENSIONS[EmailToolTipPrefDialog.SIZE_VERYSMALL];\nvar e=t.replace(/px/ig,\"\");\nvar o=e.split(\" x \");\nthis._tooltipWidth=o[0];\nthis._tooltipHeight=o[1]\n};\nUnknownPersonSlide.prototype.showTooltip=function(){\nif(appCtxt.get(ZmSetting.CALENDAR_ENABLED)){\nthis._setCalendarFrame()\n}\nif(appCtxt.get(ZmSetting.MAIL_ENABLED)){\nthis._setMailFrame()\n}\nthis._setContactFrame();\nthis.emailZimlet.tooltip.popup(this.emailZimlet.x,this.emailZimlet.y,true,null);\nthis._slide.select()\n};\nUnknownPersonSlide.prototype._setContactFrame=function(){\nthis.emailZimlet.hideBusyImg();\nvar t=this._getTooltipBGHtml();\nvar e=new AjxCallback(this,this._handleContactSlideSelect);\nthis._slide=new EmailToolTipSlide(t,true,\"UnknownPerson_contact\",e,this.emailZimlet.getMessage(\"slideTooltip\"));\nthis.emailZimlet.slideShow.addSlide(this._slide);\nthis._mainDiv=document.getElementById(UnknownPersonSlide.TEXT_DIV_ID);\nthis._slide.setCanvasElement(this._mainDiv)\n};\nUnknownPersonSlide.prototype._setMailFrame=function(){\nvar t=new AjxCallback(this,this._handleMailSlideSelect);\nvar e=new EmailToolTipSlide(null,true,\"Mail_icon\",t,this.emailZimlet.getMessage(\"slideMailTooltip\"));\nthis.emailZimlet.slideShow.addSlide(e)\n};\nUnknownPersonSlide.prototype._setCalendarFrame=function(){\nvar t=new AjxCallback(this,this._handleCalendarSlideSelect);\nvar e=new EmailToolTipSlide(null,true,\"Calendar_icon\",t,this.emailZimlet.getMessage(\"slideCalendarTooltip\"));\nthis.emailZimlet.slideShow.addSlide(e)\n};\nUnknownPersonSlide.prototype._setChatFrame=function(){\nvar t=this._handleChatSlideSelect.bind(this);\nvar e=new EmailToolTipSlide(null,true,\"Conversation_icon\",t,this.emailZimlet.getMessage(\"slideChatTooltip\"));\nthis.emailZimlet.slideShow.addSlide(e)\n};\nUnknownPersonSlide.prototype._setPresence=function(){};\nUnknownPersonSlide.prototype._handleImgLoadFailure=function(){\nvar e=new Image();\ne.onload=AjxCallback.simpleClosure(this._handleImageLoad,this,e);\ne.id=UnknownPersonSlide.PHOTO_ID;\ne.src=this.emailZimlet.getResource(\"img/UnknownPerson_dataNotFound.jpg\")\n};\nUnknownPersonSlide.prototype._handleImageLoad=function(e){\nthis.emailZimlet.hideBusyImg();\nvar t=document.getElementById(UnknownPersonSlide.PHOTO_PARENT_ID);\nif(!t){\nreturn\n}\nt.innerHTML=\"\";\nt.style.textAlign=\"center\";\nt.appendChild(e);\nif(this.emailZimlet.emailAddress.indexOf(UnknownPersonSlide.DOMAIN)!=-1){\ne.onclick=AjxCallback.simpleClosure(this._handleProfileImageClick,this);\ne.style.cursor=\"pointer\"\n}};\nUnknownPersonSlide.prototype._handleProfileImageClick=function(){};\nUnknownPersonSlide.prototype._handleAllClicks=function(o){\nvar n;\nthis.emailZimlet.popdown();\no=DwtUiEvent.getEvent(o);\nif(o.which){\nn=(o.which==3)\n}else{\nif(o.button){\nn=(o.button==2)\n}}\nif(n){\nreturn\n}\nvar t=DwtShell.mouseEvent;\nt.setFromDhtmlEvent(o);\nvar e=t.target;\nif(e.id==\"UnknownPersonSlide_EmailAnchorId\"){\nthis._composeListener(null,this.emailZimlet.emailAddress)\n}else{\nif(e.id==\"UnknownPersonSlide_NameAnchorId\"){\nthis._contactListener(true)\n}else{\nif(e.id==\"UnknownPersonSlide_mobilePhoneAnchorId\"&&appCtxt.getSettings()._hasVoiceFeature()){\nthis.emailZimlet._phoneListener(this.attribs&&this.attribs.mobilePhone)\n}else{\nif(e.id==\"UnknownPersonSlide_workPhoneAnchorId\"&&appCtxt.getSettings()._hasVoiceFeature()){\nthis.emailZimlet._phoneListener(this.attribs&&this.attribs.workPhone)\n}else{\nif(e.id==\"UnknownPersonSlide_imAnchorId\"&&appCtxt.getSettings()._hasVoiceFeature()){\nZmZimbraMail.unloadHackCallback();\nlocation.href=this.imURI;\nthis.emailZimlet._imListener(this.imURI);\nreturn false\n}}}}}};\nUnknownPersonSlide.prototype._handleRightClick=function(t){\nvar e;\nif(!t){\nvar t=window.event\n}\nif(t.which){\ne=(t.which==3)\n}else{\nif(t.button){\ne=(t.button==2)\n}}\nif(!e){\nreturn\n}\nthis.emailZimlet.popdown();\nDwtUiEvent.setBehaviour(t,true,false);\nthis.emailZimlet.contextMenu.popup(100,this.emailZimlet.x,this.emailZimlet.y)\n};\nUnknownPersonSlide.prototype._handleContactSlideSelect=function(){\nif(this._slide.loaded){\nreturn\n}\nthis._slide.loaded=true;\nthis._getContactDetailsAndShowTooltip()\n};\nUnknownPersonSlide.prototype._handleMailSlideSelect=function(){\nthis.emailZimlet.popdown();\nthis._composeListener(null,this.emailZimlet.emailAddress)\n};\nUnknownPersonSlide.prototype._handleCalendarSlideSelect=function(){\nthis.emailZimlet.popdown();\nvar e=new ZmAppt();\nvar t=this._getActionedContact()||new AjxEmailAddress(this.emailZimlet.emailAddress);\ne.setAttendees(t,ZmCalBaseItem.PERSON);\nAjxDispatcher.run(\"GetCalController\").newAppointment(e,null,null,null)\n};\nUnknownPersonSlide.prototype._handleChatSlideSelect=function(){\nthis.emailZimlet.popdown();\nappCtxt.getAppController().getApp(ZmApp.CHAT).startChat(this.xmppURI)\n};\nUnknownPersonSlide.prototype._getContactDetailsAndShowTooltip=function(){\nthis._slide.setInfoMessage(this.emailZimlet.getMessage(\"loading\"));\nvar e=AjxDispatcher.run(\"GetContacts\");\nvar t=e?e.getContactByEmail(this.emailZimlet.emailAddress):null;\nif(!appCtxt.get(ZmSetting.GAL_ENABLED)){\nthis._handleContactDetails(t)\n}else{\nvar r,n,o;\nr={\nSearchGalRequest:{\n_jsns:\"urn:zimbraAccount\"}};\nn=r.SearchGalRequest;\nn.type=\"account\";\nn.name=this.emailZimlet.emailAddress;\nn.offset=0;\nn.limit=3;\nvar s=new AjxCallback(this,this._handleContactDetails,t);\nappCtxt.getAppController().sendRequest({\njsonObj:r,asyncMode:true,callback:s,noBusyOverlay:true}\n)\n}};\nUnknownPersonSlide.prototype._handleContactDetails=function(e,t){\nvar o={};\nvar d=null;\nif(t){\nvar s=t.getResponse();\nvar n=s.SearchGalResponse;\nvar l=n.cn;\nif(l&&l[0]){\nd=l[0].id;\no=AjxUtil.hashCopy(l[0]._attrs,[\"objectClass\"])\n}}\nif(e&&e.attr){\nAjxUtil.hashUpdate(o,e.attr,true)\n}\no.fullName=this.emailZimlet.fullName||o.fullName||e&&e._fileAs;\nthis._presentity=o.email=this.emailZimlet.emailAddress||o.email;\nvar h=e&&e.getImageUrl(UnknownPersonSlide.WIDTH,UnknownPersonSlide.HEIGHT);\nthis._setProfileImage(h);\nthis._setContactDetails(o);\nthis._popupToolTip();\nthis._setPresenceUI()\n};\nUnknownPersonSlide.prototype._getPresence=function(){\nvar e=new Date();\nvar t=this._presenceCache[this._presentity]&&this._presenceCache[this._presentity].timestamp||0;\nif(e-t<5000){\nreturn this._presenceCache[this._presentity]\n}\nif(this.emailZimlet._presenceProvider){\nthis.emailZimlet._presenceProvider(this._presentity,this._handlePresence.bind(this))\n}\nreturn null\n};\nUnknownPersonSlide.prototype._handlePresence=function(t){\nif(!t){\nreturn\n}\nvar e=this._presenceCache[this._presentity];\nif(!e){\ne=this._presenceCache[this._presentity]={}\n}\ne.presenceStatus=t.presenceStatus;\ne.notes=t.notes;\ne.timestamp=new Date();\nthis._setPresenceUI()\n};\nUnknownPersonSlide.prototype._popupToolTip=function(){\nthis.emailZimlet.tooltip.popup(this.emailZimlet.x,this.emailZimlet.y,true,null)\n};\nUnknownPersonSlide.prototype._getTooltipBGHtml=function(e){\nvar o=\";\";\nvar n=\";\";\nif(AjxEnv.isIE8){\nvar o=\"width:100%;\";\nvar n=\"left:3%;\"\n}\nvar t={\nphotoParentId:UnknownPersonSlide.PHOTO_PARENT_ID,textDivId:UnknownPersonSlide.TEXT_DIV_ID,width:o,left:n};\nreturn AjxTemplate.expand(\"com_zimbra_email.templates.Email1#Frame\",t)\n};\nUnknownPersonSlide.prototype._setContactDetails=function(m){\nif(m.workState||m.workCity||m.workStreet||m.workPostalCode){\nvar h=m.workState||\"\";\nvar s=m.workCity||\"\";\nvar v=m.workStreet||\"\";\nvar y=m.workPostalCode||\"\";\nvar b=this.emailZimlet.getMessage(\"postalAddress\");\nvar p=new AjxMessageFormat(b);\nvar o=[v,s,h,y];\nvar n=AjxStringUtil.trim(p.format(o),true);\nm.address=AjxStringUtil.trim(n)\n}\nvar l=m.imAddress||m.imAddress1||m.imAddress2||m.imAddress3;\nif(l){\nvar e=l.split(\":\");\nif(e.length==2){\nvar w=e[0];\nl=l.split(\":\")[1];\nif(w&&w==\"xmpp\"){\nif(appCtxt.get(ZmSetting.CHAT_FEATURE_ENABLED)&&appCtxt.get(ZmSetting.CHAT_ENABLED)){\nvar f=appCtxt.getAppController().getApp(ZmApp.CHAT);\nif(f&&f.getRosterContact(l.substring(2))){\nthis.xmppURI=m.xmppURI=AjxStringUtil.htmlEncode(l.substring(2));\nthis._setChatFrame()\n}}}else{\nif(w&&w==\"other\"){\nw=\"im\"\n}else{\nif(w&&w==\"aol\"){\nw=\"aim\"\n}}\nl=\"<a  id='UnknownPersonSlide_imAnchorId' href='\"+w+\":\"+AjxStringUtil.htmlEncode(l.substring(2))+\"'>\"+AjxStringUtil.htmlEncode(l.substring(2))+\"</a>\";\nthis.imURI=m.imURI=l\n}}}else{\nif(appCtxt.get(ZmSetting.CHAT_FEATURE_ENABLED)&&appCtxt.get(ZmSetting.CHAT_ENABLED)){\nvar f=appCtxt.getAppController().getApp(ZmApp.CHAT);\nif(f){\nfor(var g=0;\ng<4;\ng++){\nvar r=\"email\"+((g==0)?\"\":g);\nif(m[r]&&f.getRosterContact(m[r])){\nthis.xmppURI=AjxStringUtil.htmlEncode(m[r]);\nthis._setChatFrame();\nbreak\n}}}}}\nif(!this.emailZimlet.noRightClick){\nm.rightClickForMoreOptions=false\n}\nthis.attribs=m;\nm=this._formatTexts(m);\nvar d=AjxTemplate.expand(\"com_zimbra_email.templates.Email1#ContactDetails\",m),t=document.getElementById(UnknownPersonSlide.TEXT_DIV_ID),u=document.getElementById(\"UnknownPersonSlide_Frame\");\nif(t){\nt.innerHTML=d\n}\nif(u){\nu.onmouseup=AjxCallback.simpleClosure(this._handleAllClicks,this)\n}};\nUnknownPersonSlide.prototype._formatTexts=function(t){\nvar e=t.email?t.email:\"\";\nt.formattedEmail=e;\nif(e.length>25){\nvar o=e.split(\"@\");\nvar n=o[0];\nvar r=o[1];\nif(n.length>25){\nn=n.substring(0,24)+\"..\"\n}\nt.formattedEmail=[n,\" @\",r].join(\"\")\n}\nvar s=t.fullName?t.fullName:\"\";\nif(s==e){\nt.fullName=\"\"\n}\nreturn t\n};\nUnknownPersonSlide.prototype._setProfileImage=function(n){\nvar o=document.getElementById(UnknownPersonSlide.PHOTO_PARENT_ID);\nif(!o||!this.emailZimlet.emailAddress){\nreturn\n}\nif(this.emailZimlet.emailAddress.indexOf(UnknownPersonSlide.DOMAIN)==-1||!n||!o){\nthis._handleImgLoadFailure();\nreturn\n}\no.width=o.style.width=UnknownPersonSlide.WIDTH;\no.height=o.style.height=UnknownPersonSlide.HEIGHT;\nvar t=new Image();\nt.onload=AjxCallback.simpleClosure(this._handleImageLoad,this,t);\nt.onerror=function(){\nthis.onerror=null;\nthis.src=ZmZimbraMail.DEFAULT_CONTACT_ICON\n};\nt.src=n;\nvar e=new AjxCallback(this,this._handleImgLoadFailure);\nthis.emailZimlet.showLoadingAtId(e,UnknownPersonSlide.PHOTO_PARENT_ID)\n};\nUnknownPersonSlide.prototype._contactListener=function(){\nthis.emailZimlet.popdown();\nvar e=new AjxCallback(this,this._handleLoadContact);\nAjxDispatcher.require([\"ContactsCore\",\"Contacts\"],false,e,null,true)\n};\nUnknownPersonSlide.prototype._handleLoadContact=function(){\nvar e=this._getActionedContact(true);\nvar t=this._isNewContact;\nif(window.parentAppCtxt){\nvar o=window.parentAppCtxt.getApp(ZmApp.CONTACTS);\no.getContactController().show(e,t)\n}else{\nAjxDispatcher.run(\"GetContactController\").show(e,t)\n}};\nUnknownPersonSlide.prototype._composeListener=function(t,s){\nthis.emailZimlet.popdown();\nvar o=this.emailZimlet._actionObject;\ns=s?this.emailZimlet._getAddress(s):(o?this.emailZimlet._getAddress(o):\"\");\nvar n={};\nvar e=(!appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE)&&t&&t.shiftKey)||(appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE)&&t&&!t.shiftKey);\nn.action=ZmOperation.NEW_MESSAGE;\nn.inNewWindow=e;\nif(!n.toOverride){\nn.toOverride=s+AjxEmailAddress.SEPARATOR\n}\nif(o&&o.isAjxEmailAddress&&o.address==s){\nn.toOverride=o\n}\nAjxDispatcher.run(\"Compose\",n)\n};\nUnknownPersonSlide.prototype._getActionedContact=function(o){\nvar e;\nvar n=this.emailZimlet._actionObject;\nvar t;\nif(n){\nif(n.isZmContact){\ne=this._actionObject\n}else{\naddress=AjxUtil.isString(n)?this.emailZimlet._getAddress(n):n.address;\nt=AjxDispatcher.run(\"GetContacts\");\ne=t&&t.getContactByEmail(address)||null\n}}\nthis._isNewContact=false;\nif(e==null&&o){\nthis._isNewContact=true;\ne=new ZmContact(null);\ne.initFromEmail(n)\n}\nreturn e\n};\nUnknownPersonSlide.prototype._isKnownPresenceCode=function(o){\nif(!this._presenceCodes){\nvar e=[\"dnd\",\"vacation\",\"on-the-phone\",\"busy\",\"unavailable\",\"away\",\"available\",\"unknown\"];\nthis._presenceCodes={};\nfor(var t=0;\nt<e.length;\nt++){\nthis._presenceCodes[e[t]]=true\n}}\nreturn this._presenceCodes[o]\n};\nUnknownPersonSlide.prototype._setPresenceUI=function(){\nvar o=this._getPresence();\nvar n=o&&o.presenceStatus;\nvar s=document.getElementById(\"row_Presence\");\nvar r=document.getElementById(\"img_Presence\");\nvar t=document.getElementById(\"text_Presence\");\nif(!s||!r||!t){\nreturn\n}\nif(n){\nif(!this._isKnownPresenceCode(n)){\nn=\"unknown\"\n}\ns.style.display=\"\";\nvar e=n.split(\"-\").join(\"\");\nr.className=\"Img_\"+e;\nif(o.notes){\nt.innerHTML=o.notes\n}else{\nt.innerHTML=this.emailZimlet.getMessage(\"msg_\"+e)\n}}else{\ns.style.display=\"none\"\n}\nreturn\n};\nCom_Zimbra_Date=function(e){\nif(arguments.length==1){\nthis._generateRegex(e)\n}};\nCom_Zimbra_Date.prototype=new ZmZimletBase();\nCom_Zimbra_Date.prototype.constructor=Com_Zimbra_Date;\nCom_Zimbra_Date.prototype.TYPE=ZmObjectManager.DATE;\nCom_Zimbra_Date.validate=function(e,n,t){\nif(e<1||e>31){\nreturn false\n}\nif(n<0||n>11){\nreturn false\n}\nif((n==3||n==5||n==8||n==10)&&e==31){\nreturn false\n}\nif(t&&n==1){\nvar o=(t%4==0&&(t%100!=0||t%400==0));\nif(e>29||(e==29&&!o)){\nreturn false\n}}\nreturn true\n};\nCom_Zimbra_Date.prototype.getCurrentDate=function(e){\nvar t=this[ZmObjectManager.ATTR_CURRENT_DATE];\nreturn t?t:new Date()\n};\nCom_Zimbra_Date.prototype.init=function(){\nCom_Zimbra_Date.prototype._zimletContext=this._zimletContext;\nCom_Zimbra_Date.prototype._className=\"Object\";\nthis._initDateObjectHandlers()\n};\nCom_Zimbra_Date.prototype.getActionMenu=function(o,t,e){\nif(this._zimletContext._contentActionMenu instanceof AjxCallback){\nthis._zimletContext._contentActionMenu=this._zimletContext._contentActionMenu.run()\n}\nCom_Zimbra_Date._actionObject=o;\nCom_Zimbra_Date._actionSpan=t;\nCom_Zimbra_Date._actionContext=e;\nreturn this._zimletContext._contentActionMenu\n};\nCom_Zimbra_Date.prototype.menuItemSelected=function(e){\nswitch(e){\ncase\"DAYVIEW\":this.showDayView(Com_Zimbra_Date._actionContext.date);\nbreak;\ncase\"NEWAPPT\":this._newApptListener();\nbreak;\ncase\"SEARCHMAIL\":this._searchMailListener();\nbreak\n}};\nCom_Zimbra_Date.prototype.toolTipPoppedUp=function(n,s,o,t){\nvar r=this.getAppInMainWindow(ZmApp.CALENDAR);\nif(!r){\nreturn\n}\nvar e=o?o.date:new Date();\nif(!isNaN(e)){\nt.innerHTML=r.getDateToolTip(e,true)\n}};\nCom_Zimbra_Date.prototype.getMainWindow=function(e){\nreturn appCtxt.isChildWindow?window.opener:window\n};\nCom_Zimbra_Date.prototype.getAppInMainWindow=function(o){\nvar t=this.getMainWindow();\nif(!t){\nreturn null\n}\nvar e=t.appCtxt;\nif(!e){\nreturn null\n}\nreturn e.getApp(o)\n};\nCom_Zimbra_Date.prototype.clicked=function(o,n,t,e){\nthis.showDayView(t.date)\n};\nCom_Zimbra_Date.prototype.showDayView=function(e){\nvar t=this.getAppInMainWindow(ZmApp.CALENDAR);\nif(!t){\nreturn\n}\nt.showDayView(e);\nif(appCtxt.isChildWindow){\nwindow.opener.focus()\n}};\nCom_Zimbra_Date.prototype.match=function(g,f){\nif(!Com_Zimbra_Date.PATTERNS){\nreturn null\n}\nvar r,t,d,p,n,s;\nfor(s=0;\ns<Com_Zimbra_Date.REGEXES.length;\ns++){\np=Com_Zimbra_Date.REGEXES[s];\np.lastIndex=f;\nn=p.exec(g);\nif(n&&n[0]&&(!r||n[0].length>r[0].length)){\nr=n;\nd=Com_Zimbra_Date.RULES[s];\nt=p.mapping;\nbreak\n}}\nif(!r){\nreturn null\n}\ntry{\nvar h,u;\nfor(s in t){\nh=t[s];\nu=r[s];\nd=d.replace(new RegExp(\"\\\\{\"+h+\"\\\\}\",\"gi\"),u)\n}\nvar o=new Date(this.getCurrentDate().getTime());\nr.context={\nrule:d,date:AjxDateUtil.calculate(d,o),monthOnly:0,valid:true};\nreturn r\n}\ncatch(l){\nif(window.console&&window.console.log){\nconsole.log(l)\n}\nreturn null\n}};\nCom_Zimbra_Date.prototype._initDateObjectHandlers=function(){\nif(!appCtxt.get(ZmSetting.CALENDAR_ENABLED)){\nreturn\n}\nCom_Zimbra_Date.MAPPINGS={\ndatenum:\"(3[0-1]|0[1-9]|[1-2][0-9]|[1-9])\",dayname:\"(\"+AjxDateUtil.S_DAYNAME+\")\",weekord:\"(\"+AjxDateUtil.S_WEEKORD+\")\",monthnum:\"(0[1-9]|[1-9]|1[0-2])\",monthname:\"(\"+AjxDateUtil.S_MONTHNAME+\")\",yearnum:\"(\\\\d{2}|[1-9]\\\\d{2,3})\",fullyearnum:\"(\\\\d{4})\",number:\"(\\\\d+)\",timenum:\"(1[0-2]:?[0-5][0-9]|[1-9]:?[0-5][0-9]|1[0-2]|[1-9])\",militarytimenum:\"(2[0-3]:?[0-5][0-9]|[0-1][0-9]:?[0-5][0-9])\"};\nCom_Zimbra_Date.PATTERNS=[];\nCom_Zimbra_Date.RULES=[];\nCom_Zimbra_Date.REGEXES=[];\nvar n,r;\nfor(n=1;\nr=this.getMessage(\"format\"+n+\".pattern\");\nn++){\nif(r.match(/^\\?\\?\\?+/)){\nbreak\n}\nif(r.match(/^###+/)){\nbreak\n}\nif(r.match(/^#/)){\ncontinue\n}\nCom_Zimbra_Date.PATTERNS.push(r);\nCom_Zimbra_Date.RULES.push(this.getMessage(\"format\"+n+\".rule\"))\n}\nfor(n=0;\nn<Com_Zimbra_Date.DEFAULT_FORMATS.length;\nn++){\nCom_Zimbra_Date.PATTERNS.push(Com_Zimbra_Date.DEFAULT_FORMATS[n]);\nCom_Zimbra_Date.RULES.push(Com_Zimbra_Date.DEFAULT_FORMATS[++n])\n}\nvar o=this.getMessage(\"boundaryTrue\");\nvar h,s;\nvar e=this.getMessage(\"format.boundary\")||o;\nfor(n=0;\nn<Com_Zimbra_Date.PATTERNS.length;\nn++){\nr=Com_Zimbra_Date.PATTERNS[n];\nr=r.replace(/\\s+/g,\"\\\\s+\");\nr=r.replace(/\\(([^\\)]+)\\)/g,\"(?:$1)\");\nCom_Zimbra_Date.__replaceKeyword_group=1;\nCom_Zimbra_Date.__replaceKeyword_mapping={};\nr=r.replace(/\\{([a-z]+)\\}/g,Com_Zimbra_Date.__replaceKeyword);\nh=this.getMessage(\"format\"+(n+1)+\".boundary\");\nif((h!=\"\"&&h==o)||e==o){\nr=\"\\\\b\"+r+\"\\\\b\"\n}\nvar t=this.getMessage(\"format.caseSensitive\")===o;\ns=new RegExp(r,\"g\"+(!t?\"i\":\"\"));\ns.mapping=Com_Zimbra_Date.__replaceKeyword_mapping;\nCom_Zimbra_Date.REGEXES.push(s)\n}\nZmObjectManager.registerHandler(this,ZmObjectManager.DATE,this._zimletContext.priority)\n};\nCom_Zimbra_Date.prototype._newApptListener=function(){\nvar t=this.getMainWindow();\nif(!t){\nreturn\n}\nvar e=new t.AjxCallback(this,this._handleLoadNewAppt);\nt.AjxDispatcher.require([\"CalendarCore\",\"Calendar\",\"CalendarAppt\"],false,e,null,true)\n};\nCom_Zimbra_Date.prototype._handleLoadNewAppt=function(){\nvar e=this.getMainWindow();\nif(!e){\nreturn null\n}\ne.appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);\ne.AjxDispatcher.run(\"GetCalController\").newAppointmentHelper(Com_Zimbra_Date._actionContext.date);\nif(appCtxt.isChildWindow){\nwindow.opener.focus()\n}};\nCom_Zimbra_Date.prototype._searchMailListener=function(){\nvar e=this.getMainWindow(ZmApp.CALENDAR);\nif(!e){\nreturn\n}\ne.appCtxt.getSearchController().dateSearch(Com_Zimbra_Date._actionContext.date);\nif(appCtxt.isChildWindow){\nwindow.opener.focus()\n}};\nCom_Zimbra_Date.__replaceKeyword_mapping=null;\nCom_Zimbra_Date.__replaceKeyword_group=-1;\nCom_Zimbra_Date.__replaceKeyword=function(e,t){\nvar n=Com_Zimbra_Date.MAPPINGS;\nt=t.toLowerCase();\nif(!n[t]){\nreturn e\n}\nvar o=Com_Zimbra_Date.__replaceKeyword_mapping;\nvar s=Com_Zimbra_Date.__replaceKeyword_group++;\no[s++]=t;\nreturn n[t]\n};\nCom_Zimbra_Date.DEFAULT_FORMATS=[\"Dante Mateo Comfort\",\"2011-03-01T17:26:00Z\",\"Brooke Ellen Henrikson\",\"2009-10-17T10:20:00Z\",\"Nicholas Mateo Damon\",\"2008-07-18T17:35:00Z\",\"Shyar Parag Shah\",\"2008-07-16T04:51:00Z\",\"Diego Isaac Comfort\",\"2006-12-08T20:05:00Z\",\"Nila Dharmaraj\",\"2006-03-19T16:30:00Z\",\"Nikhil Dharmaraj\",\"2001-08-22T20:00:00Z\"];\nfunction com_zimbra_attachmail_HandlerObject(){}\ncom_zimbra_attachmail_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_attachmail_HandlerObject.prototype.constructor=com_zimbra_attachmail_HandlerObject;\nvar AttachMailZimlet=com_zimbra_attachmail_HandlerObject;\nAttachMailZimlet.prototype.initializeAttachPopup=function(t,e){\ne._createAttachMenuItem(t,ZmMsg.mail,this.showAttachmentDialog.bind(this),\"ATTACH_MENU_MAIL\")\n};\nAttachMailZimlet.prototype.removePrevAttDialogContent=function(t){\nvar e=t&&t.firstChild;\nif(e&&e.className==\"DwtComposite\"){\nt.removeChild(e)\n}};\nAttachMailZimlet.prototype.onDisposeComposeController=function(){\nthis.AMV._overview._controller.dispose()\n};\nAttachMailZimlet.prototype.showAttachmentDialog=function(){\nvar t=this._attachDialog=appCtxt.getAttachDialog();\nt.setTitle(ZmMsg.attachMail);\nthis.removePrevAttDialogContent(t._getContentDiv().firstChild);\nif(!this.AMV||!this.AMV.attachDialog){\nthis.AMV=new AttachMailTabView(this._attachDialog,this)\n}\nthis.AMV.reparentHtmlElement(t._getContentDiv().childNodes[0],0);\nthis.AMV.attachDialog=t;\nt.setOkListener(new AjxCallback(this.AMV,this.AMV.uploadFiles));\nvar e=appCtxt.getCurrentView();\nvar o=new AjxCallback(e,e._attsDoneCallback,[true]);\nt.setUploadCallback(o);\nthis.AMV.attachDialog.popup();\nthis.AMV.attachDialog.enableInlineOption(false);\nthis._addedToMainWindow=true\n};\nAttachMailZimlet.prototype.doubleClicked=function(){\nthis.singleClicked()\n};\nAttachMailZimlet.prototype.singleClicked=function(){};\nAttachMailTabView=function(o,e,t){\nthis.zimlet=e;\nDwtComposite.call(this,o,t,Dwt.STATIC_STYLE);\nvar n=appCtxt.multiAccounts?appCtxt.getAppViewMgr().getCurrentView().getFromAccount():appCtxt.getActiveAccount();\nif(this.prevAccount&&(n.id==this.prevAccount.id)){\nthis.setSize(Dwt.DEFAULT,\"275\");\nreturn\n}\nthis.prevAccount=n;\nthis._createHtml1();\ndocument.getElementById(this._folderTreeCellId).onclick=AjxCallback.simpleClosure(this._treeListener,this)\n};\nAttachMailTabView.prototype=new DwtComposite;\nAttachMailTabView.prototype.constructor=AttachMailTabView;\nAttachMailTabView.ELEMENT_ID_SEARCH_FIELD=\"attDlg_attMsg_SearchField\";\nAttachMailTabView.ELEMENT_ID_SEARCH_BUTTON=\"attDlg_attMsg_SearchBtn\";\nAttachMailTabView.ELEMENT_ID_VIEW_MESSAGE_BUTTON=\"attDlg_attMsg_ViewMsgBtn\";\nAttachMailTabView.ELEMENT_ID_NAV_BUTTON_CELL=\"attDlg_attMsg_NavBtnCell\";\nAttachMailTabView.prototype.toString=function(){\nreturn\"AttachMailTabView\"\n};\nAttachMailTabView.prototype.showMe=function(){\nDwtTabViewPage.prototype.showMe.call(this);\nvar e=appCtxt.multiAccounts?appCtxt.getAppViewMgr().getCurrentView().getFromAccount():appCtxt.getActiveAccount();\nif(this.prevAccount&&(e.id==this.prevAccount.id)){\nthis.setSize(Dwt.DEFAULT,\"275\");\nreturn\n}\nthis.prevAccount=e;\nthis._createHtml1();\ndocument.getElementById(this._folderTreeCellId).onclick=AjxCallback.simpleClosure(this._treeListener,this)\n};\nAttachMailTabView.prototype._resetQuery=function(e){\nif(this._currentQuery==undefined){\nthis._currentQuery=e;\nreturn e\n}\nif(this._currentQuery!=e){\nthis._offset=0;\nthis._currentQuery=e\n}\nreturn e\n};\nAttachMailTabView.prototype._getQueryFromFolder=function(e){\nreturn this._resetQuery('inid:\"'+e+'\"')\n};\nAttachMailTabView.prototype.hideMe=function(){\nDwtTabViewPage.prototype.hideMe.call(this)\n};\nAttachMailTabView.prototype._createHtml1=function(){\nthis._tableID=Dwt.getNextId();\nthis._folderTreeCellId=Dwt.getNextId();\nthis._folderListId=Dwt.getNextId();\nvar o=[];\nvar d=0;\no[d++]='<table width=\"100%\" style=\"margin-bottom:5px\">';\no[d++]='<TR><td width=\"20%\"><INPUT type=\"text\" id=\"';\no[d++]=AttachMailTabView.ELEMENT_ID_SEARCH_FIELD;\no[d++]='\" style=\"padding:4px\"></INPUT></td>';\no[d++]='<td width=\"10%\"><div id=\"';\no[d++]=AttachMailTabView.ELEMENT_ID_SEARCH_BUTTON;\no[d++]='\" style=\"margin: 0 2px\" />';\no[d++]='<td width=\"10%\"><div id=\"';\no[d++]=AttachMailTabView.ELEMENT_ID_VIEW_MESSAGE_BUTTON;\no[d++]='\" style=\"margin: 0 2px\" /></td>';\no[d++]='<td align=\"right\" width=\"60%\"><SPAN id=\"';\no[d++]=AttachMailTabView.ELEMENT_ID_NAV_BUTTON_CELL;\no[d++]='\" /></td></TR></table>';\no[d++]='<table width=\"100%\">';\no[d++]=\"<tr>\";\no[d++]='<td valign=\"top\" id=\"'+this._folderTreeCellId+'\">';\no[d++]=\"</td>\";\no[d++]='<td  valign=\"top\"  id=\"'+this._folderListId+'\">';\no[d++]=\"</td>\";\no[d++]=\"</tr>\";\no[d++]=\"</table>\";\nthis.setContent(o.join(\"\"));\nvar h=new DwtButton({\nparent:this}\n);\nvar e=this.zimlet.getMessage(\"AttachMailZimlet_tab_button_search\");\nh.setText(e);\nh.addSelectionListener(new AjxListener(this,this._searchButtonListener));\ndocument.getElementById(AttachMailTabView.ELEMENT_ID_SEARCH_BUTTON).appendChild(h.getHtmlElement());\nvar r=new DwtButton({\nparent:this}\n);\nvar l=this.zimlet.getMessage(\"AttachMailZimlet_tab_button_view\");\nr.setText(l);\nr.addSelectionListener(new AjxListener(this,this._viewMsgButtonListener));\ndocument.getElementById(AttachMailTabView.ELEMENT_ID_VIEW_MESSAGE_BUTTON).appendChild(r.getHtmlElement());\nthis._navigationContainer=new DwtComposite(appCtxt.getShell());\nthis._navTB=new AMZimletNavToolBar({\nparent:this._navigationContainer}\n);\nvar s=new AjxListener(this,this._navBarListener);\nthis._navTB.addSelectionListener(ZmOperation.PAGE_BACK,s);\nthis._navTB.addSelectionListener(ZmOperation.PAGE_FORWARD,s);\ndocument.getElementById(AttachMailTabView.ELEMENT_ID_NAV_BUTTON_CELL).appendChild(this._navTB.getHtmlElement());\nvar t={\nparent:appCtxt.getShell(),className:\"AttachMailTabBox AttachMailList\",posStyle:DwtControl.ABSOLUTE_STYLE,view:ZmId.VIEW_BRIEFCASE_ICON,type:ZmItem.ATT};\nvar n=this._tabAttachMailView=new ZmAttachMailListView(t);\nthis.showAttachMailTreeView();\nn.reparentHtmlElement(this._folderListId);\nn.addSelectionListener(new AjxListener(this,this._listSelectionListener));\nDwt.setPosition(n.getHtmlElement(),Dwt.RELATIVE_STYLE)\n};\nAttachMailTabView.prototype._searchButtonListener=function(e){\nthis.treeView.deselectAll();\nvar o=document.getElementById(AttachMailTabView.ELEMENT_ID_SEARCH_FIELD).value;\nif(o==\"\"){\nreturn\n}\nvar t=this._resetQuery(o);\nthis.executeQuery(t)\n};\nAttachMailTabView.prototype._viewMsgButtonListener=function(o){\nvar e=this.getSelectedMsgs();\nfor(var t=0;\nt<e.length;\nt++){\ne[t].load({}\n);\nZmMailMsgView.detachMsgInNewWindow(e[t])\n}};\nAttachMailTabView.prototype._navBarListener=function(e){\nvar t=e.item.getData(ZmOperation.KEY_ID);\nthis._paginate(t==ZmOperation.PAGE_FORWARD)\n};\nAttachMailTabView.prototype._paginate=function(e){\nthis.executeQuery(this._currentQuery,e)\n};\nAttachMailTabView.prototype.searchFolder=function(t){\nvar e=AjxSoapDoc.create(\"SearchRequest\",\"urn:zimbraMail\");\ne.setMethodAttribute(\"types\",\"message\");\ne.setMethodAttribute(\"limit\",t.limit);\ne.setMethodAttribute(\"offset\",t.offset);\ne.set(\"query\",t.query);\nt.response=appCtxt.getAppController().sendRequest({\nsoapDoc:e,noBusyOverlay:false}\n);\nthis.handleSearchResponse(t)\n};\nAttachMailTabView.prototype.handleSearchResponse=function(t){\nvar e=t.response;\nif(e&&(e.SearchResponse||e._data.SearchResponse)){\nt.searchResponse=e.SearchResponse||e._data.SearchResponse;\nt.items=this.processDocsResponse(t)\n}\nif(t.callback){\nt.callback.run(t)\n}};\nAttachMailTabView.prototype.processDocsResponse=function(s){\nvar o=s.searchResponse.m;\nvar e=new ZmMailList(ZmItem.MSG,this._currentSearch);\ne.clear();\ne.setHasMore(s.searchResponse.more);\nif(o==undefined){\nreturn e\n}\nfor(var t=0;\nt<o.length;\nt++){\nvar n=o[t];\ne.addFromDom(n)\n}\nreturn e\n};\nAttachMailTabView.prototype.showResultContents=function(n){\nvar t=n.items;\nthis._navTB.enable(ZmOperation.PAGE_BACK,n.offset>0);\nthis._navTB.enable(ZmOperation.PAGE_FORWARD,t.hasMore());\nvar o=t.size();\nif(o==0){\nthis._navTB.setText(\"\")\n}else{\nthis._navTB.setText((this._offset+1)+\"-\"+(this._offset+t.size()))\n}\nif(t){\nthis._list=t\n}else{\nthis._list=new ZmList(ZmItem.BRIEFCASE_ITEM)\n}\nvar e=this._tabAttachMailView;\ne.set(this._list);\ne._controller.setList(this._list)\n};\nAttachMailTabView.prototype._handleKeys=function(t){\nvar e=DwtKeyEvent.getCharCode(t);\nreturn !DwtKeyEvent.IS_RETURN[e]\n};\nAttachMailTabView.prototype.gotAttachments=function(){\nreturn false\n};\nAttachMailTabView.prototype.getSelectedMsgs=function(){\nvar e=this._tabAttachMailView;\nreturn e.getSelection()\n};\nAttachMailTabView.prototype.uploadFiles=function(o,e){\nif(!e){\ne=[];\nvar t=this.getSelectedMsgs();\nif(!t||(t.length==0)){\nreturn\n}\nfor(var n in t){\ne.push(t[n].id)\n}}\nif(o==undefined){\no=this.attachDialog\n}\nif(o._uploadCallback){\no._uploadCallback.run(AjxPost.SC_OK,null,null,e)\n}\no.popdown()\n};\nAttachMailTabView.prototype.showAttachMailTreeView=function(){\nvar e=new AjxCallback(this,this._showTreeView);\nAjxPackage.undefine(\"zimbraMail.mail.controller.ZmMailFolderTreeController\");\nAjxPackage.require({\nname:\"MailCore\",forceReload:true,callback:e}\n)\n};\nAttachMailTabView.prototype._showTreeView=function(){\nif(appCtxt.isChildWindow){\nZmOverviewController.CONTROLLER.FOLDER=\"ZmMailFolderTreeController\"\n}\nvar o=appCtxt.getApp(ZmApp.MAIL);\no._createDeferredFolders();\nvar e=this.toString();\nvar t={\ntreeIds:[\"FOLDER\"],fieldId:this._folderTreeCellId,overviewId:(appCtxt.multiAccounts)?([e,this.prevAccount.name].join(\":\")):e,account:this.prevAccount};\nthis._setOverview(t);\nthis.setSize(Dwt.DEFAULT,\"275\");\nthis._currentQuery=this._getQueryFromFolder(\"2\");\nsetTimeout(AjxCallback.simpleClosure(this.treeView.setSelected,this.treeView,2),100)\n};\nAttachMailTabView.prototype._setOverview=function(n){\nvar o=n.overviewId;\nvar s=appCtxt.getOverviewController();\nvar t=s.getOverview(o);\nif(!t){\nvar e={\noverviewId:o,overviewClass:\"AttachMailTabBox\",headerClass:\"DwtTreeItem\",noTooltips:true,treeIds:n.treeIds};\nt=s.createOverview(e);\nt.account=this.prevAccount;\nt.set(n.treeIds);\nt.clearChangeListener(n.treeIds)\n}else{\nif(n.account){\nt.account=n.account\n}}\nt.setSelected(this.prevAccount.id+\":\"+ZmFolder.ID_INBOX,\"FOLDER\");\nthis._overview=t;\ndocument.getElementById(n.fieldId).appendChild(t.getHtmlElement());\nthis.treeView=t.getTreeView(\"FOLDER\");\nthis.treeView.addSelectionListener(new AjxListener(this,this._treeListener));\nthis._hideRoot(this.treeView)\n};\nAttachMailTabView.prototype._treeListener=function(o,e){\no=o||window.event;\nif(e||o.detail==DwtTree.ITEM_SELECTED){\nvar t=this.treeView.getSelected();\ndocument.getElementById(AttachMailTabView.ELEMENT_ID_SEARCH_FIELD).value=['in:\"',t.getSearchPath(),'\"'].join(\"\");\nvar n=this._getQueryFromFolder(t.id);\nthis.executeQuery(n);\nthis._tabAttachMailView.focus()\n}};\nAttachMailTabView.prototype._hideRoot=function(t){\nvar o=t.getTreeItemById(ZmOrganizer.ID_ROOT);\nif(!o){\nvar e=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,this.prevAccount);\no=t.getTreeItemById(e)\n}\no.showCheckBox(false);\no.setExpanded(true);\no.setVisible(false,true)\n};\nAttachMailTabView.prototype.setSize=function(n,e){\nDwtTabViewPage.prototype.setSize.call(this,n,e);\nvar o=this.getSize();\nvar r=o.x*0.35;\nvar s=o.x-r;\nvar t=e-55;\nthis._overview.setSize(r,t);\nthis._tabAttachMailView.setSize(s-5,t);\nreturn this\n};\nAttachMailTabView.prototype.executeQuery=function(t,e){\nif(this._limit==undefined){\nthis._limit=50\n}\nif(this._offset==undefined){\nthis._offset=0\n}\nif(e!=undefined){\nif(e){\nthis._offset=this._offset+50\n}else{\nthis._offset=this._offset-50\n}}\nvar o=new AjxCallback(this,this.showResultContents);\nthis.searchFolder({\nquery:t,offset:this._offset,limit:this._limit,callback:o}\n)\n};\nZmAttachMailController=function(e){\nif(arguments.length==0){\nreturn\n}\nZmListController.call(this,null,null);\nthis.clearChangeListener();\nthis._currentViewId=\"ZmAttachMailListView\";\nthis._view={};\nthis._view[this._currentViewId]=e\n};\nZmAttachMailController.prototype=new ZmListController;\nZmAttachMailController.prototype.constructor=ZmAttachMailController;\nZmAttachMailController.prototype._resetToolbarOperations=function(){};\nZmAttachMailController.prototype.clearChangeListener=function(){\nif(this._boundTagChangeListener){\nvar e=appCtxt.getTagTree();\nif(e){\ne.removeChangeListener(this._boundTagChangeListener)\n}}};\nZmAttachMailListView=function(e){\nthis._showCheckboxColSpan=appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX);\nZmListView.call(this,e);\nthis.clearChangeListener();\nthis._controller=new ZmAttachMailController(this)\n};\nZmAttachMailListView.prototype=new ZmListView;\nZmAttachMailListView.prototype.constructor=ZmAttachMailListView;\nZmAttachMailListView.prototype._getDivClass=function(t,e,o){\nreturn\"\"\n};\nZmAttachMailListView.prototype.clearChangeListener=function(){\nif(this._boundFolderChangeListener){\nvar t=appCtxt.getFolderTree();\nif(t){\nt.removeChangeListener(this._boundFolderChangeListener)\n}}\nif(this._tagListChangeListener){\nvar e=appCtxt.getTagTree();\nif(e){\ne.removeChangeListener(this._tagListChangeListener)\n}}};\nZmAttachMailListView.prototype._getCellContents=function(u,d,m,h,t,e){\nvar n=m.fragment?AjxStringUtil.htmlEncode(m.fragment.slice(0,80)):\"\";\nvar l=m.getAddress(\"FROM\");\nif(l.name!=\"\"){\nl=l.name\n}else{\nl=l.address\n}\nvar o=\"\";\nvar r=2;\nif(m.hasAttach){\no=\"<td width='16px'><div class='ImgAttachment'/></td>\";\nr=3\n}\nu[d++]=\"<div class='AttachMailRowDiv'>\";\nu[d++]=\"<table width='100%'>\";\nvar s=m.subject?AjxStringUtil.htmlEncode(m.subject.slice(0,32)):ZmMsg.noSubject;\nu[d++]=\"<tr>\";\nif(this._showCheckboxColSpan){\nu[d++]=\"<td rowspan=3 style='vertical-align:middle;' width='20'><center>\";\nd=this._getImageHtml(u,d,\"CheckboxUnchecked\",this._getFieldId(m,ZmItem.F_SELECTION));\nu[d++]=\"</center></td>\"\n}\nu[d++]=o;\nu[d++]=\"<td align='left' width='80%'><span class='AttachMailSubject'> \"+s+\"</span></td>\";\nu[d++]=\"<td width='20%' align='right'>\";\nu[d++]=AjxDateUtil.computeDateStr(e.now||new Date(),m.date);\nu[d++]=\"</td></tr>\";\nu[d++]=\"<tr><td align='left' colspan='\"+r+\"'><span class='AttachMailFrom'> \";\nu[d++]=l;\nu[d++]=\"</span></td></tr>\";\nif(n!=\"\"){\nu[d++]=\"<tr><td align=left colspan=\"+r+\"><span class='AttachMailFrag'>\"+n+\"</span></td></tr>\"\n}\nu[d++]=\"</table></div>\";\nreturn d\n};\nAMZimletNavToolBar=function(t){\nt.className=t.className||\"AMZimletNavToolBar\";\nvar e=(t.hasText!==false);\nt.buttons=this._getButtons(e);\nt.toolbarType=ZmId.TB_NAV;\nt.posStyle=t.posStyle||DwtControl.STATIC_STYLE;\nZmButtonToolBar.call(this,t);\nif(e){\nthis._textButton=this.getButton(ZmOperation.TEXT)\n}};\nAMZimletNavToolBar.prototype=new ZmButtonToolBar;\nAMZimletNavToolBar.prototype.constructor=AMZimletNavToolBar;\nAMZimletNavToolBar.prototype.toString=function(){\nreturn\"AMZimletNavToolBar\"\n};\nAMZimletNavToolBar.prototype._getButtons=function(e){\nvar t=[];\nt.push(ZmOperation.PAGE_BACK);\nif(e){\nt.push(ZmOperation.TEXT)\n}\nt.push(ZmOperation.PAGE_FORWARD);\nreturn t\n};\nAMZimletNavToolBar.prototype.createOp=function(t,e){\ne.textClassName=\"ZWidgetTitle AMZimletNavToolBarTitle\";\nreturn ZmButtonToolBar.prototype.createOp.apply(this,arguments)\n};\nAMZimletNavToolBar.prototype.setText=function(e){\nif(!this._textButton){\nreturn\n}\nthis._textButton.setText(e)\n};\nfunction com_zimbra_holidaycalendars_HandlerObject(){}\ncom_zimbra_holidaycalendars_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_holidaycalendars_HandlerObject.prototype.constructor=com_zimbra_holidaycalendars_HandlerObject;\nvar HolidayCalendarsZimlet=com_zimbra_holidaycalendars_HandlerObject;\nHolidayCalendarsZimlet.VIEW=\"appointment\";\nHolidayCalendarsZimlet.prototype.init=function(){};\nHolidayCalendarsZimlet.prototype._loadFeeds=function(){\nthis.feeds=[];\nthis.feeds[\"http://www.mozilla.org/projects/calendar/caldata/FrenchHolidays.ics\"]={\ni:\"ImgDayView\",t:this.getMessage(\"HolidayCalendarsZimlet_jours_feries\")};\nthis.feeds[\"webcal://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A.ics\"]={\ni:\"ImgCalListView\",t:this.getMessage(\"HolidayCalendarsZimlet_vacs_za\")};\nthis.feeds[\"webcal://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-B.ics\"]={\ni:\"ImgCalListView\",t:this.getMessage(\"HolidayCalendarsZimlet_vacs_zb\")};\nthis.feeds[\"webcal://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-C.ics\"]={\ni:\"ImgCalListView\",t:this.getMessage(\"HolidayCalendarsZimlet_vacs_zc\")};\nthis.feeds[\"webcal://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A-B-C-Corse.ics\"]={\ni:\"ImgCalListView\",t:this.getMessage(\"HolidayCalendarsZimlet_vacs_zabc\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Australian32Holidays.ics\"]={\ni:\"ImgFlagAU\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_australian\")};\nthis.feeds[\"webcal://ical.mac.com/ical/China32Lunar32Simplified32Holidays.ics\"]={\ni:\"ImgFlagCN\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_chineseSimplified\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Brazil32Holidays.ics\"]={\ni:\"ImgFlagBR\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_brazil\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Danish32Holidays.ics\"]={\ni:\"ImgFlagDK\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_danish\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Dutch32Holidays.ics\"]={\ni:\"ImgFlagNL\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_dutch\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Irish32Holidays.ics\"]={\ni:\"ImgFlagIE\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_irish\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Finnish32Holidays.ics\"]={\ni:\"ImgFlagFI\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_finnish\")};\nthis.feeds[\"webcal://ical.mac.com/ical/German32Holidays.ics\"]={\ni:\"ImgFlagDE\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_german\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Hong32Kong32Holidays.ics\"]={\ni:\"ImgFlagHK\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_hongKong\")};\nthis.feeds[\"webcal://ical.mac.com/ical/India32Holidays.ics\"]={\ni:\"ImgFlagIN\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_india\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Italian32Holidays.ics\"]={\ni:\"ImgFlagIT\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_italian\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Japanese32Holidays.ics\"]={\ni:\"ImgFlagJP\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_japanese\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Mexican32Holidays.ics\"]={\ni:\"ImgFlagMX\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_mexican\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Norwegian32Holidays.ics\"]={\ni:\"ImgFlagNO\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_norwegian\")};\nthis.feeds[\"webcal://ical.mac.com/ical/New32Zealand32Holidays.ics\"]={\ni:\"ImgFlagNZ\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_newZealand\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Portuguese32Holidays.ics\"]={\ni:\"ImgFlagPT\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_portuguese\")};\nthis.feeds[\"webcal://ical.mac.com/ical/South32Africa32Holidays.ics\"]={\ni:\"ImgFlagZA\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_southAfrican\")};\nthis.feeds[\"webcal://ical.mac.com/ical/South32Korean32Holidays.ics\"]={\ni:\"ImgFlagKR\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_southKorean\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Swedish32Holidays.ics\"]={\ni:\"ImgFlagSE\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_swedish\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Spain32Holidays.ics\"]={\ni:\"ImgFlagES\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_spain\")};\nthis.feeds[\"webcal://ical.mac.com/ical/Taiwan32Holidays.ics\"]={\ni:\"ImgFlagTW\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_taiwan\")};\nthis.feeds[\"webcal://ical.mac.com/ical/UK32Holidays.ics\"]={\ni:\"ImgFlagGB\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_uk\")};\nthis.feeds[\"webcal://ical.mac.com/ical/US32Holidays.ics\"]={\ni:\"ImgFlagUS\",t:this.getMessage(\"HolidayCalendarsZimlet_holidays_us\")}\n};\nHolidayCalendarsZimlet.prototype.doubleClicked=function(){\nthis.singleClicked()\n};\nHolidayCalendarsZimlet.prototype.singleClicked=function(){\nthis._initializeDlg()\n};\nHolidayCalendarsZimlet.prototype._createFolder=function(r){\nvar h={\nCreateFolderRequest:{\n_jsns:\"urn:zimbraMail\"}};\nvar n=h.CreateFolderRequest.folder={};\nfor(var o in r){\nif(o==\"callback\"||o==\"errorCallback\"||o==\"postCallback\"){\ncontinue\n}\nvar s=r[o];\nif(s){\nn[o]=s\n}}\nvar t=new AjxCallback(this,this._createFldrCallback,r);\nvar e=new AjxCallback(this,this._createFldrErrCallback,r);\nreturn appCtxt.getAppController().sendRequest({\njsonObj:h,asyncMode:true,errorCallback:e,callback:t}\n)\n};\nHolidayCalendarsZimlet.prototype._createFldrCallback=function(n,t){\nvar o=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];\nvar e=AjxMessageFormat.format(this.getMessage(\"HolidayCalendarsZimlet_successSubscribing\"),n.name);\nappCtxt.getAppController().setStatusMsg(e,ZmStatusView.LEVEL_INFO,null,o)\n};\nHolidayCalendarsZimlet.prototype._createFldrErrCallback=function(s,e){\nif(!s.url&&!s.name){\nreturn false\n}\nvar n;\nif(s.name&&(e.code==ZmCsfeException.MAIL_ALREADY_EXISTS)){\nn=AjxMessageFormat.format(ZmMsg.errorAlreadyExists,[s.name])\n}else{\nif(s.url){\nvar t=(e.code==ZmCsfeException.SVC_RESOURCE_UNREACHABLE)?ZmMsg.feedUnreachable:ZmMsg.feedInvalid;\nn=AjxMessageFormat.format(t,s.url)\n}}\nvar o=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];\nappCtxt.getAppController().setStatusMsg(this.getMessage(\"HolidayCalendarsZimlet_errorSubscribing\"),ZmStatusView.LEVEL_WARNING,null,o);\nif(n){\nthis._showErrorMsg(n);\nreturn true\n}\nreturn false\n};\nHolidayCalendarsZimlet.prototype._showErrorMsg=function(t){\nvar e=appCtxt.getMsgDialog();\ne.reset();\ne.setMessage(t,DwtMessageDialog.CRITICAL_STYLE);\ne.popup()\n};\nHolidayCalendarsZimlet.prototype._initializeDlg=function(){\nif(this.rssFeedDialog){\nthis.rssFeedDialog.popup();\nreturn\n}\nthis._loadFeeds();\nthis._parentView=new DwtComposite(this.getShell());\nthis._parentView.setSize(\"550\",\"300\");\nthis._parentView.getHtmlElement().style.overflow=\"auto\";\nthis._parentView.getHtmlElement().innerHTML=this._constructView();\nvar e={\ntitle:this.getMessage(\"HolidayCalendarsZimlet_dialog_title\"),view:this._parentView,parent:this.getShell(),standardButtons:[DwtDialog.OK_BUTTON]};\nthis.rssFeedDialog=new ZmDialog(e);\nthis._addBtnListeners();\nthis.rssFeedDialog.popup()\n};\nHolidayCalendarsZimlet.prototype._constructView=function(){\nvar n=new Array();\nvar o=0;\nvar e=0;\nthis._btnidAndUrl=[];\nfor(var s in this.feeds){\nvar t=this.feeds[s].i;\nvar r=this.feeds[s].t;\nvar h=\"hcals_btn\"+e;\nthis._btnidAndUrl[h]={\nurl:s,foldername:r};\nn[o++]=\"<div class='hcals_sectionDiv'>\";\nn[o++]=\"<TABLE  cellpadding=5>\";\nn[o++]=\"<TR>\";\nn[o++]=\"<TD width=5%><DIV class='\"+t+\"'></DIV></TD>\";\nn[o++]=\"<TD width=80%>\";\nn[o++]=\"<B>\";\nn[o++]=r;\nn[o++]=\"</B>\";\nn[o++]=\"<BR>\";\nn[o++]=s;\nn[o++]=\"</TD>\";\nn[o++]=\"<TD width=10%><button id='hcals_btn\"+e+'\\' type=\"button\">';\nn[o++]=this.getMessage(\"HolidayCalendarsZimlet_dialog_subscribeButton\");\nn[o++]=\"</button></TD>\";\nn[o++]=\"</TR>\";\nn[o++]=\"</TABLE>\";\nn[o++]=\"</div>\";\ne=e+1\n}\nreturn n.join(\"\")\n};\nHolidayCalendarsZimlet.prototype._addBtnListeners=function(){\nfor(var e in this._btnidAndUrl){\ndocument.getElementById(e).onclick=AjxCallback.simpleClosure(this._onSubscribeClick,this,this._btnidAndUrl[e])\n}};\nHolidayCalendarsZimlet.prototype._onSubscribeClick=function(r){\nvar e=r.foldername;\nvar n=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.PAUSE,ZmToast.PAUSE,ZmToast.PAUSE,ZmToast.FADE_OUT];\nvar o=AjxMessageFormat.format(this.getMessage(\"HolidayCalendarsZimlet_createFolderMsg\"),e);\nappCtxt.getAppController().setStatusMsg(o,ZmStatusView.LEVEL_INFO,null,n);\nvar t=\"1\";\nvar s=Math.floor(Math.random()*9);\nvar r={\ncolor:null,name:e,url:r.url,view:HolidayCalendarsZimlet.VIEW,l:t,color:s};\nthis._createFolder(r)\n};\nfunction com_zimbra_stickyNotes_HandlerObject(){}\ncom_zimbra_stickyNotes_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_stickyNotes_HandlerObject.prototype.constructor=com_zimbra_stickyNotes_HandlerObject;\nvar StickyNotesZimlet=com_zimbra_stickyNotes_HandlerObject;\nStickyNotesZimlet.stickyNotes=\"STICKYNOTES\";\nStickyNotesZimlet.prototype.init=function(){\nthis._tagName=this.getMessage(\"sn_EmailsWithStickyNotes\");\nthis._createTagAndStoreId();\nthis._migrateOldData()\n};\nStickyNotesZimlet.prototype.onShowView=function(o,s){\nif(o==\"CNS\"||o==\"CAL\"||o==\"CNS-main\"){\nvar n=appCtxt.getCurrentController();\ntry{\nif(o==\"CAL\"){\nfor(var t in n._listView){\nn._listView[t].addSelectionListener(new AjxListener(this,this._onContactOrApptView,[n]))\n}}else{\nn._listView[o].addSelectionListener(new AjxListener(this,this._onContactOrApptView,[n]))\n}}\ncatch(r){}}};\nStickyNotesZimlet.prototype._createTagAndStoreId=function(){\nvar e=appCtxt.getActiveAccount().trees.TAG.getByName(this._tagName);\nif(!e){\nthis._createTag({\nname:this._tagName,color:ZmOrganizer.C_YELLOW,callback:new AjxCallback(this,this._handleTagCreation)}\n)\n}else{\nthis._tagId=e.nId\n}};\nStickyNotesZimlet.prototype._createTag=function(n){\nvar t=AjxSoapDoc.create(\"CreateTagRequest\",\"urn:zimbraMail\");\nvar o=t.set(\"tag\");\no.setAttribute(\"name\",n.name);\nvar e=ZmOrganizer.checkColor(n.color);\nif(e&&(e!=ZmOrganizer.DEFAULT_COLOR[ZmOrganizer.TAG])){\no.setAttribute(\"color\",e)\n}\nappCtxt.getAppController().sendRequest({\nsoapDoc:t,asyncMode:true,callback:n.callback}\n)\n};\nStickyNotesZimlet.prototype._handleTagCreation=function(t){\ntry{\nthis._tagId=t.getResponse().CreateTagResponse.tag[0].id\n}\ncatch(o){}};\nStickyNotesZimlet.prototype._showStickyNotes=function(e,t){\nif(!t||!t.notes){\nt=\"\"\n}else{\nt=t.notes\n}\nif(t==\"\"&&!e){\nreturn\n}\nthis._createNewStickyNotes=e;\nthis._stickyNotesView(t)\n};\nStickyNotesZimlet.prototype._saveAndHideStickyNotes=function(){\nif(!this._mainContainer){\nreturn\n}\nvar e=this._getStickyContent();\nif(!this._createNewStickyNotes||(this._createNewStickyNotes&&e!=\"\")){\nthis._saveStickyNotesDataToServer(this._itemId,e)\n}\nif(this._createNewStickyNotes&&e!=\"\"){\nthis._tagAction(true)\n}\nthis._hideStickyNotes()\n};\nStickyNotesZimlet.prototype._getStickyNotesMetaData=function(e,t){\nthis._currentMetaData=new ZmMetaData(appCtxt.getActiveAccount(),e);\nthis._currentMetaData.get(\"stikyNotesZimletMetaData\",null,new AjxCallback(this,this._handleGetStickyNotesMetaData,t))\n};\nStickyNotesZimlet.prototype._handleGetStickyNotesMetaData=function(n,e){\nthis._stikyNotesMetaData=\"\";\ntry{\nvar t=e.getResponse().BatchResponse.GetCustomMetadataResponse[0];\nif(t.meta&&t.meta[0]){\nthis._stikyNotesMetaData=t.meta[0]._attrs\n}\nif(n){\nn.run(this._stikyNotesMetaData)\n}else{\nreturn this._stikyNotesMetaData\n}}\ncatch(o){\nconsole.log(\"StickyNotesZimlet.prototype._handleGetStickyNotesMetaData\"+o);\nreturn\n}};\nStickyNotesZimlet.prototype._saveStickyNotesDataToServer=function(o,t){\nthis._currentMetaData=new ZmMetaData(appCtxt.getActiveAccount(),o);\nvar e=[];\ne.notes=t;\nthis._currentMetaData.set(\"stikyNotesZimletMetaData\",e,null,null)\n};\nStickyNotesZimlet.prototype._saveContentCallback=function(){\nvar e=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.PAUSE,ZmToast.FADE_OUT];\nappCtxt.getAppController().setStatusMsg(this.getMessage(\"sn_notesSaved\"),ZmStatusView.LEVEL_INFO,null,e)\n};\nStickyNotesZimlet.prototype._tagAction=function(e){\nif(!appCtxt.getAccountTagList().getByName(this._tagName)){\nreturn\n}\nthis.srcMsgObj.list.tagItems({\nitems:this.srcMsgObj,tagName:this._tagName,doTag:e}\n)\n};\nStickyNotesZimlet.prototype._deleteSaveAndHideStickyNotes=function(){\nif(!this._mainContainer){\nreturn\n}\nthis._saveStickyNotesDataToServer(this._itemId,\"\");\nthis._hideStickyNotes();\nif(this.srcMsgObj.hasTag(this._tagName)){\nthis._tagAction(false)\n}};\nStickyNotesZimlet.prototype._hideStickyNotes=function(){\nthis._mainContainer.style.display=\"none\";\nthis.stickyNotesDisplayed=false\n};\nStickyNotesZimlet.prototype._stickyNotesView=function(o){\nif(this._mainContainer){\nthis._mainContainer.style.display=\"block\";\nthis._setStickyContent(o);\nif(o==\"\"){\nthis._focusStickyNotes()\n}\nthis.stickyNotesDisplayed=true;\nreturn\n}\nthis._mainContainer=document.getElementById(\"z_shell\").appendChild(document.createElement(\"div\"));\nthis._mainContainer.style.left=\"100px\";\nthis._mainContainer.style.top=\"200px\";\nthis._mainContainer.style.position=\"absolute\";\nthis._mainContainer.style.display=\"block\";\nthis._mainContainer.style.zIndex=9000;\nvar t=new Array();\nvar e=0;\nt.push(\"<DIV id ='stickyn_actionContainerID' class='stickyn_axnClass'>\",\"<img  style='cursor:pointer;' src=\\\"\",this.getResource(\"sticky_deleteBtn.png\"),\"\\\" id='stickyn_deleteBtn' />&nbsp;\",\"<img  style='cursor:pointer;' src=\\\"\",this.getResource(\"sticky_saveBtn.png\"),\"\\\" id='stickyn_closeBtn'/></DIV>\",\"<TEXTAREA  id ='stickyn_textAreaID'class='stickyn_textAreaClass'>\",\"</TEXTAREA>\");\nthis._mainContainer.innerHTML=t.join(\"\");\nthis._addListeners();\nif(o){\nthis._setStickyContent(o)\n}\nthis.stickyNotesDisplayed=true\n};\nStickyNotesZimlet.prototype._setStickyContent=function(e){\ndocument.getElementById(\"stickyn_textAreaID\").value=e\n};\nStickyNotesZimlet.prototype._focusStickyNotes=function(){\ndocument.getElementById(\"stickyn_textAreaID\").focus()\n};\nStickyNotesZimlet.prototype._getStickyContent=function(){\nreturn document.getElementById(\"stickyn_textAreaID\").value\n};\nStickyNotesZimlet.prototype._addListeners=function(){\ndocument.getElementById(\"stickyn_closeBtn\").onclick=AjxCallback.simpleClosure(this._saveAndHideStickyNotes,this);\ndocument.getElementById(\"stickyn_deleteBtn\").onclick=AjxCallback.simpleClosure(this._deleteSaveAndHideStickyNotes,this)\n};\nStickyNotesZimlet.prototype.initializeToolbar=function(r,s,o,t){\nt=appCtxt.getViewTypeFromId(t);\nif(t==ZmId.VIEW_CONVLIST||t==ZmId.VIEW_CONV||t==ZmId.VIEW_TRAD||t==\"CNS\"||t==\"CLD\"){\nZmMsg.stickyNotesLabel=this.getMessage(\"sn_label\");\nZmMsg.stickyNotesTip=this.getMessage(\"sn_tooltip\");\nvar e={\ntext:ZmMsg.stickyNotesLabel,tooltip:ZmMsg.stickyNotesTip,image:\"stickynotes-panelIcon\",showImageInToolbar:true,showTextInToolbar:false};\nif(!s.getOp(StickyNotesZimlet.stickyNotes)){\nvar n=s.createZimletOp(StickyNotesZimlet.stickyNotes,e);\nn.addSelectionListener(new AjxListener(this,this._stickyTBListener,[o]))\n}}};\nStickyNotesZimlet.prototype._stickyTBListener=function(e){\ntry{\nvar o=e.getCurrentView().getSelection()\n}\ncatch(t){\ntry{\nvar o=e.getCurrentView().getListView().getSelection()\n}\ncatch(t){}}\nif(o.length>0){\nif(o[0].isDL!==true){\nthis.srcMsgObj=o[0];\nif(this.srcMsgObj.type==\"CONV\"){\nthis.srcMsgObj=this.srcMsgObj.getFirstHotMsg()\n}\nthis._createStickyNotes(this.srcMsgObj)\n}}};\nStickyNotesZimlet.prototype._createStickyNotes=function(e){\nif(e.type==\"CONV\"){\nthis._itemId=e.cid\n}else{\nif(e.type==\"MSG\"||e.type==\"CONTACT\"||e.type==\"APPT\"){\nthis._itemId=e.id\n}else{\nreturn\n}}\nthis._showStickyNotes(true,\"\")\n};\nStickyNotesZimlet.prototype.onMsgView=function(e){\nif(this.stickyNotesDisplayed){\nthis._hideStickyNotes()\n}\nthis.srcMsgObj=e;\nif(this.srcMsgObj.tags.length==0){\nreturn\n}\nif(e.type==\"CONV\"){\nthis._itemId=e.cid\n}else{\nif(e.type==\"MSG\"){\nthis._itemId=e.id\n}}\nthis._handleItemSelect()\n};\nStickyNotesZimlet.prototype._onContactOrApptView=function(e){\ntry{\nvar o=e.getCurrentView().getSelection()\n}\ncatch(t){\nvar o=e.getCurrentView().getListView().getSelection()\n}\nif(o.length>0){\nthis.srcMsgObj=o[0];\nthis._itemId=this.srcMsgObj.id\n}\nthis._handleItemSelect()\n};\nStickyNotesZimlet.prototype._handleItemSelect=function(){\nthis._getStickyNotesMetaData(this._itemId,new AjxCallback(this,this._showStickyNotes,false))\n};\nStickyNotesZimlet.prototype._showErrorMessage=function(o){\nvar t=\"\";\nif(o instanceof AjxException){\nt=o.msg\n}else{\nt=o\n}\nvar e=appCtxt.getMsgDialog();\ne.reset();\ne.setMessage(t,DwtMessageDialog.WARNING_STYLE);\ne.popup()\n};\nStickyNotesZimlet.prototype._migrateOldData=function(){\nvar t=this.getUserProperty(\"stickyNotes_data\");\nif(t==\"\"){\nreturn\n}\nvar n=t.split(\":=:\");\nthis._msgIdAndDataArry=[];\nfor(var e=0;\ne<n.length;\ne++){\nif(n[e]==\"\"){\ncontinue\n}\nvar r=n[e].split(\",__data::\");\nvar s=r[0].replace(\"__id::\",\"\").replace(\"MSG\",\"\").replace(\"CONV\",\"\");\nvar o=r[1];\nthis._saveStickyNotesDataToServer(s,o)\n}\nthis.setUserProperty(\"stickyNotes_data\",\"\",true)\n};\nfunction Com_Zimbra_YMEmoticons(){\nthis.re=Com_Zimbra_YMEmoticons.REGEXP;\nthis.reCaseSensitive=Com_Zimbra_YMEmoticons.REGEXP_CASE_SENSITIVE;\nthis.hash=Com_Zimbra_YMEmoticons.SMILEYS;\nthis._isEnabled=true\n}\nCom_Zimbra_YMEmoticons.prototype=new ZmZimletBase;\nCom_Zimbra_YMEmoticons.prototype.constructor=Com_Zimbra_YMEmoticons;\nCom_Zimbra_YMEmoticons.prototype.init=function(){\nvar t;\nfor(var e in this.hash){\nt=this.hash[e];\nt.alt=this.getMessage(t.alt)\n}};\nCom_Zimbra_YMEmoticons.prototype.createComposeButton=function(t){\nvar o=t.parent;\nvar e=new YMEmoticonsPickerButton({\nparent:t,className:\"ZToolbarButton\"}\n,true);\ne.dontStealFocus();\ne.setToolTipContent(ZmMsg.emoticons);\ne.setEmoticon(\":)\");\ne.addSelectionListener(new AjxListener(this,this._composeToolbarSmileyListener,[o]))\n};\nCom_Zimbra_YMEmoticons.prototype.on_htmlEditor_createToolbar2=function(t,e){\nthis.createComposeButton(e)\n};\nCom_Zimbra_YMEmoticons.prototype.onFindMsgObjects=function(t,e){\nif(!this.enableInMail){\nthis.enableInMail=Boolean(this.getUserProperty(\"yemoticons_enableInMail\"))\n}\nif(t&&t.folderId==ZmOrganizer.ID_CHATS){\ne.addHandler(this);\ne.sortHandlers();\ne.__hasSmileysHandler=true\n}else{\nif(!e.__hasSmileysHandler&&this._isEnabled&&this.enableInMail){\ne.addHandler(this);\ne.sortHandlers();\ne.__hasSmileysHandler=true\n}\nif(e.__hasSmileysHandler&&(!this._isEnabled||!this.enableInMail)){\ne.removeHandler(this);\ne.sortHandlers();\ne.__hasSmileysHandler=false\n}}};\nCom_Zimbra_YMEmoticons.prototype.match=function(t,n){\nthis.re.lastIndex=this.reCaseSensitive.lastIndex=n;\nvar e=this.re.exec(t)||this.reCaseSensitive.exec(t);\nif(e){\ne.context=this.hash[e[1].toLowerCase()];\nvar o=new Image();\no.src=e.context.src;\ne.context.img=o\n}\nreturn e\n};\nCom_Zimbra_YMEmoticons.prototype.generateSpan=function(o,e,r,s,t){\nvar n=t.height/2;\nif(AjxEnv.isIE){\nn=\"0px\"\n}\no[e++]=[\"<span style='height:\",t.height,\";width:\",t.width,\";padding:\",n,\"px \",t.width,\"px \",n,\"px 0; background:url(\",t.img.src,\") no-repeat 0 50%;'\",' title=\"',AjxStringUtil.xmlAttrEncode(t.text),\" - \",AjxStringUtil.xmlAttrEncode(t.alt),'\"','><span style=\"visibility:hidden\">a</span></span>'].join(\"\");\nreturn e\n};\nCom_Zimbra_YMEmoticons.prototype._smileyListener=function(t,e){\nthis._composeToolbarSmileyListener(t.getEditor(),e)\n};\nCom_Zimbra_YMEmoticons.prototype._composeToolbarSmileyListener=function(e,o){\nif(!e){\nreturn\n}\nvar t=o.item.getSelectedSmiley();\nif(t){\ne.insertText(t.text);\ne.focus()\n}};\nCom_Zimbra_YMEmoticons.prototype.menuItemSelected=function(e){\nswitch(e){\ncase\"YE_TEMP_DISABLE\":this.temporarilyDisable();\nbreak;\ncase\"YE_PREFERENCES\":this._showPreferenceDlg();\nbreak\n}};\nCom_Zimbra_YMEmoticons.prototype.doubleClicked=function(){\nthis.singleClicked()\n};\nCom_Zimbra_YMEmoticons.prototype.singleClicked=function(){\nthis._showPreferenceDlg()\n};\nCom_Zimbra_YMEmoticons.prototype.temporarilyDisable=function(){\nthis._isEnabled=false;\nvar e=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];\nappCtxt.getAppController().setStatusMsg(this.getMessage(\"yahoo_emoticons_toaster_temporarily_disabled\"),ZmStatusView.LEVEL_INFO,null,e)\n};\nCom_Zimbra_YMEmoticons.prototype._showPreferenceDlg=function(){\nif(this._preferenceDialog){\nthis._preferenceDialog.popup();\nreturn\n}\nthis._preferenceView=new DwtComposite(this.getShell());\nthis._preferenceView.getHtmlElement().style.overflow=\"auto\";\nthis._preferenceView.getHtmlElement().innerHTML=this._createPrefView();\nthis._preferenceDialog=this._createDialog({\ntitle:this.getMessage(\"yahoo_emoticons_pref_dialog_title\"),view:this._preferenceView,standardButtons:[DwtDialog.OK_BUTTON],id:\"YahooEmoticonsPrefs\"}\n);\nthis._preferenceDialog.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._okPreferenceBtnListener));\nif(!this.enableInMail){\nthis.enableInMail=Boolean(this.getUserProperty(\"yemoticons_enableInMail\"))\n}\ndocument.getElementById(\"yemoticons_enableInMail_div\").checked=this.enableInMail;\nthis._preferenceDialog.popup()\n};\nCom_Zimbra_YMEmoticons.prototype._createPrefView=function(){\nreturn[\"<div class='ymemoticonsPrefDialog'>\",\"<input id='yemoticons_enableInMail_div' type='checkbox'/>\",this.getMessage(\"enableInMail\"),\"</div>\"].join(\"\")\n};\nCom_Zimbra_YMEmoticons.prototype._okPreferenceBtnListener=function(){\nthis._preferenceDialog.popdown();\nvar t=document.getElementById(\"yemoticons_enableInMail_div\").checked;\nif(t!=this.enableInMail){\nthis.setUserProperty(\"yemoticons_enableInMail\",t,true);\nthis.enableInMail=t;\nvar e=t?this.getMessage(\"yahoo_emoticons_toaster_enabled\"):this.getMessage(\"yahoo_emoticons_toaster_disabled\");\nvar o=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];\nappCtxt.getAppController().setStatusMsg(e,ZmStatusView.LEVEL_INFO,null,o)\n}};\nCom_Zimbra_YMEmoticons.REGEXP=/(>:D<|#:-S|O:-\\)|<:-P|:-SS|<\\):\\)|:-\\?\\?|3:-O|:\\(\\|\\)|@};-|\\*\\*==|\\(~~\\)|\\*-:\\)|\\[-O<|:\\)>-|\\\\:D\\x2f|\\^:\\)\\^|;;\\)|:-\\x2f|:\\x22>|:-\\*|=\\(\\(|:-O|B-\\)|:-S|>:\\)|:\\(\\(|:\\)\\)|\\x2f:\\)|=\\)\\)|:-B|:-c|:\\)\\]|~X\\(|:-h|:-t|8->|I-\\)|8-\\||L-\\)|:-&|:-\\$|\\[-\\(|:O\\)|8-}|\\(:\\||=P~|:-\\?|#-o|=D>|@-\\)|:\\^o|:-w|:-<|>:P|:o3|%-\\(|:@\\)|~:>|%%-|~O\\)|8-X|=:\\)|>-\\)|:-L|\\$-\\)|:-\\x22|b-\\(|\\[-X|>:\\x2f|;\\)\\)|:-@|:-j|\\(\\*\\)|o->|o=>|o-\\+|\\(%\\)|:\\)|:\\(|;\\)|X\\(|:>|:\\||=;)/ig;\nCom_Zimbra_YMEmoticons.REGEXP_CASE_SENSITIVE=/(:D|:X|:P)/g;\nCom_Zimbra_YMEmoticons.SMILEYS={\n\":)\":{\nwidth:18,alt:\"emoticon_happy\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/1.gif\",text:\":)\",regexp:\":\\\\)\",height:18}\n,\":(\":{\nwidth:18,alt:\"emoticon_sad\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/2.gif\",text:\":(\",regexp:\":\\\\(\",height:18}\n,\"(~~)\":{\nwidth:17,alt:\"emoticon_pumpkin\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/56.gif\",text:\"(~~)\",regexp:\"\\\\(~~\\\\)\",height:18}\n,\"~o)\":{\nwidth:18,alt:\"emoticon_coffee\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/57.gif\",text:\"~O)\",regexp:\"~O\\\\)\",height:18}\n,':\">':{\nwidth:18,alt:\"emoticon_blushing\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/9.gif\",text:':\">',regexp:\":\\\\x22>\",height:18}\n,\"[-(\":{\nwidth:18,alt:\"emoticon_not_talking\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/33.gif\",text:\"[-(\",regexp:\"\\\\[-\\\\(\",height:18}\n,\">:d<\":{\nwidth:42,alt:\"emoticon_big_hug\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/6.gif\",text:\">:D<\",regexp:\">:D<\",height:18}\n,\"#-o\":{\nwidth:24,alt:\"emoticon_d_oh\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/40.gif\",text:\"#-o\",regexp:\"#-o\",height:18}\n,\"[-x\":{\nwidth:22,alt:\"emoticon_shame_on_you\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/68.gif\",text:\"[-X\",regexp:\"\\\\[-X\",height:18}\n,\":-t\":{\nwidth:30,alt:\"emoticon_time_out\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/104.gif\",text:\":-t\",regexp:\":-t\",height:18}\n,\":(|)\":{\nwidth:21,alt:\"emoticon_monkey\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/51.gif\",text:\":(|)\",regexp:\":\\\\(\\\\|\\\\)\",height:18}\n,\":o)\":{\nwidth:28,alt:\"emoticon_clown\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/34.gif\",text:\":O)\",regexp:\":O\\\\)\",height:18}\n,\"i-)\":{\nwidth:21,alt:\"emoticon_sleepy\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/28.gif\",text:\"I-)\",regexp:\"I-\\\\)\",height:18}\n,\";;)\":{\nwidth:18,alt:\"emoticon_batting_eyelashes\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/5.gif\",text:\";;)\",regexp:\";;\\\\)\",height:18}\n,\":^o\":{\nwidth:18,alt:\"emoticon_liar\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/44.gif\",text:\":^o\",regexp:\":\\\\^o\",height:18}\n,\"<:-p\":{\nwidth:38,alt:\"emoticon_party\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/36.gif\",text:\"<:-P\",regexp:\"<:-P\",height:18}\n,\"x(\":{\nwidth:34,alt:\"emoticon_angry\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/14.gif\",text:\"X(\",regexp:\"X\\\\(\",height:18}\n,\":-/\":{\nwidth:20,alt:\"emoticon_confused\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/7.gif\",text:\":-/\",regexp:\":-\\\\x2f\",height:18}\n,\"#:-s\":{\nwidth:34,alt:\"emoticon_whew\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/18.gif\",text:\"#:-S\",regexp:\"#:-S\",height:18}\n,\"8->\":{\nwidth:23,alt:\"emoticon_daydreaming\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/105.gif\",text:\"8->\",regexp:\"8->\",height:18}\n,\":d\":{\nwidth:18,alt:\"emoticon_big_grin\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/4.gif\",text:\":D\",regexp:\":D\",height:18}\n,\"\\\\:d/\":{\nwidth:26,alt:\"emoticon_dancing\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/69.gif\",text:\"\\\\:D/\",regexp:\"\\\\\\\\:D\\\\x2f\",height:18}\n,\":-b\":{\nwidth:24,alt:\"emoticon_nerd\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/26.gif\",text:\":-B\",regexp:\":-B\",height:18}\n,\":-@\":{\nwidth:36,alt:\"emoticon_chatterbox\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/76.gif\",text:\":-@\",regexp:\":-@\",height:18}\n,\":-h\":{\nwidth:28,alt:\"emoticon_wave\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/103.gif\",text:\":-h\",regexp:\":-h\",height:18}\n,\":-c\":{\nwidth:28,alt:\"emoticon_call_me\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/101.gif\",text:\":-c\",regexp:\":-c\",height:18}\n,\"=p~\":{\nwidth:18,alt:\"emoticon_drooling\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/38.gif\",text:\"=P~\",regexp:\"=P~\",height:18}\n,\"(:|\":{\nwidth:18,alt:\"emoticon_yawn\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/37.gif\",text:\"(:|\",regexp:\"\\\\(:\\\\|\",height:18}\n,\":-o\":{\nwidth:18,alt:\"emoticon_surprise\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/13.gif\",text:\":-O\",regexp:\":-O\",height:18}\n,\"o->\":{\nwidth:18,alt:\"emoticon_hiro\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/72.gif\",text:\"o->\",regexp:\"o->\",height:18}\n,\":))\":{\nwidth:18,alt:\"emoticon_laughing\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/21.gif\",text:\":))\",regexp:\":\\\\)\\\\)\",height:18}\n,\"/:)\":{\nwidth:18,alt:\"emoticon_raised_eyebrow\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/23.gif\",text:\"/:)\",regexp:\"\\\\x2f:\\\\)\",height:18}\n,\"*-:)\":{\nwidth:30,alt:\"emoticon_idea\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/58.gif\",text:\"*-:)\",regexp:\"\\\\*-:\\\\)\",height:18}\n,\":)]\":{\nwidth:31,alt:\"emoticon_on_the_phone\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/100.gif\",text:\":)]\",regexp:\":\\\\)\\\\]\",height:18}\n,\":-ss\":{\nwidth:36,alt:\"emoticon_nailbiting\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/42.gif\",text:\":-SS\",regexp:\":-SS\",height:18}\n,\"(%)\":{\nwidth:18,alt:\"emoticon_yin_yang\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/75.gif\",text:\"(%)\",regexp:\"\\\\(%\\\\)\",height:18}\n,\":-*\":{\nwidth:18,alt:\"emoticon_kiss\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/11.gif\",text:\":-*\",regexp:\":-\\\\*\",height:18}\n,\"~x(\":{\nwidth:44,alt:\"emoticon_at_wits_end\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/102.gif\",text:\"~X(\",regexp:\"~X\\\\(\",height:18}\n,\"o=>\":{\nwidth:18,alt:\"emoticon_billy\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/73.gif\",text:\"o=>\",regexp:\"o=>\",height:18}\n,\":-??\":{\nwidth:40,alt:\"emoticon_I_dont_know\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/106.gif\",text:\":-??\",regexp:\":-\\\\?\\\\?\",height:18}\n,\"@-)\":{\nwidth:18,alt:\"emoticon_hypnotized\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/43.gif\",text:\"@-)\",regexp:\"@-\\\\)\",height:18}\n,\"3:-o\":{\nwidth:18,alt:\"emoticon_cow\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/50.gif\",text:\"3:-O\",regexp:\"3:-O\",height:18}\n,\"=d>\":{\nwidth:18,alt:\"emoticon_applause\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/41.gif\",text:\"=D>\",regexp:\"=D>\",height:18}\n,\":-w\":{\nwidth:23,alt:\"emoticon_waiting\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/45.gif\",text:\":-w\",regexp:\":-w\",height:18}\n,\":x\":{\nwidth:18,alt:\"emoticon_love_struck\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/8.gif\",text:\":x\",regexp:\":x\",height:18}\n,\":-$\":{\nwidth:18,alt:\"emoticon_dont_tell_anyone\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/32.gif\",text:\":-$\",regexp:\":-\\\\$\",height:18}\n,\"~:>\":{\nwidth:18,alt:\"emoticon_chicken\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/52.gif\",text:\"~:>\",regexp:\"~:>\",height:18}\n,\"=:)\":{\nwidth:20,alt:\"emoticon_bug\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/60.gif\",text:\"=:)\",regexp:\"=:\\\\)\",height:18}\n,\"(*)\":{\nwidth:18,alt:\"emoticon_star\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/79.gif\",text:\"(*)\",regexp:\"\\\\(\\\\*\\\\)\",height:18}\n,\":|\":{\nwidth:18,alt:\"emoticon_straight_face\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/22.gif\",text:\":|\",regexp:\":\\\\|\",height:18}\n,\":((\":{\nwidth:22,alt:\"emoticon_crying\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/20.gif\",text:\":((\",regexp:\":\\\\(\\\\(\",height:18}\n,\"8-x\":{\nwidth:18,alt:\"emoticon_skull\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/59.gif\",text:\"8-X\",regexp:\"8-X\",height:18}\n,\"o:-)\":{\nwidth:30,alt:\"emoticon_angel\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/25.gif\",text:\"O:-)\",regexp:\"O:-\\\\)\",height:18}\n,\">:p\":{\nwidth:18,alt:\"emoticon_phbbbbt\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/47.gif\",text:\">:P\",regexp:\">:P\",height:18}\n,\">-)\":{\nwidth:18,alt:\"emoticon_alien\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/61.gif\",text:\">-)\",regexp:\">-\\\\)\",height:18}\n,\"=((\":{\nwidth:18,alt:\"emoticon_broken_heart\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/12.gif\",text:\"=((\",regexp:\"=\\\\(\\\\(\",height:18}\n,\"l-)\":{\nwidth:24,alt:\"emoticon_loser\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/30.gif\",text:\"L-)\",regexp:\"L-\\\\)\",height:18}\n,\":@)\":{\nwidth:18,alt:\"emoticon_pig\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/49.gif\",text:\":@)\",regexp:\":@\\\\)\",height:18}\n,\">:/\":{\nwidth:23,alt:\"emoticon_bring_it_on\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/70.gif\",text:\">:/\",regexp:\">:\\\\x2f\",height:18}\n,\"b-(\":{\nwidth:18,alt:\"emoticon_feeling_beat_up\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/66.gif\",text:\"b-(\",regexp:\"b-\\\\(\",height:18}\n,\"$-)\":{\nwidth:18,alt:\"emoticon_money_eyes\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/64.gif\",text:\"$-)\",regexp:\"\\\\$-\\\\)\",height:18}\n,\":-?\":{\nwidth:18,alt:\"emoticon_thinking\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/39.gif\",text:\":-?\",regexp:\":-\\\\?\",height:18}\n,\":)>-\":{\nwidth:22,alt:\"emoticon_peace_sign\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/67.gif\",text:\":)>-\",regexp:\":\\\\)>-\",height:18}\n,\":-j\":{\nwidth:26,alt:\"emoticon_oh_go_on\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/78.gif\",text:\":-j\",regexp:\":-j\",height:18}\n,\"%%-\":{\nwidth:18,alt:\"emoticon_good_luck\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/54.gif\",text:\"%%-\",regexp:\"%%-\",height:18}\n,\"%-(\":{\nwidth:52,alt:\"emoticon_not_listening\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/107.gif\",text:\"%-(\",regexp:\"%-\\\\(\",height:18}\n,\":p\":{\nwidth:18,alt:\"emoticon_tongue\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/10.gif\",text:\":P\",regexp:\":P\",height:18}\n,\"^:)^\":{\nwidth:32,alt:\"emoticon_not_worthy\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/77.gif\",text:\"^:)^\",regexp:\"\\\\^:\\\\)\\\\^\",height:18}\n,':-\"':{\nwidth:22,alt:\"emoticon_whistling\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/65.gif\",text:':-\"',regexp:\":-\\\\x22\",height:18}\n,\":-<\":{\nwidth:24,alt:\"emoticon_sigh\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/46.gif\",text:\":-<\",regexp:\":-<\",height:18}\n,\":o3\":{\nwidth:31,alt:\"emoticon_puppy_dog_eyes\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/108.gif\",text:\":o3\",regexp:\":o3\",height:18}\n,\">:)\":{\nwidth:18,alt:\"emoticon_devil\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/19.gif\",text:\">:)\",regexp:\">:\\\\)\",height:18}\n,\"=;\":{\nwidth:18,alt:\"emoticon_talk_to_the_hand\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/27.gif\",text:\"=;\",regexp:\"=;\",height:18}\n,\"8-|\":{\nwidth:18,alt:\"emoticon_rolling_eyes\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/29.gif\",text:\"8-|\",regexp:\"8-\\\\|\",height:18}\n,\"**==\":{\nwidth:25,alt:\"emoticon_flag\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/55.gif\",text:\"**==\",regexp:\"\\\\*\\\\*==\",height:18}\n,\"o-+\":{\nwidth:18,alt:\"emoticon_april\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/74.gif\",text:\"o-+\",regexp:\"o-+\",height:18}\n,\"8-}\":{\nwidth:24,alt:\"emoticon_silly\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/35.gif\",text:\"8-}\",regexp:\"8-}\",height:18}\n,\"=))\":{\nwidth:30,alt:\"emoticon_rolling_on_the_floor\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/24.gif\",text:\"=))\",regexp:\"=\\\\)\\\\)\",height:18}\n,\":-l\":{\nwidth:18,alt:\"emoticon_frustrated\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/62.gif\",text:\":-L\",regexp:\":-L\",height:18}\n,\"b-)\":{\nwidth:18,alt:\"emoticon_cool\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/16.gif\",text:\"B-)\",regexp:\"B-\\\\)\",height:18}\n,\";)\":{\nwidth:18,alt:\"emoticon_winking\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/3.gif\",text:\";)\",regexp:\";\\\\)\",height:18}\n,\":>\":{\nwidth:18,alt:\"emoticon_smug\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/15.gif\",text:\":>\",regexp:\":>\",height:18}\n,\":-&\":{\nwidth:18,alt:\"emoticon_sick\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/31.gif\",text:\":-&\",regexp:\":-&\",height:18}\n,\"<):)\":{\nwidth:18,alt:\"emoticon_cowboy\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/48.gif\",text:\"<):)\",regexp:\"<\\\\):\\\\)\",height:18}\n,\":-s\":{\nwidth:18,alt:\"emoticon_worried\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/17.gif\",text:\":-S\",regexp:\":-S\",height:18}\n,\";))\":{\nwidth:18,alt:\"emoticon_hee_hee\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/71.gif\",text:\";))\",regexp:\";\\\\)\\\\)\",height:18}\n,\"[-o<\":{\nwidth:18,alt:\"emoticon_praying\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/63.gif\",text:\"[-O<\",regexp:\"\\\\[-O<\",height:18}\n,\"@};-\":{\nwidth:18,alt:\"emoticon_rose\",src:\"/service/zimlet/com_zimbra_ymemoticons/img/53.gif\",text:\"@};-\",regexp:\"@};-\",height:18}};\nYMEmoticonsPickerButton=function(t,e){\nif(arguments.length==0){\nreturn\n}\nt.actionTiming=DwtButton.ACTION_MOUSEUP;\nDwtToolBarButton.call(this,t);\nthis.setEmoticon();\nif(e&&e==true){\nthis.setMenu(new AjxCallback(this,this._createMenu),false,false,false)\n}else{\nthis.setMenu(new AjxCallback(this,this._createMenu),false,false,true)\n}};\nYMEmoticonsPickerButton.prototype=new DwtToolBarButton;\nYMEmoticonsPickerButton.prototype.constructor=YMEmoticonsPickerButton;\nYMEmoticonsPickerButton.prototype._createMenu=function(){\nvar e=new DwtMenu({\nparent:this,style:DwtMenu.GENERIC_WIDGET_STYLE}\n);\nthis._picker=new YMEmoticonsPicker(e,null,null);\nthis._picker.addSelectionListener(new AjxListener(this,this._smileyPicked));\nreturn e\n};\nYMEmoticonsPickerButton.prototype.setEmoticon=function(t){\nvar e=t?YMEmoticonsPicker.SMILEYS[t]:YMEmoticonsPicker.getDefaultSmiley();\nif(e){\nthis._smileyButtonDiv.src=e.src;\nthis._smiley=e\n}};\nYMEmoticonsPickerButton.prototype._createHtmlFromTemplate=function(t,o){\nDwtButton.prototype._createHtmlFromTemplate.call(this,t,o);\nvar n=Dwt.getNextId();\nvar e=\"<div unselectable><img width='18' src='' id='\"+n+\"_smiley'></div>\";\nthis.setText(e);\nthis._smileyButtonDiv=document.getElementById(n+\"_smiley\");\ndelete n\n};\nYMEmoticonsPickerButton.prototype.getSmiley=function(e){\nreturn this._picker.getSmiley(e)\n};\nYMEmoticonsPickerButton.prototype.getSelectedSmiley=function(){\nreturn this._smiley\n};\nYMEmoticonsPickerButton.prototype._smileyPicked=function(e){\nvar o=e.detail;\nthis.setEmoticon(o);\nif(this.isListenerRegistered(DwtEvent.SELECTION)){\nvar t=DwtShell.selectionEvent;\nt.item=this;\nthis.notifyListeners(DwtEvent.SELECTION,t)\n}};\nYMEmoticonsPicker=function(o,t,e){\nif(arguments.length==0){\nreturn\n}\nt=t||\"DwtColorPicker\";\nDwtControl.call(this,{\nparent:o,className:t,posStyle:e}\n);\nthis._createEmoticonsPicker(o)\n};\nYMEmoticonsPicker.prototype=new DwtControl;\nYMEmoticonsPicker.prototype.constructor=YMEmoticonsPicker;\nYMEmoticonsPicker.SMILEYS=Com_Zimbra_YMEmoticons.SMILEYS;\nYMEmoticonsPicker.getDefaultSmiley=function(){\nfor(var e in YMEmoticonsPicker.SMILEYS){\nreturn YMEmoticonsPicker.SMILEYS[e]\n}\nreturn null\n};\nYMEmoticonsPicker.prototype.getDefaultSmiley=YMEmoticonsPicker.getDefaultSmiley;\nYMEmoticonsPicker.prototype._createEmoticonsPicker=function(e){\nthis._createEmoticonsTable();\nthis._registerHandlers()\n};\nYMEmoticonsPicker.prototype.addSelectionListener=function(e){\nthis.addListener(DwtEvent.SELECTION,e)\n};\nYMEmoticonsPicker.prototype.removeSelectionListener=function(e){\nthis.removeListener(DwtEvent.SELECTION,e)\n};\nYMEmoticonsPicker.prototype.dispose=function(){\nif(this._disposed){\nreturn\n}\nDwt.disassociateElementFromObject(this.getHtmlElement().firstChild,this);\nDwtControl.prototype.dispose.call(this)\n};\nYMEmoticonsPicker.prototype.getSmiley=function(e){\nreturn YMEmoticonsPicker.SMILEYS[e]\n};\nYMEmoticonsPicker.EMOTICONS_PER_ROW=11;\nYMEmoticonsPicker.prototype._createEmoticonsTable=function(){\nvar h=0;\nvar n=[];\nvar e=0;\nvar s=0;\nvar l=0;\nvar t=0;\nvar d=0;\nfor(var o in YMEmoticonsPicker.SMILEYS){\nif(e!=0&&!(e%YMEmoticonsPicker.EMOTICONS_PER_ROW)){\nn[h++]=\"</tr><tr>\";\nif(s>l){\nl=s\n}\ns=0\n}\nt=YMEmoticonsPicker.SMILEYS[o].width;\nd=YMEmoticonsPicker.SMILEYS[o].height;\nn[h++]=['<td style=\\'background-color:#FFFFFF;\\' align=\"center\" valign=\"middle\" id=\\'',o,\"' >\"].join(\"\");\nn[h++]=[\"<img  height='\",d,\"' width='\",t,\"' src='\",YMEmoticonsPicker.SMILEYS[o].src,\"'\",\"  title='\",YMEmoticonsPicker.SMILEYS[o].alt,\"  \",YMEmoticonsPicker.SMILEYS[o].text,\"'\",\"  />\"].join(\"\");\nn[h++]=\"</td>\";\ne++;\ns=s+t\n}\nn[h++]=\"</table>\";\nvar r=[\"<table  cellpadding='2' cellspacing='3' border='0' align='center' width='\",l,\"px'><tr>\"].join(\"\");\nthis.getHtmlElement().innerHTML=[r,n.join(\"\")].join(\"\");\nif(AjxEnv.isFirefox1_5up&&!AjxEnv.isFirefox3up){\nthis.setSize(\"480px\",Dwt.DEFAULT)\n}};\nYMEmoticonsPicker.prototype._registerHandlers=function(){\nvar r=this.getHtmlElement().firstChild;\nDwt.associateElementWithObject(r,this);\nvar h=r.rows;\nvar l=h.length;\nfor(var n=0;\nn<l;\nn++){\nvar o=h[n].cells;\nvar s=o.length;\nfor(var t=0;\nt<s;\nt++){\nvar e=o[t];\nDwt.setHandler(e,DwtEvent.ONMOUSEDOWN,YMEmoticonsPicker._mouseDownHdlr);\nDwt.setHandler(e,DwtEvent.ONMOUSEUP,YMEmoticonsPicker._mouseUpHdlr)\n}}};\nYMEmoticonsPicker._mouseDownHdlr=function(t){\nvar e=DwtShell.mouseEvent;\ne.setFromDhtmlEvent(t,true);\nvar o=e.target;\nif(o.nodeName.toLowerCase()==\"img\"){\no=o.parentNode\n}\ne.dwtObj._downTdId=o.id;\ne._stopPropagation=true;\ne._returnValue=false;\ne.setToDhtmlEvent(t);\nreturn false\n};\nYMEmoticonsPicker._mouseUpHdlr=function(o){\nvar t=DwtShell.mouseEvent;\nt.setFromDhtmlEvent(o,true);\nvar r=t.dwtObj;\nvar s=t.target;\nif(s.nodeName.toLowerCase()==\"img\"){\ns=s.parentNode\n}\nif(r._downTdId==s.id){\nvar e=YMEmoticonsPicker.SMILEYS[s.id];\nif(e){\nif(r.isListenerRegistered(DwtEvent.SELECTION)){\nvar n=DwtShell.selectionEvent;\nDwtUiEvent.copy(n,t);\nn.item=r;\nn.detail=s.id;\nr.notifyListeners(DwtEvent.SELECTION,n)\n}}\nif(r.parent instanceof DwtMenu){\nDwtMenu.closeActiveMenu()\n}}\nt._stopPropagation=true;\nt._returnValue=false;\nt.setToDhtmlEvent(o);\nreturn false\n};\nfunction Com_Zimbra_EmailTemplates(){}\nCom_Zimbra_EmailTemplates.prototype=new ZmZimletBase();\nCom_Zimbra_EmailTemplates.prototype.constructor=Com_Zimbra_EmailTemplates;\nCom_Zimbra_EmailTemplates.prototype.init=function(){\nthis._folderPath=this.getUserProperty(\"etemplates_sourcefolderPath\")\n};\nCom_Zimbra_EmailTemplates.prototype.initializeToolbar=function(l,s,o,t){\nif(!this._viewIdAndMenuMap){\nthis._viewIdAndMenuMap=[]\n}\nthis.viewId=appCtxt.getViewTypeFromId(t);\nthis._currentViewId=this.viewId;\nif(this.viewId.indexOf(\"COMPOSE\")>=0||(this.viewId.indexOf(\"APPT\")!=-1)){\nif(s.getOp(\"EMAIL_TEMPLATES_ZIMLET_TOOLBAR_BUTTON\")){\nreturn\n}\nvar r=3;\nvar e={\ntext:this.getMessage(\"EmailTemplatesZimlet_templates\"),tooltip:this.getMessage(\"EmailTemplatesZimlet_tooltip\"),index:r,image:\"zimbraicon\"};\nvar n=s.createOp(\"EMAIL_TEMPLATES_ZIMLET_TOOLBAR_BUTTON\",e);\nvar h=new ZmPopupMenu(n);\nn.setMenu(h);\nn.noMenuBar=true;\nthis._viewIdAndMenuMap[this.viewId]={\nmenu:h,controller:o,button:n};\nn.removeAllListeners();\nn.removeDropDownSelectionListener();\nn.addSelectionListener(new AjxListener(this,this._addMenuItems,[n,h]));\nn.addDropDownSelectionListener(new AjxListener(this,this._addMenuItems,[n,h]))\n}};\nCom_Zimbra_EmailTemplates.prototype._addMenuItems=function(e,o){\nif(!o._loaded){\nthis._getRecentEmails(false);\no._loaded=true\n}else{\nvar t=e.getBounds();\no.popup(0,t.x,t.y+t.height,false)\n}};\nCom_Zimbra_EmailTemplates.prototype._getRecentEmails=function(e){\nif(this._folderPath==\"\"){\nthis._getRecentEmailsHdlr(e);\nreturn\n}\nvar t=appCtxt.get(ZmSetting.VIEW_AS_HTML);\nvar o=new AjxCallback(this,this._getRecentEmailsHdlr,e);\nvar n=new AjxVector();\nn.add(\"MSG\");\nappCtxt.getSearchController().search({\nquery:['in:(\"',this._folderPath,'\")'].join(\"\"),userText:true,limit:75,searchFor:ZmId.SEARCH_MAIL,offset:0,types:n,forceTypes:true,noRender:true,getHtml:t,callback:o,errorCallback:o}\n)\n};\nCom_Zimbra_EmailTemplates.prototype._getRecentEmailsHdlr=function(m,f){\nvar n=this._viewIdAndMenuMap[this._currentViewId].menu;\nif(m){\nn.removeChildren()\n}\nif(f){\nif(f instanceof ZmCsfeException){\nappCtxt.setStatusMsg(this.getMessage(\"EmailTemplatesZimlet_folderNotExist\")+\" \"+f.getErrorMsg(),ZmStatusView.LEVEL_WARNING);\nthis._addStandardMenuItems(n);\nreturn\n}\nvar u=f.getResponse().getResults(\"MSG\").getVector().getArray();\nfor(var h=0;\nh<u.length;\nh++){\nvar s=u[h];\nvar o=s.id;\nvar d=n.createMenuItem(o,{\nimage:\"zimbraIcon\",text:s.subject,style:DwtMenuItem.CASCADE_STYLE}\n);\nvar t=new ZmPopupMenu(d);\nd.setMenu(t);\nvar r=t.createMenuItem(\"subMenu_\"+Dwt.getNextId(),{\nimage:\"Edit\",text:this.getMessage(\"EmailTemplatesZimlet_bodyOnly\")}\n);\nr.addSelectionListener(new AjxListener(this,this._insertMsg,{\nmsg:s,insertMode:\"body\"}\n));\nr=t.createMenuItem(\"subMenu_\"+Dwt.getNextId(),{\nimage:\"Edit\",text:this.getMessage(\"EmailTemplatesZimlet_bodyAndSubject\")}\n);\nr.addSelectionListener(new AjxListener(this,this._insertMsg,{\nmsg:s,insertMode:\"bodyAndSubject\"}\n));\nr=t.createMenuItem(\"subMenu_\"+Dwt.getNextId(),{\nimage:\"Edit\",text:this.getMessage(\"EmailTemplatesZimlet_bodySubjectAndParticipants\")}\n);\nr.addSelectionListener(new AjxListener(this,this._insertMsg,{\nmsg:s,insertMode:\"all\"}\n))\n}\nif(u.length!=0){\nd=n.createMenuItem(o,{\nstyle:DwtMenuItem.SEPARATOR_STYLE}\n)\n}}\nthis._addStandardMenuItems(n);\nvar l=this._viewIdAndMenuMap[this._currentViewId].button;\nvar e=l.getBounds();\nn.popup(0,e.x,e.y+e.height,false)\n};\nCom_Zimbra_EmailTemplates.prototype._addStandardMenuItems=function(t){\nvar e=t.createMenuItem(\"reloadTemplates\",{\nimage:\"Refresh\",text:this.getMessage(\"EmailTemplatesZimlet_reloadTemplates\")}\n);\ne.addSelectionListener(new AjxListener(this,this._getRecentEmails,true));\nvar e=t.createMenuItem(\"preferences\",{\nimage:\"Preferences\",text:this.getMessage(\"EmailTemplatesZimlet_preferences\")}\n);\ne.addSelectionListener(new AjxListener(this,this._displayPrefDialog));\nvar e=t.createMenuItem(\"save\",{\nimage:\"Save\",text:this.getMessage(\"EmailTemplatesZimlet_save\")}\n);\ne.addSelectionListener(new AjxListener(this,this._saveTemplate))\n};\nCom_Zimbra_EmailTemplates.prototype._insertMsg=function(e){\nthis.msg=e.msg;\nthis.msg.load({\ncallback:new AjxCallback(this,this._handleLoadedMsg,e.insertMode)}\n)\n};\nCom_Zimbra_EmailTemplates.prototype._handleLoadedMsg=function(o){\nthis.viewId=appCtxt.getCurrentViewId();\nvar t=this._viewIdAndMenuMap[this._currentViewId].controller;\nvar n=appCtxt.getCurrentView();\nvar e=e=appCtxt.getCurrentView().getHtmlEditor().getContent();\nthis._composeMode=appCtxt.getCurrentView().getHtmlEditor().getMode();\nvar r=this.getTemplateContent(this.msg,this._composeMode);\nvar s={\ncontroller:t,templateSubject:this.msg.subject,templateBody:r,currentBodyContent:e,composeView:n,insertMode:o};\nthis._testTemplateContentForKeys(s)\n};\nCom_Zimbra_EmailTemplates.prototype._testTemplateContentForKeys=function(r){\nvar t=new RegExp(\"\\\\$\\\\{[-a-zA-Z._0-9]+\\\\}\",\"ig\");\nvar s=r.templateBody;\nvar n=r.templateSubject;\nvar o=s.match(t);\nvar e;\nif(n){\ne=n.match(t)\n}\nif(o!=null||e!=null){\nr.bodyArry=o;\nr.subjectArry=e;\nthis._showReplaceStringsDlg(r)\n}else{\nthis._doInsert(r.controller,r.composeView,r.templateSubject,r.templateBody,r.currentBodyContent,r.insertMode)\n}};\nCom_Zimbra_EmailTemplates.prototype._showReplaceStringsDlg=function(e){\nif(this.replaceDlg){\nthis.replaceDlg.params=e;\nthis._createReplaceView(e);\nthis.replaceDlg.popup();\nthis._addTabControl();\nreturn\n}\nthis.replaceDlgView=new DwtComposite(this.getShell());\nthis.replaceDlgView.getHtmlElement().style.overflow=\"auto\";\nthis._createReplaceView(e);\nthis.replaceDlg=this._createDialog({\ntitle:this.getMessage(\"EmailTemplatesZimlet_replaceTemplateData\"),view:this.replaceDlgView,standardButtons:[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]}\n);\nthis.replaceDlg.params=e;\nthis.replaceDlg.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._replaceOKBtnListener));\nthis.replaceDlg.popup();\nthis._addTabControl()\n};\nCom_Zimbra_EmailTemplates.prototype._createReplaceView=function(n){\nvar d=n.bodyArry;\nvar t=n.subjectArry;\nvar u=[];\nif(t!=null&&t!=undefined){\nu=t\n}\nif(d!=null&&d!=undefined){\nu=u.concat(d)\n}\nvar l=[];\nfor(var s=0;\ns<u.length;\ns++){\nl.push(AjxStringUtil.trim(u[s]))\n}\nu=emailtemplates_unique(l);\nthis._replaceFieldIds=[];\nthis._replaceFieldIdsMap=[];\nvar r=0;\nvar h=new Array();\nh[r++]=\"<div class='emailTemplates_yellow'>\"+this.getMessage(\"EmailTemplatesZimlet_replaceGenericData\")+\"</div><BR/>\";\nh[r++]=\"<TABLE  class='emailTemplates_table' width=100% cellspacing=3 cellpadding=3>\";\nfor(var o=0;\no<u.length;\no++){\nvar m=u[o];\nm=m.replace(/\\$\\{([^}]*)\\}/,\"$1\");\nvar e=Dwt.getNextId();\nthis._replaceFieldIds.push(e);\nthis._replaceFieldIdsMap.push({\nkey:m,id:e}\n);\nh[r++]=[\"<TR><TD><DIV style='font-weight:bold;'>\",m,\"</div></TD><TD><input type=text id='\",e,\"'></input></TD></TR>\"].join(\"\")\n}\nh[r++]=\"</TABLE>\";\nthis.replaceDlgView.getHtmlElement().innerHTML=h.join(\"\")\n};\nCom_Zimbra_EmailTemplates.prototype._addTabControl=function(){\nthis.replaceDlg._tabGroup.removeAllMembers();\nfor(var e=0;\ne<this._replaceFieldIds.length;\ne++){\nvar t=document.getElementById(this._replaceFieldIds[e]);\nif(t){\nthis.replaceDlg._tabGroup.addMember(t)\n}}\nthis.replaceDlg._tabGroup.addMember(this.replaceDlg.getButton(DwtDialog.OK_BUTTON));\nthis.replaceDlg._tabGroup.addMember(this.replaceDlg.getButton(DwtDialog.CANCEL_BUTTON));\ndocument.getElementById(this._replaceFieldIds[0]).focus()\n};\nCom_Zimbra_EmailTemplates.prototype._replaceOKBtnListener=function(){\nvar t=this.replaceDlg.params;\nvar h=t.insertMode;\nvar o=t.templateBody;\nvar r=t.templateSubject;\nvar u=t.currentBodyContent;\nfor(var s=0;\ns<this._replaceFieldIdsMap.length;\ns++){\nvar n=this._replaceFieldIdsMap[s];\nvar l=\"${\"+n.key+\"}\";\nl=l.replace(/\\$\\{/,\"\\\\$\\\\{\").replace(/\\}$/,\"\\\\}\");\nvar d=new RegExp(l,\"ig\");\nvar e=document.getElementById(n.id).value;\nif(e==\"\"){\ncontinue\n}\nif(h==\"bodyAndSubject\"||h==\"all\"){\nr=r.replace(d,e)\n}\no=o.replace(d,e)\n}\nthis.replaceDlg.popdown();\nthis._doInsert(t.controller,t.composeView,r,o,u,h)\n};\nCom_Zimbra_EmailTemplates.prototype._doInsert=function(h,l,d,n,y,p){\nif(p==\"bodyAndSubject\"||p==\"all\"){\nif(this.viewId.indexOf(\"APPT\")!=-1){\nl._apptEditView._subjectField.setValue(d)\n}else{\nl._subjectField.value=d\n}}\nif(p==\"all\"){\nvar u=this.msg.participants.getArray();\nvar g=[];\nvar o=[];\nfor(var s=0;\ns<u.length;\ns++){\nvar f=u[s];\nvar t=\"\";\nif(f.name&&f.name!=\"\"){\nt=['\"',f.name,'\" <',f.address,\">\"].join(\"\")\n}else{\nt=f.address\n}\nif(f.type==AjxEmailAddress.TO){\ng.push(t)\n}else{\nif(f.type==AjxEmailAddress.CC){\no.push(t)\n}}}\nif(this.viewId.indexOf(\"APPT\")!=-1){\ntry{\nl._apptEditView._attInputField.PERSON.setValue(g.concat(o).join(\";\"))\n}\ncatch(m){\nappCtxt.setStatusMsg(this.getMessage(\"EmailTemplatesZimlet_couldNotInsertApptAttendees\")+\" \"+result.getErrorMsg(),ZmStatusView.LEVEL_WARNING)\n}}else{\nif(g.length!=0){\nl.setAddress(AjxEmailAddress.TO,g.join(\";\"))\n}\nif(o.length!=0){\nl.setAddress(AjxEmailAddress.CC,o.join(\";\"))\n}}}\nvar r=\"\\r\\n\";\nif((this._composeMode==Dwt.HTML)){\nr=\"</br>\"\n}\nif(this.viewId.indexOf(\"APPT\")!=-1){\nl.getHtmlEditor().setContent([y,r,n].join(\"\"))\n}else{\nl._htmlEditor.setContent([n,r,y].join(\"\"))\n}\nif(this.msg.attachments&&this.msg.attachments.length>0){\nthis._isDrafInitiatedByThisZimlet=true;\nh.saveDraft(ZmComposeController.DRAFT_TYPE_AUTO)\n}};\nCom_Zimbra_EmailTemplates.prototype.addExtraMsgParts=function(o,e){\nif(!e||!this._isDrafInitiatedByThisZimlet){\nreturn\n}\nif(o&&o.m){\nif(!o.m.attach){\no.m.attach={};\no.m.attach.mp=[]\n}else{\nif(!o.m.attach.mp){\no.m.attach.mp=[]\n}}\nvar n=this.msg.attachments;\nif(n){\nfor(var t=0;\nt<n.length;\nt++){\no.m.attach.mp.push({\nmid:this.msg.id,part:n[t].part}\n)\n}}}\nthis._isDrafInitiatedByThisZimlet=false\n};\nCom_Zimbra_EmailTemplates.arrayContainsElement=function(o,t){\nfor(var e=0;\ne<o.length;\ne++){\nif(o[e]==t){\nreturn true\n}}\nreturn false\n};\nfunction emailtemplates_unique(e){\nvar o=[],n,t=e.length;\nfor(n=0;\nn<t;\nn++){\nif(!Com_Zimbra_EmailTemplates.arrayContainsElement(o,e[n])){\no.push(e[n])\n}}\nreturn o\n}\nCom_Zimbra_EmailTemplates.prototype.getTemplateContent=function(t,o){\nvar e=\"\";\nvar e=t.getBodyContent();\nif(t.isHtmlMail()&&o==ZmMimeTable.TEXT_PLAIN){\nvar n=document.createElement(\"div\");\nn.innerHTML=t.getBodyContent();\nreturn AjxStringUtil.convertHtml2Text(n)\n}else{\nif(!t.isHtmlMail()&&o==ZmMimeTable.TEXT_HTML){\nreturn AjxStringUtil.convertToHtml(t.getBodyContent())\n}else{\nreturn e\n}}};\nCom_Zimbra_EmailTemplates.prototype._displayPrefDialog=function(){\nif(this.prefDlg){\nthis.prefDlg.popup();\nreturn\n}\nthis.pView=new DwtComposite(this.getShell());\nthis.pView.getHtmlElement().style.overflow=\"auto\";\nthis.pView.getHtmlElement().innerHTML=this._createPreferenceView();\nthis.prefDlg=this._createDialog({\ntitle:this.getMessage(\"EmailTemplatesZimlet_preferences\"),view:this.pView,standardButtons:[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]}\n);\nthis.prefDlg.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._prefOKBtnListener));\nthis._initializePrefDialog();\nthis.prefDlg.popup()\n};\nCom_Zimbra_EmailTemplates.prototype._createPreferenceView=function(){\nvar o=\"Templates folder not set\";\nif(this._folderPath!=\"\"){\no=this._folderPath\n}\nvar t=new Array();\nvar e=0;\nt.push(\"<TABLE cellspacing=3 cellpadding=3>\",\"<TR><TD><DIV style='font-weight:bold;'>\",this.getMessage(\"EmailTemplatesZimlet_templateFolderPath\"),\"</div></TD><TD><DIV style='color:blue;font-weight:bold;' id='emailtemplates_folderInfo'>\",o,\"</div></TD></TR>\",\"<TR><TD colspan=2><DIV id='emailtemplates_folderLookupDiv'></DIV></TD></TR></TABLE>\",\"<br/><div class='emailTemplates_yellow'>\",this.getMessage(\"EmailTemplatesZimlet_genericNames\"),\"</div><div  class='emailTemplates_yellowNormal'>\",\"<br/>\",this.getMessage(\"EmailTemplatesZimlet_helpLine1\"),\"<br/> \",this.getMessage(\"EmailTemplatesZimlet_helpLine2\"),\"<br/><br/>\",this.getMessage(\"EmailTemplatesZimlet_helpLine3\"),\"<br/>\",this.getMessage(\"EmailTemplatesZimlet_helpLine4\"),\"<br/>\",this.getMessage(\"EmailTemplatesZimlet_helpLine5\"),\"<br/>\",this.getMessage(\"EmailTemplatesZimlet_helpLine6\"));\nreturn t.join(\"\")\n};\nCom_Zimbra_EmailTemplates.prototype._initializePrefDialog=function(){\nvar e=new DwtButton({\nparent:this.getShell()}\n);\ne.setText(this.getMessage(\"EmailTemplatesZimlet_setTemplatesFolder\"));\ne.setImage(\"Search\");\ne.setToolTipContent(this.getMessage(\"EmailTemplatesZimlet_selectTemplatesFolder\"));\ne.addSelectionListener(new AjxListener(this,this._setFolderBtnListener));\ndocument.getElementById(\"emailtemplates_folderLookupDiv\").appendChild(e.getHtmlElement())\n};\nCom_Zimbra_EmailTemplates.prototype._prefOKBtnListener=function(){\nif(this.needRefresh){\nthis.setUserProperty(\"etemplates_sourcefolderPath\",this._folderPath);\nvar e=new AjxCallback(this,this._handleSaveProperties,this.needRefresh);\nthis.saveUserProperties(e)\n}\nthis.prefDlg.popdown()\n};\nCom_Zimbra_EmailTemplates.prototype._setFolderBtnListener=function(){\nif(!this._chooseFolderDialog){\nAjxDispatcher.require(\"Extras\");\nthis._chooseFolderDialog=new ZmChooseFolderDialog(appCtxt.getShell())\n}\nthis._chooseFolderDialog.reset();\nthis._chooseFolderDialog.registerCallback(DwtDialog.OK_BUTTON,this._chooseFolderOkBtnListener,this,this._chooseFolderDialog);\nvar e={\ntreeIds:[ZmOrganizer.FOLDER],title:this.getMessage(\"EmailTemplatesZimlet_selectTemplatesFolder\"),overviewId:this.toString(),description:this.getMessage(\"EmailTemplatesZimlet_selectTemplatesFolder\"),skipReadOnly:false,hideNewButton:false,appName:ZmApp.MAIL,omit:[]};\nthis._chooseFolderDialog.popup(e)\n};\nCom_Zimbra_EmailTemplates.prototype._chooseFolderOkBtnListener=function(o,t){\no.popdown();\nvar e=t.getPath();\nthis.needRefresh=false;\nif(this._folderPath!=e){\nthis.needRefresh=true\n}\nthis._folderPath=e;\ndocument.getElementById(\"emailtemplates_folderInfo\").innerHTML=this._folderPath\n};\nCom_Zimbra_EmailTemplates.prototype._handleSaveProperties=function(e){\nappCtxt.setStatusMsg(\"Preferences Saved\",ZmStatusView.LEVEL_INFO);\nif(e){\nthis.showYesNoDialog()\n}};\nCom_Zimbra_EmailTemplates.prototype.showYesNoDialog=function(){\nvar e=appCtxt.getYesNoMsgDialog();\ne.registerCallback(DwtDialog.YES_BUTTON,this._yesButtonClicked,this,e);\ne.registerCallback(DwtDialog.NO_BUTTON,this._NoButtonClicked,this,e);\ne.setMessage(this.getMessage(\"EmailTemplatesZimlet_restartBrowser\"),DwtMessageDialog.WARNING_STYLE);\ne.popup()\n};\nCom_Zimbra_EmailTemplates.prototype._yesButtonClicked=function(e){\ne.popdown();\nthis._refreshBrowser()\n};\nCom_Zimbra_EmailTemplates.prototype._NoButtonClicked=function(e){\ne.popdown()\n};\nCom_Zimbra_EmailTemplates.prototype._refreshBrowser=function(){\nwindow.onbeforeunload=null;\nvar e=AjxUtil.formatUrl({}\n);\nZmZimbraMail.sendRedirect(e)\n};\nCom_Zimbra_EmailTemplates.prototype._saveTemplate=function(){\nappCtxt.getCurrentController().saveDraft(null,null,null,new AjxCallback(this,this._doSaveTemplate,[]))\n};\nCom_Zimbra_EmailTemplates.prototype._doSaveTemplate=function(){\nvar o=appCtxt.getCurrentView().getMsg();\nif(o.subject==\"\"){\nvar t=appCtxt.getMsgDialog();\nt.setMessage(this.getMessage(\"EmailTemplatesZimlet_noSubject\"),DwtMessageDialog.CRITICAL_STYLE);\nt.setTitle(this.getMessage(\"EmailTemplatesZimlet_noSubject_title\"));\nt.popup();\nreturn\n}\nvar e=this._folderPath;\nif(e[0]==\"/\"){\ne=e.substr(1,e.length-1)\n}\no.move(appCtxt.getFolderTree().getByPath(e).id,new AjxCallback(this,this._getRecentEmails,[]));\nvar t=appCtxt.getMsgDialog();\nt.setMessage(this.getMessage(\"EmailTemplatesZimlet_saved\"),DwtMessageDialog.INFO_STYLE);\nt.setTitle(this.getMessage(\"EmailTemplatesZimlet_saved_title\"));\nt.popup()\n};\nCom_Zimbra_EmailTemplates.prototype.singleClicked=function(e){\nthis._displayPrefDialog()\n};\nCom_Zimbra_EmailTemplates.prototype.doubleClicked=function(e){\nthis._displayPrefDialog()\n};\nfunction com_zimbra_attachcontacts_HandlerObject(){}\ncom_zimbra_attachcontacts_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_attachcontacts_HandlerObject.prototype.constructor=com_zimbra_attachcontacts_HandlerObject;\nvar AttachContactsZimlet=com_zimbra_attachcontacts_HandlerObject;\nAttachContactsZimlet.SEND_CONTACTS=\"SEND_CONTACTS_IN_EMAIL\";\nAttachContactsZimlet.prototype.init=function(){\nthis._op=ZmOperation.registerOp(AttachContactsZimlet.SEND_CONTACTS,{\nimage:\"MsgStatusSent\",text:this.getMessage(\"ACZ_Send\"),tooltip:this.getMessage(\"ACZ_SendContactsAsAttachments\")}\n);\nthis._contactSendListener=new AjxListener(this,this._contactListSendListener);\nthis.overrideAPI(ZmListController.prototype,\"_setContactText\",this._setContactText)\n};\nAttachContactsZimlet.prototype.initializeAttachPopup=function(t,e){\ne._createAttachMenuItem(t,ZmMsg.contacts,this.showAttachmentDialog.bind(this),\"ATTACH_MENU_CONTACT\")\n};\nAttachContactsZimlet.prototype.removePrevAttDialogContent=function(t){\nvar e=t&&t.firstChild;\nif(e&&e.className==\"DwtComposite\"){\nt.removeChild(e)\n}};\nAttachContactsZimlet.prototype.showAttachmentDialog=function(){\nvar e=this._attachDialog=appCtxt.getAttachDialog();\ne.setTitle(ZmMsg.attachContact);\ne.setButtonEnabled(DwtDialog.OK_BUTTON,false);\nthis.removePrevAttDialogContent(e._getContentDiv().firstChild);\nif(!this.AttachContactsView||!this.AttachContactsView.attachDialog){\nthis.AttachContactsView=new AttachContactsTabView(this._attachDialog,this);\nvar t=this._selectionListener.bind(this);\nthis.AttachContactsView.addListener(DwtEvent.SELECTION,t)\n}\nthis.AttachContactsView.reparentHtmlElement(e._getContentDiv().childNodes[0],0);\nthis.AttachContactsView.attachDialog=e;\ne.setOkListener(new AjxCallback(this,this._okListener));\nthis.AttachContactsView.attachDialog.popup();\nthis.AttachContactsView.attachDialog.enableInlineOption(false);\nthis._addedToMainWindow=true\n};\nAttachContactsZimlet.prototype._okListener=function(){\nthis.AttachContactsView.uploadFiles();\nthis.AttachContactsView.setClosed(true);\nthis.AttachContactsView.attachDialog.popdown()\n};\nAttachContactsZimlet.prototype._selectionListener=function(){\nvar e=this.AttachContactsView.getSelectionCount()>0;\nthis._attachDialog.setButtonEnabled(DwtDialog.OK_BUTTON,e)\n};\nAttachContactsZimlet.prototype.addExtraMsgParts=function(o,e){\nif(!e||!this._isDraftInitiatedByThisZimlet){\nreturn\n}\nif(o&&o.m){\nif(!o.m.attach){\no.m.attach={};\no.m.attach.cn=[]\n}else{\nif(!o.m.attach.cn){\no.m.attach.cn=[]\n}}\nvar s=this.contactIdsToAttach;\nif(s){\nfor(var t=0;\nt<s.length;\nt++){\nvar n=s[t];\nif(appCtxt.multiAccounts&&s[t].indexOf(\":\")==-1){\nn=[appCtxt.getActiveAccount().id,\":\",s[t]].join(\"\")\n}\no.m.attach.cn.push({\nid:n}\n)\n}}}\nthis._isDraftInitiatedByThisZimlet=false\n};\nAttachContactsZimlet.prototype._initContactsReminderToolbar=function(n,e){\nvar s=AttachContactsZimlet.SEND_CONTACTS;\nif(n.getButton(s)||!this._isOkayToAttach()){\nreturn\n}\nvar o=AjxUtil.hashCopy(ZmOperation.SETUP[s]);\no.text=this.getMessage(\"ACZ_Send\");\nvar t=n.createZimletOp(s,o);\nt.addSelectionListener(this._contactSendListener)\n};\nAttachContactsZimlet.prototype.resetContactListToolbarOperations=function(t,e){\nvar n=t;\nvar o=null;\nif(t.isZmButtonToolBar){\nn=n.getActionsMenu();\no=ZmOperation.NEW_MESSAGE\n}\nthis._addContactActionMenuItem(n,o);\nn.enable(AttachContactsZimlet.SEND_CONTACTS,e>0&&this._isOkayToAttach())\n};\nAttachContactsZimlet.prototype._isOkayToAttach=function(){\nthis._getContactListIds();\nreturn this.contactIdsToAttach&&this.contactIdsToAttach.length>0\n};\nAttachContactsZimlet.prototype._contactListSendListener=function(){\nthis._getContactListIds();\nif(this.contactIdsToAttach&&this.contactIdsToAttach.length){\nthis._openCompose()\n}};\nAttachContactsZimlet.prototype._getContactListIds=function(){\nvar o=AjxDispatcher.run(\"GetContactListController\");\nthis.contactIdsToAttach=[];\nvar t=o.getListView&&o.getListView();\nif(t){\nvar n=t.getSelection();\nfor(var s=0;\ns<n.length;\ns++){\nvar e=n[s];\nif(e.isGal||e.isGroup()){\ncontinue\n}\nthis.contactIdsToAttach.push(e.id)\n}}\nreturn this.contactIdsToAttach\n};\nAttachContactsZimlet.prototype._openCompose=function(){\nvar t=ZmOperation.NEW_MESSAGE;\nAjxDispatcher.run(\"Compose\",{\naction:t,inNewWindow:false}\n);\nvar e=appCtxt.getApp(ZmApp.MAIL).getComposeController(appCtxt.getApp(ZmApp.MAIL).getCurrentSessionId(ZmId.VIEW_COMPOSE));\nthis._isDraftInitiatedByThisZimlet=true;\ne.saveDraft(ZmComposeController.DRAFT_TYPE_AUTO)\n};\nAttachContactsZimlet.prototype._setContactText=function(e){\nif(this._participantActionMenu){\nthis._participantActionMenu.enable(AttachContactsZimlet.SEND_CONTACTS,e&&!e.isGal)\n}\narguments.callee.func.apply(this,arguments)\n};\nAttachContactsZimlet.prototype.onParticipantActionMenuInitialized=function(e,t){\nthis.onActionMenuInitialized(e,t)\n};\nAttachContactsZimlet.prototype.onActionMenuInitialized=function(e,t){\nthis.addMenuButton(this._getContact.bind(this),t,ZmOperation.CONTACT)\n};\nAttachContactsZimlet.prototype._addContactActionMenuItem=function(e,t){\nthis.addMenuButton(this._getContact.bind(this),e,t||ZmOperation.CONTACT)\n};\nAttachContactsZimlet.prototype._getContact=function(){\nvar o=appCtxt.getCurrentController();\nif(!o){\nreturn\n}\nvar t=o._actionEv&&o._actionEv.contact;\nif(o instanceof ZmContactListController){\nvar e=o.getListView();\nif(e){\nvar s=e.getSelection();\nif(s&&s.length>0){\nif(!t){\nreturn s\n}\nfor(var n=0;\nn<s.length;\nn++){\nif(s[n]===t){\nreturn s\n}}}}}\nreturn t\n};\nAttachContactsZimlet.prototype.addMenuButton=function(e,r,s){\nif(e&&r&&!r.getMenuItem(AttachContactsZimlet.SEND_CONTACTS)){\nvar t=null;\nif(AjxUtil.isString(s)){\nvar n=r.getMenuItem(s);\nif(n){\nfor(t=0,c=r.getChildren();\nt<c.length&&c[t]!==n;\nt++){}}}else{\nif(AjxUtil.isNumber(s)){\nt=s\n}}\nif(!s||t!==null){\nvar h={\nid:AttachContactsZimlet.SEND_CONTACTS,text:this.getMessage(\"ACZ_SendContact\"),image:\"MsgStatusSent\"};\nif(t!==null){\nh.index=t+1\n}\nvar o=ZmOperation.defineOperation(null,h);\nr.addOp(AttachContactsZimlet.SEND_CONTACTS);\nr.addSelectionListener(AttachContactsZimlet.SEND_CONTACTS,new AjxListener(this,this._contactActionMenuListener,e))\n}}};\nAttachContactsZimlet.prototype._contactActionMenuListener=function(t,n){\nvar e=t.run();\nif(e){\nvar s=AjxUtil.toArray(e);\nif(s.length){\nthis.contactIdsToAttach=[];\nfor(var o=0;\no<s.length;\no++){\nif(!s[o].isGroup()){\nthis.contactIdsToAttach.push(s[o].id)\n}}\nif(this.contactIdsToAttach.length>0){\nthis._openCompose()\n}}}};\nAttachContactsZimlet.prototype.overrideAPI=function(o,t,n){\nn=n||this[t];\nif(n){\nvar e=o[t];\no[t]=function(){\nn.func=e;\nreturn n.apply(this,arguments)\n};\no[t].func=e\n}};\nACZimletNavToolBar=function(t){\nt.className=t.className||\"ACZimletNavToolBar\";\nvar e=(t.hasText!==false);\nt.buttons=this._getButtons(e);\nt.toolbarType=ZmId.TB_NAV;\nt.posStyle=t.posStyle||DwtControl.STATIC_STYLE;\nZmButtonToolBar.call(this,t);\nif(e){\nthis._textButton=this.getButton(ZmOperation.TEXT)\n}};\nACZimletNavToolBar.prototype=new ZmButtonToolBar;\nACZimletNavToolBar.prototype.constructor=ACZimletNavToolBar;\nACZimletNavToolBar.prototype.toString=function(){\nreturn\"ACZimletNavToolBar\"\n};\nACZimletNavToolBar.prototype._getButtons=function(e){\nvar t=[];\nt.push(ZmOperation.PAGE_BACK);\nif(e){\nt.push(ZmOperation.TEXT)\n}\nt.push(ZmOperation.PAGE_FORWARD);\nreturn t\n};\nACZimletNavToolBar.prototype.createOp=function(t,e){\ne.textClassName=\"ZWidgetTitle ACZimletNavToolBarTitle\";\nreturn ZmButtonToolBar.prototype.createOp.apply(this,arguments)\n};\nACZimletNavToolBar.prototype.setText=function(e){\nif(!this._textButton){\nreturn\n}\nthis._textButton.setText(e)\n};\nAttachContactsTabView=function(o,e,t){\nthis.zimlet=e;\nDwtComposite.call(this,o,t,Dwt.STATIC_STYLE);\nthis._createHtml1();\nthis.closed=true\n};\nAttachContactsTabView.prototype=new DwtComposite;\nAttachContactsTabView.prototype.constructor=AttachContactsTabView;\nAttachContactsTabView.ELEMENT_ID_SEARCH_FIELD=\"attDlg_attContact_SearchField\";\nAttachContactsTabView.ELEMENT_ID_SEARCH_BUTTON=\"attDlg_attContact_SearchBtn\";\nAttachContactsTabView.ELEMENT_ID_NAV_BUTTON_CELL=\"attDlg_attContact_NavBtnCell\";\nAttachContactsTabView.DEFAULT_CONTACTS_FOLDER=\"7\";\nAttachContactsTabView.GROUP_CUTOFF=6;\nAttachContactsTabView.prototype.toString=function(){\nreturn\"AttachContactsTabView\"\n};\nAttachContactsTabView.prototype.showMe=function(){\nDwtTabViewPage.prototype.showMe.call(this);\nvar e=appCtxt.multiAccounts?appCtxt.getAppViewMgr().getCurrentView().getFromAccount():appCtxt.getActiveAccount();\nif(appCtxt.multiAccounts){\nappCtxt.accountList.setActiveAccount(e)\n}\nif(this.prevAccount&&(e.id==this.prevAccount.id)){\nthis.reset();\nthis.setSize(Dwt.DEFAULT,\"295\");\nreturn\n}\nthis.prevAccount=e;\nthis._createHtml1();\nDwt.byId(this._folderTreeCellId).onclick=AjxCallback.simpleClosure(this._treeListener,this)\n};\nAttachContactsTabView.prototype.setClosed=function(e){\nthis._closed=(e!==false)\n};\nAttachContactsTabView.prototype._resetQuery=function(e){\nif(this._currentQuery==undefined){\nreturn e\n}\nif(this._currentQuery!=e){\nthis._offset=0;\nthis._currentQuery=e\n}\nreturn e\n};\nAttachContactsTabView.prototype._getQueryFromFolder=function(e){\nreturn this._resetQuery('inid:\"'+e+'\"')\n};\nAttachContactsTabView.prototype.hideMe=function(){\nDwtTabViewPage.prototype.hideMe.call(this)\n};\nAttachContactsTabView.prototype._createHtml1=function(){\nthis._tableID=Dwt.getNextId();\nthis._folderTreeCellId=Dwt.getNextId();\nthis._folderListId=Dwt.getNextId();\nvar o=[];\no.push(\"<table class='AttachContacts_table' width='100%' style='margin-bottom:5px;'>\",\"<TR><td><INPUT type='text' id='\",AttachContactsTabView.ELEMENT_ID_SEARCH_FIELD,\"'></INPUT></td>\",\"<td width='80%' style='padding:0 2px'><SPAN id='\",AttachContactsTabView.ELEMENT_ID_SEARCH_BUTTON,\"' /></td>\",\"<td><SPAN id='\",AttachContactsTabView.ELEMENT_ID_NAV_BUTTON_CELL,\"' /></td></TR></table>\",\"<table width='100%'><tr><td valign='top' id='\",this._folderTreeCellId,\"'></td>\",\"<td  valign='top'><div  id='\",this._folderListId,\"' ></div>\",\"</td></tr></table>\");\nthis.setContent(o.join(\"\"));\nvar t=new DwtButton({\nparent:this}\n);\nvar e=this.zimlet.getMessage(\"ACZ_tab_button_search\");\nt.setText(e);\nt.setImage(\"Contact\");\nt.setSize(\"140\");\nt.addSelectionListener(new AjxListener(this,this._searchButtonListener));\nDwt.byId(AttachContactsTabView.ELEMENT_ID_SEARCH_BUTTON).appendChild(t.getHtmlElement());\nthis._navigationContainer=new DwtComposite(appCtxt.getShell());\nthis._navTB=new ACZimletNavToolBar({\nparent:this._navigationContainer}\n);\nvar n=new AjxListener(this,this._navBarListener);\nthis._navTB.addSelectionListener(ZmOperation.PAGE_BACK,n);\nthis._navTB.addSelectionListener(ZmOperation.PAGE_FORWARD,n);\nDwt.byId(AttachContactsTabView.ELEMENT_ID_NAV_BUTTON_CELL).appendChild(this._navTB.getHtmlElement());\nthis.showAttachContactsTreeView();\nDwt.byId(this._folderListId);\nDwt.byId(this._folderListId).onclick=AjxCallback.simpleClosure(this._handleItemSelect,this)\n};\nAttachContactsTabView.prototype._handleItemSelect=function(n){\nif(AjxEnv.isIE){\nn=window.event\n}\nvar o=DwtShell.mouseEvent;\no.setFromDhtmlEvent(n);\nvar e=o.target;\nvar r=true;\nif(e.className==\"ImgCheckboxUnchecked\"||e.className==\"ImgCheckboxChecked\"){\nr=false\n}\nwhile(!Dwt.hasClass(e,\"AttachContactRow\")&&e.id!=this._folderListId){\ne=e.parentNode\n}\nif(e.id==this._folderListId){\nreturn\n}\nthis._resetRowSelection(r);\nvar s=e.id.replace(\"attachContactsZimlet_row_\",\"\");\nvar t=document.getElementById(\"attachContactsZimlet_checkbox_\"+s);\nif(t&&!r){\nif(t.className==\"ImgCheckboxUnchecked\"){\nthis._setCheckBoxSelection(t,true)\n}else{\nif(t.className==\"ImgCheckboxChecked\"){\nthis._setCheckBoxSelection(t,false)\n}}}\nif(e){\nif(e.className.indexOf(\"Row-selected\")>=0){\nif(t.className!=\"ImgCheckboxChecked\"){\nthis._setRowSelection(e,false);\nthis._selectedItemIds[s]=false\n}}else{\nthis._setRowSelection(e,true);\nthis._selectedItemIds[s]=true\n}}\nthis._selectionChanged()\n};\nAttachContactsTabView.prototype._resetRowSelection=function(n){\nfor(var o in this._selectedItemIds){\nvar t=document.getElementById(\"attachContactsZimlet_checkbox_\"+o);\nvar e=document.getElementById(\"attachContactsZimlet_row_\"+o);\nif(!n&&t&&t.className==\"ImgCheckboxChecked\"){\ncontinue\n}\nthis._setRowSelection(e,false);\nthis._setCheckBoxSelection(t,false);\nif(this._selectedItemIds&&this._selectedItemIds[o]){\nthis._selectedItemIds[o]=false\n}}};\nAttachContactsTabView.prototype._setCheckBoxSelection=function(t,e){\nif(!t){\nreturn\n}\nif(!e){\nt.className=\"ImgCheckboxUnchecked\"\n}else{\nt.className=\"ImgCheckboxChecked\"\n}};\nAttachContactsTabView.prototype._setRowSelection=function(e,t){\nif(!e){\nreturn\n}\nif(!t){\ne.className=AjxStringUtil.trim(e.className.replace(\"Row-selected\",\"\"))\n}else{\nif(e.className.indexOf(\"Row-selected\")==-1){\ne.className=e.className+\" Row-selected\"\n}}};\nAttachContactsTabView.prototype._searchButtonListener=function(e){\nthis.treeView.deselectAll();\nvar o=Dwt.byId(AttachContactsTabView.ELEMENT_ID_SEARCH_FIELD).value;\nif(o==\"\"){\nreturn\n}\nvar t=this._resetQuery(o);\nthis.executeQuery(t)\n};\nAttachContactsTabView.prototype._navBarListener=function(e){\nvar t=e.item.getData(ZmOperation.KEY_ID);\nthis._paginate(t==ZmOperation.PAGE_FORWARD)\n};\nAttachContactsTabView.prototype._paginate=function(e){\nthis.executeQuery(this._currentQuery,e)\n};\nAttachContactsTabView.prototype.showResultContents=function(n){\nthis._checkboxIdAndItemIdMap=[];\nthis._selectedItemIds={};\nvar t=[];\nvar e={};\nif(n.response&&n.response.SearchResponse&&n.response.SearchResponse.cn){\ne=n.response.SearchResponse;\nt=e.cn\n}\nthis._navTB.enable(ZmOperation.PAGE_BACK,e.offset>0);\nthis._navTB.enable(ZmOperation.PAGE_FORWARD,e.more);\nvar o=t.length;\nif(o==0){\nthis._navTB.setText(\"\")\n}else{\nthis._navTB.setText((this._offset+1)+\"-\"+(this._offset+o))\n}\nthis._setListView(t)\n};\nAttachContactsTabView.prototype._setListView=function(p){\nvar l=[];\nvar y=0;\nif(p.length==0){\nif(!this._noContactsFoundStr){\nthis._noContactsFoundStr=[\"<div padding=5px>\",this.zimlet.getMessage(\"ACZ_NoContactsFound\"),\"</div>\"].join(\"\")\n}\nl[y++]=this._noContactsFoundStr\n}else{\nvar d=[ZmContact.EMAIL_FIELDS,ZmContact.PHONE_FIELDS,ZmContact.IM_FIELDS];\nvar b=true;\nfor(var r=0;\nr<p.length;\nr++){\nvar w=p[r];\nvar m;\ntry{\nm=ZmContact.createFromDom(w,{}\n)\n}\ncatch(f){\ncontinue\n}\nif(!m){\ncontinue\n}\nvar h=(b)?\"RowOdd AttachContactRow\":\"RowEven AttachContactRow\";\nb=!b;\nvar t=ZmContact.computeFileAs(m);\nvar u;\nif(!m.isGroup()){\nu=[];\nfor(var s=0;\ns<d.length;\ns++){\nvar n=this._getFirstWorkingAttr(m.getAttrs(),d[s]);\nif(n){\nu.push(n)\n}}\nvar g=\"attachContactsZimlet_checkbox_\"+w.id;\nvar o=\"attachContactsZimlet_row_\"+w.id;\nl[y++]=\"<div  class='\";\nl[y++]=h;\nl[y++]=\"' id='\";\nl[y++]=o;\nl[y++]=\"'>\";\nl[y++]=\"<table width=100%>\";\nl[y++]=\"<tr>\";\nl[y++]=\"<td width='1px'><div  id='\";\nl[y++]=g;\nl[y++]=\"' class='ImgCheckboxUnchecked'></div></td>\";\nl[y++]=\"<td width='1px'>\";\nl[y++]=AjxImg.getImageHtml(m.getIcon());\nl[y++]=\"</td>\";\nl[y++]=\"<td width='98%'><span style=\\\"font-weight:bold;\\\">\";\nl[y++]=AjxStringUtil.htmlEncode(t||ZmMsg.noName);\nl[y++]=\"</span></td></tr>\";\nfor(var s=0;\ns<u.length;\ns++){\nl[y++]=\"<tr><td></td><td colspan=3>\";\nl[y++]=AjxStringUtil.htmlEncode(u[s]);\nl[y++]=\"</td></tr>\"\n}\nl[y++]=\"</table></div>\"\n}}}\nDwt.setInnerHtml(Dwt.byId(this._folderListId),l.join(\"\"));\nthis._selectionChanged()\n};\nAttachContactsTabView.prototype._selectionChanged=function(){\nif(this.isListenerRegistered(DwtEvent.SELECTION)){\nvar e=new DwtSelectionEvent(true);\ne.button=DwtMouseEvent.LEFT;\ne.target=this;\ne.item=null;\ne.detail=DwtListView.ITEM_SELECTED;\ne.ersatz=true;\nthis.notifyListeners(DwtEvent.SELECTION,e)\n}};\nAttachContactsTabView.prototype._getFirstWorkingAttr=function(s,t){\nvar o=[];\nif(AjxUtil.isArray(t)){\nfor(var n=0;\nn<t.length;\nn++){\nvar e=this._getFirstWorkingAttr(s,t[n]);\nif(e){\nreturn e\n}}}else{\nif(AjxUtil.isString(t)){\nif(s[t]){\nreturn s[t]\n}}}};\nAttachContactsTabView.prototype._handleKeys=function(t){\nvar e=DwtKeyEvent.getCharCode(t);\nreturn !DwtKeyEvent.IS_RETURN[e]\n};\nAttachContactsTabView.prototype.gotAttachments=function(){\nreturn false\n};\nAttachContactsTabView.prototype._getSelectedItems=function(){\nvar e=[];\nfor(var t in this._selectedItemIds){\nif(this._selectedItemIds[t]){\ne.push(t)\n}}\nreturn e\n};\nAttachContactsTabView.prototype.getSelectionCount=function(){\nvar t=0;\nfor(var e in this._selectedItemIds){\nt+=this._selectedItemIds[e]\n}\nreturn t\n};\nAttachContactsTabView.prototype.uploadFiles=function(){\nvar e=appCtxt.getApp(ZmApp.MAIL).getComposeController(appCtxt.getApp(ZmApp.MAIL).getCurrentSessionId(ZmId.VIEW_COMPOSE));\nthis.zimlet.contactIdsToAttach=this._getSelectedItems();\nthis.zimlet._isDrafInitiatedByThisZimlet=true;\ne.saveDraft(ZmComposeController.DRAFT_TYPE_AUTO,null,null,null,this.zimlet.contactIdsToAttach)\n};\nAttachContactsTabView.prototype.showAttachContactsTreeView=function(){\nvar e=new AjxCallback(this,this._showTreeView);\nAjxPackage.undefine(\"zimbraMail.abook.controller.ZmAddrBookTreeController\");\nAjxPackage.require({\nname:[\"ContactsCore\",\"Contacts\"],forceReload:true,callback:e}\n)\n};\nAttachContactsTabView.prototype.reset=function(){\nDwt.byId(AttachContactsTabView.ELEMENT_ID_SEARCH_FIELD).value=\"\";\nvar e=AttachContactsTabView.DEFAULT_CONTACTS_FOLDER;\nthis._currentQuery=this._getQueryFromFolder(e);\nthis.treeView.setSelected(e);\nthis._treeListener()\n};\nAttachContactsTabView.prototype._showTreeView=function(){\nif(appCtxt.isChildWindow){\nZmOverviewController.CONTROLLER.ADDRBOOK=\"ZmAddrBookTreeController\"\n}\nvar o=appCtxt.getApp(ZmApp.CONTACTS);\no._createDeferredFolders();\nvar e=this.toString();\nvar t={\ntreeIds:[\"ADDRBOOK\"],overviewId:(appCtxt.multiAccounts)?([e,this.prevAccount.name].join(\":\")):e,account:this.prevAccount};\nthis._setOverview(t);\nthis.setSize(Dwt.DEFAULT,\"295\");\nthis.reset()\n};\nAttachContactsTabView.prototype._setOverview=function(s){\nvar n=s.overviewId;\nvar r=appCtxt.getOverviewController();\nvar o=r.getOverview(n);\nif(!o){\nvar e={\noverviewId:n,overviewClass:\"AttachContactsTabBox\",headerClass:\"DwtTreeItem\",noTooltips:true,treeIds:s.treeIds};\no=r.createOverview(e);\no.account=this.prevAccount;\nvar t={};\nt[ZmOrganizer.ID_DLS]=true;\no.set(s.treeIds,t)\n}else{\nif(s.account){\no.account=s.account\n}}\nthis._overview=o;\nDwt.byId(this._folderTreeCellId).appendChild(o.getHtmlElement());\nthis.treeView=o.getTreeView(\"ADDRBOOK\");\nthis.treeView.addSelectionListener(this._treeListener.bind(this));\nthis._hideRoot(this.treeView)\n};\nAttachContactsTabView.prototype._treeListener=function(){\nvar e=this.treeView.getSelected();\nif(e){\nvar t=this._getQueryFromFolder(e.id);\nthis.executeQuery(t)\n}};\nAttachContactsTabView.prototype._hideRoot=function(t){\nvar o=t.getTreeItemById(ZmOrganizer.ID_ROOT);\nif(!o){\nvar e=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,this.prevAccount);\no=t.getTreeItemById(e)\n}\no.showCheckBox(false);\no.setExpanded(true);\no.setVisible(false,true)\n};\nAttachContactsTabView.prototype.setSize=function(n,e){\nDwtTabViewPage.prototype.setSize.call(this,n,e);\nvar o=this.getSize();\nvar h=o.x*0.35;\nvar r=o.x-h;\nvar t=e-55;\nthis._overview.setSize(h,t);\nvar s=Dwt.byId(this._folderListId);\ns.style.width=(r-5)+\"px\";\ns.style.height=t+\"px\";\ns.style.overflow=\"auto\";\ns.style.background=\"white\";\nreturn this\n};\nAttachContactsTabView.prototype.executeQuery=function(t,e){\nif(this._limit==undefined){\nthis._limit=50\n}\nif(this._offset==undefined){\nthis._offset=0\n}\nif(e!=undefined){\nif(e){\nthis._offset=this._offset+50\n}else{\nthis._offset=this._offset-50\n}}\nvar o=new AjxCallback(this,this.showResultContents);\nthis._searchContacts({\nquery:this._currentQuery,offset:this._offset,limit:this._limit,callback:o}\n)\n};\nAttachContactsTabView.prototype._searchContacts=function(e){\nvar t={\nSearchRequest:{\n_jsns:\"urn:zimbraMail\"}};\nt.SearchRequest.query=e.query+\" not #type:group\";\nt.SearchRequest.types=\"contact\";\nt.SearchRequest.limit=e.limit;\nt.SearchRequest.offset=e.offset;\nt.SearchRequest.fetch=\"1\";\ne.response=appCtxt.getAppController().sendRequest({\njsonObj:t,noBusyOverlay:false}\n);\nthis.showResultContents(e)\n};\nfunction ZmSecureMail(){\nthis._patchedFcts={};\nthis._active=false\n}\nZmSecureMail.prototype=new ZmZimletBase();\nZmSecureMail.prototype.constructor=ZmSecureMail;\nZmSecureMail.SECUREMAIL_SECURITY_BUTTON_CLASS=\"com_zimbra_securemail\";\nZmSecureMail.SECUREMAIL_PREF_SECURITY=\"MAIL_SECURITY_PREF\";\nZmSecureMail.SECUREMAIL_USER_SECURITY=\"MAIL_USER_SECURITY\";\nZmSecureMail.SECUREMAIL_DONTSIGN=\"none\";\nZmSecureMail.SECUREMAIL_SIGN=\"sign\";\nZmSecureMail.SECUREMAIL_SIGNENCRYPT=\"both\";\nZmSecureMail.SECUREMAIL_SECURITY_TYPES={\nnone:{\nlabel:com_zimbra_securemail.dontSignMessage,className:\"DontSign\"}\n,sign:{\nlabel:com_zimbra_securemail.signMessage,className:\"Sign\"}\n,both:{\nlabel:com_zimbra_securemail.signAndEncryptMessage,className:\"SignEncrypt\"}};\nZmSecureMail.prototype.init=function(){\nif(!appCtxt.get(ZmSetting.MAIL_ENABLED)||!this._hasSMIMEFeature()){\nreturn\n}\nthis._active=true;\nthis.zimletSettings=ZmSecureMailPreferences.registerSettings(this);\nAjxDispatcher.addPackageLoadFunction(\"MailCore\",new AjxCallback(this,this._handleMailCoreLoad));\nAjxDispatcher.addPackageLoadFunction(\"ContactsCore\",new AjxCallback(this,this._handleContactsLoad));\nAjxDispatcher.addPackageLoadFunction(\"Preferences\",new AjxCallback(this,this._handlePreferencesLoad));\nif(appCtxt.isChildWindow){\nthis._handleNewWindowLoad()\n}\nthis._updateZmMsg();\nthis._handleLazyLoad()\n};\nZmSecureMail.prototype.toString=function(){\nreturn\"ZmSecureMail\"\n};\nZmSecureMail.prototype._hasSMIMEFeature=function(){\nvar t=appCtxt.get(ZmSetting.LICENSE_STATUS);\nif(ZmSetting.LICENSE_MSG[t]){\nreturn false\n}\nvar n=appCtxt.getSettings().getInfoResponse.license;\nfor(var o=0;\nn&&o<n.attr.length;\no++){\nvar e=n.attr[o];\nif(e.name==\"SMIME\"){\nreturn e._content==\"TRUE\"\n}}\nreturn false\n};\nZmSecureMail.prototype.initializeToolbar=function(l,u,f,v){\nif(!this._active){\nreturn\n}\nif(v.indexOf(\"COMPOSE\")!=-1){\nvar e;\nvar n=u.getChildren();\nfor(var y=0;\ny<n.length&&!e;\ny++){\nif(Dwt.hasClass(n[y].getHtmlElement(),ZmSecureMail.SECUREMAIL_SECURITY_BUTTON_CLASS)){\ne=n[y];\nbreak\n}}\nvar m;\nvar g=true;\nm=this._getSecuritySetting();\nif(!e){\nvar r=AjxUtil.indexOf(u.opList,ZmOperation.COMPOSE_OPTIONS)+1;\nvar p=Dwt.getNextId()+\"_\"+ZmSecureMail.SECUREMAIL_SECURITY_BUTTON_CLASS;\nvar b=new DwtToolBarButton({\nparent:u,id:p+\"_checkbox\",index:r,className:ZmSecureMail.SECUREMAIL_SECURITY_BUTTON_CLASS+\" ZToolbarButton\"}\n);\nvar s=new DwtMenu({\nparent:b,id:p+\"_menu\",className:\"DwtMenu ZmSecureMailComposeMenu\"}\n);\nvar d=p+\"_menu_sign\";\nb.setMenu(s);\nvar o=new AjxListener(this,this._handleSelectSigning,[b]);\nvar k=new DwtMenuItem({\nparent:s,style:DwtMenuItem.RADIO_STYLE,radioGroupId:d}\n);\nk.setText(com_zimbra_securemail.dontSignMessage);\nk.setImage(ZmSecureMail.SECUREMAIL_SECURITY_TYPES.none.className);\nk.addSelectionListener(o);\nk.setData(\"sign\",ZmSecureMail.SECUREMAIL_DONTSIGN);\nvar w=new DwtMenuItem({\nparent:s,style:DwtMenuItem.RADIO_STYLE,radioGroupId:d}\n);\nw.setText(com_zimbra_securemail.signMessage);\nw.setImage(ZmSecureMail.SECUREMAIL_SECURITY_TYPES.sign.className);\nw.addSelectionListener(o);\nw.setData(\"sign\",ZmSecureMail.SECUREMAIL_SIGN);\nvar h=new DwtMenuItem({\nparent:s,style:DwtMenuItem.RADIO_STYLE,radioGroupId:d}\n);\nh.setText(com_zimbra_securemail.signAndEncryptMessage);\nh.setImage(ZmSecureMail.SECUREMAIL_SECURITY_TYPES.both.className);\nh.addSelectionListener(o);\nh.setData(\"sign\",ZmSecureMail.SECUREMAIL_SIGNENCRYPT);\ns.checkItem(\"sign\",m,true);\nthis._setSecurityImage(b,m);\nb.setEnabled(g)\n}else{\nvar t=e.getMenu();\nif(t){\nt.checkItem(\"sign\",m,true);\nthis._setSecurityImage(e,m)\n}\ne.setEnabled(g)\n}}};\nZmSecureMail.prototype._getSecuritySetting=function(){\nif(appCtxt.isChildWindow){\nreturn window.opener.appCtxt.getZimletMgr().getZimletByName(\"com_zimbra_securemail\").handlerObject._getUserSecuritySetting()\n}else{\nvar e=appCtxt.get(ZmSecureMail.SECUREMAIL_PREF_SECURITY);\nif(e==\"auto\"){\nreturn this.getUserProperty(ZmSecureMail.SECUREMAIL_USER_SECURITY)||ZmSecureMail.SECUREMAIL_DONTSIGN\n}else{\nreturn e\n}}};\nZmSecureMail.prototype._getUserSecuritySetting=function(t,h){\nvar r=appCtxt.getApp(\"Mail\");\nAjxDispatcher.require([\"MailCore\",\"Mail\"]);\nvar e=appCtxt.getAppViewMgr().getCurrentView();\nt=t||(e&&e.isZmComposeView&&e.getController());\nif(!h){\nt=t||r.getComposeController(r.getCurrentSessionId(\"COMPOSE\"))\n}\nvar n=t&&t._toolbar;\nvar o=n&&this._getSecurityButtonFromToolbar(n);\nvar s=o&&o.getMenu();\nif(s){\nreturn s.getSelectedItem().getData(\"sign\")\n}else{\nif(h){\nreturn false\n}else{\nreturn this._getSecuritySetting()\n}}};\nZmSecureMail.prototype._getSecurityButtonFromToolbar=function(o){\nvar t=o.getChildren();\nfor(var e=0;\ne<t.length;\ne++){\nif(Dwt.hasClass(t[e].getHtmlElement(),ZmSecureMail.SECUREMAIL_SECURITY_BUTTON_CLASS)){\nreturn t[e]\n}}};\nZmSecureMail.prototype._setSecurityImage=function(e,t){\nt=t||ZmSecureMail.SECUREMAIL_DONTSIGN;\ne.setImage(ZmSecureMail.SECUREMAIL_SECURITY_TYPES[t].className);\ne.setText(ZmSecureMail.SECUREMAIL_SECURITY_TYPES[t].label)\n};\nZmSecureMail.prototype._handleSelectSigning=function(n,t){\nvar s=t.dwtObj.getData(\"sign\");\nthis._setSecurityImage(n,s);\nthis.setUserProperty(ZmSecureMail.SECUREMAIL_USER_SECURITY,s);\nthis.saveUserProperties();\nvar e=appCtxt.getCurrentView();\nvar o=e&&e.getController&&e.getController();\no.saveDraft(ZmComposeController.DRAFT_TYPE_AUTO);\nthis._manageSendLaterButton()\n};\nZmSecureMail.prototype._shouldSign=function(){\nvar e=this._getUserSecuritySetting();\nreturn e==ZmSecureMail.SECUREMAIL_SIGN||e==ZmSecureMail.SECUREMAIL_SIGNENCRYPT\n};\nZmSecureMail.prototype._shouldEncrypt=function(){\nreturn this._getUserSecuritySetting()==ZmSecureMail.SECUREMAIL_SIGNENCRYPT\n};\nZmSecureMail.prototype._handleMailCoreLoad=function(){\nthis._handleZmMailMsgLoad()\n};\nZmSecureMail.prototype._handleZmMailMsgLoad=function(){\nvar t=this;\nthis.override(\"ZmMailMsg.prototype._sendMessage\",function e(o){\nt._sendMessage(e.func,this,o)\n}\n);\nthis.override(\"ZmMailMsg.prototype._handleResponseSendMessage\",function e(n,o){\nt._handleResponseSendMessage(e.func,this,n,o)\n}\n);\nthis.override(\"ZmMailMsg.prototype._loadFromDom\",function e(o){\nt._loadMsgFromDom(e.func,this,o)\n}\n)\n};\nZmSecureMail.prototype._sendMessage=function(o,n,r){\nvar e=this._shouldSign();\nvar s=this._shouldEncrypt();\nif((e||s)&&r.jsonObj.SendMsgRequest&&appCtxt.getCurrentAppName()==ZmId.APP_MAIL){\nvar t=r.jsonObj.SendMsgRequest;\ndelete r.jsonObj.SendMsgRequest;\nr.jsonObj.SendSecureMsgRequest=t;\nr.jsonObj.SendSecureMsgRequest.sign=e?\"true\":\"false\";\nr.jsonObj.SendSecureMsgRequest.encrypt=s?\"true\":\"false\"\n}\no.apply(n,[r])\n};\nZmSecureMail.prototype._handleResponseSendMessage=function(o,n,s,e){\nif(s.jsonObj.SendSecureMsgRequest){\nvar t=e.getResponse();\ne.set(t.SendSecureMsgResponse);\nif(s.callback){\ns.callback.run(e)\n}}else{\no.call(n,s,e)\n}};\nZmSecureMail.prototype._loadMsgFromDom=function(t,o,e){\nt.call(o,e);\nif(e.certificate){\no.certificate=e.certificate\n}\nif(e.isSigned){\no.isSigned=e.isSigned==\"true\"\n}\nif(e.isEncrypted){\no.isEncrypted=e.isEncrypted==\"true\"\n}\nif(e.decryptionErrorCode){\no.decryptionErrorCode=e.decryptionErrorCode\n}};\nZmSecureMail.prototype.override=function(n,l,o){\nif(this._patchedFcts[n]&&!o){\nreturn\n}else{\nif(!l){\nreturn\n}}\nvar h=n.split(\".\");\nvar e=window;\nfor(var t=0;\nt<h.length-1;\nt++){\ne=e[h[t]];\nif(!e){\nreturn\n}}\nvar r=h[h.length-1];\nvar s=e[r];\nif(s){\ne[r]=function(){\nl.func=s;\nreturn l.apply(this,arguments)\n};\nthis._patchedFcts[n]=true\n}};\nZmSecureMail.prototype.onShowView=function(o){\nif(!this._active){\nreturn\n}\nif(o.indexOf(\"COMPOSE\")!=-1){\nthis._manageSendLaterButton()\n}else{\nif(o.indexOf(ZmId.VIEW_CONTACT_SIMPLE)!=-1){\nvar n=appCtxt.getCurrentView();\nvar t=appCtxt.getCurrentController();\nif(!n._contact){\nreturn\n}\nvar e=n._contact;\nif(e.certificate){\nn.setContact(e,t.isGalSearch())\n}}}};\nZmSecureMail.prototype._manageSendLaterButton=function(){\nvar n=appCtxt.get(ZmSetting.MAIL_SEND_LATER_ENABLED);\nif(n){\nvar e=appCtxt&&appCtxt.getCurrentController();\nvar r=e&&e._toolbar;\nvar o=r.getButton(ZmId.OP_SEND_MENU).getMenu();\nvar s=o.getMenuItem(ZmId.OP_SEND_LATER);\nvar t=this._getUserSecuritySetting();\nif(t!=ZmSecureMail.SECUREMAIL_DONTSIGN){\ns.setEnabled(false)\n}else{\ns.setEnabled(true)\n}}};\nZmSecureMail.prototype.onMsgView=function(n,u,l){\nif(!this._active){\nreturn\n}\nif(n&&n.type==ZmId.ITEM_MSG){\nif((n.isSigned||n.isEncrypted)&&!n.decryptionErrorCode){\nvar d=l._hdrTableId;\nif(!d){\nreturn\n}\nvar o=Dwt.byId(d);\nvar m=o.insertRow();\nvar s=m.insertCell(0);\nvar e=m.insertCell(1);\ns.innerHTML=com_zimbra_securemail.security+\":\";\ns.className=\"LabelColName\";\ne.className=\"LabelColValue ZmSecureMailCertificateRow\";\nvar t=new DwtComposite({\nparent:l}\n);\nt.reparentHtmlElement(e);\nvar r={\nparent:t,type:\"MSG\",certificates:n.certificate||[],isSigned:n.isSigned,isEncrypted:n.isEncrypted};\nnew ZmSecureCertificatePreview(r)\n}else{\nif(n.decryptionErrorCode){\nvar d=l._hdrTableId;\nif(!d){\nreturn\n}\nvar o=Dwt.byId(d);\nvar m=o.insertRow();\nvar s=m.insertCell(0);\nvar e=m.insertCell(1);\ns.innerHTML=com_zimbra_securemail.security+\":\";\ns.className=\"LabelColName\";\ne.className=\"LabelColValue ZmSecureMailCertificateRow\";\nvar h=new DwtLabel({\nparent:l,style:DwtLabel.IMAGE_LEFT,className:\"invalid_cert_wrapper\"}\n);\nh.reparentHtmlElement(e);\nh.setImage(\"Invalid\");\nh.setText(com_zimbra_securemail[\"decryptionError.\"+n.decryptionErrorCode]||com_zimbra_securemail[\"decryptionError.DECRYPTION_FAILED\"])\n}}\nthis._hideRemoveAttachmentLinks(n,l)\n}};\nZmSecureMail.prototype.onMsgExpansion=function(t,e){\nthis.onMsgView(t,null,e)\n};\nZmSecureMail.prototype._handleContactsLoad=function(){\nvar t=this;\nthis.override(\"ZmContact.prototype._addRequestAttr\",function e(s,o,n){\nreturn t._addContactRequestAttr(e.func,this,s,o,n)\n}\n);\nthis.override(\"ZmEditContactView.prototype.getModifiedAttrs\",function e(){\nreturn t._getContactModifiedAttrs(e.func,this)\n}\n);\nthis.override(\"ZmEditContactView.prototype.__initRowsOther\",function e(n,h,s,o,r){\nreturn t.__initContactRowsOther(e.func,this,n,h,s,o,r)\n}\n);\nthis.override(\"ZmContact.prototype._loadFromDom\",function e(o){\nt._loadContactFromDom(e.func,this,o)\n}\n);\nthis.override(\"ZmContact.createFromDom\",function e(n,o){\nreturn t._createContactFromDom(e.func,n,o)\n}\n);\nthis.override(\"ZmContactSplitView._showContactListItem\",function e(o){\nreturn t._showContactListItem(e.func,this,o)\n}\n)\n};\nZmSecureMail.prototype._addContactRequestAttr=function(o,s,r,t,n){\nif(t==\"userCertificate\"&&AjxUtil.isString(n)&&n.length){\nif(n.indexOf(\"aid_\")!=-1){\nvar e={\nn:t};\ne.aid=n.substring(4);\nr.a.push(e)\n}else{\no.call(s,r,t,n)\n}}else{\no.call(s,r,t,n)\n}};\nZmSecureMail.prototype._getContactModifiedAttrs=function(t,o){\nvar e=t.call(o)||{};\nif(o.newCertificate){\ne.userCertificate=\"aid_\"+o.newCertificate\n}else{\nif(o.newCertificate===null){\ne.userCertificate=\"\"\n}}\nreturn e\n};\nZmSecureMail.prototype.__initContactRowsOther=function(o,r,t,l,n,e,s){\nvar h=AjxUtil.hashCopy(t);\ndelete h.userCertificate;\nreturn o.call(r,h,l,n,e,s)\n};\nZmSecureMail.prototype._loadContactFromDom=function(t,n,e){\nif(!(n instanceof ZmContact)){\nreturn\n}\nt.call(n,e);\nif(e.certificate){\nn.certificate=e.certificate\n}\nvar o=new AjxListener(this,this._onContactUpdate);\nn.addChangeListener(o)\n};\nZmSecureMail.prototype._createContactFromDom=function(n,o,t){\nn(o,t);\nvar e=appCtxt.cacheGet(o.id);\nif(e&&o.certificate){\ne.certificate=o.certificate;\nvar s=new AjxListener(this,this._onContactUpdate);\ne.addChangeListener(s)\n}\nreturn e\n};\nZmSecureMail.prototype._showContactListItem=function(e,t,o){\nif(o.name==\"userCertificate\"){\nreturn\"\"\n}else{\nreturn e.call(t,o)\n}};\nZmSecureMail.prototype.onContactView=function(e,o){\nif(!this._active){\nreturn\n}\nif(appCtxt.getCurrentViewType()!=ZmId.VIEW_CONTACT_SIMPLE&&!e.certificate){\nreturn\n}\nvar n=appCtxt&&appCtxt.getCurrentView&&appCtxt.getCurrentView()._detailsId;\nif(!n){\nreturn\n}\nvar s=Dwt.byClassName(\"headerRow\",Dwt.byId(n));\ns=s&&s[0];\ns=Dwt.byClassName(\"rowValue\",s);\ns=s&&s[0];\nvar t=new DwtComposite({\nparent:appCtxt.getCurrentView(),className:\"contactHeaderCertRow\"}\n);\nt.reparentHtmlElement(s);\nvar r={\ntype:\"CONTACT_VIEW\",parent:t,certificates:e.certificate};\nnew ZmSecureCertificatePreview(r)\n};\nZmSecureMail.prototype.onContactEdit=function(u,l,h){\nif(!this._active){\nreturn\n}\nvar n=Dwt.byId(u.getHTMLElId()+\"_EMAIL\");\nvar m=n.parentNode.parentNode;\nvar s=m.parentNode.parentNode;\nvar f=s.insertRow(m.rowIndex+1);\nvar o=f.insertCell(0);\nvar e=f.insertCell(1);\no.innerHTML=com_zimbra_securemail.certificate+\":\";\no.className=\"rowLabel\";\ne.className=\"rowValue\";\nvar t=new DwtComposite({\nparent:u}\n);\nt.reparentHtmlElement(e);\nvar r={\nparent:t,contact:l,type:\"CONTACT\"};\nvar d=new ZmSecureCertificateManager(r);\nd.loadCertificate()\n};\nZmSecureMail.prototype._onContactUpdate=function(e){\nif(e.type!=ZmId.ITEM_CONTACT||e.event!=ZmEvent.E_MODIFY){\nreturn\n}\nif(e._details&&e._details._attrs&&e._details._attrs.userCertificate){\ne.item.certificate=e._details.certificate\n}else{\nif(e.item.getAttr&&e.item.getAttr(\"userCertificate\")==\"\"){\ne.item.certificate=null\n}}};\nZmSecureMail.prototype._handleNewWindowLoad=function(){\nvar t=this;\nthis.override(\"ZmNewWindow.prototype._deepCopyMsg\",function e(o){\nreturn t._deepCopyMsgForNewWindow(e.func,this,o)\n}\n)\n};\nZmSecureMail.prototype._deepCopyMsgForNewWindow=function(t,o,n){\nvar e=t.call(o,n);\nif(n.certificate){\ne.certificate=n.certificate\n}\nreturn e\n};\nZmSecureMail.prototype._updateZmMsg=function(){\nif(!window.ZmMsg){\nZmMsg={}\n}\nvar e=[\"smime.ENCRYPTION_FAILED\",\"smime.SIGNING_FAILED\",\"smime.RECIPIENT_SMIME_CERT_NOT_FOUND\",\"smime.MSG_ENCRYPTION_FAILED\",\"smime.MSG_SIGNING_FAILED\",\"smime.LOAD_CERTIFICATE_FAILED\",\"smime.USER_CERT_NOT_YET_VALID\",\"smime.CERT_VALIDATION_FAILED\",\"smime.USER_CERT_EXPIRED\",\"smime.USER_CERT_REVOKED\",\"smime.USER_CERT_EMAIL_ADDRESS_NOT_MATCHING\",\"smime.USER_CERT_NOT_TRUSTED\",\"smime.OPERATION_DENIED\",\"smime.DELEGATE_SEND_SECURE_PERM_DENIED\"];\ne.forEach(function(t){\nZMsg[t]=com_zimbra_securemail[t]\n}\n)\n};\nZmSecureMail.prototype.onSendMsgFailure=function(n,e,r){\nvar o=e&&e.code;\nif(o){\nvar t=[\"smime.LOAD_CERTIFICATE_FAILED\",\"smime.USER_CERT_NOT_YET_VALID\",\"smime.CERT_VALIDATION_FAILED\",\"smime.USER_CERT_EXPIRED\",\"smime.USER_CERT_REVOKED\",\"smime.USER_CERT_EMAIL_ADDRESS_NOT_MATCHING\",\"smime.USER_CERT_NOT_TRUSTED\",\"smime.RECIPIENT_SMIME_CERT_NOT_FOUND\"];\nif(t.indexOf(o)>-1){\nvar s=this._shouldEncrypt();\nif(s){\nZMsg[o]=ZMsg[\"smime.ENCRYPTION_FAILED\"]+\" \"+com_zimbra_securemail[o]\n}else{\nZMsg[o]=ZMsg[\"smime.SIGNING_FAILED\"]+\" \"+com_zimbra_securemail[o]\n}\nif(o==\"smime.RECIPIENT_SMIME_CERT_NOT_FOUND\"){\nZMsg[o]=AjxMessageFormat.format(ZMsg[o],[e.msg])\n}\nif(appCtxt.isChildWindow){\ne.getErrorMsg=function(){\nreturn e.message\n};\ne.message=ZMsg[o];\ne.msg=ZMsg[o]\n}}\nif(o==ZmCsfeException.SVC_UNKNOWN_DOCUMENT){\ne.getErrorMsg=function(){\nreturn com_zimbra_securemail[\"smime.SERVER_EXTENSION_NOT_INSTALLED\"]\n}\n}}};\nZmSecureMail.prototype._handlePreferencesLoad=function(){\nZmSecureMailPreferences.init(this)\n};\nZmSecureMail.prototype._handleLazyLoad=function(){\nvar e=appCtxt.getCurrentAppName();\nif(e===ZmApp.MAIL){\nthis._handleLazyLoadMail()\n}else{\nif(e===ZmApp.CONTACTS){\nthis._handleLazyLoadContact()\n}}};\nZmSecureMail.prototype._handleLazyLoadMail=function(){\nvar n=appCtxt.getCurrentView();\nvar e=appCtxt.getCurrentController();\nvar o=e&&e.getMsg&&e.getMsg();\nif(!o){\nreturn\n}\nif(n instanceof ZmMailMsgView){\nthis.onMsgView(o,null,n)\n}else{\nif(n instanceof ZmConvView2){\nAjxUtil.foreach(n._msgViews,function(s){\nthis.onMsgView(o,null,s)\n}\n.bind(this))\n}else{\nif(n instanceof ZmTradView){\nvar t=n.getMsgView();\nthis.onMsgView(o,null,t)\n}else{\nif(n instanceof ZmConvDoublePaneView){\nvar t=n.getMsgView();\nAjxUtil.foreach(t._msgViews,function(s){\nthis.onMsgView(o,null,s)\n}\n.bind(this))\n}}}}};\nZmSecureMail.prototype._handleLazyLoadContact=function(){\nvar o=appCtxt.getCurrentView();\nvar t=appCtxt.getCurrentController();\nif(!o._contact){\nreturn\n}\nvar e=o._contact;\nif(e.certificate){\ne.removeAttr(\"userCertificate\");\ne.addChangeListener(new AjxListener(this,this._onContactUpdate))\n}\nif(o instanceof ZmContactSplitView){\nif(e.certificate){\no.setContact(e,t.isGalSearch())\n}\nthis.onContactView(e)\n}else{\nif(o instanceof ZmEditContactView){\nif(e.certificate){\no.set(e)\n}\nthis.onContactEdit(o,e)\n}}};\nZmSecureMail.prototype._hideRemoveAttachmentLinks=function(s,o){\nif(s&&!s.isEncrypted){\nreturn\n}\nvar n=Dwt.byId(o._viewId+\"_removeAll\");\nif(n){\nvar t=this.closest(n,\"tr\");\nt&&(t.outerHTML=\"\")\n}\nvar e=document.querySelectorAll('[id^=\"'+o._attLinksId+'_\"][id$=\"_'+ZmMailMsgView.ATT_LINK_REMOVE+'\"]');\nAjxUtil.foreach(e,function(r){\nif(r.previousSibling&&r.previousSibling.nodeType===3){\nr.previousSibling.nodeValue.indexOf(\"|\")>-1&&(r.previousSibling.nodeValue=\"\")\n}\nr.outerHTML=\"\"\n}\n)\n};\nZmSecureMail.prototype.closest=function(o,e){\nvar n=\"matches\";\n[\"matches\",\"webkitMatchesSelector\",\"mozMatchesSelector\",\"msMatchesSelector\",\"oMatchesSelector\"].some(function(s){\nif(typeof document.body[s]==\"function\"){\nn=s;\nreturn true\n}\nreturn false\n}\n);\nvar t;\nwhile(o){\nt=o.parentElement;\nif(t&&t[n](e)){\nreturn t\n}\no=t\n}\nreturn null\n};\nZmSecureMailPreferences=function(o,n,t,e){\nif(!arguments.length){\nreturn\n}\nthis._handler=e;\nthis._certificateWidget=null;\nZmPreferencesPage.call(this,o,n,t)\n};\nZmSecureMailPreferences.SECURITY=\"MAIL_SECURITY_PREF\";\nAjxDispatcher.addPackageLoadFunction(\"Preferences\",new AjxCallback(function(){\nZmSecureMailPreferences.prototype=new ZmPreferencesPage;\nZmSecureMailPreferences.prototype.constructor=ZmSecureMailPreferences;\nZmSecureMailPreferences.prototype.toString=function(){\nreturn\"ZmSecureMailPreferences\"\n};\nZmSecureMailPreferences.prototype.setSettingsName=function(e){\nthis._settings=e\n};\nZmSecureMailPreferences.prototype.getSettingsName=function(){\nreturn this._settings||[]\n};\nZmSecureMailPreferences.prototype.getPostSaveCallback=function(){\nreturn new AjxCallback(this,this._doPostSave)\n};\nZmSecureMailPreferences.prototype._doPostSave=function(){\nvar o=this.getSettingsName();\nvar s=appCtxt.getSettings();\nfor(var e=0;\ne<o.length;\ne++){\nvar t=s.getSetting(o[e]);\nvar n=t.getValue();\nthis._handler.setUserProperty(t.id,n);\nt.origValue=n\n}\nthis._controller.setDirty(this._section.id,false);\nthis._handler.saveUserProperties()\n};\nZmSecureMailPreferences.prototype.showMe=function(){\nZmPreferencesPage.prototype.showMe.apply(this);\nthis._initCertificateWidget()\n};\nZmSecureMailPreferences.prototype._initCertificateWidget=function(){\nvar o=this.getHTMLElId();\nif(this._certificateWidget&&this._certificateWidget instanceof DwtComposite){\nreturn\n}\nthis._certificateWidget=new DwtComposite({\nparent:this}\n);\nthis._certificateWidget.reparentHtmlElement(o+\"_CertificateContainer\");\nvar t={\nparent:this._certificateWidget,type:\"PREF\"};\nvar e=new ZmSecureCertificateManager(t);\ne.loadCertificate()\n}\n}\n));\nZmSecureMailPreferences.registerPreferences=function registerPreferences(n,e){\nvar s=function(r){\nreturn com_zimbra_securemail[r]\n};\nZmPref.registerPref(ZmSecureMailPreferences.SECURITY,{\ndisplayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[s(\"prefSecurityAuto\"),s(\"prefSecurityNone\"),s(\"prefSecuritySign\"),s(\"prefSecurityBoth\")],options:[\"auto\",\"none\",\"sign\",\"both\"]}\n);\nvar o=appCtxt.getSettings().getSetting(ZmSecureMailPreferences.SECURITY).getValue();\nZmPref.setFormValue(ZmSecureMailPreferences.SECURITY,o);\nvar t={\ntitle:s(\"prefSection\"),icon:\"ZmSecureEmail\",templateId:\"ZmSecureMail#Preferences\",priority:49,manageChanges:false,manageDirty:true,prefs:n,createView:function(d,l,r){\nvar h=new ZmSecureMailPreferences(d,l,r,e);\nh.setSettingsName(n);\nreturn h\n}};\nZmPref.registerPrefSection(\"SECURITY\",t)\n};\nZmSecureMailPreferences.registerSettings=function(e){\nvar n=appCtxt.getSettings();\nvar o=[];\nvar t=[];\nvar s=n.registerSetting(ZmSecureMailPreferences.SECURITY,{\ntype:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:\"auto\"}\n);\nt.push(s);\no.push(ZmSecureMailPreferences.SECURITY);\nt.forEach(function(h){\nvar r=e.getUserProperty(h.id);\nh.setValue(r)\n}\n);\nreturn o\n};\nZmSecureMailPreferences.init=function(e){\nZmSecureMailPreferences.registerPreferences(e.zimletSettings,e)\n};\nZmCertificatePasswordDialog=function(e){\nif(!e){\nreturn\n}\nZmDialog.call(this,{\nparent:e.parent,className:\"ZmCertificatePasswordDialog\",title:this.getLabel(\"passwordDialogTitle\"),id:\"CertificatePasswordDialog\",disposeOnPopDown:true}\n);\nthis._okCallback=e.okCallback;\nthis._cancelCallback=e.cancelCallback;\nthis._session=e.session||{};\nthis._setNameField(this._nameFieldId);\nthis.setSize(400,150);\nthis._createControls()\n};\nZmCertificatePasswordDialog.prototype=new ZmDialog;\nZmCertificatePasswordDialog.prototype.constructor=ZmCertificatePasswordDialog;\nZmCertificatePasswordDialog.prototype.toString=function(){\nreturn\"ZmCertificatePasswordDialog\"\n};\nZmCertificatePasswordDialog.prototype.popup=function(e){\nZmDialog.prototype.popup.call(this);\ne?this.setErrorMsg():this.resetErrorMsg();\nthis.reset();\nthis._toggleOKButton(false)\n};\nZmCertificatePasswordDialog.prototype.getLabel=function(e){\nreturn com_zimbra_securemail[e]\n};\nZmCertificatePasswordDialog.prototype.setErrorMsg=function(){\nthis.reset();\nthis._toggleOKButton(false);\nif(this._errorEl){\nthis._errorEl.innerHTML=this.getLabel(\"passwordDialogError\")\n}};\nZmCertificatePasswordDialog.prototype.resetErrorMsg=function(){\nif(this._errorEl){\nthis._errorEl.innerHTML=\"\"\n}};\nZmCertificatePasswordDialog.prototype._createControls=function(){\nthis._toggleOKButton(false);\nvar t=this.getButton(DwtDialog.CANCEL_BUTTON);\nt.setText(this.getLabel(\"passwordDialogCancel\"));\nthis.setButtonListener(DwtDialog.CANCEL_BUTTON,new AjxListener(this,this._cancelButtonListener));\nvar e=this.getButton(DwtDialog.OK_BUTTON);\ne.setText(this.getLabel(\"passwordDialogSubmit\"));\nDwt.setHandler(this._nameField,DwtEvent.ONKEYUP,this._handleKeyUp.bind(this))\n};\nZmCertificatePasswordDialog.prototype._okButtonListener=function(e){\nthis._session.password=this._nameField.value;\nthis._okCallback&&this._okCallback.run(this._session)\n};\nZmCertificatePasswordDialog.prototype._cancelButtonListener=function(e){\nthis._cancelCallback&&this._cancelCallback.run();\nthis.popdown()\n};\nZmCertificatePasswordDialog.prototype._enterListener=function(e){\nvar t=this._nameField.value;\nif(t&&t.length>0){\nthis._okButtonListener()\n}};\nZmCertificatePasswordDialog.prototype._handleKeyUp=function(o){\nvar e=DwtKeyEvent.getCharCode(o);\nif(e===DwtKeyEvent.KEY_TAB){\nreturn\n}\nvar t=DwtUiEvent.getTarget(o);\nvar n=t&&t.value;\nthis._toggleOKButton(n.length>0)\n};\nZmCertificatePasswordDialog.prototype._toggleOKButton=function(e){\nvar t=this.getButton(DwtDialog.OK_BUTTON);\nt.setEnabled(e)\n};\nZmCertificatePasswordDialog.prototype._getButtonsContainerStartTemplate=function(){\nreturn\"<table role='presentation' class='ZmCertificateDialogButtonsContainer'><tr>\"\n};\nZmCertificatePasswordDialog.prototype._contentHtml=function(){\nthis._nameFieldId=this._htmlElId+\"_password\";\nvar e={\nid:this._htmlElId,labelPasswd:this.getLabel(\"passwordDialogInputLabel\")};\nreturn AjxTemplate.expand(\"ZmSecureMail#ZmCertificatePasswordDialog\",e)\n};\nZmCertificatePasswordDialog.prototype._createHtmlFromTemplate=function(o,s){\nDwtBaseDialog.prototype._createHtmlFromTemplate.call(this,o,s);\nvar n=s.id+\"_focus\";\nif(document.getElementById(n)){\nthis._focusElementId=n\n}\nthis._buttonsEl=document.getElementById(s.id+\"_buttons\");\nif(this._buttonsEl){\nvar t=[\"<span id='certificatePasswordError'>\",\"</span>\"];\nvar e=2;\nthis._addButtonsHtml(t,e);\nthis._buttonsEl.innerHTML=t.join(\"\");\nthis._errorEl=document.getElementById(\"certificatePasswordError\")\n}};\nZmSecureCertificateUpload=function(e){\nif(!e){\nreturn\n}\nDwtComposite.call(this,e);\nthis.parent=e.parent||null;\nthis.type=e.type||null;\nthis.uploadDoneCallback=e.uploadDoneCallback||null;\nthis.uploadStartCallback=e.uploadStartCallback||null;\nthis.uploadFailedCallback=e.uploadFailedCallback||null;\nthis.hideHelpTextLabel=e.hideHelpTextLabel||false;\nthis._browseBtn=null;\nthis._helpTextLabel=null;\nthis.bubbleContainer=null;\nthis._validFileTypes=this._getValidFileTypes()\n};\nZmSecureCertificateUpload.prototype=new DwtComposite();\nZmSecureCertificateUpload.prototype.constructor=ZmSecureCertificateUpload;\nZmSecureCertificateUpload.TEMPLATE=\"ZmSecureMail#UploadWidget\";\nZmSecureCertificateUpload.prototype.render=function(){\nvar n=this.getHTMLElId();\nvar o=ZmDragAndDrop.isSupported();\nvar t=this._validFileTypes;\nvar e=t.lastIndexOf(\",\");\nif(e>-1){\nt=\"<em>\"+t.substring(0,e)+\"</em> \"+com_zimbra_securemail.uploadOptionsAnd+\" <em>\"+t.substring(e+1)+\"</em>\"\n}else{\nt=\"<em>\"+t+\"</em>\"\n}\nthis.parent._createHtmlFromTemplate(ZmSecureCertificateUpload.TEMPLATE,{\nid:n,supportDnD:o,validFileTypes:t}\n);\nthis._browseBtn=new DwtButton({\nparent:this.parent}\n);\nthis._browseBtn.setText(com_zimbra_securemail.browseBtnLabel);\nthis._browseBtn.reparentHtmlElement(n+\"_UploadCertificateBtn\");\nthis._browseBtn.setToolTipContent(com_zimbra_securemail.browseBtnLabel,true);\nthis._browseBtn.addSelectionListener(this.showBrowseWindow.bind(this));\nif(!this.hideHelpTextLabel){\nthis._helpTextLabel=new DwtLabel({\nparent:this.parent}\n);\nthis._helpTextLabel.reparentHtmlElement(n+\"_CertificateHelpText\");\nthis._helpTextLabel.setText(com_zimbra_securemail.certificateHelpText)\n}\nif(o){\nthis.dndContainer=new DwtComposite({\nparent:this.parent}\n);\nthis.dndContainer.replaceElement(n+\"_UploadCertificateDnDBtn\");\nthis.dndContainer.setContent(com_zimbra_securemail.dragDropLabel);\nthis.addDragDropHandlers(this.dndContainer.getHtmlElement());\nthis.bubbleContainer=this.dndContainer\n}else{\nthis.bubbleContainer=new DwtComposite({\nparent:this.parent}\n);\nthis.bubbleContainer.replaceElement(n+\"_certificateBubbleContainer\")\n}};\nZmSecureCertificateUpload.prototype.addDragDropHandlers=function(e){\nDwt.setHandler(e,\"ondragover\",this._onDragOver.bind(this));\nDwt.setHandler(e,\"ondrop\",this._onDrop.bind(this))\n};\nZmSecureCertificateUpload.prototype._onDragOver=function(e){\ne.preventDefault();\nreturn false\n};\nZmSecureCertificateUpload.prototype._onDrop=function(e){\nif(e.stopPropagation){\ne.stopPropagation()\n}\nthis._uploadFile(e.dataTransfer);\nreturn false\n};\nZmSecureCertificateUpload.prototype.showBrowseWindow=function(){\nif(AjxEnv.supportsHTML5File){\nvar e=ZmSecureCertificateUpload.FILE_INPUT;\nif(e){\ne.value=\"\"\n}else{\nZmSecureCertificateUpload.FILE_INPUT=e=document.createElement(\"INPUT\");\ne.type=\"file\";\ne.title=ZmMsg.uploadNewFile;\ne.multiple=false;\ne.style.display=\"none\";\ndocument.body.appendChild(e)\n}\ne.accept=this._validFileTypes;\ne.onchange=this._uploadFile.bind(this,e);\ne.click()\n}};\nZmSecureCertificateUpload.prototype._uploadFile=function(h){\nh=h.files;\nvar s=0;\nif(h.length){\nfor(var t=0;\nt<h.length;\nt++){\nvar n=h[t];\ns+=n.size||n.fileSize||0;\nif((-1!=appCtxt.get(ZmSetting.MESSAGE_SIZE_LIMIT))&&(s>appCtxt.get(ZmSetting.MESSAGE_SIZE_LIMIT))){\nvar o=appCtxt.getMsgDialog();\nvar r=AjxMessageFormat.format(ZmMsg.attachmentSizeError,AjxUtil.formatSize(appCtxt.get(ZmSetting.MESSAGE_SIZE_LIMIT)));\no.setMessage(r,DwtMessageDialog.WARNING_STYLE);\no.popup();\nreturn false\n}}\nvar l={\nattachment:false,files:h,notes:\"\",allResponses:null,start:0,curView:null,preAllCallback:null,initOneUploadCallback:this._handleUploadStart.bind(this,h),progressCallback:null,errorCallback:this._handleUploadFailed.bind(this,h),completeOneCallback:null,completeAllCallback:this._handleUploadDone.bind(this,h)};\nvar e=appCtxt.getZmUploadManager();\ne.upload(l)\n}};\nZmSecureCertificateUpload.prototype._handleUploadStart=function(e){\nthis._browseBtn.setEnabled(false);\nif(!this.hideHelpTextLabel){\nthis._helpTextLabel.setText(com_zimbra_securemail.certificateUploadingHelpText)\n}\nthis.uploadStartCallback&&this.uploadStartCallback.run()\n};\nZmSecureCertificateUpload.prototype._handleUploadDone=function(n,o){\nvar e=o&&o[0];\nvar t=n&&n[0];\nvar r=e&&e.aid;\nthis._browseBtn.setEnabled(true);\nif(r){\nvar s={\nfile:t,uploadId:r};\nthis.uploadDoneCallback&&this.uploadDoneCallback.run(s)\n}};\nZmSecureCertificateUpload.prototype._handleUploadFailed=function(e){\nthis._browseBtn.setEnabled(true);\nif(!this.hideHelpTextLabel){\nthis._helpTextLabel.setText(com_zimbra_securemail.certificateHelpText)\n}\nthis.uploadFailedCallback&&this.uploadFailedCallback.run()\n};\nZmSecureCertificateUpload.prototype._createSelectionBubble=function(n){\nn.id=this.getHTMLElId();\nvar o=AjxTemplate.expand(\"ZmSecureMail#UploadBubble\",n);\nthis.bubbleContainer.setContent(o);\nvar t=document.querySelector(\"#\"+this.getHTMLElId()+\"_ZmSecureMailUploadContainer .CertificateBubbleClose\");\nt&&Dwt.setHandler(t,DwtEvent.ONCLICK,this._removeSelectionBubble.bind(this,n));\nvar e=document.querySelector(\"#\"+this.getHTMLElId()+\"_ZmSecureMailUploadContainer .ZmSecureSaveToCompleteLabel\");\nDwt.setDisplay(e,Dwt.DISPLAY_TABLE_CELL)\n};\nZmSecureCertificateUpload.prototype._removeSelectionBubble=function(t){\nthis.bubbleContainer.clear();\nthis.dndContainer&&this.dndContainer.setContent(com_zimbra_securemail.dragDropLabel);\nvar e=document.querySelector(\"#\"+this.getHTMLElId()+\"_ZmSecureMailUploadContainer .ZmSecureSaveToCompleteLabel\");\nDwt.setVisible(e,false);\nt.removeCallback&&t.removeCallback()\n};\nZmSecureCertificateUpload.prototype._getValidFileTypes=function(){\nif(this.type){\nvar e;\nswitch(this.type){\ncase\"PREF\":e=\"zimbraSmimeUserCertificateExtensions\";\nbreak;\ncase\"CONTACT\":e=\"zimbraSmimePublicCertificateExtensions\";\nbreak\n}\nif(e){\nvar o=appCtxt.getSettings().getInfoResponse&&appCtxt.getSettings().getInfoResponse.attrs&&appCtxt.getSettings().getInfoResponse.attrs._attrs;\nvar t=o&&o[e];\nt=t instanceof Array?t:[t];\nreturn t.map(function(n){\nreturn\".\"+n\n}\n).join(\", \")\n}}};\nZmSecureCertificateManager=function(e){\nif(!e&&!e.type){\nreturn\n}\nDwtComposite.call(this,e);\nthis.parent=e.parent||null;\nthis.type=e.type&&e.type.toUpperCase();\nthis.contact=e.contact||null;\nthis._passwordDialog=null;\nthis.uploadCertificateWidget=null;\nswitch(this.type){\ncase\"PREF\":this._initPrefUploader();\nbreak;\ncase\"CONTACT\":this._initContactUploader();\nbreak;\ndefault:this._initPrefUploader()\n}};\nZmSecureCertificateManager.prototype=new DwtComposite();\nZmSecureCertificateManager.prototype.constructor=ZmSecureCertificateManager;\nZmSecureCertificateManager.prototype._initPrefUploader=function(){\nvar e={\nparent:this.parent,type:this.type,uploadDoneCallback:new AjxCallback(this,this._saveUserCertificateRequest)};\nthis.uploadCertificateWidget=new ZmSecureCertificateUpload(e)\n};\nZmSecureCertificateManager.prototype._initContactUploader=function(){\nvar e={\nparent:this.parent,hideHelpTextLabel:true,type:this.type,uploadDoneCallback:new AjxCallback(this,this._saveContactCertificateRequest)};\nthis.uploadCertificateWidget=new ZmSecureCertificateUpload(e)\n};\nZmSecureCertificateManager.prototype.loadCertificate=function(){\nswitch(this.type){\ncase\"PREF\":this._loadUserCertificates();\nbreak;\ncase\"CONTACT\":this._loadContactCertificate();\nbreak;\ndefault:this._loadUserCertificates()\n}};\nZmSecureCertificateManager.prototype._loadUserCertificates=function(){\nthis._certificates=null;\nthis.parent.setContent(com_zimbra_securemail.certificateLoadingHelpText);\nvar e=AjxSoapDoc.create(\"GetSmimeCertificateInfoRequest\",\"urn:zimbraAccount\");\nappCtxt.getAppController().sendRequest({\nsoapDoc:e,asyncMode:true,callback:new AjxCallback(this,this._handleLoadUserCertificates),errorCallback:new AjxCallback(this,this._handleLoadUserCertificatesError)}\n)\n};\nZmSecureCertificateManager.prototype._handleLoadUserCertificates=function(e){\nthis.parent.clear();\nvar t=e&&e.getResponse&&e.getResponse();\nt=t.GetSmimeCertificateInfoResponse;\nif(t&&t.certificate){\nvar o=t&&t.certificate;\nvar n={\nparent:this.parent,certificates:o,type:\"PREF\",removeCertificateHandler:this._confirmRemoveCertificate.bind(this)};\nnew ZmSecureCertificatePreview(n)\n}else{\nthis.uploadCertificateWidget.render()\n}};\nZmSecureCertificateManager.prototype._handleLoadUserCertificatesError=function(e){\nthis.uploadCertificateWidget.render();\nif(e&&e.code==ZmCsfeException.SVC_UNKNOWN_DOCUMENT){\ne.getErrorMsg=function(){\nreturn com_zimbra_securemail[\"smime.SERVER_EXTENSION_NOT_INSTALLED\"]\n}\n}};\nZmSecureCertificateManager.prototype._saveUserCertificateRequest=function(o){\nif(!o){\nreturn new DwtException(\"Missing Params\",DwtException.INVALID_PARAM)\n}\nvar t=AjxSoapDoc.create(\"SaveSmimeCertificateRequest\",\"urn:zimbraAccount\");\nif(o.uploadId){\nvar e=t.set(\"upload\");\ne.setAttribute(\"id\",o.uploadId)\n}\nif(o.password){\nt.set(\"password\",o.password)\n}\nappCtxt.getAppController().sendRequest({\nsoapDoc:t,asyncMode:true,callback:new AjxCallback(this,this._handleUserSaveCertificateRequest),errorCallback:new AjxCallback(this,this._handleUserSaveCertificateException)}\n)\n};\nZmSecureCertificateManager.prototype._handleUserSaveCertificateRequest=function(e){\nthis._disposePasswordDialog();\nthis._loadUserCertificates()\n};\nZmSecureCertificateManager.prototype._handleUserSaveCertificateException=function(n){\nvar r=null;\nswitch(n.code){\ncase\"smime.INVALID_CERTIFICATE\":case\"smime.CERT_VALIDATION_FAILED\":r=com_zimbra_securemail.invalidCertificateUploaded;\nbreak;\ncase\"smime.CERT_ALREADY_EXISTS\":r=com_zimbra_securemail.duplicateCertificateUploaded;\nbreak;\ncase\"smime.PASSWORD_REQUIRED\":var t=AjxSoapDoc.createFromXml(n.request).getDoc();\nvar e=t.getElementsByTagName(\"upload\")[0];\nvar s={\nparent:appCtxt.getShell(),session:{\nuploadId:e.getAttribute(\"id\")}\n,okCallback:new AjxCallback(this,this._saveUserCertificateRequest.bind(this)),cancelCallback:new AjxCallback(this,this._cancelPasswordDialog.bind(this))};\nthis._passwordDialog=new ZmCertificatePasswordDialog(s);\nthis._passwordDialog.popup();\nreturn true;\nbreak;\ncase\"smime.INVALID_PASSWORD\":if(this._passwordDialog){\nthis._passwordDialog.setErrorMsg()\n}\nreturn true;\nbreak;\ncase ZmCsfeException.SVC_UNKNOWN_DOCUMENT:n.getErrorMsg=function(){\nreturn com_zimbra_securemail[\"smime.SERVER_EXTENSION_NOT_INSTALLED\"]\n};\nbreak;\ndefault:r=n.msg\n}\nthis.uploadCertificateWidget.render();\nif(r){\nvar o=appCtxt.getErrorDialog();\no.setMessage(r,null,DwtMessageDialog.CRITICAL_STYLE);\no.popup(null,true);\nreturn true\n}};\nZmSecureCertificateManager.prototype._confirmRemoveCertificate=function(e){\nvar t=appCtxt.getYesNoMsgDialog();\nt.setMessage(com_zimbra_securemail.certificateRemoveWarning,DwtMessageDialog.WARNING_STYLE);\nswitch(this.type){\ncase\"PREF\":t.registerCallback(DwtDialog.YES_BUTTON,this._removeUserCertificate,this,[e,t]);\nbreak;\ncase\"CONTACT\":t.registerCallback(DwtDialog.YES_BUTTON,this._removeContactCertificate,this,[e,t]);\nbreak;\ndefault:t.registerCallback(DwtDialog.YES_BUTTON,this._removeUserCertificate,this,[e,t]);\nbreak\n}\nt.popup()\n};\nZmSecureCertificateManager.prototype._removeUserCertificate=function(e,s){\nvar n=[];\ne.pvtKeyId&&n.push(e.pvtKeyId);\ne.pubCertId&&n.push(e.pubCertId);\nvar t=AjxSoapDoc.create(\"ItemActionRequest\",\"urn:zimbraMail\");\nvar o=t.set(\"action\");\no.setAttribute(\"id\",n.join());\no.setAttribute(\"op\",\"delete\");\nappCtxt.getAppController().sendRequest({\nsoapDoc:t,asyncMode:true,callback:new AjxCallback(this,this._handleRemoveCertificateRequest,[s]),errorCallback:new AjxCallback(this,this._handleRemoveCertificateError,[s])}\n)\n};\nZmSecureCertificateManager.prototype._handleRemoveCertificateRequest=function(e){\ne.popdown();\nthis.uploadCertificateWidget.render()\n};\nZmSecureCertificateManager.prototype._handleRemoveCertificateError=function(e){\ne.popdown()\n};\nZmSecureCertificateManager.prototype._disposePasswordDialog=function(){\nif(this._passwordDialog){\nthis._passwordDialog.popdown();\nthis._passwordDialog=null\n}};\nZmSecureCertificateManager.prototype._loadContactCertificate=function(){\nif(!this.contact){\nreturn\n}\nif(this.contact.certificate){\nvar e={\nparent:this.parent,certificates:this.contact.certificate,type:\"CONTACT_EDIT\",removeCertificateHandler:this._confirmRemoveCertificate.bind(this)};\nnew ZmSecureCertificatePreview(e)\n}else{\nthis.uploadCertificateWidget.render()\n}};\nZmSecureCertificateManager.prototype._saveContactCertificateRequest=function(e){\nif(!e&&!this.contact){\nreturn new DwtException(\"Missing Params\",DwtException.INVALID_PARAM)\n}\nvar o=e.uploadId;\nvar t=appCtxt.getCurrentView();\nif(t instanceof ZmEditContactView){\nt.newCertificate=o;\nt.setDirty(\"OTHER\",true);\nvar e={\nfileName:e.file.name,removeCallback:this._removeCertificateBubbleCallback};\nthis.uploadCertificateWidget._createSelectionBubble(e)\n}};\nZmSecureCertificateManager.prototype._removeCertificateBubbleCallback=function(){\nvar e=appCtxt.getCurrentView();\nif(e instanceof ZmEditContactView){\ne.newCertificate=null;\ne.setDirty(\"OTHER\",false)\n}};\nZmSecureCertificateManager.prototype._removeContactCertificate=function(e,t){\nt.popdown();\nthis.uploadCertificateWidget.render();\nvar o=appCtxt.getCurrentView();\nif(o instanceof ZmEditContactView){\no.newCertificate=null;\no.setDirty(\"OTHER\",true)\n}};\nZmSecureCertificateManager.prototype._cancelPasswordDialog=function(){\nthis._disposePasswordDialog();\nthis.uploadCertificateWidget.render()\n};\nZmSecureCertificatePreview=function(e){\nif(!e&&!e.certificates){\nreturn\n}\nDwtComposite.call(this,e);\nthis._init(e)\n};\nZmSecureCertificatePreview.prototype=new DwtComposite();\nZmSecureCertificatePreview.prototype.constructor=ZmSecureCertificatePreview;\nZmSecureCertificatePreview.prototype._init=function(e){\nthis.htmlId=this.getHTMLElId();\nthis.parent=e.parent||null;\nthis.certificates=e.certificates||[];\nthis.viewCertificateHandler=e.viewCertificateHandler||ZmCertificateView._showCertificate;\nthis.removeCertificateHandler=e.removeCertificateHandler||null;\nthis.type=e.type&&e.type.toUpperCase()||\"PREF\";\nthis.isSigned=e.isSigned||false;\nthis.isEncrypted=e.isEncrypted||false;\nif(this.certificates.length==0&&(!this.isSigned&&this.isEncrypted)){\nthis._renderEncryptionLabel()\n}else{\nAjxUtil.foreach(this.certificates,function(t){\nthis._render(t)\n}\n.bind(this))\n}};\nZmSecureCertificatePreview.prototype._render=function(e){\nthis.parent._createHtmlFromTemplate(\"ZmSecureMail#CertificateSummary\",{\nid:this.htmlId}\n);\nthis._renderCertificateErrorLabel(e);\nthis._renderUserLabel(e);\nthis._renderRemoveLabel(e);\nthis._renderViewLabel(e)\n};\nZmSecureCertificatePreview.prototype._renderCertificateErrorLabel=function(e){\nif(!e.errorCode){\nvar t=Dwt.byId(this.htmlId+\"_certStatusLabel\");\nt?t.outerHTML=\"\":null;\nreturn\n}\nvar o=new DwtLabel({\nparent:this.parent,style:DwtLabel.IMAGE_LEFT}\n);\no.reparentHtmlElement(this.htmlId+\"_certStatusLabel\");\no.setImage(\"Invalid\");\nswitch(e.errorCode){\ncase\"SIGNER_DIGEST_MISMATCH\":o.setText(com_zimbra_securemail.tamperedMsg);\nbreak;\ncase\"CERTIFICATE_NOT_YET_VALID\":o.setText(com_zimbra_securemail.notYetValidCertificateMsg);\nbreak;\ncase\"CERTIFICATE_REVOKED\":o.setText(com_zimbra_securemail.revokedCertificateMsg);\nbreak;\ncase\"CERTIFICATE_NOT_TRUSTED\":o.setText(com_zimbra_securemail.untrustedCertificateMsg);\nbreak;\ncase\"CERTIFICATE_EMAIL_ADDRESS_NOT_MATCHING\":o.setText(com_zimbra_securemail.certificateEmailInvalidMsg);\nbreak;\ncase\"INVALID_SIGNATURE\":o.setText(com_zimbra_securemail.invalidSignatureMsg);\nbreak;\ncase\"SIGNATURE_VALIDATION_FAILED\":o.setText(com_zimbra_securemail.signatureValidationFailedMsg);\nbreak;\ncase\"CERTIFICATE_VALIDATION_FAILED\":case\"VERIFIER_CERTIFICATE_NOT_VALID\":o.setText(com_zimbra_securemail.invalidCertificateMsg);\nbreak;\ncase\"CERTIFICATE_EXPIRED\":case\"VERIFIER_NOT_VALID_AT_SIGNING_TIME\":o.setText(com_zimbra_securemail.expiredCertificateMsg);\nbreak;\ndefault:o.setText(e.errorCode)\n}};\nZmSecureCertificatePreview.prototype._renderUserLabel=function(e){\nvar o=new DwtLabel({\nparent:this.parent,style:DwtLabel.IMAGE_LEFT}\n);\no.reparentHtmlElement(this.htmlId+\"_userLabel\");\nif([\"MSG\",\"CONTACT_VIEW\",\"CONTACT_EDIT\"].indexOf(this.type)>-1){\nvar t=e.emailAddress\n}else{\nif(e.issuedTo&&e.issuedTo.cn){\nvar t=e.issuedTo.cn+\" &#60;\"+e.emailAddress+\"&#62;\"\n}else{\nvar t=e.emailAddress\n}}\nif(this.isSigned&&this.isEncrypted){\nt=com_zimbra_securemail.signedAndencryptedMsg+\"&nbsp;\"+t\n}else{\nif(this.isSigned){\nt=com_zimbra_securemail.signedMsg+\"&nbsp;\"+t\n}}\no.setText(t);\nif(!e.errorCode){\nthis.isEncrypted?o.setImage(\"SignEncrypt\"):o.setImage(\"Valid\")\n}\nif(!t){\no=Dwt.byId(this.htmlId+\"_userLabel\");\no?o.outerHTML=\"\":null\n}};\nZmSecureCertificatePreview.prototype._renderRemoveLabel=function(e){\nif([\"CONTACT_VIEW\",\"MSG\"].indexOf(this.type)>-1){\nvar t=Dwt.byId(this.htmlId+\"_removeLabel\");\nt?t.outerHTML=\"\":null;\nreturn\n}\nvar t=new DwtLabel({\nparent:this.parent}\n);\nt.setText(com_zimbra_securemail.certificateRemoveLabel);\nt.reparentHtmlElement(this.htmlId+\"_removeLabel\");\nt.setClassName(\"FakeAnchor\");\nt.setHandler(DwtEvent.ONCLICK,AjxCallback.simpleClosure(this.removeCertificateHandler,this,e))\n};\nZmSecureCertificatePreview.prototype._renderViewLabel=function(e){\nvar t=new DwtLabel({\nparent:this.parent}\n);\nif([\"PREF\"].indexOf(this.type)>-1){\nt.setText(com_zimbra_securemail.certificateViewLabel)\n}else{\nt.setText(com_zimbra_securemail.certificateViewFullLabel)\n}\nt.reparentHtmlElement(this.htmlId+\"_viewLabel\");\nt.setClassName(\"FakeAnchor\");\nt.setHandler(DwtEvent.ONCLICK,AjxCallback.simpleClosure(this.viewCertificateHandler,this,e))\n};\nZmSecureCertificatePreview.prototype._renderEncryptionLabel=function(){\nvar e=new DwtLabel({\nparent:this.parent,style:DwtLabel.IMAGE_LEFT}\n);\ne.reparentHtmlElement(this.htmlId+\"_userLabel\");\ne.setText(com_zimbra_securemail.encryptedMsg);\ne.setImage(\"Encrypt\")\n};\nvar ZmCertificateView=function(){};\nZmCertificateView._showCertificate=function(e){\nvar r=ZmCertificateView.getProcessedCertificate(e);\nvar s=new DwtMessageDialog({\nparent:appCtxt.getShell()}\n);\ns.reset();\ns.setTitle(com_zimbra_securemail.certificate);\nvar o=AjxTemplate.expand(\"ZmSecureMail#CertificateDetails\",{\ncert:r}\n);\ns.setContent(o);\ns.popup();\nif(!e.errorCode){\nvar t=Dwt.byId(\"certDialog_certStatusLabel\");\nt?t.outerHTML=\"\":null\n}else{\nvar n=new DwtLabel({\nparent:this.parent,style:DwtLabel.IMAGE_LEFT}\n);\nn.reparentHtmlElement(\"certDialog_certStatusLabel\");\nswitch(e.errorCode){\ncase\"CERTIFICATE_NOT_YET_VALID\":n.setText(com_zimbra_securemail.notYetValidCertificateMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"CERTIFICATE_REVOKED\":n.setText(com_zimbra_securemail.revokedCertificateMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"CERTIFICATE_NOT_TRUSTED\":n.setText(com_zimbra_securemail.untrustedCertificateMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"CERTIFICATE_EMAIL_ADDRESS_NOT_MATCHING\":n.setText(com_zimbra_securemail.certificateEmailInvalidMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"INVALID_SIGNATURE\":n.setText(com_zimbra_securemail.invalidSignatureMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"SIGNATURE_VALIDATION_FAILED\":n.setText(com_zimbra_securemail.signatureValidationFailedMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"CERTIFICATE_VALIDATION_FAILED\":case\"VERIFIER_CERTIFICATE_NOT_VALID\":case\"SIGNER_INFORMATION_NOT_VERIFIED\":n.setText(com_zimbra_securemail.invalidCertificateMsg);\nn.setImage(\"Invalid\");\nbreak;\ncase\"CERTIFICATE_EXPIRED\":case\"VERIFIER_NOT_VALID_AT_SIGNING_TIME\":n.setText(com_zimbra_securemail.expiredCertificateMsg);\nn.setImage(\"Invalid\");\nbreak\n}}};\nZmCertificateView.getProcessedCertificate=function(l){\nvar o=function(m){\nreturn com_zimbra_securemail[m]||\"\"\n};\nvar t={};\nvar d=t[o(\"certSubject\")]={};\nif(l.issuedTo){\nd[o(\"certSubjectCN\")]=l.issuedTo.cn;\nd[o(\"certSubjectOrg\")]=l.issuedTo.o;\nd[o(\"certSubjectOrgUnit\")]=l.issuedTo.ou;\nd[o(\"certSubjectEmail\")]=l.issuedTo.emailAddress;\nd[o(\"certSubjectCountry\")]=l.issuedTo.c;\nd[o(\"certSubjectState\")]=l.issuedTo.st;\nd[o(\"certSubjectCity\")]=l.issuedTo.l\n}\nif(l.issuedBy){\nvar r=t[o(\"certIssuer\")]={};\nr[o(\"certIssuerCN\")]=l.issuedBy.cn;\nr[o(\"certIssuerOrg\")]=l.issuedBy.o;\nr[o(\"certIssuerOrgUnit\")]=l.issuedBy.ou;\nr[o(\"certIssuerEmail\")]=l.issuedBy.emailAddress;\nr[o(\"certIssuerCountry\")]=l.issuedBy.c;\nr[o(\"certIssuerState\")]=l.issuedBy.st;\nr[o(\"certIssuerCity\")]=l.issuedBy.l\n}\nif(l.validity){\nvar h=t[o(\"certValidity\")]={};\nh[o(\"certValidityBegin\")]=ZmCertificateView._formatDate(l.validity.startDate);\nh[o(\"certValidityEnd\")]=ZmCertificateView._formatDate(l.validity.endDate)\n}\nif(l.signature){\nvar s=t[o(\"certInfo\")]={};\ns[o(\"certInfoSN\")]=l.signature.serialNo;\ns[o(\"certInfoAlg\")]=ZmCertificateView._formatAlgorithm(l.signature.algorithm)\n}\nvar n=l.subjectAltName;\nif(n){\nvar e=t[o(\"subjectAltName\")]={};\nvar u=[\"otherName\",\"rfc822Name\",\"dNSName\",\"x400Address\",\"directoryName\",\"ediPartyName\",\"uniformResourceIdentifier\",\"iPAddress\",\"registeredID\"];\nAjxUtil.foreach(u,function(f,m){\nZmCertificateView.getSubjectAltNameAttrValues(n,f,e)\n}\n)\n}\nZmCertificateView._removeEmptyLeaves(t);\nreturn t\n};\nZmCertificateView.getSubjectAltNameAttrValues=function(n,o,e){\nif(n[o]){\nvar t=n[o];\nAjxUtil.foreach(t,function(r,s){\nif(s===0){\ne[com_zimbra_securemail[\"subjectAltName\"+o]]=r._content\n}else{\ne[o+\"blank\"+s]=r._content\n}}\n)\n}};\nZmCertificateView._formatDate=function(e){\nreturn e&&AjxDateUtil.longComputeDateStr(new Date(e))\n};\nZmCertificateView._formatAlgorithm=function(e){\ne=e.replace(/([A-Z])([a-z])/g,function(n,o,t){\nreturn\" \"+n\n}\n);\ne=e.replace(/([a-z])([A-Z])/g,function(n,o,t){\nreturn o+\" \"+t\n}\n);\nreturn e\n};\nZmCertificateView._removeEmptyLeaves=function(o){\nfor(var e in o){\nvar t=o[e];\nif(!t){\ndelete o[e]\n}else{\nif(AjxUtil.isObject(t)){\nZmCertificateView._removeEmptyLeaves(t)\n}}}};\nAjxTemplate.register(\"ZmSecureMail#Preferences\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]=\"<div class='prefHeader'>\";\ne[o++]=com_zimbra_securemail.label;\ne[o++]=\"</div><table class='ZOptionsSectionTable' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td class='ZOptionsSectionMain'><table width='100%'><tr><td colspan=\\\"2\\\"><b>\";\ne[o++]=com_zimbra_securemail.settingHeader;\ne[o++]='</b></td></tr><tr><td colspan=\"2\">';\ne[o++]=com_zimbra_securemail.settingHelpText;\ne[o++]=\"</td></tr><tr><td class=\\\"ZOptionsLabel\\\"></td><td class='ZOptionsField'><div id='\";\ne[o++]=s.id;\ne[o++]=\"_MAIL_SECURITY_PREF' tabindex='0'></div></td></tr><tr><td colspan=\\\"2\\\"><b>\";\ne[o++]=com_zimbra_securemail.certificateHeader;\ne[o++]='</b></td></tr><tr><td colspan=\"2\"><table role=\"presentation\" class=\"ZOptionsSectionTable\"><tr><td class=\"ZOptionsSectionMain ZmSecureMailCertificateContainer\" id=\"';\ne[o++]=s.id;\ne[o++]='_CertificateContainer\"></td></tr></table></td></tr></table></td></tr></table>';\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"ZmSecureMail#Preferences\"}\n,true);\nAjxPackage.define(\"ZmSecureMail\");\nAjxTemplate.register(\"ZmSecureMail\",AjxTemplate.getTemplate(\"ZmSecureMail#Preferences\"),AjxTemplate.getParams(\"ZmSecureMail#Preferences\"));\nAjxTemplate.register(\"ZmSecureMail#ZmCertificatePasswordDialog\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]=\"<table role=\\\"presentation\\\" class='ZPropertySheet' cellspacing='6'><tr><td class='Label' >\";\ne[o++]=s.labelPasswd;\ne[o++]=\": </td></tr><tr><td><input type='password' class='Field passwordInput'  id='\";\ne[o++]=s.id;\ne[o++]='_password\\' autocomplete=\"off\"/></td></tr></table>';\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"ZmSecureMail#ZmCertificatePasswordDialog\"}\n,true);\nAjxTemplate.register(\"ZmSecureMail#UploadWidget\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]='<div class=\"ZmCertificateHelpText\"><span id=\"';\ne[o++]=s.id;\ne[o++]='_CertificateHelpText\"></span>';\nif(s.validFileTypes){\ne[o++]=\"<span>\\n\";\ne[o++]=\"                    &nbsp;\";\ne[o++]=com_zimbra_securemail.validFileTypes;\ne[o++]=\" \";\ne[o++]=s.validFileTypes;\ne[o++]=\"</span>\"\n}\ne[o++]='</div><div class=\"ZmSecureMailUploadContainer\" id=\"';\ne[o++]=s.id;\ne[o++]='_ZmSecureMailUploadContainer\">';\nif(s.supportDnD){\ne[o++]=\"<div id='\";\ne[o++]=s.id;\ne[o++]='_UploadCertificateDnDBtn\\' class=\"ZmSecureMailInlineBlock ZmSecureDragDrop\"></div><div class=\"ZmSecureMailInlineBlock ZmSecureUploadOrLabel\">';\ne[o++]=com_zimbra_securemail.uploadOptionsOr;\ne[o++]='</div><div class=\"ZmSecureMailInlineBlock ZmSecureMailUploadCertBtn\" id=\\'';\ne[o++]=s.id;\ne[o++]=\"_UploadCertificateBtn'></div>\"\n}else{\ne[o++]='<div class=\"ZmSecureMailInlineBlock ZmSecureMailUploadCertBtn\" id=\\'';\ne[o++]=s.id;\ne[o++]=\"_UploadCertificateBtn'></div><div id='\";\ne[o++]=s.id;\ne[o++]='_certificateBubbleContainer\\' class=\"ZmSecureMailInlineBlock ZmSecureBubbleContainer\"></div>'\n}\ne[o++]='<div class=\"ZmSecureMailInlineBlock ZmSecureSaveToCompleteLabel\">';\ne[o++]=com_zimbra_securemail.saveToCompleteUpload;\ne[o++]=\"</div></div>\";\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"ZmSecureMail#UploadWidget\"}\n,true);\nAjxTemplate.register(\"ZmSecureMail#CertificateSummary\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]='<table width=\"100%\"><tr><td class=\"ZmSecureMailCertificateRow\"><div id=\\'';\ne[o++]=s.id;\ne[o++]=\"_certStatusLabel' class=\\\"invalid_cert_wrapper\\\"></div><div id='\";\ne[o++]=s.id;\ne[o++]=\"_userLabel'></div><div id='\";\ne[o++]=s.id;\ne[o++]=\"_viewLabel'></div><div id='\";\ne[o++]=s.id;\ne[o++]=\"_removeLabel'></div></td></tr></table>\";\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"ZmSecureMail#CertificateSummary\"}\n,true);\nAjxTemplate.register(\"ZmSecureMail#CertificateDetails\",function(e,t,l,r){\nvar o=Boolean(r);\nl=(typeof l==\"string\"?{\nid:l}\n:l)||{};\nr=r||[];\nvar n=r.length;\nr[n++]=\"<div class=\\\"CertificateDetailsWrapper\\\"><div id='certDialog_certStatusLabel' class=\\\"invalid_cert_wrapper\\\"></div><table class='CertificateDetails'>\";\nfor(var d in l.cert){\nif(d!=\"_summary_\"){\nif(AjxUtil.isObject(l.cert[d])){\nr[n++]=\"<tr data-name = '\";\nr[n++]=d;\nr[n++]=\"' ><td class='Label1'>\";\nr[n++]=d;\nr[n++]=\"</td><td></td></tr>\";\nfor(var s in l.cert[d]){\nif(AjxUtil.isArray(l.cert[d][s])){\nfor(var h=0;\nh<l.cert[d][s].length;\nh++){\nr[n++]=\"<tr data-name = '\";\nr[n++]=s;\nr[n++]=\"' ><td class='Label2'>\";\nr[n++]=(h==0)?s:\"&nbsp;\";\nr[n++]=\"</td><td class='Value'>\";\nr[n++]=l.cert[d][s][h];\nr[n++]=\"</td></tr>\"\n}}else{\nr[n++]=\"<tr  data-name = '\";\nr[n++]=s;\nr[n++]=\"' >\";\nvalue=l.cert[d][s];\nif(s.indexOf(\"blank\")>=0){\nr[n++]=s=\"\"\n}\nr[n++]=\"<td class='Label2'>\";\nr[n++]=s;\nr[n++]=\"</td><td class='Value'>\";\nr[n++]=value;\nr[n++]=\"</td></tr>\"\n}}}else{\nr[n++]=\"<tr data-name = '\";\nr[n++]=d;\nr[n++]=\"' ><td class='Label1'>\";\nr[n++]=d;\nr[n++]=\"</td><td class='Value'>\";\nr[n++]=l.cert[d];\nr[n++]=\"</td></tr>\"\n}}}\nr[n++]=\"</table></div>\";\nreturn o?r.length:r.join(\"\")\n}\n,{\nid:\"ZmSecureMail#CertificateDetails\"}\n,true);\nAjxTemplate.register(\"ZmSecureMail#UploadBubble\",function(t,r,s,e){\nvar n=Boolean(e);\ns=(typeof s==\"string\"?{\nid:s}\n:s)||{};\ne=e||[];\nvar o=e.length;\ne[o++]=\"<span id='\";\ne[o++]=s.id;\ne[o++]=\"_certificateBubble' class='AttachmentLoading attachmentBubble AttachmentSpan certificateBubble' name='CertificateUploadSpan'><span class='AttProgressSpan2'>\";\ne[o++]=s.fileName;\ne[o++]=\"</span><span class='ImgBubbleDelete AttachmentClose CertificateBubbleClose'></span></span>\";\nreturn n?e.length:e.join(\"\")\n}\n,{\nid:\"ZmSecureMail#UploadBubble\"}\n,true);\nfunction com_zimbra_rocket_HandlerObject(){\ncom_zimbra_rocket_HandlerObject.settings={}\n}\ncom_zimbra_rocket_HandlerObject.prototype=new ZmZimletBase();\ncom_zimbra_rocket_HandlerObject.prototype.constructor=com_zimbra_rocket_HandlerObject;\nvar ZimbraRocketZimlet=com_zimbra_rocket_HandlerObject;\nZimbraRocketZimlet.prototype.init=function(){\ntry{\nvar t=appCtxt._zimletMgr.getZimletByName(\"com_zimbra_rocket\").handlerObject;\nZimbraRocketZimlet.prototype.setTab()\n}\ncatch(e){\nconsole.log(e)\n}};\nZimbraRocketZimlet.prototype.setTab=function(){\ntry{\nvar t=appCtxt._zimletMgr.getZimletByName(\"com_zimbra_rocket\").handlerObject;\nt.tabLabel=t._zimletContext.getConfig(\"tabLabel\");\nt.ZimbraRocketTab=t.createApp(t.tabLabel,\"ZimbraRocket-panelIcon\",t.tabLabel,null,DwtLabel.IMAGE_RIGHT)\n}\ncatch(e){\nconsole.log(e)\n}};\nZimbraRocketZimlet.prototype.setIframe=function(){\ntry{\nvar r=appCtxt._zimletMgr.getZimletByName(\"com_zimbra_rocket\").handlerObject;\nvar s=appCtxt.getApp(r.ZimbraRocketTab);\nvar n=document.getElementById(\"skin_container_app_new_button\").getBoundingClientRect();\ns.setContent('<div style=\"position: fixed; top:'+n.y+'px; left:0; width:100%; height:92%; border:0px;\"><iframe id=\"ZimbraRocketFrame\" style=\"z-index:2; left:0; width:100%; height:100%; border:0px;\" src=\"'+r._zimletContext.getConfig(\"rocketurl\")+'\"></div>');\nvar e=r.tabLabel=r._zimletContext.getConfig(\"tabLabel\");\nvar t=appCtxt.getZimletMgr().getZimletByName(\"com_zimbra_rocket\").handlerObject.ZimbraRocketTab;\nwindow.addEventListener(\"message\",function(h){\nif(h.data.eventName===\"unread-changed\"){\nif(h.data.data!=\"\"){\ndocument.title=ZmMsg.zimbraTitle+\": \"+e+\" (\"+h.data.data.toString()+\")\";\ndocument.getElementById(\"zb__App__\"+t+\"_title\").innerHTML=e+\" (\"+h.data.data.toString()+\")\";\ndocument.getElementById(\"zb__App__\"+t).classList.add(\"ZAlert\")\n}else{\ndocument.title=ZmMsg.zimbraTitle+\": \"+e;\ndocument.getElementById(\"zb__App__\"+t+\"_title\").innerHTML=e;\ndocument.getElementById(\"zb__App__\"+t).classList.remove(\"ZAlert\")\n}}}\n)\n}\ncatch(o){\nconsole.log(o)\n}};\nZimbraRocketZimlet.prototype.appLaunch=function(e){\ntry{\nZimbraRocketZimlet.prototype.setIframe()\n}\ncatch(t){\nconsole.log(t)\n}};\nZimbraRocketZimlet.prototype.appActive=function(e,n){\nvar h=appCtxt._zimletMgr.getZimletByName(\"com_zimbra_rocket\").handlerObject;\nif(n){\ndocument.title=ZmMsg.zimbraTitle+\": \"+h._zimletContext.getConfig(\"tabLabel\");\nif(document.getElementById(\"ZimbraRocketFrame\")){\nsetTimeout(function(){\ndocument.getElementById(\"ZimbraRocketFrame\").focus()\n}\n,1000)\n}\ndocument.getElementById(\"z_sash\").style.display=\"none\";\ntry{\nvar o=document.getElementsByClassName(\"DwtCalendar\");\no[0].style.display=\"none\"\n}\ncatch(t){\nsetTimeout(function(){\ntry{\nvar u=document.getElementsByClassName(\"DwtCalendar\");\nu[0].style.display=\"none\"\n}\ncatch(d){}}\n,4000)\n}\nvar r=appCtxt.getApp(h.ZimbraRocketTab);\nvar s=r.getOverview();\ns.setContent(\"&nbsp;\");\ntry{\nvar l=document.getElementById(s._htmlElId);\nl.parentNode.removeChild(l)\n}\ncatch(t){}}else{\ndocument.getElementById(\"z_sash\").style.display=\"block\";\ntry{\nvar o=document.getElementsByClassName(\"DwtCalendar\");\no[0].style.display=\"block\"\n}\ncatch(t){}}};"
                    },
                    "redirectURL": "",
                    "headersSize": 319,
                    "bodySize": 227593
                },
                "cache": {},
                "timings": {
                    "send": 0,
                    "wait": 0,
                    "receive": 0
                }
            }
        ],
        "_webSocketEntries": {},
        "_settings": {
            "_proxy": {}
        }
    }
}
